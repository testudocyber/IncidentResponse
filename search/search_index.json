{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>/docs/   \u251c\u2500\u2500 index.md (or README.md)   \u251c\u2500\u2500 _config.yml (optional but recommended)   \u251c\u2500\u2500 1.Preparation/   \u251c\u2500\u2500 2.Identification/   \u251c\u2500\u2500 3.Containment/   \u251c\u2500\u2500 4.Eradication/   \u251c\u2500\u2500 5.Recovery/   \u251c\u2500\u2500 6.LessonsLearned/   \u2514\u2500\u2500 ReferenceDocuments/</p>"},{"location":"404/","title":"Page Not Found","text":"<p>Sorry, the page you were looking for does not exist.</p> <p>Return Home</p>"},{"location":"StyleGuide/","title":"StyleGuide","text":"<p>This repository is a compulation of SOPs and How Tos for conducting a generic Incident Response.  It is designed to provide a wide variety of options.  </p>"},{"location":"StyleGuide/#concept-for-contributions","title":"Concept for contributions","text":"<ul> <li>IR Phase - Example: (2.Identification)  </li> <li>README.md Table of Contents for phase tasks  </li> <li>IR Phase Task - Example: (2.02_Create_Active_IP_List)  <ul> <li>Scripts  </li> <li>README.md IR Phase Task  </li> </ul> </li> </ul>"},{"location":"StyleGuide/#script-style-guide","title":"Script Style Guide","text":"<p>Name the script the following way. <pre><code># {TaskID}-WhatScriptDoes.(sh/ps1)\n2.04-GatherADStructureInformation.ps1\n</code></pre></p>"},{"location":"StyleGuide/#1-bash","title":"1. Bash","text":"<p>Use Camel Case for Variable and Function Names:</p> <pre><code># variable: varCaseFirstLetterofEachWord\n# function: funcCaseFirstLetterofEachWord\n\nmyVariable=\"My Variable\"\n\nfunction myFunction {\n  # do something...\n}\n</code></pre>"},{"location":"StyleGuide/#2-powershell","title":"2. Powershell","text":"<p>Use Pascal Case for Variable. Function Names should be Verb-Action combination: <pre><code># variable: VarCaseFirstLetterofEachWord\n# function: FuncCaseFirstLetterofEachWord\n\n$MyVariable = \"My Variable\"\n\nfunction MyFunction {\n  # do something...\n}\n</code></pre></p>"},{"location":"StyleGuide/#3-python","title":"3. Python","text":"<p>Follow PEP 8 Guide Line: https://www.python.org/dev/peps/pep-0008/</p>"},{"location":"StyleGuide/#git-workflow","title":"Git Workflow","text":""},{"location":"StyleGuide/#1-clone-the-repo","title":"1. clone the repo","text":"<p>Once your account has MFA enforced you will need to use an API key.  Make sure you store your API key in a safe place, I would suggest your password manager. Generate API Key</p> <pre><code># copy url of this git repo and replace APIKEY with yours generated above\n$ git clone https://APIKEY@github.com/cmdcnd/IncidentResponse.git\n</code></pre> <p>once you clone, at this point, you should only have local copy of <code>main</code> branch. you can check all local branches using</p> <pre><code>$ git branch\n(output should look)\n* main\n</code></pre>"},{"location":"StyleGuide/#2-create-a-local-branch","title":"2. create a local branch","text":"<p>create a local branch with name that is related to changes that are being made. <pre><code>$ git checkout -b $YOUR_LOCAL_BRANCH_NAME\n\n# if you're working on task 2.04, you can do something like.\n\n$ git checkout -b task-2.04\n</code></pre></p> <p>You can check all local branches again. <pre><code>$ git branch\n(output should look)\n  main\n* task-2.04\n</code></pre></p> <p>you can also jump back and forth different branch using <pre><code>$ git checkout $(branch_name)\n</code></pre></p> <p>This allows avoiding making changes directly on main which is usually the official branch where we only want to keep changes that are validated and reviewed.</p>"},{"location":"StyleGuide/#3-complete-tasks-documenations","title":"3. complete tasks documenations","text":"<ul> <li>complete README.md: you can get the template and the example from ./template</li> <li>add any scripts if you have one under $(your_tasks_folder)/scripts</li> <li>make sure to include detailed steps for running the script.</li> </ul>"},{"location":"StyleGuide/#4-add-your-changes","title":"4. add your changes","text":"<p>any changes to an existing files or a new file will show with red text when you run <pre><code>$ git status\n</code></pre></p> <p>before commiting, files you want to commit need to be added. <pre><code># adding everything: this has to run at the top level folder that contains any changes that are made.\n$ git add .\n\n# or add one at a time: if you want to commit some but leave others.\n$ git add $(file_name)\n</code></pre></p> <p>if you run the <code>git status</code> again, added files should show up green in color.</p>"},{"location":"StyleGuide/#5-commit-your-changes","title":"5. commit your changes","text":"<p>committing will open whatever editor that is set as <code>core.editor</code> under <pre><code>$ git config --list\n</code></pre></p> <p>this is so that you can write a commit message. make sure that you're comfortable with editor the git is about to open.</p> <p>once you've confirmed that all files that need to be committed are added, commit the changes.</p> <pre><code>$ git commit\n</code></pre> <p>make sure to write a meaningful commit message that gives context to what changes are made. the first line becomes the header, and add a space and write the body.</p> <p>When you save and exit our of the editor, commit is complete.  </p>"},{"location":"StyleGuide/#6-push-your-local-branch-to-remote","title":"6. push your local branch to remote","text":"<p>The branch you've created in step 2 is only available locally.  Remote is the central version of repo where everybody can access.  In order to make the branch available at remote, the branch needs to be pushed.  </p> <p>run this while you are at your branch: this means when <code>git branch</code> has <code>*</code> next to the branch you want to push. <pre><code>$ git push\n</code></pre></p> <p>When you push the local branch for the first time, <code>git</code> will complain because the remote branch does not exist yet for the local branch. in git, the paired remote branch of the local branch is called the upstream.</p> <pre><code>fatal: The current branch task-2.04 has no upstream branch.\nTo push the current branch and set the remote as upstream, use\n\n    git push --set-upstream origin task-2.04\n</code></pre> <p>Run the command the git suggests. <pre><code>$ git push --set-upstream origin task-2.04\n</code></pre></p> <p>Setting the upstream is required only once for the very first time, and if you need to push any other changes to your branch afterward, you can simply do</p> <pre><code>$ git push\n</code></pre>"},{"location":"StyleGuide/#7-create-a-pull-request","title":"7. create a pull request","text":"<p>Now, the branch with your change is available remote. when you go to git repo: https://github.com/cmdcnd/IncidentResponse, you can create a pull request.  </p> <p>git should show a banner in the main repo as a short cut asking if you want to make a pull request out of the recent push.</p> <p>Or, you can click on <code>create a pull request</code> button. choose <code>main</code> on the left, and <code>your branch</code> on the right.</p>"},{"location":"StyleGuide/#references","title":"References","text":"<p>Tasks are based on the NIST Framework for Improving Critical Infrastructure Cybersecurity. NIST Framework for Improving Critical Infrastructure Cybersecurity </p>"},{"location":"1.Preparation/","title":"1.Preparation","text":""},{"location":"1.Preparation/#preparation-tasks","title":"Preparation Tasks","text":"<p>The preparation phase of incident response is the phase where an organization takes proactive steps to prepare for potential security incidents or breaches. The goal of this phase is to establish an incident response plan that outlines the necessary procedures, roles and responsibilities, and tools and resources required to detect, respond to, and recover from security incidents.  </p> <p>The preparation phase typically involves the following activities:  </p> <ul> <li>Establishing an incident response team: This team is responsible for managing the incident response process and includes representatives from various departments within the organization.  </li> <li>Defining the incident response plan: This plan outlines the steps to be taken during a security incident, including who to contact, what actions to take, and how to communicate with stakeholders.  </li> <li>Identifying and prioritizing assets: This involves identifying critical assets that are essential to the organization's operations and prioritizing them based on their importance.  </li> <li>Conducting risk assessments: This involves identifying potential threats and vulnerabilities to the organization's assets and assessing the likelihood and impact of these risks.  </li> <li>Implementing security controls: This involves implementing security measures such as firewalls, intrusion detection systems, and access controls to reduce the likelihood of security incidents.  </li> <li>Testing and updating the incident response plan: This involves testing the incident response plan to ensure that it works as intended and updating it as necessary to reflect changes in the organization's infrastructure, assets, or threat landscape.  </li> </ul> <p>Overall, the preparation phase is critical for ensuring that an organization is well-prepared to respond to security incidents in a timely and effective manner.  </p>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/","title":"Troop Leading Procedures Task","text":""},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#conditions","title":"Conditions","text":"<ul> <li>Given a mission to deploy an IR Team in support of Guardnet, State IT systems, or other organization as directed by the Governor.</li> <li>Response effort is localized and a Type I / II Federal Disaster Response has not been declared.</li> </ul>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#standards","title":"Standards","text":"<ul> <li>Receive the Mission</li> <li>Issue a warning order</li> <li>Make a tentative plan</li> <li>Start necessary movement</li> <li>Reconnoiter</li> <li>Complete the plan</li> <li>Issue the complete order</li> <li>Supervise</li> </ul>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#receive-the-mission","title":"Receive the Mission","text":"<ul> <li> Confirm receipt of the mission from higher headquarters.</li> <li> Document the mission parameters (who, what, where, when, why).</li> <li> Notify all IR Team leadership and key staff.</li> <li> Create initial mission folder (digital or physical).</li> </ul>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#issue-a-warning-order","title":"Issue a Warning Order","text":"<ul> <li> Notify all team members that a mission is pending.</li> <li> Provide known details:</li> <li>Expected mission start</li> <li>Location</li> <li>Initial support needs</li> <li> Confirm acknowledgement from each member.</li> </ul>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#make-a-tentative-plan","title":"Make a Tentative Plan","text":"<ul> <li> Conduct initial mission analysis.</li> <li> Identify tasks, constraints, and resources.</li> <li> Draft preliminary COA (Course of Action).</li> <li> Consult SME if available.</li> </ul>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#start-necessary-movement","title":"Start Necessary Movement","text":"<ul> <li> Initiate movement prep (gear, transportation, documentation).</li> <li> Assign movement officer.</li> <li> Coordinate with logistics and mission partner for site access.</li> </ul>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#reconnoiter","title":"Reconnoiter","text":"<ul> <li> Conduct remote or physical site recon (network topology, owner engagement).</li> <li> Validate assumptions in tentative plan.</li> <li> Update plan based on recon findings.</li> </ul>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#complete-the-plan","title":"Complete the Plan","text":"<ul> <li> Finalize OPORD or verbal orders.</li> <li> Coordinate support requirements.</li> <li> Validate plan with mission owner if applicable.</li> </ul>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#issue-the-complete-order","title":"Issue the Complete Order","text":"<ul> <li> Issue OPORD or verbal orders to IR Team.</li> <li> Conduct mission brief to cover:</li> <li>Situation</li> <li>Mission</li> <li>Execution</li> <li>Sustainment</li> <li>Command/Signal</li> </ul>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#supervise","title":"Supervise","text":"<ul> <li> Monitor execution.</li> <li> Adjust orders as needed (FRAGOs).</li> <li> Ensure after-action capture and reporting.</li> </ul>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#tools-and-resources","title":"Tools and Resources","text":"Purpose Tools OPORD creation Word template or Confluence Mission tracking SharePoint, IR Tracker Communication MS Teams, Phone, Radio"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#end-state","title":"End State","text":"<p>As time allows, conduct MDMP, develop OPORD (and/or FRAGOs), and on-premises recon. If time does not allow, verbal orders are issued and documented during Cyber Incident Tracking.</p>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#references","title":"References","text":"<ul> <li>CALL Handbook 15-06: MDMP</li> <li>150-LDR-5012: Troop Leading Procedures</li> <li>ADP 6-22: Army Leadership</li> </ul>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.1 Expanded with procedural checklist and operator details Leo"},{"location":"1.Preparation/1.02-Receive_Mission/","title":"Receive the Mission Task","text":""},{"location":"1.Preparation/1.02-Receive_Mission/#conditions","title":"Conditions","text":"<ul> <li>Given an IR Team mission to support Guardnet, State IT systems, or another organization as directed by the Governor.</li> <li>Response effort is localized and a Type I / II Federal Disaster Response has not been declared.</li> </ul>"},{"location":"1.Preparation/1.02-Receive_Mission/#standards","title":"Standards","text":"<p>Successfully understand guidance from higher and deploy appropriate resources to complete the mission.</p> <ul> <li>Receive Mission</li> <li>Issue WARNO</li> <li>Conduct Mission Analysis</li> <li>Develop Courses of Action</li> <li>Estimate Manning</li> <li>Produce OPORD</li> <li>Activate Personnel and mobilize</li> </ul>"},{"location":"1.Preparation/1.02-Receive_Mission/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.02-Receive_Mission/#receive-mission","title":"Receive Mission","text":"<ul> <li> Receive official mission notification.</li> <li> Document mission requirements and limitations.</li> <li> Notify IR Team leadership.</li> <li> Create mission folder.</li> </ul>"},{"location":"1.Preparation/1.02-Receive_Mission/#issue-warning-order-warno","title":"Issue Warning Order (WARNO)","text":"<ul> <li> Draft and issue WARNO with:</li> <li>Mission overview</li> <li>Timeline</li> <li>Task organization</li> <li> Confirm acknowledgment by all personnel.</li> </ul>"},{"location":"1.Preparation/1.02-Receive_Mission/#conduct-mission-analysis","title":"Conduct Mission Analysis","text":"<ul> <li> Identify mission requirements and objectives.</li> <li> Assess environment (internal network, external stakeholders).</li> <li> Identify gaps and constraints.</li> </ul>"},{"location":"1.Preparation/1.02-Receive_Mission/#develop-courses-of-action-coa","title":"Develop Courses of Action (COA)","text":"<ul> <li> Draft multiple COAs (best case, worst case, likely case).</li> <li> Assess risks and benefits of each.</li> <li> Select optimal COA for execution.</li> </ul>"},{"location":"1.Preparation/1.02-Receive_Mission/#estimate-manning","title":"Estimate Manning","text":"<ul> <li> Identify skills needed (forensics, network, malware).</li> <li> Assign personnel and fill gaps as necessary.</li> <li> Validate all personnel are available and fit for duty.</li> </ul>"},{"location":"1.Preparation/1.02-Receive_Mission/#produce-opord","title":"Produce OPORD","text":"<ul> <li> Utilize OPORD template.</li> <li> Ensure Annex P (Information) and Annex H (Communications) are detailed.</li> <li> Review and approve by OIC.</li> <li> Issue OPORD.</li> </ul>"},{"location":"1.Preparation/1.02-Receive_Mission/#activate-personnel-and-mobilize","title":"Activate Personnel and Mobilize","text":"<ul> <li> Notify personnel of mission start.</li> <li> Stage equipment and prepare movement.</li> <li> Coordinate access to mission site.</li> </ul>"},{"location":"1.Preparation/1.02-Receive_Mission/#tools-and-resources","title":"Tools and Resources","text":"Purpose Tools OPORD drafting Word or Confluence Personnel management Google Sheet, Excel, Task Tracker Communication MS Teams, Email"},{"location":"1.Preparation/1.02-Receive_Mission/#end-state","title":"End State","text":"<p>The IR Team arrives on-site with appropriate personnel and equipment, prepared to execute defensive operations.</p>"},{"location":"1.Preparation/1.02-Receive_Mission/#references","title":"References","text":"<ul> <li>NIST Cyber Security Framework</li> <li>NIST SP 800-61r2: Computer Security Incident Handling Guide</li> </ul>"},{"location":"1.Preparation/1.02-Receive_Mission/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.1 Expanded with procedural checklist and operator guidance Leo"},{"location":"1.Preparation/1.03-Personnel_Status/","title":"Personnel Status &amp; Logistics Task","text":""},{"location":"1.Preparation/1.03-Personnel_Status/#conditions","title":"Conditions","text":"<ul> <li>Given a mission to deploy an IR Team in support of Guardnet, State IT systems, or other organization as directed by the Governor.</li> <li>Response effort is localized and a Type I / II Federal Disaster Response has not been declared.</li> </ul>"},{"location":"1.Preparation/1.03-Personnel_Status/#standards","title":"Standards","text":"<ul> <li>Verify personnel status: State Active Duty (SAD) or T32.</li> <li>Ensure orders are published for on-mission personnel.</li> <li>Coordinate for lodging, meals, and other Soldier needs.</li> <li>Coordinate for transportation to/from mission location.</li> <li>Provide reporting on Personnel Status (PERSTAT) to chain of command.</li> </ul>"},{"location":"1.Preparation/1.03-Personnel_Status/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.03-Personnel_Status/#verify-personnel-status","title":"Verify Personnel Status","text":"<ul> <li> Confirm each team member's duty status with personnel systems (SAD, T32).</li> <li> Verify with HR or admin staff that personnel orders are valid and current.</li> <li> Document status and keep updated roster.</li> </ul>"},{"location":"1.Preparation/1.03-Personnel_Status/#tools","title":"Tools:","text":"<ul> <li>State or unit personnel systems (SIDPERS, J1 tools)</li> <li>Manual roster in Excel or Google Sheets</li> </ul>"},{"location":"1.Preparation/1.03-Personnel_Status/#ensure-orders-are-published","title":"Ensure Orders Are Published","text":"<ul> <li> Review activation or mission orders for accuracy.</li> <li> Distribute orders to each team member.</li> <li> File orders in mission log folder.</li> </ul>"},{"location":"1.Preparation/1.03-Personnel_Status/#coordinate-for-lodging-meals-and-soldier-needs","title":"Coordinate for Lodging, Meals, and Soldier Needs","text":"<ul> <li> Contact logistics coordinator or J4 representative.</li> <li> Arrange hotel or barracks lodging.</li> <li> Setup meal plan or MRE issue.</li> <li> Document lodging and meal logistics in mission log.</li> </ul>"},{"location":"1.Preparation/1.03-Personnel_Status/#coordinate-transportation","title":"Coordinate Transportation","text":"<ul> <li> Schedule military or commercial transport.</li> <li> Verify route, pickup/drop-off points.</li> <li> Provide transportation details to all personnel.</li> <li> Confirm movement and arrival.</li> </ul>"},{"location":"1.Preparation/1.03-Personnel_Status/#tools_1","title":"Tools:","text":"<ul> <li>DTS, State Fleet Management portals</li> <li>Google Sheets manifest</li> </ul>"},{"location":"1.Preparation/1.03-Personnel_Status/#provide-personnel-status-reporting-perstat","title":"Provide Personnel Status Reporting (PERSTAT)","text":"<ul> <li> Create PERSTAT format (standard roster with status: Available, On Mission, Injured, etc.).</li> <li> Collect updates daily or as required.</li> <li> Send report to chain of command via secure email or Teams.</li> </ul>"},{"location":"1.Preparation/1.03-Personnel_Status/#tools_2","title":"Tools:","text":"<ul> <li>PERSTAT Excel template</li> <li>Secure email (DOD365, Outlook)</li> </ul>"},{"location":"1.Preparation/1.03-Personnel_Status/#references","title":"References","text":"<ul> <li>NGAUS Fact Sheet - Guard Duty Status</li> </ul>"},{"location":"1.Preparation/1.03-Personnel_Status/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Expanded Standards and operator checklist Leo"},{"location":"1.Preparation/1.04-Legal_Support/","title":"Legal Support Task","text":""},{"location":"1.Preparation/1.04-Legal_Support/#conditions","title":"Conditions","text":"<ul> <li>Given a mission to deploy an IR Team in support of Guardnet, State IT systems, or other organization as directed by the Governor.</li> <li>Response effort is localized and a Type I / II Federal Disaster Response has not been declared.</li> </ul>"},{"location":"1.Preparation/1.04-Legal_Support/#standards","title":"Standards","text":"<ul> <li>Verify personnel status: State Active Duty (SAD) or T32.</li> <li>Coordinate with JAG / Cyber Legal personnel regarding MOUs and NDAs.</li> <li>Coordinate with JAG / Cyber Legal personnel to review Rules for Use of Cyber (RUC).</li> <li>Continue legal coordination after arriving on mission.</li> <li>Coordinate immediately if a Soldier becomes involved in illegal activities.</li> </ul>"},{"location":"1.Preparation/1.04-Legal_Support/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.04-Legal_Support/#verify-personnel-status","title":"Verify Personnel Status","text":"<ul> <li> Confirm all team members are under correct legal status for operation (SAD, T32).</li> <li> Ensure all personnel understand authorities and limitations based on status.</li> </ul>"},{"location":"1.Preparation/1.04-Legal_Support/#coordinate-mous-and-ndas","title":"Coordinate MOUs and NDAs","text":"<ul> <li> Engage JAG / Legal advisor upon mission notification.</li> <li> Determine if NDAs or MOUs are needed for mission partner interaction.</li> <li> Draft and send templates for mission partner review.</li> <li> Secure signed documents and store in mission documentation folder.</li> </ul>"},{"location":"1.Preparation/1.04-Legal_Support/#tools","title":"Tools:","text":"<ul> <li>MOU/NDA Templates (Word docs)</li> <li>Adobe Acrobat or DocuSign for signing</li> </ul>"},{"location":"1.Preparation/1.04-Legal_Support/#review-rules-for-use-of-cyber-ruc","title":"Review Rules for Use of Cyber (RUC)","text":"<ul> <li> Review existing RUC documents.</li> <li> Confirm with legal advisor that rules are up to date.</li> <li> Disseminate RUC to IR team prior to mission execution.</li> </ul>"},{"location":"1.Preparation/1.04-Legal_Support/#maintain-legal-coordination-on-mission","title":"Maintain Legal Coordination On Mission","text":"<ul> <li> Provide daily or event-based updates to legal advisors.</li> <li> Consult legal when new authorities or questionable activities arise.</li> <li> Log all legal consultations in mission log.</li> </ul>"},{"location":"1.Preparation/1.04-Legal_Support/#respond-to-illegal-activity-or-issues","title":"Respond to Illegal Activity or Issues","text":"<ul> <li> Immediately notify JAG and leadership.</li> <li> Suspend related IR activity pending legal review.</li> <li> Follow documented procedures for reporting.</li> </ul>"},{"location":"1.Preparation/1.04-Legal_Support/#references","title":"References","text":"<ul> <li>Consult your state JAG for relevant legal references and pre-mission packets.</li> </ul>"},{"location":"1.Preparation/1.04-Legal_Support/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Expanded standards and procedural checklist Leo"},{"location":"1.Preparation/1.05-Partner_Engagements/","title":"Partner Engagements Task","text":""},{"location":"1.Preparation/1.05-Partner_Engagements/#conditions","title":"Conditions","text":"<ul> <li>Given a mission to deploy an IR Team in support of Guardnet, State IT systems, or other organization as directed by the Governor.</li> <li>Response effort is localized and a Type I / II Federal Disaster Response has not been declared.</li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#standards","title":"Standards","text":"<ul> <li>Verify personnel status: State Active Duty (SAD) or T32.</li> <li>Work with mission partner POC to understand support requirements.</li> <li>Recognize mission partner authority.</li> <li>Coordinate MOUs and NDAs.</li> <li>Provide updates to mission partner POC.</li> <li>Make recommendations as appropriate.</li> <li>Avoid interacting with mission partner systems without approval.</li> <li>Prepare to share all findings.</li> <li>Report any illegal activity immediately to mission partner and authorities.</li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.05-Partner_Engagements/#verify-personnel-status","title":"Verify Personnel Status","text":"<ul> <li> Confirm team members\u2019 duty status and readiness.</li> <li> Share personnel summary with mission partner for accountability.</li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#work-with-mission-partner-poc","title":"Work with Mission Partner POC","text":"<ul> <li> Identify and document primary POC.</li> <li> Conduct initial meeting to gather requirements and expectations.</li> <li> Clarify reporting expectations and meeting cadence.</li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#respect-mission-partner-authority","title":"Respect Mission Partner Authority","text":"<ul> <li> Ensure IR team members know the mission partner is in charge.</li> <li> Document and escalate any disagreements professionally.</li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#coordinate-mous-and-ndas","title":"Coordinate MOUs and NDAs","text":"<ul> <li> Engage legal and partner POC to draft and sign MOUs/NDAs.</li> <li> Ensure all team members have signed documents before accessing partner systems.</li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#tools","title":"Tools:","text":"<ul> <li>MOU/NDA templates</li> <li>DocuSign or Adobe Acrobat</li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#provide-regular-updates","title":"Provide Regular Updates","text":"<ul> <li> Establish reporting format (summary or technical).</li> <li> Send updates at agreed intervals (daily, end of shift).</li> <li> Log updates in IR mission log.</li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#make-recommendations","title":"Make Recommendations","text":"<ul> <li> Document observations or improvements.</li> <li> Deliver recommendations respectfully and in writing when possible.</li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#avoid-unauthorized-system-interaction","title":"Avoid Unauthorized System Interaction","text":"<ul> <li> Obtain written permission for all system access.</li> <li> Use approved tools only.</li> <li> Log all access and actions.</li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#example-command-for-safe-read-only-access-linux","title":"Example command for safe read-only access (Linux):","text":"<pre><code>mount -o ro /dev/sda1 /mnt/analysis\n</code></pre>"},{"location":"1.Preparation/1.05-Partner_Engagements/#prepare-to-share-findings","title":"Prepare to Share Findings","text":"<ul> <li> Document all actions, findings, and timelines.</li> <li> Prepare both technical and executive summaries.</li> <li> Validate findings with partner before release.</li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#report-illegal-activity","title":"Report Illegal Activity","text":"<ul> <li> If identified, notify mission partner immediately.</li> <li> Pause affected IR activities until advised.</li> <li> Document reporting and responses.</li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#references","title":"References","text":"<ul> <li>FM 3-13: Information Operations (Chapter 9, Soldier and Leader Engagements)</li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Expanded standards and detailed checklist for partner coordination Leo"},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/","title":"Create and Execute IR Team Orders Task","text":""},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#conditions","title":"Conditions","text":"<ul> <li>Given an OPORD for IR Team Operations</li> </ul>"},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#standards","title":"Standards","text":"<p>Create and execute Defensive Cyber Operations (DCO) Orders:</p> <ul> <li>Enter Request for Orders</li> <li>Establish Rules of Engagement (ROE)</li> <li>Execute supporting documents</li> </ul>"},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#enter-request-for-orders","title":"Enter Request for Orders","text":"<ul> <li> Identify operational requirement through mission planning.</li> <li> Draft order request specifying:</li> <li>Scope of operation</li> <li>Participating personnel and units</li> <li>Mission start and end times</li> <li>Tools/authorities required</li> <li> Submit draft to Incident Commander and legal for review.</li> <li> Send formal request via chain of command system (e.g. JOCS or email).</li> <li> Track submission and approval status.</li> </ul>"},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#establish-rules-of-engagement-roe","title":"Establish Rules of Engagement (ROE)","text":"<ul> <li> Work with Legal Support and Operations to define ROE.</li> <li> ROE must clarify:</li> <li>What actions are authorized</li> <li>What actions require escalation</li> <li>Any non-permissible actions</li> <li> Disseminate ROE to all IR team members.</li> <li> Store ROE document in mission folder.</li> </ul>"},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#execute-supporting-documents","title":"Execute Supporting Documents","text":"<ul> <li> Develop supporting documents such as:</li> <li>Concept of Operations (CONOPS)</li> <li>Execution checklist</li> <li>Communication plan</li> <li> Review documents with team during briefing.</li> <li> Maintain version control and archive in mission log repository.</li> </ul>"},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#tools","title":"Tools","text":"<ul> <li>Microsoft Word or Markdown for orders</li> <li>Email or Command and Control platforms (JOCS, Slack Ops Channel)</li> <li>File storage: SharePoint, Confluence</li> </ul>"},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#references","title":"References","text":"<ul> <li>NIST Cyber Security Framework</li> <li>NIST SP 800-184: Guide to Cyber Event Recovery</li> </ul>"},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Expanded procedural checklist for orders process Leo"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/","title":"Integrate Additional Support Task","text":""},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#conditions","title":"Conditions","text":"<ul> <li>Given a mission to deploy IR Team in support of Guardnet or State IT systems</li> <li>Scope exceeds IR Team capabilities or escalates to Federal response levels</li> </ul>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#standards","title":"Standards","text":"<ul> <li>Coordinate with JAG/Cyber Legal for inclusion of T10 forces</li> <li>Confirm Dual Status Commander requirement</li> <li>Establish T10 and IR team coordination</li> <li>Review and establish Rules for Use of Cyber (RUC)</li> <li>Coordinate daily integration operations (Battle Rhythm)</li> <li>Coordinate immediately on any legal concerns</li> </ul>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#coordinate-legal-inclusion-of-t10-forces","title":"Coordinate Legal Inclusion of T10 Forces","text":"<ul> <li> Notify legal team of operational scope change.</li> <li> Request review for integration of federal assets.</li> <li> Document authorities and jurisdictional considerations.</li> </ul>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#confirm-dual-status-commander-requirement","title":"Confirm Dual Status Commander Requirement","text":"<ul> <li> Escalate to TAG (Adjutant General) for determination.</li> <li> Assign liaison officer for Dual Status Commander coordination.</li> <li> Document appointment and roles.</li> </ul>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#coordinate-t10-arrival-and-integration","title":"Coordinate T10 Arrival and Integration","text":"<ul> <li> Notify State Joint Operations Center (JOC) upon arrival.</li> <li> Conduct joint in-brief and mission sync.</li> <li> Assign partner liaison roles.</li> </ul>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#establish-battle-rhythm-and-integration","title":"Establish Battle Rhythm and Integration","text":"<ul> <li> Define daily brief and debrief schedule.</li> <li> Align reporting formats.</li> <li> Create shared communication channels (Teams, SIPR, Signal).</li> </ul>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#update-rules-for-use-of-cyber-ruc","title":"Update Rules for Use of Cyber (RUC)","text":"<ul> <li> Engage JAG to review and update RUC.</li> <li> Brief all teams on updated RUC.</li> <li> Document RUC in mission folder.</li> </ul>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#coordinate-legal-issues","title":"Coordinate Legal Issues","text":"<ul> <li> Set direct contact protocols with JAG for urgent legal matters.</li> <li> Immediately notify JAG of any actual or perceived illegal activities.</li> <li> Suspend relevant operations pending review.</li> </ul>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#tools","title":"Tools","text":"<ul> <li>MS Teams or Slack for coordination</li> <li>SharePoint or Confluence for documentation</li> <li>Email/DTS for official correspondence</li> </ul>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#references","title":"References","text":"<ul> <li>NIST Cyber Security Framework</li> <li>NIST SP 800-61r2: Computer Security Incident Handling Guide</li> </ul>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Expanded procedural checklist for integration Leo"},{"location":"1.Preparation/1.08-Mission_Intent/","title":"Receive, Plan, and Communicate Mission Intent Task","text":""},{"location":"1.Preparation/1.08-Mission_Intent/#conditions","title":"Conditions","text":"<ul> <li>IR Team requested to support mission partner\u2019s critical information systems</li> </ul>"},{"location":"1.Preparation/1.08-Mission_Intent/#standards","title":"Standards","text":"<ul> <li>Use MDMP to develop Course of Action (COA)</li> <li>Address non-standard considerations:</li> <li>Duty Status (SAD, Title 10/32)</li> <li>Cyber tool availability/limitations</li> <li>Escalation procedures</li> <li>OPSEC requirements</li> <li>Legal support</li> </ul>"},{"location":"1.Preparation/1.08-Mission_Intent/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.08-Mission_Intent/#use-mdmp-to-develop-coa","title":"Use MDMP to Develop COA","text":"<ul> <li> Define mission and objectives.</li> <li> Gather intelligence on environment and threat.</li> <li> Develop multiple COAs considering risk and constraints.</li> <li> Select best COA and document rationale.</li> </ul>"},{"location":"1.Preparation/1.08-Mission_Intent/#address-duty-status","title":"Address Duty Status","text":"<ul> <li> Verify personnel duty status (SAD, T10/32).</li> <li> Validate legal authorities for each member.</li> <li> Adjust tasking accordingly.</li> </ul>"},{"location":"1.Preparation/1.08-Mission_Intent/#review-cyber-tool-availability","title":"Review Cyber Tool Availability","text":"<ul> <li> Identify required IR tools.</li> <li> Validate mission partner approval for tool usage.</li> <li> Prepare alternate tools/scripts if access denied.</li> </ul>"},{"location":"1.Preparation/1.08-Mission_Intent/#example-alternate-tool-if-edr-blocked","title":"Example Alternate Tool (if EDR blocked):","text":"<pre><code>ps -ef | grep suspicious_process\nnetstat -antup\n</code></pre>"},{"location":"1.Preparation/1.08-Mission_Intent/#define-escalation-procedures","title":"Define Escalation Procedures","text":"<ul> <li> Establish thresholds for escalation.</li> <li> Designate escalation contacts.</li> <li> Document and communicate process to team.</li> </ul>"},{"location":"1.Preparation/1.08-Mission_Intent/#review-opsec-requirements","title":"Review OPSEC Requirements","text":"<ul> <li> Confirm classification level and sensitivity of mission.</li> <li> Define handling requirements for data and reports.</li> <li> Provide OPSEC brief to IR team.</li> </ul>"},{"location":"1.Preparation/1.08-Mission_Intent/#maintain-legal-coordination","title":"Maintain Legal Coordination","text":"<ul> <li> Engage JAG during planning.</li> <li> Validate ROE and jurisdiction.</li> <li> Document legal signoff on mission plan.</li> </ul>"},{"location":"1.Preparation/1.08-Mission_Intent/#references","title":"References","text":"<ul> <li>ADP 5.0</li> </ul>"},{"location":"1.Preparation/1.08-Mission_Intent/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Expanded checklist including non-standard considerations Leo"},{"location":"1.Preparation/1.09-Continuous_AARs/","title":"Continuous AARs Task","text":""},{"location":"1.Preparation/1.09-Continuous_AARs/#conditions","title":"Conditions","text":"<ul> <li>IR Team deployed in support of Guardnet or State IT systems</li> </ul>"},{"location":"1.Preparation/1.09-Continuous_AARs/#standards","title":"Standards","text":"<p>Develop After Action Reviews (AARs) covering:</p> <ul> <li>List of Participants</li> <li>Review of key actions and events</li> <li>Lessons Learned analysis</li> <li>Remediation plans</li> <li>Indicators of Compromise (IOC) sharing</li> <li>Staff performance review</li> <li>Corrective actions</li> <li>Tool utilization review</li> </ul>"},{"location":"1.Preparation/1.09-Continuous_AARs/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.09-Continuous_AARs/#list-of-participants","title":"List of Participants","text":"<ul> <li> Document all IR team members and key stakeholders.</li> <li> Include mission partner contacts.</li> </ul>"},{"location":"1.Preparation/1.09-Continuous_AARs/#review-key-actionsevents","title":"Review Key Actions/Events","text":"<ul> <li> Capture timeline of major actions.</li> <li> Note decisions and outcomes.</li> <li> Use mission log as reference.</li> </ul>"},{"location":"1.Preparation/1.09-Continuous_AARs/#analyze-lessons-learned","title":"Analyze Lessons Learned","text":"<ul> <li> Identify what went well.</li> <li> Highlight what didn\u2019t work and why.</li> <li> Document suggested improvements.</li> </ul>"},{"location":"1.Preparation/1.09-Continuous_AARs/#develop-remediation-plans","title":"Develop Remediation Plans","text":"<ul> <li> Assign action items to responsible parties.</li> <li> Set target dates for completion.</li> <li> Track and verify completion post-incident.</li> </ul>"},{"location":"1.Preparation/1.09-Continuous_AARs/#share-indicators-of-compromise-iocs","title":"Share Indicators of Compromise (IOCs)","text":"<ul> <li> Extract IOCs from forensic data.</li> <li> Format for sharing (STIX, plain text).</li> <li> Provide to mission partner and ISAC.</li> </ul>"},{"location":"1.Preparation/1.09-Continuous_AARs/#example-ioc-sharing-format","title":"Example IOC Sharing Format:","text":"<pre><code>IOC Type: IP Address\nValue: 203.0.113.45\nObserved: 2025-05-01\nDescription: C2 Server\n</code></pre>"},{"location":"1.Preparation/1.09-Continuous_AARs/#review-staff-performance","title":"Review Staff Performance","text":"<ul> <li> Collect team feedback.</li> <li> Note outstanding contributions or gaps.</li> <li> Recommend training or recognition.</li> </ul>"},{"location":"1.Preparation/1.09-Continuous_AARs/#review-corrective-actions-and-tool-utilization","title":"Review Corrective Actions and Tool Utilization","text":"<ul> <li> Document tool performance and issues.</li> <li> Recommend upgrades or replacements.</li> <li> Adjust playbooks based on tool success/failures.</li> </ul>"},{"location":"1.Preparation/1.09-Continuous_AARs/#references","title":"References","text":"<ul> <li>NIST Cyber Security Framework</li> <li>NIST SP 800-61r2</li> </ul>"},{"location":"1.Preparation/1.09-Continuous_AARs/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully expanded checklist and IOC sharing process Leo"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/","title":"Incident Tracking Task","text":""},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#conditions","title":"Conditions","text":"<ul> <li>IR team activated with requirement to track all cyber incidents.</li> <li>Database or centralized tracking system is available.</li> </ul>"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#standards","title":"Standards","text":"<ul> <li>Create a database schema that supports the tracking of cyber incidents.</li> <li>Record all confirmed true-positive incidents.</li> <li>Report confirmed incidents to higher (ACOIC / INTEL).</li> </ul>"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#create-incident-tracking-database","title":"Create Incident Tracking Database","text":"<ul> <li> Determine location for central database (local server, SQL database, Google Sheets, Confluence table).</li> <li> Define schema including:</li> <li>Incident ID (auto-generated preferred)</li> <li>Source ID or handler ID</li> <li>Confirmation Status</li> <li>Incident Summary</li> <li>Related Incidents</li> <li>Confidence Rating</li> <li>Incident Notes</li> </ul>"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#tools","title":"Tools","text":"<ul> <li>SQL database (MySQL, PostgreSQL) for structured use</li> <li>Google Sheets or Airtable for small teams</li> <li>Confluence or Jira for integrated workflow</li> </ul>"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#example-sql-table-creation-script","title":"Example SQL Table Creation Script:","text":"<pre><code>CREATE TABLE incident_tracking (\n    incident_id SERIAL PRIMARY KEY,\n    source_id VARCHAR(50),\n    confirmed BOOLEAN,\n    summary TEXT,\n    related_incidents TEXT,\n    confidence ENUM('Low','Medium','High'),\n    notes TEXT\n);\n</code></pre>"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#record-confirmed-true-positive-incidents","title":"Record Confirmed True Positive Incidents","text":"<ul> <li> For each verified incident:</li> <li>Assign Incident ID</li> <li>Populate all required fields</li> <li>Update incident status</li> <li> Maintain real-time data entry discipline.</li> </ul>"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#report-to-acoic-or-higher","title":"Report to ACOIC (or higher)","text":"<ul> <li> Create incident summary based on database entry.</li> <li> Follow reporting format (email, daily SITREP).</li> <li> Send via secure means (encrypted email or Teams).</li> </ul>"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#end-state","title":"End State","text":"<ul> <li>All incidents are tracked in standardized database.</li> <li>True positives are reported to higher HQ or ACOIC.</li> </ul>"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#references","title":"References","text":"<ul> <li>VERIS: The Vocabulary for Event Recording and Incident Sharing</li> </ul>"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Expanded procedural checklist and SQL example Leo"},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/","title":"Review Organizational Information Security Policy and Constraints Task","text":""},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#conditions","title":"Conditions","text":"<ul> <li>IR team activated to support a mission partner.</li> <li>Security policies and IT governance documents are available.</li> </ul>"},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#standards","title":"Standards","text":"<ul> <li>Request and review the organization's Information Security and IT policies before mission execution.</li> <li>Understand constraints on VPN access, removable media, and data handling.</li> <li>Use policies to inform IR team operating procedures.</li> </ul>"},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#request-security-policies","title":"Request Security Policies","text":"<ul> <li> Contact mission partner POC to request:</li> <li>Information Security Policies</li> <li>Acceptable Use Policies (AUP)</li> <li>Network Access Policy</li> <li>Data Handling Policy</li> </ul>"},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#review-and-analyze-policies","title":"Review and Analyze Policies","text":"<ul> <li> Assign team member to review documents.</li> <li> Identify constraints relevant to IR operations:</li> <li>VPN access requirements</li> <li>Restrictions on removable media</li> <li>Data transfer limitations</li> <li>Logging and monitoring obligations</li> </ul>"},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#adjust-ir-operations-accordingly","title":"Adjust IR Operations Accordingly","text":"<ul> <li> Brief IR team on constraints.</li> <li> Update IR checklist or playbooks to reflect policy-driven restrictions.</li> <li> Log policy review and adjustments in mission documentation.</li> </ul>"},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#engage-legalcompliance-if-required","title":"Engage Legal/Compliance (if required)","text":"<ul> <li> If unclear or restrictive policies exist, escalate for review.</li> <li> Obtain approvals for deviations or waivers.</li> </ul>"},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#tools","title":"Tools","text":"<ul> <li>PDF viewers (Adobe Reader, Foxit)</li> <li>Policy review checklist (Excel, Confluence template)</li> </ul>"},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#end-state","title":"End State","text":"<ul> <li>IR team operations aligned to mission partner security requirements.</li> <li>No policy violations during incident response activities.</li> </ul>"},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Expanded procedural checklist for policy review process Leo"},{"location":"1.Preparation/1.14-Request_Logs/","title":"Request Logs from Mission Owner Task","text":""},{"location":"1.Preparation/1.14-Request_Logs/#conditions","title":"Conditions","text":"<ul> <li>IR team activated and network investigation required.</li> <li>Logs may be needed from internal and external sources.</li> </ul>"},{"location":"1.Preparation/1.14-Request_Logs/#standards","title":"Standards","text":"<ul> <li>Immediately request logs covering the previous 30 days (minimum).</li> <li>Focus requests on IAP, proxy, DNS, DHCP, and host/network sensor logs.</li> </ul>"},{"location":"1.Preparation/1.14-Request_Logs/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.14-Request_Logs/#identify-required-logs","title":"Identify Required Logs","text":"<ul> <li> Confirm log sources with network owner:</li> <li>Internet Access Provider (IAP)</li> <li>Proxy firewall logs</li> <li>DNS logs</li> <li>DHCP logs</li> <li>Host and network sensor logs (EDR, IDS, SIEM)</li> </ul>"},{"location":"1.Preparation/1.14-Request_Logs/#prepare-and-send-log-request","title":"Prepare and Send Log Request","text":"<ul> <li> Draft log request memo or email:</li> <li>Include log types, timeframe (30 days minimum), and format.</li> <li>Use mission justification.</li> <li> Send request to network owner POC.</li> <li> Track request submission and ETA for receipt.</li> </ul>"},{"location":"1.Preparation/1.14-Request_Logs/#receive-and-validate-logs","title":"Receive and Validate Logs","text":"<ul> <li> Validate format and completeness upon receipt.</li> <li> Log receipt date/time and completeness in mission log.</li> </ul>"},{"location":"1.Preparation/1.14-Request_Logs/#tools","title":"Tools","text":"<ul> <li>Secure file transfer: SFTP, encrypted email, external hard drive</li> <li>Log review: ElasticSearch, Kibana, Splunk, grep (Linux)</li> </ul>"},{"location":"1.Preparation/1.14-Request_Logs/#example-log-validation-command-linux","title":"Example Log Validation Command (Linux):","text":"<pre><code>gzip -l firewall_logs_202504.tar.gz\nwc -l firewall_logs_202504/*.log\n</code></pre>"},{"location":"1.Preparation/1.14-Request_Logs/#organize-and-store-logs","title":"Organize and Store Logs","text":"<ul> <li> Store logs securely (IR evidence repository).</li> <li> Document chain of custody if needed.</li> </ul>"},{"location":"1.Preparation/1.14-Request_Logs/#analyze-logs","title":"Analyze Logs","text":"<ul> <li> Assign log analysis tasks to IR team members.</li> <li> Use tools/scripts to parse and identify indicators of compromise.</li> </ul>"},{"location":"1.Preparation/1.14-Request_Logs/#end-state","title":"End State","text":"<ul> <li>Logs successfully requested, received, validated, and stored.</li> <li>Ready for analysis and use in incident investigation.</li> </ul>"},{"location":"1.Preparation/1.14-Request_Logs/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Expanded procedural checklist and log validation examples Leo"},{"location":"1.Preparation/1.15-Interview_Network_Owner/","title":"Interview Network Owner Task","text":""},{"location":"1.Preparation/1.15-Interview_Network_Owner/#purpose","title":"Purpose","text":"<p>Identify available tools, sensors, and network monitoring capabilities through structured discussion with the mission owner. Use this information to understand the environment and propose additional capabilities as needed.</p>"},{"location":"1.Preparation/1.15-Interview_Network_Owner/#standards","title":"Standards","text":"<p>An IR Team deploys to an existing network that may or may not have adequate sensors to complete the mission. It is important to discuss existing sensors, network monitoring and cyber defense tools (firewalls, SIEM, malware detection, discovery/mapping tools) with the mission owner. Based on this interview, determine what tools are already in place and discuss additional needs.</p>"},{"location":"1.Preparation/1.15-Interview_Network_Owner/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.15-Interview_Network_Owner/#prepare-for-the-interview","title":"Prepare for the Interview","text":"<ul> <li> Assign team member to lead the interview.</li> <li> Gather existing network documentation if available.</li> <li> Prepare interview packet (see references).</li> </ul>"},{"location":"1.Preparation/1.15-Interview_Network_Owner/#example-interview-preparation-resources","title":"Example interview preparation resources:","text":"<ul> <li>Mission Owner Interview Packet (Questionnaire)</li> </ul>"},{"location":"1.Preparation/1.15-Interview_Network_Owner/#conduct-the-interview","title":"Conduct the Interview","text":"<ul> <li> Schedule and conduct meeting with mission owner.</li> <li> Use prepared questions to guide the discussion:</li> <li>What tools are currently used for network monitoring and detection?</li> <li>Are there gaps or coverage issues (unmonitored zones)?</li> <li>Are logs centralized or dispersed?</li> <li>Is there endpoint visibility (EDR or AV)?</li> <li>What is the process to request additional tools or capabilities?</li> </ul>"},{"location":"1.Preparation/1.15-Interview_Network_Owner/#capture-findings-and-determine-additional-needs","title":"Capture Findings and Determine Additional Needs","text":"<ul> <li> Document current tools and coverage.</li> <li> Identify any gaps or blind spots.</li> <li> Propose additional sensors or tools if needed.</li> <li> Coordinate approval with network owner.</li> </ul>"},{"location":"1.Preparation/1.15-Interview_Network_Owner/#record-and-distribute-findings","title":"Record and Distribute Findings","text":"<ul> <li> Summarize findings and recommendations.</li> <li> Share with IR team for integration into response planning.</li> </ul>"},{"location":"1.Preparation/1.15-Interview_Network_Owner/#tools-and-resources","title":"Tools and Resources","text":"Purpose Tools Interview documentation Incident Response Victim Questionnaire Communication MS Teams, Email"},{"location":"1.Preparation/1.15-Interview_Network_Owner/#references","title":"References","text":"<ul> <li>Incident Response Owner Interview Packet</li> </ul>"},{"location":"1.Preparation/1.15-Interview_Network_Owner/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.1 Expanded procedural checklist Leo"},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/","title":"Establish Mission Owner Priorities and Objectives Task","text":""},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#purpose","title":"Purpose","text":"<p>Understand mission owner's objectives and define success criteria and minimum viable services to guide incident response decisions.</p>"},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#standards","title":"Standards","text":"<p>The IR Team should interview the business or mission owner to understand: - The mission priorities - What is required to avoid mission failure - What is required to succeed - Critical capabilities (services, ports, software/hardware, connectivity, confidentiality/integrity/availability requirements)</p>"},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#prepare-for-the-interview","title":"Prepare for the Interview","text":"<ul> <li> Assign lead interviewer.</li> <li> Prepare list of questions to define minimum viable services and objectives.</li> </ul>"},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#conduct-interview-with-mission-owner","title":"Conduct Interview with Mission Owner","text":"<ul> <li> Ask about:</li> <li>Bare minimum requirements to avoid mission failure</li> <li>Desired outcomes and success definition</li> <li>Critical business processes</li> <li>Acceptable downtime windows</li> <li>Priority levels for recovery</li> </ul>"},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#example-interview-questions","title":"Example Interview Questions","text":"<pre><code>1. Which systems and services must remain online no matter what?\n2. What would constitute mission failure?\n3. What is tolerable downtime for each service?\n4. Which systems are \"nice to have\" vs mission essential?\n</code></pre>"},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#document-and-confirm-priorities","title":"Document and Confirm Priorities","text":"<ul> <li> Create mission owner priority matrix.</li> <li> Validate with owner and record approval.</li> </ul>"},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#disseminate-to-ir-team","title":"Disseminate to IR Team","text":"<ul> <li> Share documented objectives and priorities.</li> <li> Incorporate into response planning and playbooks.</li> </ul>"},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#tools-and-resources","title":"Tools and Resources","text":"Purpose Tools Documentation Google Docs, Confluence Communication MS Teams, Email"},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.1 Expanded with procedural checklist and interview examples Leo"},{"location":"1.Preparation/1.17-Establish_Mission_Log/","title":"Establish Mission Log Task","text":""},{"location":"1.Preparation/1.17-Establish_Mission_Log/#purpose","title":"Purpose","text":"<p>Create and maintain a detailed Mission Log for all incident response activities to support tracking, reporting, and after-action review.</p>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#standards","title":"Standards","text":"<ul> <li>Conduct incident tracking utilizing Date-Time Group (DTG)</li> <li>Provide incident description and categorization</li> <li>Enumerate discovery and response actions</li> <li>Utilize report logs and sanitize for archiving</li> </ul>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.17-Establish_Mission_Log/#establish-the-mission-log-format","title":"Establish the Mission Log Format","text":"<ul> <li> Determine logging platform (Excel, Google Sheet, Confluence).</li> <li> Configure fields:</li> <li>Date/Time</li> <li>Category (using Federal Agency Incident Categories)</li> <li>System/IP</li> <li>Technical Notes</li> <li>Summary</li> <li>Operator (RANK LAST, FIRST)</li> </ul>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#train-team-on-log-use","title":"Train Team on Log Use","text":"<ul> <li> Brief team on required entries and frequency.</li> <li> Review 9-Line and Category reference materials.</li> </ul>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#record-entries-in-real-time","title":"Record Entries in Real Time","text":"<ul> <li> Log all actions, observations, and communications.</li> <li> Use standardized terminology.</li> <li> Avoid sensitive or classified information unless authorized.</li> </ul>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#consolidate-and-archive","title":"Consolidate and Archive","text":"<ul> <li> Create daily summaries.</li> <li> Sanitize client/victim data.</li> <li> Store sanitized versions in CPT archive.</li> </ul>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#tools-and-resources","title":"Tools and Resources","text":"Purpose Tools Mission log entry Excel, Confluence Incident categorization US CERT Incident Categories"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#references","title":"References","text":"<ul> <li>Mission Log template</li> <li>Federal Agency Incidents Categories Spreadsheet</li> <li>Malware 9-Line Report template</li> </ul>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.1 Expanded with procedural checklist and log format Leo"},{"location":"1.Preparation/1.18-Request_Network_Accounts/","title":"Request Network Accounts Task","text":""},{"location":"1.Preparation/1.18-Request_Network_Accounts/#purpose","title":"Purpose","text":"<p>Gain necessary access to mission partner networks and systems for incident response activities.</p>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#standards","title":"Standards","text":"<ul> <li>Identify account types required.</li> <li>Establish access conditions and approval process.</li> <li>Gain access based on authorization and need-to-know.</li> <li>Monitor and remove accounts as needed.</li> </ul>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.18-Request_Network_Accounts/#identify-account-requirements","title":"Identify Account Requirements","text":"<ul> <li> Determine needed access for IR activities.</li> <li> Confirm with mission partner POC:</li> <li>End-user access</li> <li>Shared credentials</li> <li>Service accounts</li> </ul>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#submit-account-requests","title":"Submit Account Requests","text":"<ul> <li> Assign team member as Account Manager.</li> <li> Complete request forms (e.g. DD Form 2875).</li> <li> Submit request through mission partner process.</li> </ul>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#validate-access-and-use","title":"Validate Access and Use","text":"<ul> <li> Confirm accounts provide necessary access.</li> <li> Monitor use during mission.</li> <li> Notify partner of any issues or changes.</li> </ul>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#deactivate-accounts-post-mission","title":"Deactivate Accounts Post-Mission","text":"<ul> <li> Request account deactivation.</li> <li> Validate closure in mission closeout.</li> </ul>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#tools-and-resources","title":"Tools and Resources","text":"Purpose Tools Access request DD Form 2875 Documentation SharePoint, Confluence"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#references","title":"References","text":"<ul> <li>DD Form 2875.pdf</li> <li>NIST.SP.800-53r4</li> </ul>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.1 Expanded with procedural checklist and account management guidance Leo"},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/","title":"Legal Authorities and Regulatory Constraints Task","text":""},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#purpose","title":"Purpose","text":"<p>Ensure all IR activities operate within State legal authorities, privacy protections, and mission partner regulatory frameworks.</p>"},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#standards","title":"Standards","text":"<ul> <li>IR teams will generally operate under State authorities.</li> <li>Supporting CIKR missions introduces privacy/civil liberty constraints.</li> <li>Constraints must be reviewed with mission owner.</li> </ul>"},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#identify-applicable-legal-authorities","title":"Identify Applicable Legal Authorities","text":"<ul> <li> Confirm state activation status and rules.</li> <li> Engage legal support (JAG or organizational counsel).</li> <li> Clarify privacy and civil liberty constraints (PII, HIPAA, etc).</li> </ul>"},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#validate-mission-activities-against-constraints","title":"Validate Mission Activities Against Constraints","text":"<ul> <li> Review planned IR actions with legal.</li> <li> Adjust procedures to align with legal guidance.</li> </ul>"},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#document-and-maintain-legal-reviews","title":"Document and Maintain Legal Reviews","text":"<ul> <li> Record all legal consultations and approvals.</li> <li> Maintain documentation with incident logs.</li> </ul>"},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#maintain-awareness-and-adjust-as-needed","title":"Maintain Awareness and Adjust As Needed","text":"<ul> <li> Review legal considerations during mission briefings.</li> <li> Immediately pause and consult if issues arise.</li> </ul>"},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#tools-and-resources","title":"Tools and Resources","text":"Purpose Tools Legal consultation MS Teams, Email Documentation SharePoint, Confluence"},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.1 Expanded with legal coordination procedures Leo"},{"location":"1.Preparation/Preparation_References/","title":"Index","text":""},{"location":"1.Preparation/Preparation_References/#business-owner-packets-task","title":"Business Owner Packets Task","text":"<p>This packet will be provided to the Business Owner by the Team Leader. Once complete, the packet will be then be provided to the Mission Element Leads and the Analytics Support Officer, who will then provide a better refined packet, which contains only pertinent information, to the Intelligence Analysts.  </p>"},{"location":"2.Identification/","title":"Identification Phase Overview","text":""},{"location":"2.Identification/#purpose","title":"Purpose","text":"<p>Develop situational awareness and identify potential incidents by leveraging available detection methods, tools, and techniques. Accurate identification supports rapid response and minimizes impact.</p>"},{"location":"2.Identification/#standards","title":"Standards","text":"<ul> <li>Understand the mission partner\u2019s business environment and key assets.</li> <li>Establish detection methodologies using available tools and telemetry.</li> <li>Collect and analyze data from multiple sources to detect suspicious activity.</li> <li>Validate potential incidents before declaring an incident.</li> <li>Record all identified incidents in accordance with incident handling procedures.</li> </ul>"},{"location":"2.Identification/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"2.Identification/#understand-business-environment-and-network-layout","title":"Understand Business Environment and Network Layout","text":"<ul> <li> Review organizational processes and critical business functions.</li> <li> Obtain and review network diagrams and asset inventories.</li> <li> Conduct site survey if necessary (see Task 2.01).</li> </ul>"},{"location":"2.Identification/#establish-detection-methods","title":"Establish Detection Methods","text":"<ul> <li> Review existing detection sources:</li> <li>IDS/IPS</li> <li>Antivirus / EDR</li> <li>Network firewall and proxy logs</li> <li>DNS and DHCP logs</li> <li> Deploy and configure additional detection tools if required.</li> </ul>"},{"location":"2.Identification/#collect-and-correlate-data","title":"Collect and Correlate Data","text":"<ul> <li> Gather logs and telemetry from all available sources.</li> <li> Use correlation tools (SIEM, grep, Elastic, Splunk) to identify patterns.</li> </ul>"},{"location":"2.Identification/#validate-potential-incidents","title":"Validate Potential Incidents","text":"<ul> <li> Analyze data using playbooks and IOC repositories.</li> <li> Confirm activity meets incident declaration criteria.</li> <li> Avoid false positives.</li> </ul>"},{"location":"2.Identification/#declare-and-document","title":"Declare and Document","text":"<ul> <li> Record confirmed incidents in the Incident Tracking System.</li> <li> Notify stakeholders and move to containment.</li> </ul>"},{"location":"2.Identification/#tools-and-resources","title":"Tools and Resources","text":"Platform Tool Purpose Windows Wireshark Packet capture and analysis Windows/Linux/macOS Nmap Host discovery and service enumeration Windows/Linux OSQuery Endpoint telemetry collection All Sysmon System activity logging Linux/macOS tcpdump Network capture Windows/Linux/macOS Velociraptor Endpoint artifact collection"},{"location":"2.Identification/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Initial upgraded version Leo"},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/","title":"2.01 Review Organizational Processes and Conduct a Site Survey","text":""},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#purpose","title":"Purpose","text":"<p>Identify the organization's network architecture, key systems, and security controls through interviews and site surveys. This information is foundational for effective incident detection.</p> <p>The IR Team should gather information from the mission owner (and Network owner) about its domain, organizational processes, method of patch configuration management, privilege rights, training, cross-domain transfers, use of removable devices etc., prior to the site survey. The CPT needs to receive, for example, a complete list of all workstations, servers, services, required applications, and trust requirements of the Domain(s) supported. Equally as important, the CPT needs to know the required services needed to run within the Domain and where these services can run. (Example: a Domain Controller can run several rolls and services such as DHCP, DNS, and Active Directory.) It is important to remember that there may be workstations that reside in workgroups not jointed to the domain. A site survey is recommended, even though the mission owner theoretically can provide all information remotely. The site survey helps to establish the working relationships with the mission owner and can also result in the identifcation of devices and connections not previously disclosed.</p>"},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#standards","title":"Standards","text":"<ul> <li>Interview mission owner and network owner.</li> <li>Understand domain architecture, trust relationships, patch management, and removable media policy.</li> <li>Conduct site survey to verify network layout and identify undocumented devices.</li> </ul>"},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#procedural-steps-checklist","title":"Procedural Steps (Checklist)","text":""},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#prepare-for-site-survey","title":"Prepare for Site Survey","text":"<ul> <li> Obtain preliminary network documentation.</li> <li> Prepare interview questions focused on:</li> <li>Domain structure and trust</li> <li>Patch and configuration management</li> <li>Privileged account management</li> <li>Allowed devices and media</li> </ul>"},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#conduct-interviews","title":"Conduct Interviews","text":"<ul> <li> Meet with mission owner and network owner.</li> <li> Capture responses in interview notes.</li> <li> Identify gaps or discrepancies in information.</li> </ul>"},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#conduct-site-survey","title":"Conduct Site Survey","text":"<ul> <li> Physically inspect network and server rooms.</li> <li> Document:</li> <li>Connected devices</li> <li>Wireless access points</li> <li>Unauthorized systems</li> </ul>"},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#validate-and-update-network-information","title":"Validate and Update Network Information","text":"<ul> <li> Reconcile site survey findings with existing documentation.</li> <li> Update asset inventory.</li> </ul>"},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#tools-and-resources","title":"Tools and Resources","text":"Platform Tool Purpose Windows/Linux/macOS Nmap Active host discovery Windows Advanced IP Scanner Local network discovery macOS/Linux arp-scan Network device discovery Mobile Fing App Network discovery on mobile device"},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Operator-level expanded version Leo"},{"location":"2.Identification/2.02-Create_Active_IP_List/","title":"Create Active IP List","text":""},{"location":"2.Identification/2.02-Create_Active_IP_List/#task-create-active-ip-list","title":"Task Create Active IP List","text":"<p>2.04 \u2013 Active_Host_and_Service_Enumeration 2.01 \u2013 Create a list of active IP addresses 2.05 \u2013 Create a list of active IP addresses with key ports included 2.07 \u2013 Scan ICS Equipment Ports 2.06 \u2013 Scan all ports of all hosts on given network segment  </p>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can access and scan the identified network segment(s), and network scanning software included in the team\u2019s incident response kit.  </p> <p>Operator Note: Before scanning, confirm ROE (Rules of Engagement) and authorization from network owner or mission lead. If ICS/SCADA involved, scanning may need to be coordinated and approved.</p>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#standards","title":"Standards","text":"<ul> <li>The team member identifies possibly compromised network segment(s).  </li> <li>The team member accesses a system that can scan the identified network segment(s).  </li> <li>The team member utilizes an IP-based network scanning utility to perform one of the following scanning tasks and directs the output to a text file for analysis:  <ul> <li>2.04 \u2013 Active Host and Service Enumeration  </li> <li>2.01 \u2013 Create a list of active IP addresses  </li> <li>2.05 \u2013 Create a list of active IP addresses with key ports included  </li> <li>2.07 \u2013 Scan ICS Equipment Ports  </li> <li>2.06 \u2013 Scan all ports of all hosts on given network segment  </li> </ul> </li> <li>The resulting scan data is compared to known network host data to determine anomalies present in the scanned network segment.  </li> <li>The results should be saved and uploaded to a central repository for team-wide access and review.</li> </ul> <p>Operator Note: Use timestamped filenames and document scan scope (date, network, target ranges) for later validation and correlation.</p>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#end-state","title":"End State","text":"<p>All active hosts, ports and services are carefully enumerated based on the specific sub-task accomplished and any anomalies or mis-configurations are identified.  </p> <p>Operator Note: Review scan results with NetOps or SysAdmins to clarify unknown hosts or services and avoid false positives.</p>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#manual-steps","title":"Manual Steps","text":"<p>A list of IP ranges can be provided by using the <code>-f IPRanges</code> option; otherwise, a range can be specified with <code>-i IPRange</code>.  </p> <p>For each BD, the script will need to be ran. The script will need to be marked executable before running:</p> <pre><code>chmod +x NmapScript.sh\n</code></pre> <ul> <li>For Task 2.04, run the NmapScript.sh and choose menu 1:</li> </ul> <pre><code>1. 2.04 \u2013 Active_Host_and_Service_Enumeration\n2. 2.01 \u2013 Create a list of active IP addresses\n3. 2.05 \u2013 Create a list of active IP addresses with key ports included\n4. 2.07 \u2013 Scan ICS Equipment Ports\n5. 2.06 \u2013 Scan all ports of all hosts on given network segment\n6. Exit\n\nSelection:&gt; 1\n</code></pre> <ul> <li>A log will be generated to NmapScript.txt and the output will be shown to the user:</li> </ul> <pre><code>Selection:&gt; 1\n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:47 EDT\n[+] Nmap scan report for 192.168.69.2\n[+] Host is up (0.00084s latency).\n[+] Not shown: 999 closed ports\n[+] PORT   STATE SERVICE VERSION\n[+] 53/tcp open  domain  dnsmasq 2.55\n[+] MAC Address: 00:50:56:EB:3D:1D (VMware)\n[+] Service detection performed.\n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 17.23 seconds\n</code></pre> <ul> <li>For Task 2.02, run the NmapScript.sh and choose menu 2:</li> </ul> <pre><code>Selection:&gt; 2\n[+] 192.168.69.1 is live!\n[+] 192.168.69.2 is live!\n[+] 192.168.69.142 is live!\n[+] 192.168.69.254 is live!\n[+] 192.168.69.132 is live!\n[+] 192.168.69.137 is live!\n</code></pre> <ul> <li>For Task 2.05, run the NmapScript.sh and choose menu 3:</li> </ul> <pre><code>Selection:&gt; 3\n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:56 EDT\n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds\n</code></pre> <ul> <li>For Task 2.07, run the script and choose menu 4 (ICS warning):</li> </ul> <pre><code>Selection:&gt; 4\n[!] It is possible for Scada devices to fail with an Nmap scan, do you want to continue? Y\n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:59 EDT\n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds\n</code></pre> <ul> <li>For Task 2.06, run the script and choose menu 5:</li> </ul> <pre><code>Selection:&gt; 5\n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 14:01 EDT\n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds\n</code></pre>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#dependencies","title":"Dependencies","text":"<ul> <li>If Nmap is not installed:</li> </ul> <pre><code>sudo apt install nmap\n</code></pre> <p>Operator Note: On Windows, use Nmap installer or <code>choco install nmap</code>.</p> <ul> <li>Python (optional if running dns_hostname_mapping.py later).</li> </ul>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#other-available-tools","title":"Other available tools","text":"<ul> <li>Angry IP Scanner  </li> <li>Advanced IP Scanner  </li> <li>Solarwinds IP Scanner</li> </ul> <p>Operator Note: Validate licensing and environment compatibility before using third-party tools.</p>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#references","title":"References","text":"<p>NMAP Site LAN Spy NMAP Man Pages Nmap Network Scanning Book </p>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.02-Create_Active_IP_List/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate network authorization and ROE before scanning.</li> <li> Identify the subnet/IP range from mission partner.</li> <li> Use NmapScript.sh for consistency.</li> <li> Save all output in standardized folder and filename format.</li> <li> Review active IPs against known good baselines.</li> </ul>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Universal Nmap, NmapScript.sh Primary active IP discovery Windows PowerShell Test-Connection Alternate ping sweep Linux/macOS arp-scan Lightweight local discovery Mobile Fing Lightweight subnet scan"},{"location":"2.Identification/2.02-Create_Active_IP_List/#alternate-commands","title":"Alternate Commands","text":""},{"location":"2.Identification/2.02-Create_Active_IP_List/#linux-arp-scan","title":"Linux ARP scan:","text":"<pre><code>sudo arp-scan --interface=eth0 --localnet\n</code></pre>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#linux-bash-simple-ping-sweep","title":"Linux Bash simple ping sweep:","text":"<pre><code>for ip in $(seq 1 254); do ping -c 1 192.168.1.$ip | grep \"bytes from\"; done\n</code></pre>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#best-practices","title":"Best Practices","text":"<ul> <li>Schedule scans during low traffic times.</li> <li>Confirm scan completion and review NmapScript.txt after every task.</li> <li>Avoid scanning ICS without explicit permission.</li> </ul>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.1 Finalized version with revision history moved Leo"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/","title":"DNS Host Name Mapping","text":""},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#task-dns-host-name-mapping","title":"Task DNS Host Name Mapping","text":""},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#conditions","title":"Conditions","text":"<p>Given a responder\u2019s computer, a known network topology including IP address ranges, and the proper tools to map network hosts.</p> <p>Operator Note: Ensure the topology and IP ranges have been confirmed with the mission network owner prior to scanning.</p>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#standards","title":"Standards","text":"<ul> <li>Team member selects an appropriate tool for conducting host scans of the network  </li> <li>Team member configures the tool to do a full or partial (i.e., per subnet) scan of the network and saves the results to a text or comma-separated values (CSV) file  </li> </ul> <p>Operator Note: Where available, use tools that resolve hostnames via DNS, NetBIOS or other name resolution protocols for best results.</p>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#end-state","title":"End State","text":"<ul> <li>A list of all accessible computers within the given IP ranges are listed with their domain name and IP addresses  </li> <li>These scripts are meant to be an Out-Of-the-Box (OOB) solution to Cybersecurity Operations  </li> <li>All scripts are open source and can be branched/edited as needed</li> </ul> <p>Operator Note: Save results using the naming convention noted below and share with the incident coordination lead and intelligence team.</p>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#manual-steps","title":"Manual Steps","text":"<p>There are multiple tools available to scan network IP ranges and determine their host names. While a simple ping scan using the built-in Ping tool in Windows will work, the difficulty is that some Operating Systems (OS) block ICMP pings by default. Additionally network administrators may institute a firewall policy to block ICMP across the Enterprise. In those cases a simple ping sweep will not work. In this case, other 3<sup>rd</sup>-party tools will be more effective, Nmap being one of the most effective.</p> <ul> <li>Example Host Discovery scan with Nmap: On a network with working DNS server, this scan will return all live hosts on this network. For network hosts that do not synch with the local DHCP or DNS server this scan may not return the host name.</li> </ul> <pre><code>nmap -sn 192.168.1.0/24\n</code></pre> <ul> <li>If the above scan does not return hostnames (poorly configured DNS issues), then the following script can be run to further enumerate Windows hosts and possible return the hostname:</li> </ul> <pre><code>nmap -sU --script nbstat.nse -p137 192.168.1.0/24\n</code></pre> <ul> <li>Output should be in the format identified in 'output_format_template.csv' and named as follows:</li> </ul> <pre><code>[mm/dd/yyyy_hh:mm:ss_DNS_HOSTNAME_Mapping_(xx.xx.xx.xx/x)]\n</code></pre> <ul> <li>Notify mission element lead and intelligence analyst of completion of this Task.</li> </ul> <p>Operator Note: Where possible, validate unknown hostnames using reverse DNS, Active Directory, or administrative tools on the network.</p>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#running-script","title":"Running Script","text":"<ul> <li>Runs the script as Admin for full capabilities  </li> <li>Script execution is menu driven  </li> <li>Ensure the script is executable  </li> </ul> <pre><code>chmod 755 dns_hostname_mapping.py\n</code></pre> <ul> <li>Windows:</li> </ul> <p>Right-click script file, Properties/Unblock</p> <ul> <li>Execute the script (Linux/Mac/Windows):</li> </ul> <pre><code>python dns_hostname_mapping.py\n</code></pre> <ul> <li>Python 3 version:</li> </ul> <pre><code>python3 dns_hostname_mapping_py3.py\n</code></pre> <ul> <li>Select a menu option  </li> <li>Specify the IP address range to be scanned  </li> <li>Specify the path and filename for output files</li> </ul> <p>Operator Note: Always review script output for errors or incomplete scans.</p>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#dependencies","title":"Dependencies","text":"<ul> <li>Python 3.6+</li> <li>Nmap</li> </ul> <p>Operator Note: Ensure Python and Nmap are updated to avoid deprecated module issues.</p>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#other-available-tools","title":"Other available tools","text":"<ul> <li>Windows: <code>Resolve-DnsName</code> (PowerShell) for DNS lookups</li> <li>Linux/macOS: <code>dig</code> or <code>host</code> command</li> <li>Mobile: <code>Fing</code> app for basic hostname resolution</li> </ul>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#references","title":"References","text":"<p>NMAP Discovery NMAP Host Discovery NMAP NBTSTAT </p>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Verify target IP range with network owner.</li> <li> Use Nmap with DNS first, then fallback to NetBIOS NBSTAT if DNS is unavailable.</li> <li> Always run scripts with administrative permissions.</li> <li> Record and save results in CSV as per naming convention.</li> <li> Review results with NetOps / AD administrators for unknown hosts.</li> </ul>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Universal Nmap (SN scan + NBSTAT NSE script) Primary hostname resolution Universal dns_hostname_mapping.py (menu script) Automated hostname resolution Windows Resolve-DnsName Built-in Windows DNS resolver Linux/macOS dig / host Built-in Unix/Linux hostname resolution Mobile Fing Lightweight mobile host discovery"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#alternate-commands","title":"Alternate Commands","text":""},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#windows-powershell","title":"Windows PowerShell:","text":"<pre><code>Resolve-DnsName -Name 192.168.1.10\n</code></pre>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#linux","title":"Linux:","text":"<pre><code>dig -x 192.168.1.10\n</code></pre>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#best-practices","title":"Best Practices","text":"<ul> <li>Use passive resolution methods first to reduce network impact.</li> <li>Avoid aggressive scanning in sensitive segments.</li> <li>Cross-validate results using multiple tools if DNS returns inconsistent results.</li> </ul>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + enhanced operator guidance and recommendations Leo"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/","title":"Active Host and Service Enumeration","text":""},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#task-active-host-and-service-enumeration","title":"Task Active Host and Service Enumeration","text":"<p>2.04 \u2013 Active_Host_and_Service_Enumeration 2.01 \u2013 Create a list of active IP addresses 2.05 \u2013 Create a list of active IP addresses with key ports included 2.07 \u2013 Scan ICS Equipment Ports 2.06 \u2013 Scan all ports of all hosts on given network segment</p>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can access and scan the identified network segment(s), and network scanning software included in the team\u2019s incident response kit.</p> <p>Operator Note: Always verify network access rules, ROE, and mission owner authorization before performing active scans. In critical infrastructure environments, scanning may cause disruption.</p>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#standards","title":"Standards","text":"<ul> <li>The team member identifies possibly compromised network segment(s).  </li> <li>The team member accesses a system that can scan the identified network segment(s).  </li> <li>The team member utilizes an IP-based network scanning utility to perform one of the following scanning tasks and directs the output to a text file for analysis:<ul> <li>2.04 \u2013 Active Host and Service Enumeration</li> <li>2.01 \u2013 Create a list of active IP addresses</li> <li>2.05 \u2013 Create a list of active IP addresses with key ports included</li> <li>2.07 \u2013 Scan ICS Equipment Ports</li> <li>2.06 \u2013 Scan all ports of all hosts on given network segment</li> </ul> </li> <li>The resulting scan data is compared to known network host data to determine anomalies present in the scanned network segment.</li> </ul> <p>Operator Note: Service identification scans can be noisy. When possible, use timing options in Nmap to reduce network load during production hours.</p>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#end-state","title":"End State","text":"<p>All active hosts, ports and services are carefully enumerated based on the specific sub-task accomplished and any anomalies or mis-configurations are identified.</p> <p>Operator Note: After scanning, work with mission partner system administrators to validate unknown or unauthorized services.</p>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#manual-steps","title":"Manual Steps","text":"<p>A list of IP ranges can be provided by using the <code>-f IPRanges</code> option; otherwise, a range can be specified with <code>-i IPRange</code>. For each BD, the script will need to be ran. The script will need to be marked executable before running:</p> <pre><code>chmod +x NmapScript.sh\n</code></pre> <ul> <li>For Task 2.04, run the NmapScript.sh and choose menu 1:</li> </ul> <pre><code>1. 2.04 \u2013 Active_Host_and_Service_Enumeration\n2. 2.01 \u2013 Create a list of active IP addresses\n3. 2.05 \u2013 Create a list of active IP addresses with key ports included\n4. 2.07 \u2013 Scan ICS Equipment Ports\n5. 2.06 \u2013 Scan all ports of all hosts on given network segment\n6. Exit\n\nSelection:&gt; 1\n</code></pre> <ul> <li>A log will be generated to NmapScript.txt and the output will be shown to the user:</li> </ul> <pre><code>Selection:&gt; 1\n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:47 EDT\n[+] Nmap scan report for 192.168.69.2\n[+] Host is up (0.00084s latency).\n[+] Not shown: 999 closed ports\n[+] PORT   STATE SERVICE VERSION\n[+] 53/tcp open  domain  dnsmasq 2.55\n[+] MAC Address: 00:50:56:EB:3D:1D (VMware)\n[+] Service detection performed.\n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 17.23 seconds\n</code></pre> <ul> <li>For Task 2.01 (Active IP):</li> </ul> <pre><code>Selection:&gt; 2\n[+] 192.168.69.1 is live!\n[+] 192.168.69.2 is live!\n[+] ...\n</code></pre> <ul> <li>For Task 2.05 (Key Ports):</li> </ul> <pre><code>Selection:&gt; 3\n[+] Starting Nmap 7.80 ( https://nmap.org )\n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds\n</code></pre> <ul> <li>For Task 2.07 (ICS scan with caution):</li> </ul> <pre><code>Selection:&gt; 4\n[!] It is possible for Scada devices to fail with an Nmap scan, do you want to continue? Y\n[+] Starting Nmap...\n[+] Nmap done\n</code></pre> <ul> <li>For Task 2.06 (All Ports):</li> </ul> <pre><code>Selection:&gt; 5\n[+] Starting Nmap...\n[+] Nmap done\n</code></pre> <p>Operator Note: Always carefully check NmapScript.txt logs for errors and complete scan information.</p>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#dependencies","title":"Dependencies","text":"<ul> <li>Nmap</li> </ul> <pre><code>sudo apt install nmap\n</code></pre> <p>Operator Note: Ensure Nmap is latest stable version for best service fingerprinting accuracy.</p>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#other-available-tools","title":"Other available tools","text":"<ul> <li>Angry IP Scanner  </li> <li>Advanced IP Scanner  </li> <li>Solarwinds IP Scanner</li> </ul> <p>Operator Note: Validate use of third-party scanning tools in mission environments before installation.</p>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#references","title":"References","text":"<p>NMAP Site LAN Spy NMAP Man Pages Nmap Network Scanning Book</p>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Verify scanning approval with mission owner or IT administrator.</li> <li> Determine subnet scope and schedule scans during low-traffic hours.</li> <li> Prefer NmapScript.sh for consistency and record keeping.</li> <li> Backup NmapScript.txt results and save with timestamp.</li> <li> Review services for anomalies and unexpected open ports.</li> </ul>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Universal Nmap + NmapScript.sh Primary host and service enumeration Windows Netcat Manual port testing and banner grabbing Linux/macOS masscan High-speed port scanning Mobile Fing Basic service discovery"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#alternate-commands","title":"Alternate Commands","text":""},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#netcat-manual-check","title":"Netcat (manual check):","text":"<pre><code>nc -v 192.168.1.5 80\n</code></pre>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#linux-nmap-quick-tcp-full-port-scan","title":"Linux Nmap quick TCP full port scan:","text":"<pre><code>nmap -p- 192.168.1.0/24\n</code></pre>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#best-practices","title":"Best Practices","text":"<ul> <li>ICS environments must be scanned only with explicit permission.</li> <li>Validate unknown services with application owners or IT.</li> <li>Log and track findings in central incident documentation.</li> </ul>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + enriched operator notes and recommendations Leo"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/","title":"Active IP List on Key Ports","text":""},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#task-active-ip-list-on-key-ports","title":"Task Active IP List on Key Ports","text":"<p>2.04 \u2013 Active_Host_and_Service_Enumeration 2.01 \u2013 Create a list of active IP addresses 2.05 \u2013 Create a list of active IP addresses with key ports included 2.07 \u2013 Scan ICS Equipment Ports 2.06 \u2013 Scan all ports of all hosts on given network segment</p>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can access and scan the identified network segment(s), and network scanning software included in the team\u2019s incident response kit.</p> <p>Operator Note: Always confirm scanning authorization from the network owner and ensure proper communication with affected system owners. Key ports scans can identify sensitive services and create alerts.</p>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#standards","title":"Standards","text":"<ul> <li>The team member identifies possibly compromised network segment(s).  </li> <li>The team member accesses a system that can scan the identified network segment(s).  </li> <li>The team member utilizes an IP-based network scanning utility to perform one of the following scanning tasks and directs the output to a text file for analysis:  <ul> <li>2.04 \u2013 Active Host and Service Enumeration  </li> <li>2.01 \u2013 Create a list of active IP addresses  </li> <li>2.05 \u2013 Create a list of active IP addresses with key ports included  </li> <li>2.07 \u2013 Scan ICS Equipment Ports  </li> <li>2.06 \u2013 Scan all ports of all hosts on given network segment  </li> </ul> </li> <li>The resulting scan data is compared to known network host data to determine anomalies present in the scanned network segment.</li> </ul> <p>Operator Note: Focus on high-value ports such as RDP (3389), SSH (22), HTTP/HTTPS (80/443), SMB (445). These are commonly exploited ports.</p>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#end-state","title":"End State","text":"<p>All active hosts, ports and services are carefully enumerated based on the specific sub-task accomplished and any anomalies or mis-configurations are identified.</p> <p>Operator Note: Unknown or unauthorized services running on key ports should immediately be escalated to IR lead.</p>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#manual-steps","title":"Manual Steps","text":"<p>A list of IP ranges can be provided by using the <code>-f IPRanges</code> option; otherwise, a range can be specified with <code>-i IPRange</code>. For each BD, the script will need to be ran. The script will need to be marked executable before running:</p> <pre><code>chmod +x NmapScript.sh\n</code></pre> <ul> <li>For Task 2.04, run the NmapScript.sh and choose menu 1:</li> </ul> <pre><code>Selection:&gt; 1\n[+] Starting Nmap 7.80 ( https://nmap.org ) at ...\n[+] Nmap done: ...\n</code></pre> <ul> <li>For Task 2.02 (Active IP), run NmapScript.sh and choose menu 2:</li> </ul> <pre><code>Selection:&gt; 2\n[+] 192.168.69.1 is live!\n[+] ...\n</code></pre> <ul> <li>For Task 2.05 (this task), run the NmapScript.sh and choose menu 3:</li> </ul> <pre><code>Selection:&gt; 3\n[+] Starting Nmap 7.80 ( https://nmap.org )\n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds\n</code></pre> <p>Operator Note: This scan focuses on scanning specific ports only, so if no ports are open on target, no output will be shown for those hosts.</p> <ul> <li>For Task 2.07 (ICS scan):</li> </ul> <pre><code>Selection:&gt; 4\n[!] It is possible for Scada devices to fail with an Nmap scan, do you want to continue? Y\n[+] Nmap done...\n</code></pre> <ul> <li>For Task 2.06 (all ports):</li> </ul> <pre><code>Selection:&gt; 5\n[+] Starting Nmap...\n[+] Nmap done\n</code></pre>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#dependencies","title":"Dependencies","text":"<ul> <li>If Nmap is not installed:</li> </ul> <pre><code>sudo apt install nmap\n</code></pre> <p>Operator Note: On Windows, install via Chocolatey or official Nmap installer.</p>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#other-available-tools","title":"Other available tools","text":"<ul> <li>Angry IP Scanner  </li> <li>Advanced IP Scanner  </li> <li>Solarwinds IP Scanner</li> </ul> <p>Operator Note: Use GUI scanners only if authorized and validated for enterprise network use.</p>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#references","title":"References","text":"<p>NMAP Site LAN Spy NMAP Man Pages Nmap Network Scanning Book</p>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Confirm with network owner the critical ports to scan.</li> <li> Schedule scans during off-peak hours to avoid impact.</li> <li> Use NmapScript.sh for consistency across team members.</li> <li> Validate scan output is complete and save as timestamped log.</li> <li> Investigate and escalate unknown services or unexpected open ports.</li> </ul>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Universal Nmap, NmapScript.sh Primary scanning tool for key ports Windows/Linux/macOS Netcat Manual port connection testing Linux/macOS masscan High-speed port discovery Mobile Fing Lightweight local port scanning"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#alternate-commands","title":"Alternate Commands","text":""},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#simple-nmap-scan-for-common-ports","title":"Simple Nmap scan for common ports:","text":"<pre><code>nmap -p 22,80,443,445,3389 192.168.1.0/24\n</code></pre>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#netcat-manual-connection-check","title":"Netcat manual connection check:","text":"<pre><code>nc -vz 192.168.1.100 3389\n</code></pre>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#best-practices","title":"Best Practices","text":"<ul> <li>Prioritize sensitive ports for IR (SSH, RDP, SMB).</li> <li>Avoid scanning ICS/SCADA segments without express approval.</li> <li>Correlate identified hosts with asset database and ticketing systems.</li> </ul>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + enhanced operator guidance and recommendations Leo"},{"location":"2.Identification/2.06-All_Port_Scan/","title":"All Port Scan","text":""},{"location":"2.Identification/2.06-All_Port_Scan/#task-all-port-scan","title":"Task All Port Scan","text":"<p>2.04 \u2013 Active_Host_and_Service_Enumeration 2.01 \u2013 Create a list of active IP addresses 2.05 \u2013 Create a list of active IP addresses with key ports included 2.07 \u2013 Scan ICS Equipment Ports 2.06 \u2013 Scan all ports of all hosts on given network segment</p>"},{"location":"2.Identification/2.06-All_Port_Scan/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can access and scan the identified network segment(s), and network scanning software included in the team\u2019s incident response kit.</p> <p>Operator Note: Full port scanning is inherently intrusive and noisy. Ensure coordination with network owner and obtain explicit authorization, especially in production environments.</p>"},{"location":"2.Identification/2.06-All_Port_Scan/#standards","title":"Standards","text":"<ul> <li>The team member identifies possibly compromised network segment(s).  </li> <li>The team member accesses a system that can scan the identified network segment(s).  </li> <li>The team member utilizes an IP-based network scanning utility to perform one of the following scanning tasks and directs the output to a text file for analysis:  <ul> <li>2.04 \u2013 Active Host and Service Enumeration  </li> <li>2.01 \u2013 Create a list of active IP addresses  </li> <li>2.05 \u2013 Create a list of active IP addresses with key ports included  </li> <li>2.07 \u2013 Scan ICS Equipment Ports  </li> <li>2.06 \u2013 Scan all ports of all hosts on given network segment  </li> </ul> </li> <li>The resulting scan data is compared to known network host data to determine anomalies present in the scanned network segment.</li> </ul> <p>Operator Note: Scans of all ports will take longer and may trigger IDS/IPS alerts. Plan scan windows accordingly.</p>"},{"location":"2.Identification/2.06-All_Port_Scan/#end-state","title":"End State","text":"<p>All active hosts, ports and services are carefully enumerated based on the specific sub-task accomplished and any anomalies or mis-configurations are identified.</p> <p>Operator Note: Anomalous services on high ports should be reviewed carefully. Common services usually operate on well-known ports.</p>"},{"location":"2.Identification/2.06-All_Port_Scan/#manual-steps","title":"Manual Steps","text":"<p>A list of IP ranges can be provided by using the <code>-f IPRanges</code> option; otherwise, a range can be specified with <code>-i IPRange</code>. For each BD, the script will need to be ran. The script will need to be marked executable before running:</p> <pre><code>chmod +x NmapScript.sh\n</code></pre> <ul> <li>For Task 2.04, run the NmapScript.sh and choose menu 1:</li> </ul> <pre><code>1. 2.04 \u2013 Active_Host_and_Service_Enumeration\n2. 2.01 \u2013 Create a list of active IP addresses\n3. 2.05 \u2013 Create a list of active IP addresses with key ports included\n4. 2.07 \u2013 Scan ICS Equipment Ports\n5. 2.06 \u2013 Scan all ports of all hosts on given network segment\n6. Exit\n\nSelection:&gt; 1\n</code></pre> <ul> <li>A log will be generated to NmapScript.txt and the output will be shown to the user:</li> </ul> <pre><code>Selection:&gt; 1\n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:47 EDT\n[+] Nmap scan report for 192.168.69.2\n[+] Host is up (0.00084s latency).\n[+] Not shown: 999 closed ports\n[+] PORT   STATE SERVICE VERSION\n[+] 53/tcp open  domain  dnsmasq 2.55\n[+] MAC Address: 00:50:56:EB:3D:1D (VMware)\n[+] Service detection performed.\n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 17.23 seconds\n</code></pre> <ul> <li>For Task 2.06 (this task), run the script and choose menu 5. This will scan for all ports on the target/target list:</li> </ul> <pre><code>Selection:&gt; 5\n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 14:01 EDT\n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds\n</code></pre> <p>Operator Note: Scan will attempt TCP ports 1-65535 for each live host. Results should be carefully analyzed for unexpected open ports.</p>"},{"location":"2.Identification/2.06-All_Port_Scan/#dependencies","title":"Dependencies","text":"<ul> <li>If Nmap is not installed:</li> </ul> <pre><code>sudo apt install nmap\n</code></pre> <p>Operator Note: On Windows, install via official installer or <code>choco install nmap</code>.</p>"},{"location":"2.Identification/2.06-All_Port_Scan/#other-available-tools","title":"Other available tools","text":"<ul> <li>Angry IP Scanner  </li> <li>Advanced IP Scanner  </li> <li>Solarwinds IP Scanner</li> </ul> <p>Operator Note: GUI scanners typically do not support full-port scanning. Use CLI tools (Nmap) for comprehensive coverage.</p>"},{"location":"2.Identification/2.06-All_Port_Scan/#references","title":"References","text":"<p>NMAP Site LAN Spy NMAP Man Pages Nmap Network Scanning Book</p>"},{"location":"2.Identification/2.06-All_Port_Scan/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.06-All_Port_Scan/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Confirm authorization to perform full port scan.</li> <li> Select the correct network and IP range to target.</li> <li> Use NmapScript.sh option 5 for consistency and logging.</li> <li> Save results securely and with timestamped filenames.</li> <li> Analyze results carefully and report unauthorized open ports.</li> </ul>"},{"location":"2.Identification/2.06-All_Port_Scan/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Universal Nmap, NmapScript.sh Primary full port scanner Windows/Linux/macOS Netcat Manual port testing Linux/macOS masscan High-speed full port scanner (caution required) Mobile Fing Lightweight alternative (not suitable for full port scans)"},{"location":"2.Identification/2.06-All_Port_Scan/#alternate-commands","title":"Alternate Commands","text":""},{"location":"2.Identification/2.06-All_Port_Scan/#full-tcp-port-scan-using-nmap","title":"Full TCP port scan using Nmap:","text":"<pre><code>nmap -p- 192.168.1.0/24\n</code></pre>"},{"location":"2.Identification/2.06-All_Port_Scan/#netcat-manual-connection-single-port-check","title":"Netcat manual connection (single port check):","text":"<pre><code>nc -vz 192.168.1.5 8080\n</code></pre>"},{"location":"2.Identification/2.06-All_Port_Scan/#best-practices","title":"Best Practices","text":"<ul> <li>Avoid running full port scans during peak hours.</li> <li>Coordinate with system owners ahead of scans.</li> <li>Document and report anomalous or high-risk open ports immediately.</li> </ul>"},{"location":"2.Identification/2.06-All_Port_Scan/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + enriched operator notes and recommendations Leo"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/","title":"Scan ICS Equipment Ports","text":""},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#task-scan-ics-equipment-ports","title":"Task Scan ICS Equipment Ports","text":"<p>2.04 \u2013 Active_Host_and_Service_Enumeration 2.01 \u2013 Create a list of active IP addresses 2.05 \u2013 Create a list of active IP addresses with key ports included 2.07 \u2013 Scan ICS Equipment Ports 2.06 \u2013 Scan all ports of all hosts on given network segment</p>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can access and scan the identified network segment(s), and network scanning software included in the team\u2019s incident response kit.</p> <p>Operator Note: ICS environments are extremely sensitive. Nmap scans can cause device failure or process disruption. Always coordinate with system owners and obtain written approval.</p>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#standards","title":"Standards","text":"<ul> <li>The team member identifies possibly compromised network segment(s).  </li> <li>The team member accesses a system that can scan the identified network segment(s).  </li> <li>The team member utilizes an IP-based network scanning utility to perform one of the following scanning tasks and directs the output to a text file for analysis:  <ul> <li>2.04 \u2013 Active Host and Service Enumeration  </li> <li>2.01 \u2013 Create a list of active IP addresses  </li> <li>2.05 \u2013 Create a list of active IP addresses with key ports included  </li> <li>2.07 \u2013 Scan ICS Equipment Ports  </li> <li>2.06 \u2013 Scan all ports of all hosts on given network segment  </li> </ul> </li> <li>The resulting scan data is compared to known network host data to determine anomalies present in the scanned network segment.</li> </ul> <p>Operator Note: Use <code>-T1</code> or <code>-T2</code> scan timing options in Nmap to reduce scan aggressiveness when targeting ICS environments.</p>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#end-state","title":"End State","text":"<p>All active hosts, ports and services are carefully enumerated based on the specific sub-task accomplished and any anomalies or mis-configurations are identified.</p> <p>Operator Note: Carefully review ICS results with facility or SCADA engineers to validate accuracy and rule out false positives.</p>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#manual-steps","title":"Manual Steps","text":"<p>A list of IP ranges can be provided by using the <code>-f IPRanges</code> option; otherwise, a range can be specified with <code>-i IPRange</code>. For each BD, the script will need to be ran. The script will need to be marked executable before running:</p> <pre><code>chmod +x NmapScript.sh\n</code></pre> <ul> <li>For Task 2.04, run the NmapScript.sh and choose menu 1:</li> </ul> <pre><code>Selection:&gt; 1\n[+] Starting Nmap...\n</code></pre> <ul> <li>For Task 2.02 (active IP list):</li> </ul> <pre><code>Selection:&gt; 2\n[+] 192.168.69.1 is live!\n</code></pre> <ul> <li>For Task 2.05 (key ports):</li> </ul> <pre><code>Selection:&gt; 3\n[+] Starting Nmap...\n</code></pre> <ul> <li>For Task 2.07 (this task \u2014 ICS scan):</li> </ul> <pre><code>Selection:&gt; 4\n[!] It is possible for SCADA devices to fail with an Nmap scan, do you want to continue? Y\n[+] Starting Nmap 7.80 ( https://nmap.org )\n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds\n</code></pre> <p>Operator Note: This mode is targeted for ICS systems. However, even so, it may disrupt sensitive equipment. Use the <code>--scan-delay</code> and <code>-T0</code> or <code>-T1</code> flags in custom scans if needed.</p> <ul> <li>For Task 2.06 (full port scan):</li> </ul> <pre><code>Selection:&gt; 5\n[+] Starting Nmap...\n</code></pre>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#dependencies","title":"Dependencies","text":"<ul> <li>If Nmap is not installed:</li> </ul> <pre><code>sudo apt install nmap\n</code></pre> <p>Operator Note: Windows: <code>choco install nmap</code> or official installer.</p>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#other-available-tools","title":"Other available tools","text":"<ul> <li>Angry IP Scanner  </li> <li>Advanced IP Scanner  </li> <li>Solarwinds IP Scanner</li> </ul> <p>Operator Note: These tools are NOT recommended for ICS scanning \u2014 only use Nmap or highly controlled protocols for ICS/SCADA equipment.</p>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#references","title":"References","text":"<p>NMAP Site LAN Spy NMAP Man Pages Nmap Network Scanning Book</p>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Obtain written approval before scanning ICS/SCADA environments.</li> <li> Use NmapScript.sh menu 4 for this task.</li> <li> If custom scanning, use <code>-T0</code> or <code>-T1</code> to minimize impact.</li> <li> Save NmapScript.txt results with timestamp and segment identifier.</li> <li> Validate results with facility engineers before escalating.</li> </ul>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Universal Nmap, NmapScript.sh Primary ICS scan tool (use with caution) Windows/Linux/macOS Nmap CLI with timing/scanning options Low and slow ICS scanning Mobile Fing NOT recommended for ICS, use only for basic discovery if permitted"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#example-alternate-commands-recommended-for-ics","title":"Example Alternate Commands (Recommended for ICS)","text":""},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#nmap-low-impact-ics-scan","title":"Nmap low impact ICS scan:","text":"<pre><code>nmap -sS -p 1-1024 --scan-delay 1s -T1 192.168.1.0/24\n</code></pre>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#nmap-scada-targeted-modbustcp","title":"Nmap SCADA targeted (Modbus/TCP):","text":"<pre><code>nmap -sU -p 502 --script modbus-discover 192.168.1.0/24\n</code></pre> <p>Operator Note: Use SCADA-specific NSE scripts carefully and only with approval.</p>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#best-practices","title":"Best Practices","text":"<ul> <li>Avoid scanning during operational hours.</li> <li>Consult with ICS/SCADA vendors or site engineers.</li> <li>Log, review, and archive all scan artifacts.</li> </ul>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + enriched ICS/SCADA operator guidance and recommendations Leo"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/","title":"Conduct Vulnerability Scan of Network Host","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#task-conduct-vulnerability-scan","title":"Task Conduct Vulnerability Scan","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#conditions","title":"Conditions","text":"<p>Given a host with local administrator credentials, an incident response workstation, network access, and a vulnerability assessment tool.</p> <p>Operator Note: Vulnerability scans must be authorized by the network owner, and the impact of scanning must be understood, especially in production environments.</p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#standards","title":"Standards","text":"<ul> <li>Team member verifies network connectivity to the host using the host IP address  </li> <li>Team member assures the vulnerability assessment tool is using the latest updates and signatures of the selected tool  </li> <li>Team member configures the vulnerability assessment tool with the IP address of the host  </li> <li>Team member selects assessment options within the tool based on testing level required  <ul> <li>Note: Some tests can cause denial of service to host and will need to be evaluated before beginning of assessment  </li> </ul> </li> <li>Team member runs the assessment with selected options and monitors progress  </li> <li>Team member evaluates the results of the assessment and determines if critical or high vulnerabilities exist on the test machine  </li> </ul> <p>Operator Note: Confirm scan profiles before running (e.g., \"Safe Scan\" vs \"Full + Aggressive\") to avoid unintentionally disrupting hosts.</p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#end-state","title":"End State","text":"<p>All vulnerabilities on the test machine are found and critical or high results are evaluated for remediation.</p> <p>Operator Note: Results should be saved, backed up, and shared securely with remediation team and incident command.</p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#manual-steps","title":"Manual Steps","text":"<ul> <li>Determine if the client/victim currently have designated in-house vulnerability tools  </li> <li>Identify if the customer has a service account to conduct your scans. See Task 1.18 Establish Network Access Accounts </li> <li>Request a network topology from the network owner (if available)  <ul> <li>Verify network topology with a ping sweep (see <code>nmap -sn</code> example below):</li> </ul> </li> </ul> <pre><code>nmap -sn 192.168.1.0/24\n</code></pre> <ul> <li>Establish and separate vulnerability scan groups by Operating Systems (Win/Linux)  <ul> <li>Narrow vulnerability scans prevent false positives and irrelevant results  </li> </ul> </li> <li>Verify the credentials you are using to scan have:  <ul> <li><code>Sudo</code> privilege for Unix/Linux  </li> <li><code>Administrator group</code> for Windows  </li> </ul> </li> </ul> <p>Operator Note: Ensure credentials are configured correctly in the vulnerability scanner for authenticated scanning to maximize detection capabilities.</p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#optional-tools","title":"Optional Tools","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#nessus-recommended-for-windows-and-mixed-environments","title":"Nessus (Recommended for Windows and mixed environments)","text":"<p>Nessus</p> <p>Installation: - Download Nessus from Tenable website and install (Windows, Linux, macOS). - Access web GUI via https://localhost:8834 and complete setup wizard.</p> <p>Usage: - Create new scan \u2192 Select \"Advanced Scan\" - Input target IP range - Under Credentials \u2192 Input Windows/Unix admin credentials - Start scan \u2192 Monitor progress \u2192 Export results (HTML, CSV, PDF)</p> <p>Command-line (start Nessus scanner daemon on Linux):</p> <pre><code>sudo systemctl start nessusd\n</code></pre>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#openvas-recommended-for-linux-and-open-source-environments","title":"OpenVAS (Recommended for Linux and open-source environments)","text":"<p>OpenVAS</p> <p>Installation (Kali Linux):</p> <pre><code>sudo apt update &amp;&amp; sudo apt install openvas\nsudo gvm-setup\nsudo gvm-check-setup\n</code></pre> <p>Installation (Ubuntu):</p> <pre><code>sudo apt install software-properties-common\nsudo add-apt-repository ppa:mrazavi/gvm\nsudo apt update &amp;&amp; sudo apt install gvm\nsudo gvm-setup\n</code></pre> <p>Usage: - Access web UI: https://localhost:9392 - Create target \u2192 Input IP range - Set credentials (optional but recommended for deep scans) - Start scan \u2192 Review and export results</p> <p>Command-line scan example:</p> <pre><code>gvm-cli socket --xml \"&lt;create_target&gt;\" \n</code></pre> <p>Operator Note: OpenVAS scans can be slower and heavier on the network \u2014 plan accordingly.</p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#running-script","title":"Running Script","text":"<p>N/A</p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#dependencies","title":"Dependencies","text":"<p>Network access accounts:</p> <ul> <li>Administrative group (Windows/Mac)  </li> <li>Sudo privilege (Unix/Linux)</li> </ul> <p>Scanner installed and configured:</p> <ul> <li>Nessus OR OpenVAS installed and reachable  </li> <li>Network reachability to targets</li> </ul> <p>Operator Note: Update scanner feeds prior to scanning to ensure accurate vulnerability detection.</p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#references","title":"References","text":"<p>OpenVAS Nessus Greenbone Vulnerability Manager Installation Guide</p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Confirm authorization to perform vulnerability scanning.</li> <li> Select tool (Nessus or OpenVAS) based on environment.</li> <li> Verify credentials and access to target hosts.</li> <li> Perform scans during approved windows (off hours preferred).</li> <li> Export and archive results upon completion.</li> <li> Review and triage critical/high findings with incident response lead.</li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Universal Nessus Commercial, supported scanner with easy GUI Linux OpenVAS / Greenbone Open-source vulnerability scanner Windows/Linux/macOS Nmap (optional) Manual port/service discovery before scan Linux Nikto (optional) Lightweight web server vulnerability scanner (optional use)"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#alternate-commands-and-examples","title":"Alternate Commands and Examples","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#simple-nmap-pre-scan-optional-prep-step","title":"Simple Nmap pre-scan (optional prep step):","text":"<pre><code>nmap -p- -sS 192.168.1.0/24\n</code></pre>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#run-openvas-from-cli","title":"Run OpenVAS from CLI:","text":"<pre><code>sudo gvm-start\n</code></pre>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#nessus-start-on-linux","title":"Nessus start on Linux:","text":"<pre><code>sudo systemctl start nessusd\n</code></pre>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#best-practices","title":"Best Practices","text":"<ul> <li>Use credentialed scanning wherever possible for deeper vulnerability discovery.</li> <li>Run \"Safe Scans\" if host stability is in question.</li> <li>Validate scan targets and avoid critical production devices unless authorized.</li> <li>Coordinate findings review with asset/system owners.</li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + enriched vulnerability tool usage, commands, and operator guidance Leo"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/","title":"NESSUS","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#task-nessus-utilization-guide","title":"Task Nessus Utilization Guide","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#conditions","title":"Conditions","text":"<p>Utilizing the provided Administrative credentials with domain privileges, run vulnerability scans on servers and hosts.  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#standards","title":"Standards","text":"<ul> <li>Setup Nessus  </li> <li>Conduct vulnerability scan  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#end-state","title":"End State","text":"<p>Completed a vulnerability scan utilizing Nessus  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#manual-steps","title":"Manual Steps","text":"<ul> <li>Accessing Nessus Manager  </li> <li>You can access the Nessus Manager/Scanner web interface at: https://localhost:8834 </li> </ul> <ul> <li>Conducting a Vulnerability Assessment  </li> <li>Creating a scan  <ul> <li>In the top navigation bar, click <code>Scans</code> </li> <li>In the upper-right corner of the <code>My Scans</code> page, click the <code>New Scan</code> button  </li> </ul> </li> </ul> <ul> <li>Choose a Scan Template  </li> <li>Click on <code>Basic Network Scan</code> and select <code>Settings</code> tab  </li> </ul> <ul> <li>Configure Scan Settings  </li> <li>The following are Basic settings:  <ul> <li><code>Name</code> - Specifies the name of the scan or policy. This value is displayed on the Nessus interface.</li> <li><code>Description</code> - (Optional) Specifies a description of the scan or policy.</li> <li><code>Folder</code> - Specifies the folder where the scan appears after being saved.</li> <li><code>Targets</code> - Specifies one or more targets to be scanned. If you select a target group or upload a targets file, you are not required to specify additional targets. Input IP range(s) inside the <code>Targets</code> field  </li> </ul> </li> </ul> <ul> <li>Configure Credentials  </li> <li>Click <code>Credentials</code> tab  </li> <li>Select <code>Windows</code> </li> <li>Use the Administrator credentials and domain  </li> <li>Click <code>Save</code> and select <code>Launch Scan</code> </li> </ul> <ul> <li>Viewing Your Results  </li> <li>click on <code>My Scans</code> </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#running-script","title":"Running Script","text":"<p>N/A  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#dependencies","title":"Dependencies","text":"<p>N/A  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#other-available-tools","title":"Other available tools","text":"<p>N/A</p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#references","title":"References","text":"<p>Nessus Vulnerability Scanning</p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/","title":"OPENVAS(KALI)","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#task-openvas-uitilization-guide-for-kali-linux","title":"Task OpenVAS Uitilization Guide for Kali Linux","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#conditions","title":"Conditions","text":"<p>Utilizing the provided sudo privileges, run vulnerability scans on UNIX/Linux hosts  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#standards","title":"Standards","text":"<ul> <li>Setup OpenVAS on Kali Linux  </li> <li>Conduct vulnerability scan  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#end-state","title":"End State","text":"<p>Completed a vulnerability scan utilizing OpenVAS via Kali Linux  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#1-openvas-verification","title":"1. OpenVAS \u2013 Verification","text":"<ul> <li>Verify ONLY if OpenVAS is installed already. If OpenVAS(GVM) is not installed, move onto Step 2 From a terminal shell as root type the following: <pre><code>$ openvas-check-setup\n</code></pre></li> </ul> <p>Verify that all checks are good and openvas responds with OK  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#2-openvas-greenbone-vulnerability-manager-installation-for-kali-linux","title":"2. (OpenVAS) Greenbone Vulnerability Manager Installation for Kali Linux","text":"<ul> <li> <p>Install the packages through <code>apt install openvas</code> <pre><code>apt update\napt upgrade\napt install openvas\n</code></pre></p> </li> <li> <p>Configuration <pre><code>openvas-setup\n</code></pre></p> </li> <li> <p>Verify that the Green Security Assistant Daemon (gsad) is in a running and listening status <pre><code>netstat -apn | grep LISTEN\n</code></pre></p> </li> </ul> <p>You should see something like the following output: <pre><code>tcp    0  0 127.0.0.1:9390      0.0.0.0:*           LISTEN      128108/openvasmd    \ntcp    0  0 127.0.0.1:80        0.0.0.0:*           LISTEN      128112/gsad         \ntcp    0  0 127.0.0.1:9392      0.0.0.0:*           LISTEN      128106/gsad\n</code></pre></p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#2a-openvas-verify-all-signatures-and-feeds-are-up-to-date","title":"2a. OpenVAS \u2013 Verify all signatures and feeds are up-to-date","text":"<ul> <li>Access the OpenVAS web front-end at <code>https://localhost:9392/</code>. To access the web front-end interface from another node, use the following format: <code>https://hostname:9392/</code> </li> <li>Click on <code>Administration -&gt; NVT Feed</code> and verify that the Feed Version is the latest version Format is in the form of a timestamp: <code>YYYYMMDDHHSS</code> </li> <li>Completed the above for all feeds under Administration Menu, or to update all feeds from the terminal type the following: <pre><code>openvas-nvt-sync\n</code></pre></li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#3-openvas-simple-scan","title":"3. OpenVAS \u2013 Simple Scan","text":"<ul> <li>Access the OpenVAS web front-end at <code>https://localhost:9392/</code>. To access the web front-end interface from another node, use the following format: <code>https://hostname:9392/</code> </li> <li> <p>If you do not know the username and password see [Note 2] below  </p> </li> <li> <p>Enter the IP address or host name of the system(s) you wish to scan and press <code>Start Scan</code> </p> </li> <li>You will be presented with an updated progress bar as the scan progresses through the scan  </li> <li> <p>Once the scan is completed you will be presented with a results page  </p> </li> <li> <p>Verify results are in compliance with enclave SOP and local policy  </p> </li> <li> <p>Review the report  </p> </li> <li>The complete report as well as only filtered results can be viewed and downloaded  </li> <li>By default, only the High and Medium risks are displayed  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#4-openvas-authenticated-credentialed-scan","title":"4. OpenVAS \u2013 Authenticated / Credentialed Scan","text":"<p>This option can be heavy on the network  </p> <ul> <li> <p>Access the OpenVAS web front-end at <code>https://localhost:9392/</code>. To access the web front-end interface from another node, use the following format: <code>https://hostname:9392/</code> </p> <ul> <li>If you do not know the username and password see [Note 2] below  </li> </ul> </li> <li> <p>Create Credentials for Host being scanned  </p> <ul> <li>From the top menu select <code>Configuration</code> -&gt; <code>credentials</code> </li> <li>Click the <code>Blue Star icon</code> \u2013 New Credential and fill in the information below  </li> <li>Click <code>Create Credential</code> Button  </li> <li>For Linux / Unix hosts ensure SSH is utilized  </li> <li>If you receive an error when saving, please see [Note 3] below  </li> </ul> </li> <li> <p>Start the Advanced Wizard  </p> <ul> <li>Hovering over the purple New Wizard icon and selecting <code>Advanced Wizard</code> </li> <li>Enter in Task Name for scan  </li> <li>Change Scan Config to <code>Full and Fast</code> </li> <li>Enter in IP address or CIDR address range for Target Hosts  </li> <li>Ensure <code>Start immediately</code> radio button is selected  </li> <li>Select the credentials created in step 2 above:  <ul> <li>Ensure Linux/Unix hosts use SSH Credentials  </li> <li>Ensure Windows hosts use SMB Credentials  </li> </ul> </li> </ul> </li> <li> <p>Click <code>Create Task</code> to start your scan  </p> </li> </ul> <p>Once the scan is complete it will state <code>Done</code> in the Tasks pane. Click on the completed scan to view results.  Verify that the scan completed with credentials by checking the status of the <code>SMB Login</code> </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#5-openvas-report-and-remediate-all-high-medium-and-low-findings","title":"5. OpenVAS \u2013 Report and remediate all High Medium and Low findings","text":"<ul> <li>From the OpenVAS web page click on the Completed Report Date of the Report you would like to review  </li> <li>Vulnerabilities will be listed in order of severity (High, Medium, Low)  </li> <li>Click on each vulnerability and review/implement suggested remediation and workarounds per local SOP  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#notes","title":"Notes:","text":"<ul> <li> <p>Note 1: To perform Credentialed / Authenticated scans on windows hosts you must:  </p> <ul> <li>Ensure <code>remote registry</code> service is started  </li> <li>The credentials used must be members of the Local or Domain administrator group on scanned hosts  </li> <li>The File and Printer Sharing is activated \u2013 if host is Windows XP do not use Simple File Sharing  </li> </ul> </li> <li> <p>Note 2: To change your OpenVAS password type the following as root     <pre><code>openvasmd --user=admin --new-password=password\n</code></pre></p> </li> <li> <p>Note 3: If you receive an error while creating user credentials verify that the following directory exists  </p> <ul> <li><code>/var/lib/openvas/gnupg</code> </li> <li>If the above directory does not exist create it by typing on the server as root  <ul> <li><code>mkdir /var/lib/openvas/gnupg</code> </li> </ul> </li> </ul> </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#running-script","title":"Running Script","text":"<p>NA  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#dependencies","title":"Dependencies","text":"<p>Kali Linux  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#other-available-tools","title":"Other available tools","text":"<p>N/A  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#references","title":"References","text":"<p>Install OpenVAS(GVM) on Kali Linux 2019 A Brief Introduction to the OpenVAS Scanner </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/","title":"OPENVAS(Ubuntu)","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#task-openvas-uitilization-guide","title":"Task OpenVAS Uitilization Guide","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#conditions","title":"Conditions","text":"<ul> <li>Utilizing the provided sudo privileges, run vulnerability scans on UNIX/Linux hosts  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#standards","title":"Standards","text":"<ul> <li>Setup OpenVAS  </li> <li>Conduct vulnerability scan  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#end-state","title":"End State","text":"<ul> <li>Completed a vulnerability scan utilizing OpenVAS  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#manual-steps","title":"Manual Steps","text":"<ul> <li>OpenVAS \u2013 Verification ONLY if OpenVAS is installed already  </li> <li> <p>Move to Step 1 if OpenVAS(GVM) is not installed  </p> </li> <li> <p>From a terminal shell as root type the following: <pre><code>openvas-check-setup\n</code></pre></p> </li> <li> <p>Verify that all checks are good and openvas responds with OK  </p> </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#1-openvas-greenbone-vulnerability-manager-installation","title":"1. (OpenVAS) Greenbone Vulnerability Manager Installation","text":"<ul> <li> <p>To install the Greenbone Vulnerability Management 11 packages on <code>Ubuntu 18.04 Bionic Beaver</code> first you need to install PostgreSQL database server (if you don't already have one - it could also be installed on a remote machine): <pre><code>sudo apt install postgresql\n</code></pre></p> </li> <li> <p>Then use the following commands to install GVM:     <pre><code>sudo add-apt-repository ppa:mrazavi/gvm\nsudo apt install gvm\n</code></pre></p> </li> <li> <p>Finally, you have to update the greenbone nvt/cert/scap data with these commands: <pre><code>greenbone-nvt-sync\nsudo greenbone-scapdata-sync\nsudo greenbone-certdata-sync\n</code></pre></p> </li> <li> <p>You can access the Greenbone Security Assistant web interface at: <code>https://x.x.x.x:9392</code> </p> </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#2-openvas-verify-all-signatures-and-feeds-are-up-to-date","title":"2. OpenVAS \u2013 Verify all signatures and feeds are up-to-date","text":"<ul> <li>Access OpenVAS web front-end at: <code>https://x.x.x.x:9392</code> </li> <li> <p>Click on <code>Administration</code> -&gt; <code>NVT Feed</code> and verify that the Feed Version is the latest version Format is in the form of a timestamp: <code>YYYYMMDDHHSS</code> </p> </li> <li> <p>Completed the above for all feeds under Administration Menu, or to update all feeds from the terminal type the following: <pre><code>openvas-nvt-sync\n</code></pre></p> </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#3-openvas-simple-scan","title":"3. OpenVAS \u2013 Simple Scan","text":"<ul> <li>Access OpenVAS web front-end at: <code>https://x.x.x.x:9392</code>. If you do not know the username and password see [Step 5. Note 2] below.  </li> <li> <p>Enter the IP address or host name of the system(s) you wish to scan and press <code>Start Scan</code> </p> <ul> <li>You will be presented with an updated progress bar as the scan progresses through the scan  </li> <li>Once the scan is completed you will be presented with a results page  </li> <li>Verify results are in compliance with enclave SOP and local policy  </li> </ul> </li> <li> <p>Review the report  </p> <ul> <li>The complete report as well as only filtered results can be viewed and downloaded  </li> <li>By default, only the High and Medium risks are displayed  </li> </ul> </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#4-openvas-authenticated-credentialed-scan","title":"4. OpenVAS \u2013 Authenticated / Credentialed Scan","text":"<ul> <li>This option can be heavy on the network  </li> <li> <p>Access the OpenVAS web front-end at <code>https://x.x.x.x:9392</code> </p> <ul> <li>If you do not know the username and password see [Step 5. Note 2] below  </li> </ul> </li> <li> <p>Create Credentials for Host being scanned  </p> <ul> <li>From the top menu select <code>Configuration</code> -&gt; <code>credentials</code> </li> <li>Click the <code>Blue Star icon</code> \u2013 New Credential and fill in the information below  </li> <li>Click <code>Create Credential</code> Button  </li> <li>For Linux / Unix hosts ensure SSH is utilized  </li> <li>If you receive an error when saving please see [Step 5. Note 3] below  </li> </ul> </li> <li> <p>Start the Advanced Wizard  </p> <ul> <li>by hovering over the purple New Wizard icon and selecting \"Advanced Wizard\"  </li> <li>Enter in Task Name for scan  </li> <li>Change Scan Config to \"Full and Fast\"  </li> <li>Enter in IP address or CIDR address range for Target Hosts  </li> <li>Ensure \u201cStart immediately\u201d radio button is selected  </li> <li>Select the credentials created in step 2 above:  <ul> <li>Ensure Linux/Unix hosts use SSH Credentials  </li> <li>Ensure Windows hosts use SMB Credentials  </li> </ul> </li> </ul> </li> <li> <p>Click <code>Create Task</code> to start your scan  </p> </li> </ul> <p>Once the scan is complete it will state \"Done\" in the Tasks pane. Click on the completed scan to view results  </p> <p>Verify that the scan completed with credentials by checking the status of the \"SMB Login\"  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#5-openvas-report-and-remediate-all-high-medium-and-low-findings","title":"5. OpenVAS \u2013 Report and remediate all High Medium and Low findings","text":"<ul> <li>From the OpenVAS web page click on the Completed Report Date of the Report you would like to review  </li> <li>Vulnerabilities will be listed in order of severity (High, Medium, Low)  </li> <li>Click on each vulnerability and review/implement suggested remediation and workarounds per local SOP  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#notes","title":"Notes:","text":"<ul> <li> <p>1: To perform Credentialed / Authenticated scans on windows hosts you must:  </p> <ul> <li>Ensure <code>remote registry</code> service is started  </li> <li>The credentials used must be members of the Local or Domain administrator group on scanned hosts  </li> <li>The File and Printer Sharing is activated \u2013 if host is Windows XP do not use Simple File Sharing  </li> </ul> </li> <li> <p>2: To change your OpenVAS password type the following as root  </p> <ul> <li><code>openvasmd --user=admin --new-password=password</code> </li> </ul> </li> <li> <p>3: If you receive an error while creating user credentials verify that the following directory exists  </p> <ul> <li><code>/var/lib/openvas/gnupg</code> </li> <li>If the above directory does not exist create it by typing on the server as root.  </li> <li><code>root@kali:~# mkdir /var/lib/openvas/gnupg</code> </li> </ul> </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#running-script","title":"Running Script","text":"<p>NA  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#dependencies","title":"Dependencies","text":"<p>Linux / Ubuntu  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#other-available-tools","title":"Other available tools","text":"<p>N/A  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#references","title":"References","text":"<p>N/A  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.11-Determine_Installed_Software/","title":"Determine Installed Software","text":""},{"location":"2.Identification/2.11-Determine_Installed_Software/#task-idam-31-determine-installed-software","title":"Task ID.AM-3.1 Determine Installed Software","text":""},{"location":"2.Identification/2.11-Determine_Installed_Software/#conditions","title":"Conditions","text":"<p>Given a responder\u2019s computer, a network host (workstation or server), and proper access credentials.</p> <p>Operator Note: Ensure network access and administrative privileges before conducting software enumeration activities. Confirm authorization and scope with network owner.</p>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#standards","title":"Standards","text":"<ul> <li>Team member verifies access to the network host.  </li> <li>Team member selects a method of listing installed applications on the network host and a storage location for the output file.  </li> <li>Team member runs the necessary script and verifies the data collected with the system owner upon completion.</li> </ul> <p>Operator Note: Multiple techniques exist for software discovery. Consider environment, scale, and level of access when selecting your approach.</p>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#end-state","title":"End State","text":"<p>The list of installed software for the selected host has been collected and validated as correct by the system owner.</p> <p>Operator Note: Store results securely with timestamp and hostname in filename for easy reference during later phases of the incident.</p>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#manual-steps","title":"Manual Steps","text":""},{"location":"2.Identification/2.11-Determine_Installed_Software/#powershell-local-run-as-administrator","title":"PowerShell (Local - Run as Administrator)","text":"<p>Run BOTH commands for 32-bit and 64-bit installed software:</p> <pre><code>Get-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName,DisplayVersion, Publisher, InstallDate | Format-Table -AutoSize &gt; C:\\software.txt\n</code></pre> <pre><code>Get-ItemProperty HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table -AutoSize &gt;&gt; C:\\software.txt\n</code></pre>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#powershell-remote-run-as-administrator","title":"PowerShell (Remote - Run as Administrator)","text":"<pre><code>Invoke-command -cn &lt;computername&gt; -Scriptblock {Get-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table -AutoSize} &gt; C:\\software.txt\n</code></pre> <pre><code>Invoke-command -cn &lt;computername&gt; -Scriptblock {Get-ItemProperty HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table -AutoSize} &gt;&gt; C:\\software.txt\n</code></pre> <p>Operator Note: Ensure WinRM is enabled on target hosts for remote PowerShell usage.</p>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#wmic-local-run-in-cmd-as-administrator","title":"WMIC (Local - Run in CMD as Administrator)","text":"<pre><code>wmic /output:\"C:\\software.txt\" product get name,version /format:\"C:\\Windows\\System32\\wbem\\en-us\\csv\"\n</code></pre> <pre><code>wmic /output:\"C:\\%Computername%_software.txt\" product get name,version /format:\"C:\\Windows\\System32\\wbem\\en-us\\csv\"\n</code></pre>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#wmic-remote","title":"WMIC (Remote)","text":"<pre><code>wmic /node:\"computername\" product get name,version /format:csv &gt; c:\\software.txt\n</code></pre> <p>Operator Note: WMIC is deprecated in latest Windows builds. Use PowerShell if WMIC is unavailable.</p>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#psinfo-sysinternals-must-be-downloaded","title":"PSInfo (Sysinternals - must be downloaded)","text":"<pre><code>psinfo \\\\computername -u username -p password -s &gt; c:\\software.txt\n</code></pre> <p>Operator Note: Download PsTools from Sysinternals and ensure psinfo.exe is in PATH or run from extracted folder.</p> <p>Output should follow <code>output_format_template.csv</code> and be named:</p> <pre><code>[mm/dd/yyyy_hh:mm:ss_Installed_Software_(computer name)]\n</code></pre> <p>Notify mission element lead and intelligence analyst of completion.</p>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#running-script","title":"Running Script","text":"<ul> <li> <p>Download script from <code>./script/determine_installed_software.ps1</code></p> </li> <li> <p>Run script:</p> </li> </ul> <pre><code>./determine_installed_software.ps1\n</code></pre> <ul> <li>Select method of enumeration (1 - 4)</li> <li>Provide output file path (full path required, e.g. <code>C:\\software_output.txt</code>)</li> </ul> <p>Operator Note: The script simplifies local and remote enumeration steps. Use when bulk processing is required.</p>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#dependencies","title":"Dependencies","text":"<ul> <li>Administrative credentials on target machines.</li> <li>PSTools downloaded if using PSInfo.</li> </ul> <pre><code>https://learn.microsoft.com/en-us/sysinternals/downloads/pstools\n</code></pre>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#references","title":"References","text":"<p>PowerShell find installed software PowerShell list installed programs Sysinternals Psinfo</p>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.11-Determine_Installed_Software/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate credentials and connectivity to target hosts.</li> <li> Choose appropriate collection method (PowerShell, WMIC, PsInfo, script).</li> <li> Store outputs using standardized naming convention.</li> <li> Notify mission lead and intelligence team after collection.</li> <li> Validate accuracy of discovered software list with system owner/admin.</li> </ul>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Windows PowerShell Primary scriptable option, local and remote Windows WMIC (deprecated) Alternate local/remote query Universal PsInfo (Sysinternals) Portable utility for system info collection Universal Custom PowerShell Script Automated multi-host enumeration"},{"location":"2.Identification/2.11-Determine_Installed_Software/#alternate-commands-and-examples","title":"Alternate Commands and Examples","text":""},{"location":"2.Identification/2.11-Determine_Installed_Software/#powershell-local-inventory","title":"PowerShell local inventory:","text":"<pre><code>Get-WmiObject -Class Win32_Product | Select-Object Name, Version\n</code></pre>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#psinfo-remote-command","title":"PsInfo remote command:","text":"<pre><code>psinfo \\\\192.168.1.50 -u domain\\admin -p password -s &gt; software_192.168.1.50.txt\n</code></pre>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#best-practices","title":"Best Practices","text":"<ul> <li>Prefer PowerShell for modern environments.</li> <li>Use PSInfo where PowerShell remoting is unavailable.</li> <li>Validate scripts and tools before running in sensitive environments.</li> <li>Save all outputs securely and share via IR coordination platform.</li> </ul>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + expanded operator tool usage, procedures, and best practices Leo"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/","title":"Perform SCAP Configuration Scan","text":""},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#task-perform-a-scap-or-retina-scan-of-network-configurations","title":"Task Perform a SCAP or Retina Scan of Network Configurations","text":""},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#conditions","title":"Conditions","text":"<p>Given an incident response workstation configured with the latest SCAP Compliance Checker, a current Open Vulnerability and Assessment Language (OVAL) file, and a copy of the configuration file for the device to be tested.</p> <p>Operator Note: SCAP scanning is primarily used for configuration compliance (STIG, CIS Benchmarks). It does not find vulnerabilities in software but verifies hardening status.</p>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#standards","title":"Standards","text":"<ul> <li>Team member checks the make, model, and software version of the device to be tested and ensures the latest OVAL file has been obtained from the manufacturer\u2019s website or other trusted source such as DoD Cyber Exchange.  </li> <li>Team member uploads the OVAL file to the SCAP tool.  </li> <li>Team member selects the configuration file for the device to be tested in the SCAP tool.  </li> <li>Team member runs the SCAP tool and upon completion selects for output the detailed report for the scan.  </li> <li>Team member uses the report findings to research remediation steps for all findings.</li> </ul> <p>Operator Note: Not all SCAP benchmarks apply to every system. Select benchmarks carefully based on OS and system classification (e.g., MAC-1_Sensitive).</p>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#end-state","title":"End State","text":"<p>All configuration vulnerabilities present in the device configuration file are found.</p> <p>Operator Note: The scan report is the authoritative record for compliance and should be saved with incident and assessment records.</p>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#manual-steps","title":"Manual Steps","text":"<ul> <li>Open SCAP (Admin Account needed).  </li> <li>Under Content, right-click SCAP Content section and select \"Delete All\".  </li> <li>Select Install \u2192 Browse \u2192 select SCAP 1.2 content to install.  </li> <li>Select Open \u2192 Install \u2192 ensure installed SCAP content is highlighted.  </li> <li>Under Stream Details \u2192 select MAC-1_Sensitive for each SCAP content installed.  </li> <li>Go to Options \u2192 Show Options \u2192 uncheck \"Perform OCIL Scan\" (reduces scan duration).  </li> <li>Set Output Options \u2192 Save Results to a Custom Directory.  </li> <li>Under Scan section \u2192 choose scan type:  <ul> <li>Local (system you are logged into)  </li> <li>Single Remote (enter FQDN)  </li> <li>Multiple Remote (host.txt file with DNS names)  </li> </ul> </li> <li>Select SCAP Benchmarks (Show Content if needed) \u2192 Start Scan.  </li> <li>Results will be saved in specified folder after completion.</li> </ul> <p>Operator Note: Scan results will typically include XCCDF and HTML formatted outputs. Review HTML version for readability.</p>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#dependencies","title":"Dependencies","text":"<ul> <li>Latest SCAP Compliance Checker (SCC) or equivalent tool  </li> <li>SCAP content files (OVAL, XCCDF, Benchmark) downloaded from vendor or DoD Cyber Exchange</li> </ul> <p>Operator Note: Update SCAP content regularly to align with evolving DISA STIGs and CIS Benchmarks.</p>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#references","title":"References","text":"<p>SCC 5.3 GUI Scanner Cisco OVAL content OVAL Adoption Program The Security Content Automation Protocol</p>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Confirm system classification and compliance benchmark required.</li> <li> Obtain latest SCAP/OVAL content from DoD, vendor, or community sources.</li> <li> Configure scan profile appropriately (disable OCIL unless needed).</li> <li> Execute scans and export results.</li> <li> Review findings and prepare remediation recommendations.</li> </ul>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Windows/Linux/macOS SCAP Compliance Checker (SCC) Primary GUI scanning tool for DISA STIG and USGCB Linux OpenSCAP Open-source SCAP CLI/GUI scanner Universal CIS-CAT Lite Lightweight configuration compliance scanner (optional alternative)"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#alternate-commands-and-examples","title":"Alternate Commands and Examples","text":""},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#openscap-command-line-example-linux","title":"OpenSCAP Command-Line Example (Linux):","text":"<pre><code>oscap xccdf eval --profile stig --results scan-results.xml --report scan-report.html /path/to/benchmark-xccdf.xml\n</code></pre>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#openscap-remote-scan-via-ssh","title":"OpenSCAP Remote Scan (via SSH):","text":"<pre><code>oscap-ssh username@remote-host 22 xccdf eval --profile stig --report remote-scan.html /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml\n</code></pre> <p>Operator Note: OpenSCAP is best suited for Linux environments. SCC is better suited for Windows and enterprise mixed environments.</p>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#best-practices","title":"Best Practices","text":"<ul> <li>Always run scans during authorized assessment windows.</li> <li>Validate SCAP scan profiles to avoid unnecessary test cases (which can slow scans).</li> <li>Use host grouping and scan scheduling for large environments.</li> <li>Archive raw results and HTML reports for audit trail and after-action reports.</li> </ul>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + enriched SCAP/OVAL tools usage, CLI examples, and operator guidance Leo"},{"location":"2.Identification/2.13-Perform_STIG_Scan/","title":"Perform STIG Scan","text":""},{"location":"2.Identification/2.13-Perform_STIG_Scan/#task-perform-stig-scan","title":"Task Perform STIG Scan","text":""},{"location":"2.Identification/2.13-Perform_STIG_Scan/#conditions","title":"Conditions","text":"<p>Given a list of hosts with known operating systems and/or applications, the user will complete a scan using the appropriate STIG (Security Technical Implementation Guide) using an assigned tool. These standards follow using Nessus as the tool to perform the scan. SCAP (Security Content Automation Protocol) compliant STIGs should be used when possible.</p> <p>Operator Note: SCAP STIG scanning assesses secure configurations based on DISA, CIS, or organizational hardening standards. It does not scan for software vulnerabilities.</p>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#standards","title":"Standards","text":"<ul> <li>Identify appropriate STIG(s) to be used to analyze.  </li> <li>This is dependent upon the Network Owner disclosing their complete IT Inventory.</li> <li>Scan using the chosen STIG using Nessus.  </li> <li>These will likely be conducted several times, one per software target.</li> <li>Export results of the scan.  </li> <li>Standardize naming convention to include Software Target and Time/Date.</li> </ul> <p>Operator Note: Use DoD-approved or NIST SCAP content whenever possible for best results.</p>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#end-state","title":"End State","text":"<p>Results of the STIG scan baselines the host and identifies any security control weaknesses.</p> <p>Operator Note: Exported scan reports should be saved, backed up, and shared securely with incident and compliance teams.</p>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#manual-steps","title":"Manual Steps","text":""},{"location":"2.Identification/2.13-Perform_STIG_Scan/#cli-based-nessus-legacy-automated-process","title":"CLI-based Nessus (Legacy / Automated Process)","text":"<ul> <li>Navigate to the Mission Directory:</li> </ul> <pre><code>cd /ios/data/assess/&lt;MISSION_DIR&gt;\n</code></pre> <ul> <li>View discovered targets:</li> </ul> <pre><code>ls \u2013la ./collect/targ\n</code></pre> <ul> <li>Run a Nessus STIG scan against each OS type:</li> </ul> <pre><code>nessus.sh localhost win_&lt;OS Type&gt;_stig ./collect/targ/&lt;OS Type&gt;.ips\n</code></pre> <ul> <li>View the scan output:</li> </ul> <pre><code>ls -la ./collect/nbe\n</code></pre> <ul> <li>Convert the <code>.nbe</code> file to a tabular report:</li> </ul> <pre><code>nbeSTIG2tab.sh ./collect/nbe/&lt;timestamp&gt;-win_&lt;OS Type&gt;_stig.nbe &gt; win_&lt;OS Type&gt;_stig.tab\n</code></pre> <ul> <li>Move the result into the report directory:</li> </ul> <pre><code>mv ./win_&lt;OS Type&gt;_stig.tab ./report/\n</code></pre>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#nessus-command-line-switches-quick-reference","title":"Nessus Command Line Switches (Quick Reference)","text":"<pre><code>-I Input file for report format conversion\n-o Output file for report format conversion\n-p List plugins\n-P Show plugin/server preferences\n-S SQL syntax output\n-T Report output format (nbe, html, xml, text, etc)\n</code></pre>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#nessus-web-interface-preferred-modern-method","title":"Nessus Web Interface (Preferred Modern Method)","text":"<ul> <li>Download certified SCAP content ZIP file (from NIST or DoD Cyber Exchange).</li> <li>Create a new Scan \u2192 Use SCAP Compliance Audit template.</li> <li>Upload SCAP zip in the \"Active SCAP Components\" section.</li> <li>Choose appropriate benchmark/profile.</li> <li>Add scan targets and credentials.</li> <li>Launch scan and review results after completion.</li> </ul> <p>Operator Note: Nessus Professional is recommended for larger enterprise scanning. Free version limited to 16 IPs.</p>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#downloading-scap-content","title":"Downloading SCAP Content","text":"<p>SCAP content bundles can be downloaded for use:</p> <ul> <li>NIST SCAP Content Repository</li> <li>DISA STIG Content</li> </ul>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#exporting-scan-results","title":"Exporting Scan Results","text":"<p>In Nessus Web UI:</p> <ul> <li>Export as <code>.nessus</code> format to allow portability and re-import.</li> <li>Name convention: <code>&lt;scan_name&gt;_&lt;scan_ID&gt;.nessus</code></li> </ul>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#running-script","title":"Running Script","text":"<p>N/A (scripts embedded in Nessus or manual commands)</p>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#dependencies","title":"Dependencies","text":"<ul> <li>Nessus or Nessus Pro (or equivalent SCAP scanner)</li> </ul> <p>Nessus Free version allows up to 16 IPs, Professional version allows enterprise-scale scanning.</p> <ul> <li>SCAP/STIG Benchmark Content</li> </ul>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#other-available-tools","title":"Other available tools","text":"<ul> <li>DISA SCAP Compliance Checker (SCC) \u2014 DISA-approved SCAP scanner  </li> <li>OpenSCAP \u2014 Linux-based command-line SCAP scanning and reporting  </li> <li>SCAP Workbench \u2014 Desktop-based SCAP scanning for small scale use</li> </ul>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.13-Perform_STIG_Scan/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate targets and obtain OS/application inventory.</li> <li> Download and validate SCAP content bundles.</li> <li> Configure Nessus or DISA SCC for scan profiles.</li> <li> Execute scans and monitor results.</li> <li> Export, archive, and distribute results securely.</li> </ul>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Universal Nessus / Nessus Pro Primary tool for SCAP/STIG scanning (GUI + CLI) Windows/Linux DISA SCAP Compliance Checker (SCC) DISA-approved alternative Linux OpenSCAP / SCAP Workbench Open-source STIG scanning (optional)"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#alternate-commands-and-examples","title":"Alternate Commands and Examples","text":""},{"location":"2.Identification/2.13-Perform_STIG_Scan/#openscap-example-linux","title":"OpenSCAP example (Linux):","text":"<pre><code>oscap xccdf eval --profile stig --results result.xml --report result.html /path/to/benchmark.xml\n</code></pre>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#scap-workbench-example","title":"SCAP Workbench example:","text":"<pre><code>Open SCAP Workbench GUI\nLoad XCCDF or DataStream\nSelect profile \u2192 Run Scan \u2192 Export Report\n</code></pre>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#best-practices","title":"Best Practices","text":"<ul> <li>Use standardized naming for all exported scan artifacts.</li> <li>Schedule scans during low-use windows (as they may impact performance).</li> <li>Validate and archive raw <code>.nessus</code> or <code>.xml</code> files for auditability.</li> <li>Review findings carefully with system owners for applicability.</li> </ul>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#references","title":"References","text":"<p>Tenable Nessus Trial Tenable SCAP Guide DISA SCAP Tool Stig Viewer NIST SCAP Content</p>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + enriched Nessus SCAP scan operator guidance and alternate tooling Leo"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/","title":"Gather AD Structure Information","text":""},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#task-gather-ad-structure-information","title":"Task Gather AD Structure Information","text":""},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can gather the structure of the suspected domain.</p> <p>Operator Note: Enumerating Active Directory structure is essential during incident response to detect unexpected organizational units, rogue accounts, or misconfigured objects.</p>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#standards","title":"Standards","text":"<ul> <li>The team member identifies possibly compromised network segment(s).  </li> <li>The team member accesses a system that can enumerate the domain.  </li> <li>The team member utilizes various PowerShell cmdlets to enumerate the domain structure and/or users.  </li> <li>Task 2.14 \u2013 Gather AD structure information.  </li> <li>The resulting enumerated data is compared to a known good AD configuration file to determine any anomalies present in the domain.</li> </ul> <p>Operator Note: Use baseline domain structure documentation when available to detect unauthorized additions or changes.</p>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#end-state","title":"End State","text":"<p>The structure of the domain is enumerated based on the specific sub-task accomplished and any anomalies on the domain will be identified.</p> <p>Operator Note: Findings should be shared with the incident lead and mission partner domain administrators.</p>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#manual-steps","title":"Manual Steps","text":""},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#gather-current-domain-information","title":"Gather Current Domain Information","text":"<pre><code>$adddomain = Get-ADDomain\n$adddomain\n</code></pre> <p>Example output:</p> <pre><code>AllowedDNSSuffixes    : {}\nChildDomains          : {}\nComputersContainer    : CN=Computers,DC=team01,DC=tgt\n--snipped--\n</code></pre>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#gather-domain-organizational-units-ous","title":"Gather Domain Organizational Units (OUs)","text":"<pre><code>Get-ADObject -Filter { ObjectClass -eq 'organizationalunit' } -Properties CanonicalName | Select-Object -Property CanonicalName\n</code></pre> <p>Example output:</p> <pre><code>CanonicalName\n-------------\nteam01.tgt/Domain Controllers\nteam01.tgt/Microsoft Exchange Security Groups\nteam01.tgt/Groups\nteam01.tgt/Chula Vista\n--snipped--\n</code></pre> <p>Operator Note: This command lists the hierarchy of Organizational Units. Unexpected or newly created OUs should be reviewed carefully.</p>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#output","title":"Output","text":"<p>Output should follow naming convention format:</p> <pre><code>[mm/dd/yyyy_hh:mm:ss_AD_Structure_(xx.xx.xx.xx/x)]\n</code></pre> <p>Notify mission element lead and intelligence analyst of completion.</p>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#running-script","title":"Running Script","text":"<ul> <li> <p>Download script from 2.14_Gather_AD_Structure_Information.</p> </li> <li> <p>Run script:</p> </li> </ul> <pre><code>.\\2.14_GatherADStructureInfo.ps1\n</code></pre> <p>Example script output:</p> <pre><code>[+] Writing Active Directory structure to C:\\Users\\btadmin\\Desktop\\CyberSurfers\\CyberSurfers_ACL_1593261366.22937.txt...\n[+] Done!\n</code></pre> <ul> <li>The logfile will be saved to the <code>CyberSurfers</code> directory for review.</li> </ul> <pre><code>cat .\\CyberSurfers\\CyberSurfers_ACL_1593261366.txt\n</code></pre> <p>Example contents:</p> <pre><code>[+] Domains infrastructure master: Team01-DC01.team01.tgt\n[+] The Active Directory structure as follows:\nDC=team01,DC=tgt\n--&gt; OU=Alameda\n----&gt; OU=Computers\n----&gt; OU=Groups\n----&gt; OU=Servers\n----&gt; OU=Users\n--snipped--\n</code></pre>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#dependencies","title":"Dependencies","text":"<ul> <li>PowerShell (Windows systems with RSAT installed)  </li> <li>Active Directory module for PowerShell (<code>RSAT: Active Directory</code>)</li> </ul> <pre><code>Import-Module ActiveDirectory\n</code></pre> <p>Operator Note: RSAT tools must be installed on the analyst workstation or jump box. Windows Server and domain-joined systems typically include them.</p>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#other-available-tools","title":"Other available tools","text":"<ul> <li>ADExplorer (Sysinternals) </li> <li> <p>GUI tool for offline and online AD enumeration and snapshots.</p> </li> <li> <p>BloodHound (Optional Advanced) </p> </li> <li> <p>Graph-based AD relationship mapping. Used for advanced attack path discovery. (Use only when approved.)</p> </li> <li> <p><code>dsquery</code> (legacy command-line):</p> </li> </ul> <pre><code>dsquery ou -limit 0\n</code></pre>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#references","title":"References","text":"<p>Microsoft PowerShell AD Module Cmdlets ADExplorer by Sysinternals BloodHound AD Mapping</p>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate domain connectivity and appropriate credentials.</li> <li> Use PowerShell AD module for quick OU and domain enumeration.</li> <li> Run and save output of <code>2.14_GatherADStructureInfo.ps1</code> script.</li> <li> Review output for unauthorized or suspicious OUs.</li> <li> Notify lead and preserve reports in incident repository.</li> </ul>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Windows PowerShell + AD Module Primary enumeration tool Windows ADExplorer (Sysinternals) Offline and advanced AD viewer Universal BloodHound (optional) Advanced AD relationship and path analysis"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#alternate-commands","title":"Alternate Commands","text":""},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#enumerate-domain-controllers","title":"Enumerate Domain Controllers:","text":"<pre><code>Get-ADDomainController -Filter *\n</code></pre>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#enumerate-ad-sites","title":"Enumerate AD Sites:","text":"<pre><code>Get-ADReplicationSite -Filter *\n</code></pre>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#legacy-dsquery","title":"Legacy dsquery:","text":"<pre><code>dsquery ou -limit 0\n</code></pre>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#best-practices","title":"Best Practices","text":"<ul> <li>Use domain-joined workstations with RSAT for enumeration.</li> <li>Run with least privilege necessary, but admin rights may be required.</li> <li>Compare results with baseline domain documentation.</li> <li>Preserve outputs securely for incident timeline reconstruction.</li> </ul>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + enriched AD enumeration tooling, procedures, and operator notes Leo"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/","title":"AD Configuration Scan with PowerShell","text":""},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#task-evaluate-active-directory-ad-configurations-using-powershell","title":"Task Evaluate Active Directory (AD) Configurations using PowerShell","text":""},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#conditions","title":"Conditions","text":"<p>Given an incident response workstation with PowerShell configured, Domain Administrator-level credentials, and a target Domain.</p> <p>Operator Note: Authorization from the network owner is required before accessing and scanning AD structures.</p>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#standards","title":"Standards","text":"<ul> <li>Team member verifies connectivity to the Domain Controller with provided credentials.  </li> <li>Team member ensures the Active Directory module has been imported into the PowerShell console prior to running scan.  </li> <li>Team member runs a PowerShell script utilizing AD cmdlets to capture the following AD-related information to an output file:<ul> <li>Domain Controllers (DCs)</li> <li>Domain Groups</li> <li>Domain Organizational Units (OUs)</li> <li>Domain Computers</li> <li>Domain Users</li> <li>Domain Service Accounts</li> <li>Group Membership</li> <li>OU Membership</li> </ul> </li> <li>Team member saves the output file for comparison to later evaluations.</li> </ul> <p>Operator Note: Captured data should be stored securely and compared to baselines to identify unauthorized changes.</p>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#end-state","title":"End State","text":"<p>AD configuration information for the target domain is output to a text or XML file for later comparison.</p> <p>Operator Note: Reports should be retained for post-incident analysis and forensic review.</p>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#manual-steps","title":"Manual Steps","text":"<p>Using a team laptop that is NOT a member of the domain:</p> <ol> <li>Launch <code>2.15_AD_Enumeration_FromExternal.ps1</code> PowerShell script.  </li> <li>Input required information when prompted:</li> </ol> <pre><code>Domain credentials: DOMAIN\\username (i.e. team02\\Administrator)\nDomain Controller name: (i.e. team02-dc01)\nDomain name: (i.e. team02.tgt)\n</code></pre> <ol> <li>Allow script to run (may take 5\u201310 minutes).</li> <li>Upon completion, review exported results:</li> </ol> <pre><code>C:\\Temp\\export.txt\n</code></pre> <ol> <li> <p>To compare results later:</p> </li> <li> <p>Save previous export to different directory.</p> </li> <li>Use Notepad++ with \"Compare\" plugin or similar diff tool to identify changes.</li> </ol> <p>Operator Note: Comparing AD structure over time helps detect persistence mechanisms such as rogue service accounts or group modifications.</p>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#running-script","title":"Running Script","text":"<ul> <li>The following script should be executed with PowerShell:</li> </ul> <pre><code>.\\2.15_AD_Enumeration_FromExternal.ps1\n</code></pre> <ul> <li> <p>Follow on-screen prompts to input domain and credential information.</p> </li> <li> <p>Output file is saved to:</p> </li> </ul> <pre><code>C:\\Temp\\export.txt\n</code></pre>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#dependencies","title":"Dependencies","text":"<ul> <li>PowerShell (recommended: v5+ or PowerShell 7)</li> <li>Active Directory PowerShell Module (installed via RSAT on Windows)</li> </ul> <pre><code>Import-Module ActiveDirectory\n</code></pre>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#other-available-tools","title":"Other available tools","text":"<ul> <li>Windows Command Line (dsquery, net group /domain)</li> <li>ManageEngine ADManager Plus and ADAudit Plus (optional enterprise tools)</li> <li>PowerView (for advanced operator enumeration - use only when authorized)</li> </ul> <pre><code>Import-Module PowerView\nGet-NetDomain\nGet-NetOU\nGet-NetUser\n</code></pre> <p>Operator Note: PowerView is an advanced operator tool useful for deeper relationship enumeration (offensive/defensive). Use cautiously.</p>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#references","title":"References","text":"<p>Microsoft PowerShell Overview RSAT: Active Directory Module PowerView GitHub</p>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Confirm Domain connectivity and required credentials.</li> <li> Run PowerShell AD Enumeration script and collect export.</li> <li> Store and secure exported AD configuration files.</li> <li> Use Notepad++, diff tools or automated solutions to compare AD state over time.</li> <li> Investigate any unauthorized changes immediately with AD administrators.</li> </ul>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Windows PowerShell + AD Module Primary method for AD enumeration Windows ADManager Plus, ADAudit Plus GUI-based enterprise tools Windows/Linux PowerView (optional, advanced use) Advanced AD enumeration for operators"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#alternate-commands","title":"Alternate Commands","text":""},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#enumerate-domain-controllers-quick-check","title":"Enumerate Domain Controllers (quick check):","text":"<pre><code>Get-ADDomainController -Filter *\n</code></pre>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#enumerate-all-ad-users","title":"Enumerate all AD Users:","text":"<pre><code>Get-ADUser -Filter * -Properties *\n</code></pre>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#legacy-cmd","title":"Legacy (CMD):","text":"<pre><code>net group \"Domain Admins\" /domain\n</code></pre>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#best-practices","title":"Best Practices","text":"<ul> <li>Run during off-peak hours if targeting large domains.</li> <li>Validate script and module versions to avoid compatibility issues.</li> <li>Archive all export and comparison outputs for audit and forensics.</li> <li>Conduct delta analysis post-scan for unusual changes.</li> </ul>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + enriched PowerShell AD configuration scan procedures and tooling Leo"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/","title":"List All AD Domain Accounts","text":""},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#task-identify-all-ad-domain-accounts","title":"Task Identify all AD Domain Accounts","text":""},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can access and view the list of AD accounts as is.</p> <p>Operator Note: Identifying all AD domain accounts allows responders to detect new or unauthorized accounts created by threat actors.</p>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#standards","title":"Standards","text":"<ul> <li>The team member accesses the compromised system.  </li> <li>The team member uses the approved script or tools to output the AD users to a text file for analysis.  </li> <li>The resulting scan data provides a list of AD users for later correlation and investigation.</li> </ul> <p>Operator Note: Ensure export includes key attributes (account name, status, OU) for effective analysis.</p>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#end-state","title":"End State","text":"<p>All users of the domain are enumerated and any newly created accounts will be identified.</p> <p>Operator Note: Reported user list should be shared with mission owner and reviewed for suspicious accounts, disabled accounts re-enabled, and naming convention anomalies.</p>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#manual-steps","title":"Manual Steps","text":""},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#powershell-local-or-remote-with-rsat","title":"PowerShell (local or remote with RSAT)","text":"<ul> <li>Get all users of the current domain:</li> </ul> <pre><code>Get-ADUser -Filter *\n</code></pre> <ul> <li>Count number of users:</li> </ul> <pre><code>$dcUsers = Get-ADUser -Filter *\n$dcUsers.Count\n</code></pre> <p>Example:</p> <pre><code>6609\n</code></pre> <ul> <li>List disabled AD accounts:</li> </ul> <pre><code>Get-ADUser -Filter { Enabled -eq \"False\" } | Select-Object SamAccountName\n</code></pre> <ul> <li>List all accounts with attributes:</li> </ul> <pre><code>dsquery * -limit 0\n</code></pre> <p>Example:</p> <pre><code>\"CN=Sochan\\, Carlenel,OU=Users,OU=Santa Ana,DC=team01,DC=tgt\"\n\"CN=Team01-WK4355,OU=Computers,OU=Los Angeles,DC=team01,DC=tgt\"\n</code></pre> <p>Operator Note: dsquery output provides Distinguished Name (DN), useful for OU and account path analysis.</p>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#running-script","title":"Running Script","text":"<ul> <li>Run the <code>2.16_ListADDomainAccounts.ps1</code> script:</li> </ul> <pre><code>.\\2.16_ListADDomainAccounts.ps1\n</code></pre> <ul> <li>Example output:</li> </ul> <pre><code>[+] Current Domain: team01.tgt\n[+] There are 6609 users in team01.tgt\n[+] Writing domain users to all_ad_domain_accounts.txt...\n[+] Done!\n</code></pre> <ul> <li>Review output file:</li> </ul> <pre><code>C:\\Path\\To\\all_ad_domain_accounts.txt\n</code></pre>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#dependencies","title":"Dependencies","text":"<ul> <li>PowerShell</li> <li>RSAT: Active Directory Module for PowerShell</li> </ul> <p>Install RSAT (if missing):</p> <pre><code>Add-WindowsCapability -Online -Name \"Rsat.ActiveDirectory.DS-LDS.Tools~~~~0.0.1.0\"\n</code></pre>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#other-available-tools","title":"Other available tools","text":"<ul> <li>Net User (Basic command):</li> </ul> <pre><code>net user /domain\n</code></pre> <ul> <li>ADExplorer (Sysinternals): GUI for viewing AD objects  </li> <li>PowerView (Optional advanced use): Advanced AD enumeration</li> </ul> <p>Operator Note: PowerView should be used carefully and only when authorized. ADExplorer is suitable for offline review.</p>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#references","title":"References","text":"<p>PowerShell AD Module Cmdlets Sysinternals ADExplorer</p>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate connectivity and admin rights.</li> <li> Run PowerShell or provided script to export full user list.</li> <li> Review for disabled accounts, new accounts, and naming anomalies.</li> <li> Save and secure export file.</li> <li> Compare against known baselines (if available).</li> </ul>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Windows PowerShell + AD Module Primary AD user enumeration Windows dsquery Legacy quick command Universal ADExplorer GUI-based AD object viewer Advanced (Windows/Linux) PowerView Advanced AD enumeration (optional use)"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#alternate-commands","title":"Alternate Commands","text":""},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#get-ad-users-and-export-to-csv","title":"Get AD users and export to CSV:","text":"<pre><code>Get-ADUser -Filter * | Export-Csv -Path C:\\ADUsers.csv -NoTypeInformation\n</code></pre>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#get-disabled-users-only","title":"Get disabled users only:","text":"<pre><code>Search-ADAccount -AccountDisabled | Select-Object Name, Enabled\n</code></pre>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#best-practices","title":"Best Practices","text":"<ul> <li>Run enumeration after confirming IR authority.</li> <li>Schedule large queries during off-peak hours.</li> <li>Use CSV format for easier sorting/filtering.</li> <li>Validate new or unexpected accounts with system owner.</li> </ul>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + enriched AD user enumeration tooling, PowerShell scripts, and operator recommendations Leo"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/","title":"Scan Device for Default Admin Password","text":""},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#task-scan-device-for-default-admin-passwords","title":"Task Scan Device For Default Admin Passwords","text":""},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can access and scan the identified network devices, and scanning software included in the team\u2019s incident response kit.</p> <p>Operator Note: Default or weak admin credentials are a common foothold used by attackers. Identify and report them immediately.</p>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#standards","title":"Standards","text":"<ul> <li>Team member scans network for devices with default passwords.  </li> <li>Team member identifies devices and notifies network owner of findings.</li> </ul> <p>Operator Note: Always coordinate with network owner prior to scanning production systems.</p>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#end-state","title":"End State","text":"<p>All devices on network with weak or default passwords will be identified.</p> <p>Operator Note: Results should be documented, validated with system owners, and used to plan remediation actions.</p>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#manual-steps","title":"Manual Steps","text":""},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#using-nessus-web-ui","title":"Using Nessus (Web UI)","text":"<ol> <li>Log into Nessus via IP and port <code>8834</code>.</li> </ol> <p>Example:</p> <pre><code>https://x.x.x.x:8834\n</code></pre> <ol> <li> <p>Verify correct plugins are enabled:</p> </li> <li> <p>Navigate to Scans &gt; New Scan &gt; Advanced Scan.</p> </li> <li>Click the Plugins tab.</li> <li>Use the Filter toolbar at the top.</li> <li>Change dropdown to \"Default/Known accounts\" and click Apply.</li> <li>Review filtered plugins and ensure they are enabled.</li> </ol> <p>Operator Note: Some plugins may be disabled by default for safety. Review plugin descriptions carefully.</p> <ol> <li> <p>Create a new Advanced Scan:</p> </li> <li> <p>Title: <code>Weak &amp; Known Password Scan</code></p> </li> <li>Targets: Enter IP range (example <code>x.x.x.x/24</code>)</li> <li>Leave other settings default.</li> <li>Save the scan.</li> <li> <p>Launch the scan.</p> </li> <li> <p>Monitor and review results once completed.</p> </li> </ol> <p>Operator Note: Findings may include embedded device logins, network appliances, and misconfigured admin interfaces.</p>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#running-script","title":"Running Script","text":"<ul> <li>Not applicable for this task.</li> <li>GUI + web-based scan via Nessus is the method used.</li> </ul>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#dependencies","title":"Dependencies","text":"<ul> <li>Nessus server with valid license or community edition.</li> <li>Network reachability to target subnet.</li> </ul>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#nessus-installation-quick-guide","title":"Nessus installation quick guide:","text":""},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#ubuntudebian","title":"Ubuntu/Debian:","text":"<pre><code>dpkg -i Nessus-latest-debian6_amd64.deb\nsudo /bin/systemctl start nessusd.service\n</code></pre>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#access-gui","title":"Access GUI:","text":"<pre><code>https://localhost:8834\n</code></pre> <p>Operator Note: Install Nessus on isolated assessment VM or approved incident response host.</p>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#other-available-tools","title":"Other available tools","text":"<ul> <li>Nmap NSE Scripts (optional):</li> </ul> <pre><code>nmap --script=default-credentials -p 22,23,80,443 x.x.x.x/24\n</code></pre> <ul> <li>Hydra (optional advanced tool for password brute-force, authorized use only)</li> </ul> <pre><code>hydra -L users.txt -P passwords.txt 192.168.1.1 ssh\n</code></pre> <p>Operator Note: Nmap can identify default credentials passively, Hydra is active/password guessing and should only be used with explicit authorization.</p>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#references","title":"References","text":"<p>Nessus Plugins Nessus Default Credentials Nmap NSE Default Credentials</p>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Confirm authorization to scan for weak/default credentials.</li> <li> Configure Nessus with proper plugin selection.</li> <li> Run scan and export findings.</li> <li> Review results carefully with asset/system owners.</li> <li> Propose remediation (disable default accounts, enforce strong passwords).</li> </ul>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Universal Nessus Primary tool for known/default password scans Linux/Windows Nmap NSE scripts Optional passive scan for embedded device defaults Linux/Windows Hydra Advanced password brute-forcing (authorized use only)"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#alternate-commands-and-examples","title":"Alternate Commands and Examples","text":""},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#nmap-default-credentials-quick-test","title":"Nmap Default Credentials (quick test):","text":"<pre><code>nmap --script=default-credentials -p 22,23,80,443 192.168.1.0/24\n</code></pre>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#hydra-authorized-use-only","title":"Hydra (authorized use only):","text":"<pre><code>hydra -L users.txt -P passwords.txt 192.168.1.50 ssh\n</code></pre>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#best-practices","title":"Best Practices","text":"<ul> <li>Always notify and coordinate with system owners prior to scanning.</li> <li>Prioritize critical infrastructure (routers, switches, remote management interfaces).</li> <li>Document all findings and mitigation plans.</li> <li>Avoid brute-force techniques unless part of authorized red team engagement.</li> </ul>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + enriched Nessus + alternative tooling + operator recommendations Leo"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/","title":"Review Organizational User Policies","text":""},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#task-review-organizational-user-policies","title":"Task Review Organizational User Policies","text":""},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#conditions","title":"Conditions","text":"<p>Given organization user policies and access to information security personnel and knowledge workers.</p> <p>Operator Note: Understanding policy is crucial to assessing procedural compliance and risk exposure during an incident.</p>"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#standards","title":"Standards","text":"<ul> <li>Team member reviews all written policies regarding users of information systems.  </li> <li> <p>Policies should address at minimum:</p> <ul> <li>Acceptable Use Policy (AUP)</li> <li>Account request process</li> <li>Account creation, deletion, and suspension procedures</li> <li>Access control methodology</li> <li>Initial and periodic user training</li> <li>Elevated privilege request and review process</li> <li>Account audit process</li> </ul> </li> <li> <p>Team member interviews security personnel for technical implementation insight.  </p> </li> <li>Team member interviews random users for awareness and compliance validation.</li> </ul>"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#endstate","title":"Endstate","text":"<p>All user policies have been reviewed and shortfalls annotated and briefed to the system owner.  </p>"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#notes","title":"Notes","text":"<ul> <li> <p>Acceptable Use Policy Will be tailored to the organization and include items such as social media, PII and email monitoring. Policy will fall in line with local provider or enclave.  </p> </li> <li> <p>Account Requests: Account forms can be found in a central digital location that is easily accessible for personnel to retrieve. The account request form needs to include information fields for name (first, last), rank/title, organization, reason for request, location/group. Digital copy of completed request forms should be kept in a central database with access restricted to those who need it (account creators, database administrators) Information Assurance (IA) training certification is required as part of account request packet. IA training can be found at https://ia.signal.army.mil. A passing score of 70% is required to gain an account and is an annual requirement to keep the account.  </p> </li> <li> <p>Account suspension: After a lack of use or non-use for 45 days or an AUP violation, user accounts will be placed in suspension (disabled) status. If suspension is in response to an AUP violation, the account will not be placed back into active status until after IA training has been redone and the certification is received by the account managers and noted on the account. If the account in is suspended status due to lack of use, the user will need to speak with the account managers to get it reactivated.  </p> </li> <li> <p>Account deletion: Reasons for account deletion include lack of use, repeat violations of the Acceptable Use Policy and job termination. Lack of use or non-use limit for user accounts is set at 90 days. For account deletion due to violations, users are granted two suspensions before resulting in deletion. All user violations should be noted on their account with the incident date, incident, response results, and date of completion of IA training from the new certification.  </p> </li> <li> <p>Access control methodology:  Access to groups and elevated privileges are treated on an individual basis. Requesters will need to fill out a request form that includes information fields for name, rank/title, organization, requested groups/elevated privileges/access level, why they are requesting it and have supervisor approval to be given access to additional groups and privileges. Periodic review will be conducted to determine continued user access to the groups and privileges.  </p> </li> <li> <p>Initial and periodic review: IA and Information Assurance Security Officer (IASO) training will need to renewed on an annual basis. Any additional certifications will also be reviewed on an annual basis as part of the personnel performance review to ensure any continued education that is needed is being addressed and tracked.</p> </li> <li> <p>Elevated privilege request/review: Elevated privileges will be addressed on an individual basis. The request will use the same form as the group membership request and follow the same process. Elevated privileges will be periodically reviewed for determination of continued usage. Privilege violations will result in one warning before removal. To get privileges returned will require review with the user\u2019s supervisor to determine if privileges will be returned due to required job duties.  </p> </li> <li> <p>Account audit process: Accounts will be audited on a monthly schedule and compared against various variables to determine account usage, status and IA/IASO certification expiration.  </p> </li> </ul>"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#references","title":"References","text":"<p>NIST 800-53 Controls DISA IAWIP Policy References </p>"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Obtain and review latest organizational user policies.</li> <li> Interview system administrators and IA personnel.</li> <li> Interview representative users for policy awareness.</li> <li> Document gaps and recommendations.</li> <li> Brief findings to system owner.</li> </ul>"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Universal SharePoint / Policy repository Locate user policy documents Windows PowerShell / Active Directory Tools Validate user accounts and statuses"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#best-practices","title":"Best Practices","text":"<ul> <li>Validate account suspension/deletion process during review.</li> <li>Focus on elevated privileges and their review processes.</li> <li>Provide clear recommendations for unaddressed security gaps.</li> </ul>"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#references_1","title":"References","text":"<p>NIST 800-53 Controls DISA IAWIP Policy References</p>"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + enriched operator-focused analysis procedures and checklists Leo \ud83d\udce6 FINAL VERSION \u2192 2.19 Create Firewall Rule"},{"location":"2.Identification/2.19-Create_firewall_rule_list/","title":"Create Firewall Rule List","text":""},{"location":"2.Identification/2.19-Create_firewall_rule_list/#task-create-firewall-rule-list","title":"Task Create Firewall Rule List","text":""},{"location":"2.Identification/2.19-Create_firewall_rule_list/#conditions","title":"Conditions","text":"<p>Given access to suspected compromised hosts and appropriate credentials.</p> <p>Operator Note: Local firewall rules provide critical insight into allowed and blocked communications on hosts.</p>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#standards","title":"Standards","text":"<ul> <li>Establish local firewall rules baseline.  </li> <li>Periodically rerun checks and compare against baseline.  </li> <li>Review rules for security gaps and misconfigurations.</li> </ul> <p>Operator Note: Document all rule changes and justification for audit purposes.</p>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#end-state","title":"End State","text":"<p>Local firewall rules baseline established and maintained.</p>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#manual-steps","title":"Manual Steps","text":""},{"location":"2.Identification/2.19-Create_firewall_rule_list/#display-all-firewall-rules","title":"Display all firewall rules:","text":"<pre><code>netsh advfirewall firewall show rule name=all\n</code></pre>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#set-firewall-onoff","title":"Set firewall on/off:","text":"<pre><code>netsh advfirewall set currentprofile state on\nnetsh advfirewall set currentprofile firewallpolicy blockinboundalways,allowoutbound\nnetsh advfirewall set allprofile state on\nnetsh advfirewall set allprofile state off\n</code></pre> <p>Operator Note: Changing firewall status impacts network security. Obtain approval before altering settings.</p>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#example-firewall-rules","title":"Example firewall rules:","text":"<pre><code>netsh advfirewall firewall add rule name=\"Open Port 80\" dir=in action=allow protocol=TCP localport=80\nnetsh advfirewall firewall delete rule name=\"My Application\" program=\"C:\\\\MyApp\\\\MyApp.exe\"\nnetsh advfirewall firewall set rule group=\"remote desktop\" new enable=Yes profile=domain\nnetsh advfirewall set currentprofile logging C:\\\\Logs\\\\firewall.log\n</code></pre>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#windows-firewall-log-settings","title":"Windows Firewall Log Settings:","text":"<pre><code>more %systemroot%\\system32\\LogFiles\\Firewall\\pfirewall.log\nnetsh advfirewall set allprofile logging droppedconnections enable\nnetsh advfirewall set allprofile logging allowedconnections enable\n</code></pre>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#powershell-cmdlets-for-firewall","title":"PowerShell cmdlets for firewall:","text":"<pre><code>Get-Command *-*firewall*\n</code></pre>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#running-script","title":"Running Script","text":"<ul> <li>Transfer and run <code>2.19_CreateFirewallRuleList.ps1</code>:</li> </ul> <pre><code>.\\2.19_CreateFirewallRuleList.ps1\n</code></pre> <ul> <li>Review export file for local firewall configuration.</li> </ul>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#dependencies","title":"Dependencies","text":"<ul> <li>Windows operating system  </li> <li>PowerShell installed and configured</li> </ul>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#other-available-tools","title":"Other available tools","text":"<ul> <li>Group Policy Management Console (GPMC) - Domain-wide firewall management</li> <li>Advanced Security Windows Firewall GUI</li> </ul> <p>Operator Note: Domain firewall rules may override local rules. Validate which profile is active.</p>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#references","title":"References","text":"<p>PowerShell NetSecurity</p>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.19-Create_firewall_rule_list/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Collect and export local firewall rules from target hosts.</li> <li> Establish and maintain firewall rule baselines.</li> <li> Review rules for risky configurations.</li> <li> Report gaps or misconfigurations to network owner.</li> </ul>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Windows netsh CLI-based firewall rule management Windows PowerShell NetSecurity module Scriptable firewall rule collection Universal Advanced Security Firewall GUI Visual firewall rule review"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#alternate-commands","title":"Alternate Commands","text":""},{"location":"2.Identification/2.19-Create_firewall_rule_list/#quick-allow-rule-creation","title":"Quick allow rule creation:","text":"<pre><code>New-NetFirewallRule -DisplayName \"Allow HTTP\" -Direction Inbound -LocalPort 80 -Protocol TCP -Action Allow\n</code></pre>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#export-firewall-configuration","title":"Export firewall configuration:","text":"<pre><code>netsh advfirewall export \"C:\\firewall-config.wfw\"\n</code></pre>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#best-practices","title":"Best Practices","text":"<ul> <li>Document rule baselines for future comparison.</li> <li>Review default and allow rules for security gaps.</li> <li>Validate firewall profiles (Domain, Private, Public) are correctly applied.</li> </ul>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.8 Full original + enriched firewall rule collection, validation, and operator procedures Leo"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/","title":"Review Firewall Configuration for Indicators of Compromise (IOCs)","text":""},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#task-review-firewall-configuration-for-indicators-of-compromise","title":"Task Review Firewall Configuration for Indicators of Compromise","text":""},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#conditions","title":"Conditions","text":"<p>Given access to a firewall appliance or host-based firewall, incident responders must review firewall rules and logs to detect unauthorized, suspicious, or misconfigured entries that may indicate compromise.</p> <p>Operator Note: Reviewing firewall rules and logs helps detect persistence mechanisms (e.g., backdoor ports), lateral movement, or data exfiltration paths.</p>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#standards","title":"Standards","text":"<ul> <li>The team member accesses the firewall or firewall management platform.  </li> <li>The team member exports and/or reviews active rulesets.  </li> <li>The team member reviews logs for abnormal entries, including:<ul> <li>Unusual inbound rules</li> <li>Unusual outbound destinations</li> <li>Temporary or recent rule additions</li> <li>Disabled security policies</li> </ul> </li> <li>The team member documents findings and correlates them with incident IOCs.</li> </ul> <p>Operator Note: Collaborate with firewall administrators to ensure rule and log completeness.</p>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#end-state","title":"End State","text":"<p>Firewall configuration and logs are reviewed. Any suspicious entries are documented and shared with incident commander for triage and remediation.</p>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#manual-steps","title":"Manual Steps","text":""},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#windows-defender-firewall","title":"Windows Defender Firewall","text":""},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#export-firewall-configuration","title":"Export firewall configuration:","text":"<pre><code>netsh advfirewall export \"C:\\firewall-config.wfw\"\n</code></pre>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#list-current-rules","title":"List current rules:","text":"<pre><code>Get-NetFirewallRule | Format-Table Name, DisplayName, Enabled, Direction, Action\n</code></pre>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#check-allowed-inbound-ports","title":"Check allowed inbound ports:","text":"<pre><code>Get-NetFirewallRule -Direction Inbound -Action Allow\n</code></pre> <p>Operator Note: Pay special attention to ports 20-23, 3389, and high ephemeral ranges.</p>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#review-firewall-logs","title":"Review firewall logs:","text":"<pre><code>C:\\Windows\\System32\\LogFiles\\Firewall\\pfirewall.log\n</code></pre>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#linux-iptables-firewalld","title":"Linux iptables / firewalld","text":""},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#list-current-rules-iptables","title":"List current rules (iptables):","text":"<pre><code>sudo iptables -L -v -n\n</code></pre>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#list-active-zones-firewalld","title":"List active zones (firewalld):","text":"<pre><code>sudo firewall-cmd --get-active-zones\nsudo firewall-cmd --list-all\n</code></pre>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#export-rules-iptables","title":"Export rules (iptables):","text":"<pre><code>sudo iptables-save &gt; /tmp/iptables-backup.txt\n</code></pre> <p>Operator Note: Look for rules allowing unusual ports, IPs, or entire IP ranges.</p>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#network-firewalls-palo-alto-cisco-asa-fortinet","title":"Network Firewalls (Palo Alto, Cisco ASA, Fortinet)","text":""},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#export-running-config-cisco-asa","title":"Export running config (Cisco ASA):","text":"<pre><code>show running-config\n</code></pre>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#export-security-policy-palo-alto-via-web-ui-or-cli","title":"Export security policy (Palo Alto via Web UI or CLI):","text":"<pre><code>show running security-policy\n</code></pre> <p>Operator Note: Work with Firewall Engineers/Admins to pull exports. Look for \"permit any any\", disabled zones, or suspicious policy changes.</p>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#running-script","title":"Running Script","text":"<ul> <li>Not applicable.  </li> <li>Command-line and native firewall tools are used for this task.</li> </ul>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#dependencies","title":"Dependencies","text":"<ul> <li>Appropriate firewall access credentials (local admin or firewall admin role)</li> <li>Export or read access to firewall rule sets and logs</li> <li>Knowledge of normal enterprise firewall policies and IOCs</li> </ul>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#other-available-tools","title":"Other available tools","text":"<ul> <li>Firewall Policy Viewer (for Windows export files)  </li> <li>Splunk / SIEM (to correlate firewall logs with IOCs)  </li> <li>Firewall Management Platforms (Panorama, FMC, etc.)</li> </ul> <p>Operator Note: Firewall management consoles provide easier rule review. Use CLI when console access is unavailable.</p>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Obtain approval and access to target firewall or host.</li> <li> Export current rules and logging configurations.</li> <li> Review for risky rules (ANY/ANY, unexpected ports).</li> <li> Review logs for abnormal traffic patterns or denied attempts.</li> <li> Document and report findings.</li> </ul>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#tools-by-platform","title":"Tools by Platform","text":"Platform Tool Purpose Windows netsh, PowerShell Enumerate and export firewall rules Linux iptables, firewalld List and review local firewall rules Network Firewalls CLI/GUI exports Review security policy and NAT rules Universal SIEM, Splunk Correlate firewall logs with IOCs"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#alternate-commands","title":"Alternate Commands","text":""},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#linux-iptables-check-rules-allowing-outbound","title":"Linux iptables - check rules allowing outbound:","text":"<pre><code>sudo iptables -L OUTPUT -v -n\n</code></pre>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#windows-export-log-entries-for-parsing","title":"Windows - export log entries for parsing:","text":"<pre><code>Get-Content \"C:\\Windows\\System32\\LogFiles\\Firewall\\pfirewall.log\" | Out-File firewall-log-review.txt\n</code></pre>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#cisco-asa-show-recent-config-changes","title":"Cisco ASA - show recent config changes:","text":"<pre><code>show archive config differences\n</code></pre>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#best-practices","title":"Best Practices","text":"<ul> <li>Focus on changes during incident timeframe.</li> <li>Look for temporary or unusual \"permit all\" type rules.</li> <li>Review allowed outbound rules (common exfil path).</li> <li>Validate findings with Firewall/Network Administrators.</li> </ul>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#references","title":"References","text":"<p>Microsoft NetSecurity Module Linux Iptables Docs Palo Alto Networks CLI Guide Cisco ASA Commands</p>"},{"location":"2.Identification/2.20-Reivew_Firewall_Config_for_IOCs/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Initial version generated with enriched firewall rule and IOC review procedures Leo"},{"location":"3.Containment/","title":"3.Containment","text":""},{"location":"3.Containment/#containment-tasks","title":"Containment Tasks","text":"<p>Develop and implement appropriate safeguards to ensure delivery of critical services.  The Containment Function supports the ability to limit or contain the impact of a potential cybersecurity event. Examples of outcome Categories within this Function include: Identity Management and Access Control; Awareness and Training; Data Security; Information Protection Processes and Procedures; Maintenance; and Protective Technology.  </p>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/","title":"Export Users from Active Directory","text":""},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#task-export-list-of-users-from-active-directory","title":"Task Export List of Users from Active Directory","text":""},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#conditions","title":"Conditions","text":"<p>Given domain credentials with the appropriate permissions and an incident response workstation with necessary tools.</p> <p>Operator Note: Exporting user accounts from Active Directory is critical for identifying unauthorized accounts, password policy violations, and lateral movement indicators.</p>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#standards","title":"Standards","text":"<ul> <li>Team member checks the schema of the Active Directory (AD) structure and determines best grouping for exporting users (i.e., all to one file; by OU; other breakdown).  </li> <li>Team member obtains Domain user information that may include the following:</li> </ul> Expiration date badPwdCount Distinguished name Enabled Given Name LastBadPasswordAttempt Last Logon Date/Time LockedOut Group membership Name GUID PasswordExpired PasswordLastSet PasswordNeverExpires PasswordNotRequired sAMAccountName SID Surname User Principal Name When Created <ul> <li>User data is exported to a CSV file and stored according to team SOP.</li> </ul> <p>Operator Note: Exported user account data helps responders identify suspicious accounts, accounts without expiration dates, accounts never logged in, etc.</p>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#end-state","title":"End State","text":"<p>All Domain User accounts have been exported to a CSV file with the necessary information to allow for detection of malicious activity.</p>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#notes","title":"Notes","text":"<p>The choice of tool affects export depth and format.</p> <ul> <li>PowerShell with Active Directory module is preferred.</li> <li>Multi-valued attributes (like MemberOf) require flattening into a string (joined by semicolon) for export.</li> <li>Avoid simple wildcard exports that lose nested attributes or cause export issues.</li> </ul> <p>Example of Not recommended command:</p> <pre><code>Get-ADUser -filter * -Properties * | Export-Csv UnSat.csv\n</code></pre>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#powershell-method-preferred","title":"PowerShell Method (Preferred)","text":""},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#open-powershell-ise-or-powershell","title":"Open PowerShell ISE or PowerShell:","text":"<pre><code>PowerShell_ISE.exe\n</code></pre>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#validate-powershell-environment","title":"Validate PowerShell environment:","text":"<pre><code>echo $PSVersionTable\n[Environment]::Is64BitProcess\nGet-ExecutionPolicy\n</code></pre> <p>Ensure version &gt;= 2.0 and <code>ByPass</code> or <code>Unrestricted</code> execution policy.</p>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#import-ad-module","title":"Import AD Module:","text":"<pre><code>Import-Module ActiveDirectory\n</code></pre>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#export-users-by-ou-scripted-option","title":"Export users by OU (Scripted Option):","text":"<pre><code>$output = Read-Host \"'Y' for output to file or any key for output in GUI table view\"\n$fqdn = Read-Host \"Enter FQDN domain\"\n$cred = Get-Credential\n\nWrite-Host \"Contacting $fqdn domain...\" -ForegroundColor Yellow\n$domain = (Get-ADDomain $fqdn -Credential $cred)\n\n$OUlist = @(Get-ADOrganizationalUnit -Filter * -Credential $cred -SearchBase $domain.DistinguishedName)\n\n$newlist = @{}\nforeach ($_objectitem in $OUlist) {\n    $getUser = Get-ADUser -Filter * -Credential $cred -SearchBase $_objectItem.DistinguishedName\n    $newlist.add($_objectItem.DistinguishedName, $getUser.Count)\n}\n\nif ($output -eq \"Y\") {\n    $newlist | ft -AutoSize | Out-File .\\UsersByOU.txt\n} else {\n    $newlist | Out-GridView\n}\n</code></pre>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#export-all-user-data-from-specific-ou","title":"Export all user data from specific OU:","text":"<pre><code>Get-ADUser -SearchBase \"OU=Users,DC=Army,DC=Mil\" -Filter * -Properties * |\nSelect-Object ObjectGUID, whenCreated, AccountExpirationDate, lastLogonTimestamp, @{name=\"MemberOf\";expression={$_.memberof -join \";\"}}, PasswordExpired, PasswordLastSet, PasswordNeverExpires, PasswordNotRequired, LastBadPasswordAttempt, badPwdCount, LockedOut |\nExport-Csv ADUsersExport.csv -NoTypeInformation\n</code></pre>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#rsat-aduc-method-alternative","title":"RSAT / ADUC Method (Alternative)","text":""},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#open-aduc","title":"Open ADUC:","text":"<pre><code>dsa.msc\n</code></pre>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#perform-search-and-export","title":"Perform search and export:","text":"<ul> <li>Use \"Find\" \u2192 \"View\" \u2192 \"Choose Columns\" \u2192 Add \"Published At\"</li> <li>Sort users and document OUs and user accounts manually</li> </ul> <p>Operator Note: This is slow and limited. Use only if PowerShell is not available.</p>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#running-script","title":"Running Script","text":"<ul> <li>Use <code>UsersByOU.ps1</code> as example.</li> <li>Save results to incident directory for archiving.</li> </ul>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#dependencies","title":"Dependencies","text":"<ul> <li>Windows system with RSAT + Active Directory Module installed:</li> </ul> <pre><code>Import-Module ActiveDirectory\n</code></pre> <ul> <li>Domain credentials with read access.</li> </ul>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case PowerShell + AD Module Windows Best and most scriptable export method ADUC (RSAT - dsa.msc) Windows Manual enumeration and export ADExplorer (Sysinternals) Windows AD object viewing, supports export (optional) LDAP Search Tools (Linux, Mac) Cross-platform Lightweight, simple exports (optional use)"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Verify PowerShell and Active Directory module are installed and functioning.</li> <li> Verify domain access and credentials.</li> <li> Use PowerShell to export users from entire domain or per OU.</li> <li> Validate exported CSV file includes all key attributes.</li> <li> Compare user export to baseline for anomalies or unauthorized accounts.</li> <li> Secure exported file per SOP for analysis and chain of custody.</li> </ul>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#best-practices","title":"Best Practices","text":"<ul> <li>Always include user attributes that provide indicators of suspicious activity:</li> <li>PasswordNeverExpires</li> <li>AccountExpirationDate</li> <li>LastBadPasswordAttempt</li> <li>Enabled / Disabled status</li> <li> <p>MemberOf group information</p> </li> <li> <p>Avoid default \u201cGet-ADUser -Properties *\u201d unless filtering properties properly.</p> </li> <li>Use PowerShell scripting for repeatability and auditability.</li> <li>Validate exports before archiving to ensure data integrity.</li> </ul>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#references","title":"References","text":"<p>How Security Identifiers Work SID vs. GUID List of PowerShell AD scripts</p>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.9 Enriched version with operator checklist, tooling, alt commands, best practices Leo"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/","title":"Export Groups from Active Directory","text":""},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#task-export-list-of-groups-from-active-directory","title":"Task Export List of Groups from Active Directory","text":""},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#conditions","title":"Conditions","text":"<p>Given domain credentials with the appropriate permissions, and an incident response workstation with necessary tools and access to the Primary Domain Controller (DC) for the target domain.</p> <p>Operator Note: Identifying AD groups and their attributes allows responders to detect rogue groups, privilege escalation attempts, and unauthorized changes.</p>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#standards","title":"Standards","text":"<ul> <li>Team selects the best method to connect to the Domain Controller and collect required group information.  </li> <li>Team member obtains Domain group information including:</li> </ul> Canonical Name Display Name Distinguished Name Group Category Group Scope Object GUID sAMAccountName Security Identifier (SID) Creation Date/Time Modified Date/Time <ul> <li>Group data is exported to a CSV file and stored according to incident response SOP.</li> </ul> <p>Operator Note: Attributes such as creation and modification dates help identify suspicious group creation or changes during an incident.</p>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#end-state","title":"End State","text":"<p>All Domain Groups have been exported to a CSV file with sufficient information to allow for detection of malicious activity.</p>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#powershell-method-preferred","title":"PowerShell Method (Preferred)","text":""},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#load-active-directory-module","title":"Load Active Directory module:","text":"<pre><code>Import-Module ActiveDirectory\n</code></pre>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#export-group-information","title":"Export group information:","text":"<pre><code>Get-ADGroup -Filter * -Properties * |\nSelect-Object Name, DisplayName, DistinguishedName, GroupCategory, GroupScope, ObjectGUID, sAMAccountName, SID, whenCreated, whenChanged |\nExport-Csv ADGroupsExport.csv -NoTypeInformation\n</code></pre> <p>Operator Note: Adding <code>whenCreated</code> and <code>whenChanged</code> provides vital timeline data for analysis.</p>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#optional-export-group-membership-for-each-group-advanced-analysis","title":"Optional: Export group membership for each group (advanced analysis):","text":"<pre><code>Get-ADGroup -Filter * | ForEach-Object {\n    Get-ADGroupMember $_ | Select-Object Name, SamAccountName, objectClass | Export-Csv \"$($_.Name)_Members.csv\" -NoTypeInformation\n}\n</code></pre> <p>Operator Note: This optional step helps in identifying suspicious group members.</p>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#rsat-aduc-method-alternative","title":"RSAT / ADUC Method (Alternative)","text":""},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#open-aduc","title":"Open ADUC:","text":"<pre><code>dsa.msc\n</code></pre>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#use-find-or-search-filters-to-view-and-export-groups","title":"Use \"Find\" or search filters to view and export groups:","text":"<ul> <li>View \u2192 Add/Remove Columns to select useful attributes.</li> <li>Export manually to CSV or Excel.</li> </ul> <p>Operator Note: Use only if PowerShell is unavailable. This method provides limited attributes.</p>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#running-script","title":"Running Script","text":"<ul> <li>Use the PowerShell method above and store outputs in incident shared folder for later review.</li> </ul>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#dependencies","title":"Dependencies","text":"<ul> <li>Windows system with RSAT + Active Directory Module installed:</li> </ul> <pre><code>Import-Module ActiveDirectory\n</code></pre> <ul> <li>Domain credentials with read access.</li> </ul>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case PowerShell + AD Module Windows Primary export method for comprehensive group attributes ADUC (RSAT - dsa.msc) Windows Manual export ADExplorer (Sysinternals) Windows AD object viewer, supports export LDAP Search Tools Cross-platform Lightweight alternate method"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate PowerShell and AD module installation.</li> <li> Verify domain credentials and connectivity.</li> <li> Use PowerShell to export group objects and key attributes.</li> <li> Optionally export group membership details for deeper analysis.</li> <li> Review exported CSV file for anomalies and secure per SOP.</li> </ul>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#best-practices","title":"Best Practices","text":"<ul> <li>Always export creation and modified date for timeline analysis.</li> <li>Look for group names outside normal naming conventions.</li> <li>Identify newly created groups during the incident timeframe.</li> <li>Document and preserve exported files for forensics.</li> </ul>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#references","title":"References","text":"<p>Get-ADGroup PowerShell syntax Get-ADGroupMember syntax Compare-Object syntax</p>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.9 Full original + enriched PowerShell export, alternate tooling, operator checklist and recommendations Leo"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/","title":"Export Group Policy Objects (GPOs) from Active Directory","text":""},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#task-export-group-policy-objects-gpos-from-active-directory","title":"Task Export Group Policy Objects (GPOs) from Active Directory","text":""},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#conditions","title":"Conditions","text":"<p>Given access to a Domain Controller (DC), domain account with the required permissions, and a workstation with Remote Server Administration Tools (RSAT).</p> <p>Operator Note: Exporting Group Policy Objects provides visibility into enforced security settings, startup scripts, and other critical system configuration controls.</p>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#standards","title":"Standards","text":"<ul> <li>Team member runs the Group Policy Management Console or PowerShell on the workstation and locates all relevant GPOs for export.  </li> <li>Team member saves the GPO data to a local workstation for review.  </li> <li>Team member ensures that the export includes both settings and metadata (creation, modification dates, linked OUs).</li> </ul> <p>Operator Note: Consider both human-readable (HTML/Report) and machine-parseable (XML or Backup) formats.</p>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#end-state","title":"End State","text":"<p>All Group Policy Objects have been exported to local files, organized for offline review and analysis.</p>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#notes","title":"Notes","text":"<ul> <li>PowerShell Group Policy Cmdlets are only available for:</li> <li>Windows Server 2008 R2 and higher</li> <li> <p>Windows 7 and higher (with RSAT installed)</p> </li> <li> <p>Exported GPOs should include metadata:</p> </li> <li>DisplayName</li> <li>GPOStatus</li> <li>WMIFilter</li> <li>Creation and Modification Time</li> <li>User and Computer settings</li> </ul>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#powershell-method-preferred","title":"PowerShell Method (Preferred)","text":""},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#import-grouppolicy-module","title":"Import GroupPolicy module:","text":"<pre><code>Import-Module GroupPolicy\n</code></pre>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#export-gpo-metadata-and-display-properties","title":"Export GPO metadata and display properties:","text":"<pre><code>$GPOs = Get-GPO -All -Server &lt;DomainController&gt; | Select-Object ID, Path, DisplayName, GPOStatus, WMIFilter, CreationTime, ModificationTime, User, Computer\n$GPOs | Export-Csv \".\\GPO_Metadata.csv\" -NoTypeInformation\n</code></pre>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#export-full-gpo-backup-best-method-for-forensic-review","title":"Export full GPO Backup (Best method for forensic review):","text":"<pre><code>Backup-GPO -All -Path \"C:\\GPO_Backups\"\n</code></pre> <p>Operator Note: Backup-GPO includes all settings, links, and can be restored or reviewed later using <code>Get-GPOReport</code>.</p>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#export-gpo-into-human-readable-format-html-report","title":"Export GPO into human-readable format (HTML Report):","text":"<pre><code>Get-GPO -All | ForEach-Object {\n    Get-GPOReport -Name $_.DisplayName -ReportType Html -Path \".\\Reports\\$($_.DisplayName).html\"\n}\n</code></pre> <p>Operator Note: HTML reports are useful for offline review and presentations.</p>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#group-policy-management-console-gpmc-gui-alternative","title":"Group Policy Management Console (GPMC) GUI (Alternative)","text":"<ul> <li>Open GPMC (<code>gpmc.msc</code>).</li> <li>Expand Forest \u2192 Domains \u2192  \u2192 Group Policy Objects. <li>Right-click a GPO \u2192 Save Report \u2192 Choose HTML or XML.</li> <p>Operator Note: This is suitable for single or selective GPO exports.</p>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#running-script","title":"Running Script","text":"<pre><code>Import-Module GroupPolicy\nBackup-GPO -All -Path \"C:\\GPO_Backups\"\n</code></pre> <ul> <li>Store exported files under incident response documentation repository.</li> </ul>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#dependencies","title":"Dependencies","text":"<ul> <li>RSAT with Group Policy Management Console and GroupPolicy PowerShell module.</li> <li>Domain admin or delegated GPO read permissions.</li> <li>Sufficient storage space for full backup of GPOs.</li> </ul>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case PowerShell + GroupPolicy module Windows Full export + reports + backup GPMC GUI Windows Manual single GPO export AGPM (Advanced Group Policy Management) Windows (Optional) Centralized change auditing and rollback"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Verify RSAT tools and GroupPolicy module are installed.</li> <li> Use PowerShell Backup-GPO to export all GPOs.</li> <li> Generate HTML reports for readability.</li> <li> Review exported data for:</li> <li>Recently modified or created GPOs.</li> <li>GPOs linked to unexpected OUs.</li> <li>Scripts, WMI filters, and restricted groups settings.</li> <li> Securely store exported data.</li> </ul>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#best-practices","title":"Best Practices","text":"<ul> <li>Use Backup-GPO for comprehensive export (preferred).</li> <li>Use HTML report generation for easy offline review.</li> <li>Validate permissions before performing bulk export.</li> <li>Use AGPM if available for audit trail and change control history.</li> </ul>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#references","title":"References","text":"<p>Group Policy Cmdlets Backup-GPO Documentation PowerShell GPO Examples</p>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.9 Full original + enriched operator procedures, GUI + PowerShell, operator recommendations and alternate tooling Leo"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/","title":"Export Trust Relationships from Active Directory","text":""},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#task-export-trust-relationships-from-active-directory","title":"Task Export Trust Relationships from Active Directory","text":""},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#conditions","title":"Conditions","text":"<p>Given a Domain Controller (DC), domain account with appropriate permissions, and a domain workstation with Remote Server Administration Tools (RSAT) and PowerShell available.</p> <p>Operator Note: Identifying and reviewing domain trust relationships helps detect unexpected or unauthorized domain connections, which could be used for lateral movement or privilege escalation.</p>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#standards","title":"Standards","text":"<ul> <li>Team member obtains the correct name of the target domain.  </li> <li>Team member uses approved methods (PowerShell, WMI, or command line tools) to export trust relationship information to a local file for analysis.  </li> <li>Exported data includes:</li> <li>Trust Partner</li> <li>Trust Type</li> <li>Trust Direction</li> <li>Trust Attributes (Transitive/Non-Transitive)</li> <li>Creation/Modification Dates (if available)</li> </ul>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#end-state","title":"End State","text":"<p>All Domain Trust relationship information has been exported to a local file and validated for review by the incident response team.</p>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#notes","title":"Notes","text":"<p>The Active Directory Domain Services (AD DS) Cmdlets are available on:</p> <ul> <li>Windows Server 2012 R2 and higher</li> <li>Windows 8.1 and higher with RSAT installed</li> </ul>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#powershell-method-preferred","title":"PowerShell Method (Preferred)","text":""},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#check-and-import-ad-module","title":"Check and import AD module:","text":"<pre><code>Import-Module ActiveDirectory\n</code></pre>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#enumerate-domain-trusts-using-wmi","title":"Enumerate domain trusts using WMI:","text":"<pre><code>Get-WmiObject -Class Microsoft_DomainTrustStatus -Namespace ROOT\\MicrosoftActiveDirectory |\nSelect-Object PSComputername, TrustedDomain, TrustAttributes, TrustDirection, TrustType |\nFormat-List\n</code></pre>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#trustattributes-meaning","title":"TrustAttributes meaning:","text":"<ul> <li><code>1</code> = Non-Transitive</li> <li><code>2</code> = Transitive</li> </ul>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#trustdirection-meaning","title":"TrustDirection meaning:","text":"<ul> <li><code>1</code> = Incoming Only</li> <li><code>2</code> = Outgoing Only</li> <li><code>3</code> = Two-way</li> </ul>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#export-trust-relationships-to-csv","title":"Export trust relationships to CSV:","text":"<pre><code>Get-WmiObject -Class Microsoft_DomainTrustStatus -Namespace ROOT\\MicrosoftActiveDirectory |\nSelect-Object PSComputername, TrustedDomain, TrustAttributes, TrustDirection, TrustType |\nExport-Csv \".\\DomainTrusts.csv\" -NoTypeInformation\n</code></pre>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#alternate-tools-command-line-and-other-methods","title":"Alternate Tools (Command-line and Other Methods)","text":""},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#nltest-built-in-windows-command","title":"NLTEST (Built-in Windows Command):","text":"<pre><code>nltest /domain_trusts\n</code></pre> <p>Operator Note: <code>nltest</code> provides trust relationships including flags that indicate transitive and direct/indirect relationships.</p>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#get-domaintrust-powerview-optionaladvanced-use","title":"Get-DomainTrust (PowerView - Optional/Advanced use)","text":"<pre><code>Import-Module .\\PowerView.ps1\nGet-DomainTrust\n</code></pre> <p>Operator Note: PowerView provides advanced trust relationship analysis but should only be used if authorized.</p>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#running-script","title":"Running Script","text":"<p>Example script (PowerShell):</p> <pre><code>Get-WmiObject -Class Microsoft_DomainTrustStatus -Namespace ROOT\\MicrosoftActiveDirectory |\nExport-Csv .\\DomainTrusts.csv -NoTypeInformation\n</code></pre> <p>Save the exported file to a secure incident response working directory.</p>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#dependencies","title":"Dependencies","text":"<ul> <li>PowerShell and RSAT tools installed</li> <li>Domain Admin or delegated read access to trust relationships</li> <li>Optional: PowerView (if authorized for advanced domain enumeration)</li> </ul>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case PowerShell (WMI) Windows Primary trusted relationship export nltest Windows Quick command-line trust verification PowerView Windows Advanced trust and domain relationship analysis Active Directory Domains and Trusts GUI Windows Visual review of trusts (no export feature)"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate access permissions and PowerShell module availability.</li> <li> Export domain trust relationships using WMI + PowerShell.</li> <li> Verify exported data contains all relevant attributes.</li> <li> Optionally use nltest for verification.</li> <li> Securely store exported trust relationship information.</li> </ul>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#best-practices","title":"Best Practices","text":"<ul> <li>Always use PowerShell or nltest for verifiable exports.</li> <li>Validate trust directions and attributes (watch for two-way trusts).</li> <li>Look for unexpected external domains or forest trusts.</li> <li>Cross-check modification dates for recent or unauthorized changes.</li> </ul>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#references","title":"References","text":"<p>AD DS Cmdlets Get-DomainTrusts (PowerView) NLTEST Trusts Documentation</p>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.9 Full original + enriched PowerShell, alternate tooling, operator checklist and best practices Leo"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/","title":"Export OU Structure from Active Directory","text":""},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#task-export-organizational-unit-ou-structure-from-active-directory","title":"Task Export Organizational Unit (OU) structure from Active Directory","text":""},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#conditions","title":"Conditions","text":"<p>Given access to a Domain Controller (DC), a domain account with required permissions, and a workstation with Remote Server Administration Tools (RSAT) and PowerShell.</p> <p>Operator Note: Exporting OU structure helps map the organizational design of Active Directory, identify abnormal/malicious OUs, and verify proper object placement.</p>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#standards","title":"Standards","text":"<ul> <li>Team member obtains the correct name for the target domain.  </li> <li>Team member determines and uses the appropriate tool to connect to the domain controller and export the OU structure to a file.  </li> <li>Exported OU structure includes Distinguished Name, Name, and optionally object counts and permissions.</li> </ul>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#end-state","title":"End State","text":"<p>All Organizational Unit (OU) information has been exported to a local file and validated for incident review.</p>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#notes","title":"Notes","text":"<p>Multiple tools can perform this task, including:</p> <ul> <li>PowerShell (<code>Get-ADOrganizationalUnit</code>)</li> <li>dsquery (command-line)</li> <li>LDIFDE and CSVDE (optional export formats)</li> </ul>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#powershell-method-preferred","title":"PowerShell Method (Preferred)","text":""},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#get-all-ous-in-the-domain","title":"Get all OUs in the domain:","text":"<pre><code>Get-ADOrganizationalUnit -Filter * | Select-Object -ExpandProperty DistinguishedName\n</code></pre>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#get-ou-names-and-distinguished-names-in-table-format","title":"Get OU names and distinguished names in table format:","text":"<pre><code>Get-ADOrganizationalUnit -Filter 'Name -like \"*\"' | Format-Table Name, DistinguishedName -AutoSize\n</code></pre>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#export-ou-list-to-csv-for-offline-review","title":"Export OU list to CSV for offline review:","text":"<pre><code>Get-ADOrganizationalUnit -Filter * | Select-Object Name, DistinguishedName | Export-Csv \".\\OU_Structure.csv\" -NoTypeInformation\n</code></pre>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#dsquery-method-alternate-command-line","title":"dsquery Method (Alternate - command line)","text":""},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#list-all-ous-in-domain","title":"List all OUs in domain:","text":"<pre><code>dsquery ou DC=&lt;DOMAIN&gt;,DC=&lt;DOMAIN EXTENSION&gt;\n</code></pre>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#netdom-method-additional","title":"Netdom Method (Additional)","text":""},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#list-domain-workstations","title":"List domain workstations:","text":"<pre><code>netdom query WORKSTATION\n</code></pre>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#list-domain-servers","title":"List domain servers:","text":"<pre><code>netdom query SERVER\n</code></pre>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#list-domain-controllers","title":"List domain controllers:","text":"<pre><code>netdom query DC\n</code></pre>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#list-organizational-units-where-user-can-create-machine-objects","title":"List Organizational Units (where user can create machine objects):","text":"<pre><code>netdom query OU\n</code></pre>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#list-primary-domain-controller","title":"List Primary Domain Controller:","text":"<pre><code>netdom query PDC\n</code></pre> <p>Operator Note: Netdom output can help correlate OU locations and understand domain structure relationships quickly.</p>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#optional-ldifde-and-csvde","title":"Optional: LDIFDE and CSVDE","text":"<pre><code>ldifde -f ou_export.ldf -d \"DC=contoso,DC=com\" -p subtree -r \"(objectClass=organizationalUnit)\"\ncsvde -f ou_export.csv -r \"(objectClass=organizationalUnit)\"\n</code></pre>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#running-script","title":"Running Script","text":"<pre><code>Get-ADOrganizationalUnit -Filter * | Select-Object Name, DistinguishedName | Export-Csv \".\\OU_Structure.csv\" -NoTypeInformation\n</code></pre>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#dependencies","title":"Dependencies","text":"<ul> <li>RSAT with Active Directory Module (PowerShell)</li> <li>Domain credentials with read access</li> <li>Optional: dsquery, LDIFDE, CSVDE</li> </ul>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case PowerShell + AD Module Windows Primary export method dsquery Windows Simple OU export LDIFDE / CSVDE Windows Export to simple text formats Netdom Windows Object discovery (workstations, servers, PDC, OUs) ADExplorer (Sysinternals) Windows Visual OU mapping BloodHound (optional, advanced use) Windows/Linux Graph-based AD analysis"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate PowerShell and RSAT availability.</li> <li> Export OU structure using PowerShell or dsquery.</li> <li> Use Netdom queries to gather context of domain topology.</li> <li> Save export files and validate OU accuracy.</li> <li> Investigate any suspicious or unexpected OUs.</li> <li> Secure export for review and incident reporting.</li> </ul>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#best-practices","title":"Best Practices","text":"<ul> <li>Use PowerShell for repeatable exports and CSV format.</li> <li>Review OU names and hierarchy for anomalies.</li> <li>Validate permissions if delegation or abuse is suspected.</li> <li>Document and retain OU exports for audit and recovery purposes.</li> </ul>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#references","title":"References","text":"<p>Get-ADOrganizationalUnit PowerShell Cmdlet Get-OU_Permissions Dsquery OU command line reference LDIFDE.EXE command line tool CSVDE.EXE command line tool</p>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 2.0 Final version with restored manual steps, full tooling, operator checklist, and best practices Leo"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/","title":"Monitor AD New Account Creation","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#task-monitor-for-new-active-directory-user-account-creation-events","title":"Task Monitor for new Active Directory user account creation events","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#conditions","title":"Conditions","text":"<p>Given access to a Domain Controller (DC), a domain account with appropriate permissions, and an incident response workstation with RSAT tools and PowerShell.</p> <p>Operator Note: Monitoring and detecting new accounts in AD is critical during incident response to identify potential unauthorized accounts created by adversaries.</p>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#standards","title":"Standards","text":"<ul> <li>Team member identifies and implements appropriate monitoring method(s) to detect new AD user accounts.  </li> <li>Team member configures or queries event logs or AD to identify any new accounts created during incident timeframe.  </li> <li>Team member documents and reports findings to system owner for validation and follow-up action.</li> </ul>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#end-state","title":"End State","text":"<p>All new accounts created during the timeframe of interest are identified, exported, and validated.</p>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#notes","title":"Notes","text":"<ul> <li>Event ID 4720 (\"A user account was created\") is the standard logon event ID for user creation in Active Directory.</li> <li>PowerShell and Event Viewer are primary methods for detection.</li> <li>Security Information and Event Management (SIEM) tools are preferred when available for enterprise-scale detection.</li> </ul>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#method-1-check-security-event-logs-preferred","title":"Method 1: Check Security Event Logs (Preferred)","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#on-domain-controller-locally-or-remotely","title":"On Domain Controller (locally or remotely)","text":"<pre><code>Get-WinEvent -FilterHashtable @{LogName='Security'; Id=4720; StartTime=(Get-Date).AddDays(-7)} |\nSelect-Object TimeCreated, Id, Message |\nExport-Csv .\\NewAccounts.csv -NoTypeInformation\n</code></pre> <p>Operator Note: Adjust <code>AddDays(-7)</code> as needed to specify timeframe of incident.</p>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#sample-output-entry","title":"Sample output entry:","text":"<pre><code>A user account was created.\n\nSubject:\n    Security ID:        DOMAIN\\Administrator\n    Account Name:       Administrator\n    Account Domain:     DOMAIN\n    Logon ID:           0x1A8B2\n\nNew Account:\n    Security ID:        DOMAIN\\newuser\n    Account Name:       newuser\n</code></pre>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#method-2-live-check-for-recently-created-accounts-attribute-based","title":"Method 2: Live Check for Recently Created Accounts (Attribute Based)","text":"<pre><code>Get-ADUser -Filter * -Properties whenCreated |\nWhere-Object { $_.whenCreated -ge (Get-Date).AddDays(-7) } |\nSelect-Object Name, SamAccountName, whenCreated |\nExport-Csv .\\RecentADAccounts.csv -NoTypeInformation\n</code></pre> <p>Operator Note: This queries based on AD object creation time.</p>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#method-3-enable-auditing-optional-for-persistent-monitoring","title":"Method 3: Enable Auditing (Optional for persistent monitoring)","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#enable-auditing-of-user-account-management","title":"Enable auditing of user account management:","text":"<pre><code>Auditpol /set /category:\"Account Management\" /success:enable /failure:enable\n</code></pre> <p>Operator Note: This must be done in advance or during active incident monitoring.</p>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#running-script","title":"Running Script","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#example-powershell-for-detection-export","title":"Example PowerShell for detection + export:","text":"<pre><code>$events = Get-WinEvent -FilterHashtable @{LogName='Security'; Id=4720; StartTime=(Get-Date).AddDays(-7)}\n$events | Export-Csv \".\\NewADAccounts.csv\" -NoTypeInformation\n</code></pre> <p>Store this file in the incident response working folder for analysis and reporting.</p>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#dependencies","title":"Dependencies","text":"<ul> <li>Windows Server with AD Domain Services</li> <li>RSAT tools with PowerShell access</li> <li>Security Event Log access (requires Admin rights)</li> </ul>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case PowerShell + Event Logs Windows Primary method for detection PowerShell + Get-ADUser Windows Quick check based on whenCreated attribute Event Viewer (GUI) Windows Manual review SIEM (Splunk, Sentinel, etc.) Windows/Linux Enterprise level aggregation and monitoring WMI Event Subscriptions (optional advanced use) Windows Real-time event capture (rarely used in IR)"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Verify access to Domain Controller security logs.</li> <li> Use PowerShell to pull all recent account creation events (ID 4720).</li> <li> Cross-reference new accounts against valid provisioning records.</li> <li> Validate \"who created\" and \"when created\" attributes.</li> <li> Export report and notify system owner of any suspicious or unauthorized accounts.</li> </ul>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#best-practices","title":"Best Practices","text":"<ul> <li>Use Security Event Logs for reliable and auditable data.</li> <li>Use AD attribute queries (<code>whenCreated</code>) to cross-validate events.</li> <li>When possible, ingest AD security events into SIEM for automated detection.</li> <li>Always validate account purpose before removing or disabling.</li> </ul>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#references","title":"References","text":"<p>Microsoft Event ID 4720 Documentation PowerShell Get-ADUser Cmdlet Auditpol Command</p>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide with event log monitoring, PowerShell procedures, tooling, checklist, best practices Leo"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/","title":"Create Team Admin Account in Active Directory (AD)","text":""},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#task-create-team-admin-account-in-active-directory","title":"Task Create Team Admin Account in Active Directory","text":""},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#conditions","title":"Conditions","text":"<p>Given a target Domain, a Domain Controller (DC), a user account with appropriate rights and privileges to modify user accounts, and a workstation with the Windows Remote Server Administration Tools (RSAT) installed.</p> <p>Operator Note: Creating a temporary or team admin account is often necessary to secure the environment during incident response. This should only be done with proper approvals and logged actions.</p>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#standards","title":"Standards","text":"<ul> <li>Team member coordinates the requirement to modify the Administrator Group on the Domain  </li> <li>Team member creates User Account in Active Directory on target Domain  </li> <li>Team member opens Active Directory Users and Computers (ADUC) or uses PowerShell to create the user account  </li> <li>Team member assigns Domain Admins group membership to the account  </li> <li>Team member resets the password and secures the credentials in accordance with incident response SOPs  </li> </ul> <p>Operator Note: Always consult enclave or business owner prior to creating privileged accounts during an incident.</p>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#end-state","title":"End State","text":"<p>New user account is created in Active Directory with Domain Admin credentials that the Team can utilize to carry out protection tasks.</p>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#notes","title":"Notes","text":"<ul> <li>Team admin accounts should be temporary and removed after incident resolution.</li> <li>Strong, complex passwords should be used.</li> <li>Account creation and group membership assignment should be logged.</li> </ul>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#create-active-directory-user-gui-method","title":"Create Active Directory User (GUI Method)","text":"<ol> <li>Open Active Directory Users and Computers (ADUC):  </li> <li>Click Start \u2192 Administrative Tools \u2192 Active Directory Users and Computers  </li> <li> <p>Navigate to the domain node (example.com)</p> </li> <li> <p>Right-click the folder or OU where you want to create the user \u2192 New \u2192 User</p> </li> <li> <p>Fill out the user creation form:  </p> </li> <li>First name, Initials, Last name  </li> <li> <p>User logon name (username) \u2192 Click Next</p> </li> <li> <p>Enter password and select appropriate options:  </p> </li> <li>Recommended: User must change password at next logon (can be unchecked during IR)  </li> <li>Click Next \u2192 Click Finish</li> </ol>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#assign-group-membership-gui-method","title":"Assign Group Membership (GUI Method)","text":"<ol> <li>Open Active Directory Users and Computers (ADUC) </li> <li>Navigate to Domain Admins group  </li> <li>Right-click \u2192 Properties </li> <li>Go to Members tab \u2192 Click Add </li> <li>Enter the new user\u2019s username \u2192 Click OK \u2192 User is now a Domain Admin</li> </ol>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#powershell-method-preferred-for-repeatability","title":"PowerShell Method (Preferred for repeatability)","text":""},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#create-new-user","title":"Create new user:","text":"<pre><code>New-ADUser -Name \"IR Team Admin\" -SamAccountName \"iradmin\" -AccountPassword (Read-Host -AsSecureString \"Enter Password\") -Enabled $true -Path \"OU=Incident Response,DC=example,DC=com\"\n</code></pre>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#add-user-to-domain-admins","title":"Add user to Domain Admins:","text":"<pre><code>Add-ADGroupMember -Identity \"Domain Admins\" -Members \"iradmin\"\n</code></pre> <p>Operator Note: Replace \"OU=Incident Response,DC=example,DC=com\" with the correct OU path if needed.</p>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#running-script","title":"Running Script","text":"<pre><code>New-ADUser -Name \"IR Team Admin\" -SamAccountName \"iradmin\" -AccountPassword (Read-Host -AsSecureString \"Enter Password\") -Enabled $true -Path \"OU=Incident Response,DC=example,DC=com\"\n\nAdd-ADGroupMember -Identity \"Domain Admins\" -Members \"iradmin\"\n</code></pre> <p>Store these commands securely and remove or disable the account after incident remediation.</p>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#dependencies","title":"Dependencies","text":"<ul> <li>RSAT with Active Directory Module (PowerShell)</li> <li>Domain Admin credentials or delegated permissions</li> <li>Organizational approval (business owner or enclave owner authorization)</li> </ul>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case PowerShell AD Module Windows Preferred scripted method ADUC (dsa.msc) Windows GUI-based user creation dsadd (legacy) Windows CLI-based user creation (optional) LAPS / Password Vaulting Tools Windows/Enterprise Secure storage of credentials"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Obtain approval to create Domain Admin account.</li> <li> Create user account with unique username (avoid generic names).</li> <li> Assign temporary secure password.</li> <li> Add user to Domain Admins group using PowerShell or GUI.</li> <li> Document creation in incident notes and secure credentials.</li> <li> Remove account after incident unless promoted to permanent.</li> </ul>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#best-practices","title":"Best Practices","text":"<ul> <li>Use PowerShell for speed, repeatability, and logging.</li> <li>Document all elevated account creation during incident.</li> <li>Disable and remove temporary accounts immediately after use.</li> <li>Securely share passwords (LAPS, encrypted vaults).</li> <li>Avoid generic names like \"admin\" or \"incident\" that may persist post-incident.</li> </ul>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#references","title":"References","text":"<p>Create user in Active Directory Assign Group Membership</p>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.9 Full original + enriched PowerShell method, operator checklist, alternate tooling and best practices Leo"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/","title":"Change Domain Administrator Account","text":""},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#task-change-local-administrator-account-password-on-domain-controller-dc","title":"Task Change Local Administrator Account Password on Domain Controller (DC)","text":""},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#conditions","title":"Conditions","text":"<p>Given a target Domain, a Domain Controller (DC), a user account with appropriate rights and privileges to modify user accounts, and a workstation with the Windows Remote Server Administration Tools (RSAT) installed.</p> <p>Operator Note: Changing the domain Administrator account password should be performed carefully. In some environments, this account may be tied to services and automated processes. Coordinate with enclave owners before proceeding.</p>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#standards","title":"Standards","text":"<ul> <li>Team member coordinates the requirement to modify the Administrator account on the DC.  </li> <li>Team member locates the built-in Administrator account using Active Directory Users and Computers (ADUC) or PowerShell.  </li> <li>Team member resets the password using GUI or PowerShell and confirms the change.  </li> <li>Team member documents the change, including the approval, new password storage location, and time of modification.</li> </ul>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#end-state","title":"End State","text":"<p>The target domain Administrator account password has been changed successfully and securely documented.</p>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#notes","title":"Notes","text":"<p>Mission Element lead ought to request this capability from the business or enclave owner in order to secure privileged accounts. Password changes can disrupt services and should be closely coordinated.</p>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#caution","title":"Caution","text":"<p>Changing the domain Administrator password should be coordinated with the system owner. The account may be tied to critical services or applications.</p>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#powershell-method-preferred","title":"PowerShell Method (Preferred)","text":""},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#using-cname-distinguished-name","title":"Using CNAME (Distinguished Name)","text":"<pre><code>Set-ADAccountPassword 'CN=Administrator,CN=Users,DC=example,DC=com' -Reset -NewPassword (ConvertTo-SecureString -AsPlainText \"NewP@ssw0rd!\" -Force)\n</code></pre>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#using-sam-account-name","title":"Using SAM Account Name","text":"<pre><code>Set-ADAccountPassword -Identity Administrator -OldPassword (ConvertTo-SecureString -AsPlainText \"OldP@ssw0rd!\" -Force) -NewPassword (ConvertTo-SecureString -AsPlainText \"NewP@ssw0rd!\" -Force)\n</code></pre> <p>Operator Note: Use <code>-Reset</code> when old password is not known (privileged reset) or <code>-OldPassword</code> when performing a routine password change.</p>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#gui-method-aduc-alternative","title":"GUI Method (ADUC - Alternative)","text":"<ol> <li>Open Active Directory Users and Computers (dsa.msc) </li> <li>Navigate to Users \u2192 Administrator account </li> <li>Right-click \u2192 Reset Password </li> <li>Enter new password and confirm  </li> <li>Ensure password complexity requirements are met</li> </ol> <p>Operator Note: GUI method does not allow for old password verification and uses a privileged reset.</p>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#running-script","title":"Running Script","text":"<pre><code>Set-ADAccountPassword -Identity Administrator -Reset -NewPassword (ConvertTo-SecureString -AsPlainText \"NewP@ssw0rd!\" -Force)\n</code></pre> <p>Store the password securely in an authorized password vault or encryption-protected incident notes.</p>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#dependencies","title":"Dependencies","text":"<ul> <li>RSAT with Active Directory Module installed</li> <li>Domain Admin privileges</li> <li>Coordination with System Owner / Enclave Owner</li> <li>Secure password vault or protected storage for credentials</li> </ul>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case PowerShell + AD Module Windows Primary method (automated and logged) ADUC (dsa.msc) Windows GUI method (manual password reset) LAPS (Local Admin Password Solution) Enterprise Password rotation and secure storage (if deployed)"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate approval from system owner/enclave owner.</li> <li> Verify account dependencies (services, scripts) before changing password.</li> <li> Use PowerShell <code>Set-ADAccountPassword</code> or ADUC to change password.</li> <li> Record change (time, operator, method).</li> <li> Store new password in encrypted and authorized location.</li> <li> Validate functionality after change (logon test, service checks).</li> </ul>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#best-practices","title":"Best Practices","text":"<ul> <li>Perform changes during maintenance windows or coordinated response.</li> <li>Avoid using common passwords \u2192 use randomly generated complex passwords.</li> <li>Document who approved and performed the change.</li> <li>Remove or rotate temporary passwords post-incident.</li> </ul>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#references","title":"References","text":"<p>PowerShell Set-ADAccountPassword documentation</p>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.9 Original + enriched with PowerShell + GUI methods, operator checklist, alternate tools, best practices Leo"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/","title":"Disable Domain Administrator Password","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#task-protect-domain-administrator-account","title":"Task Protect Domain Administrator Account","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#conditions","title":"Conditions","text":"<p>Given a target Domain, a Domain Controller (DC), a user account with appropriate rights and privileges to modify user accounts, and a workstation with the Windows Remote Server Administration Tools (RSAT) installed.</p> <p>Operator Note: Disabling, renaming, and clearing the built-in Domain Administrator account is a defense-in-depth control that is strongly recommended by CIS Benchmarks and DISA STIG, but must be performed with caution to avoid domain lockout.</p>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#standards","title":"Standards","text":"<ul> <li>Team member coordinates with the business or enclave owner prior to modifying the Domain Administrator account.  </li> <li>Team member renames the built-in Domain Administrator account.  </li> <li>Team member creates a dummy \"Administrator\" account with no privileges.  </li> <li>Team member disables the built-in Administrator account.  </li> <li>Team member clears any descriptive attributes to avoid revealing account details.  </li> </ul>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#end-state","title":"End State","text":"<p>The built-in Domain Administrator account has been renamed and disabled. A dummy \"Administrator\" account with no rights has been created.</p>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#notes","title":"Notes","text":"<p>Mission Element lead ought to request this capability of the business owner prior to execution.</p> <p>Disabling or renaming the Domain Administrator account prevents attackers from easily identifying or abusing the account during lateral movement.</p> <p>Microsoft does not recommend full deletion or disablement of the original Administrator account unless carefully coordinated.</p>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#open-active-directory-users-and-computers-gui","title":"Open Active Directory Users and Computers (GUI)","text":"<pre><code>dsa.msc\n</code></pre> <ul> <li>Navigate to Users</li> <li>Locate the Administrator account</li> </ul>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#rename-the-built-in-administrator-account-wmic","title":"Rename the built-in Administrator account (WMIC)","text":"<pre><code>wmic useraccount where name='Administrator' call rename name='NewAdminName'\n</code></pre> <p>Operator Note: Choose a non-obvious name to avoid easy detection (e.g. \"SysOps-Backup\").</p>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#create-a-dummy-administrator-account-with-no-permissions","title":"Create a dummy Administrator account with no permissions","text":"<pre><code>net user Administrator C0mplex_P@ssword /ADD /PASSWORDCHG:NO\n</code></pre> <p>Operator Note: Use a complex, randomly generated password.</p>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#disable-the-dummy-administrator-account","title":"Disable the dummy Administrator account","text":"<pre><code>net user Administrator /active:no\n</code></pre>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#remove-description-and-attributes-optional-but-recommended","title":"Remove description and attributes (Optional but recommended)","text":"<pre><code>Set-ADUser Administrator -Description \"\"\n\nSet-ADUser -Identity Administrator -City \"\" -Clear \"\" -Company \"\" -Country \"\" -Department \"\" -Description \"\" -DisplayName \"\" -Division \"\" -EmailAddress \"\" -EmployeeID \"\" -EmployeeNumber \"\" -Fax \"\" -GivenName \"\" -HomeDirectory \"\" -HomeDrive \"\" -HomePage \"\" -HomePhone \"\" -Initials \"\" -LogonWorkstations \"\" -MobilePhone \"\" -Office \"\" -OfficePhone \"\" -Organization \"\" -OtherName \"\" -POBox \"\" -PostalCode \"\" -ProfilePath \"\" -SamAccountName \"\" -ScriptPath \"\" -State \"\" -StreetAddress \"\" -Surname \"\" -Title \"\" -UserPrincipalName \"\" -Partition \"\" -Server \"\"\n</code></pre> <p>Operator Note: This minimizes information disclosure for dummy accounts.</p>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#running-script-example-automated-flow","title":"Running Script (Example automated flow)","text":"<pre><code># Rename default administrator account\nwmic useraccount where name='Administrator' call rename name='IRAdminBackup'\n\n# Create dummy Administrator account\nnet user Administrator ComplexPass123! /ADD /PASSWORDCHG:NO\n\n# Disable dummy Administrator account\nnet user Administrator /active:no\n\n# Clear AD attributes (optional step)\nSet-ADUser Administrator -Description \"\"\n</code></pre>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#dependencies","title":"Dependencies","text":"<ul> <li>RSAT with Active Directory Module installed</li> <li>Domain Admin or equivalent privileges</li> <li>Approval from System/Enclave owner</li> <li>Strong random password generator (optional)</li> </ul>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case PowerShell + AD Module Windows AD attribute clearing, disable account WMIC Windows Rename local Administrator net user Windows Create dummy accounts, disable ADUC (dsa.msc) Windows Visual/manual verification"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Obtain approval before proceeding.</li> <li> Rename the built-in Administrator account.</li> <li> Create a dummy \"Administrator\" account.</li> <li> Disable the dummy account immediately after creation.</li> <li> Clear dummy account AD attributes.</li> <li> Document all changes and secure new credentials.</li> </ul>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#best-practices","title":"Best Practices","text":"<ul> <li>Rename built-in Administrator account to a unique name.</li> <li>Use randomly generated passwords for dummy accounts.</li> <li>Clear all descriptive fields to prevent enumeration.</li> <li>Document approvals and execution steps in IR log.</li> </ul>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#references","title":"References","text":"<p>DISA STIGS CIS Benchmark downloads Securing AD Administrative Groups and Accounts</p>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.9 Original + enhanced operator flow, PowerShell automation, alternate tooling and recommendations Leo"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/","title":"Change or Disable Workstation Local Administrator Account","text":""},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#task-change-or-disable-workstation-local-administrator-account","title":"Task Change or Disable Workstation Local Administrator Account","text":""},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#conditions","title":"Conditions","text":"<p>Given domain credentials with the appropriate permissions, and an incident response workstation with RSAT or local admin tools available.</p> <p>Operator Note: Local Administrator accounts on workstations are a well-known target for attackers. These accounts should be disabled or removed when possible to reduce lateral movement and persistence.</p>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#standards","title":"Standards","text":"<ul> <li>Team member coordinates the requirement to disable or modify the Local Workstation Administrator Account.  </li> <li>Team member uses Group Policy to enforce the change across the workstation fleet (preferred method).  </li> <li>Team member uses local commands (Net User, PowerShell) as needed during rapid response or targeted actions.  </li> <li>Team member documents all accounts changed or disabled.</li> </ul>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#end-state","title":"End State","text":"<p>Workstation Local Administrator account is either disabled or has been renamed and removed from all local privileged groups, reducing risk of abuse.</p>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#notes","title":"Notes","text":"<ul> <li>Disabling or modifying local Administrator accounts helps prevent credential reuse and Pass-the-Hash attacks.</li> <li>Use Group Policy Objects (GPOs) for centralized and scalable enforcement.</li> <li>Use PowerShell or Net User for one-off, manual workstation actions.</li> <li>Where possible, replace static Local Administrator accounts with managed solutions (e.g. LAPS).</li> </ul>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#method-1-group-policy-preferred","title":"Method 1: Group Policy (Preferred)","text":""},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#open-group-policy-management-console-gpmc","title":"Open Group Policy Management Console (GPMC)","text":"<pre><code>gpmc.msc\n</code></pre>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#create-a-new-group-policy-object-gpo","title":"Create a new Group Policy Object (GPO):","text":"<ul> <li>Right-click Domain \u2192 Create a GPO \u2192 name it \u201cDisable Local Admin Account\u201d</li> <li>Right-click \u2192 Edit \u2192 go to:</li> </ul> <pre><code>Computer Configuration \u2192 Windows Settings \u2192 Security Settings \u2192 Local Policies \u2192 Security Options\n</code></pre>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#set-the-following-policy","title":"Set the following policy:","text":"<pre><code>Accounts: Administrator account status \u2192 Disabled\n</code></pre>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#link-gpo-to-workstation-ou","title":"Link GPO to Workstation OU:","text":"<ul> <li>Drag and drop or Link existing GPO to workstation OU.</li> <li>Force Group Policy update on workstations:</li> </ul> <pre><code>gpupdate /force\n</code></pre> <p>Operator Note: Only link to Workstation OU, not Servers or Domain Controllers.</p>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#method-2-command-line-net-user","title":"Method 2: Command Line (Net User)","text":"<p>For individual machines or small groups:</p> <pre><code>net user administrator /active:no\n</code></pre> <p>Operator Note: This disables the local administrator account immediately.</p>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#method-3-powershell-alternate","title":"Method 3: PowerShell (Alternate)","text":"<pre><code>Disable-LocalUser -Name \"Administrator\"\n</code></pre> <p>Operator Note: PowerShell method requires PowerShell 5.1+ and is useful for scripting.</p>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#running-script","title":"Running Script","text":"<pre><code># Disable Local Administrator on a remote workstation\nInvoke-Command -ComputerName Workstation01 -ScriptBlock {\n    Disable-LocalUser -Name \"Administrator\"\n}\n</code></pre> <p>Operator Note: Use with caution. Use GPO for fleet-wide, consistent deployment.</p>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#dependencies","title":"Dependencies","text":"<ul> <li>RSAT with Group Policy Management Console (for domain GPO)  </li> <li>Domain Admin or delegated permissions  </li> <li>Local administrator rights (if running manually on workstation)  </li> <li>PowerShell 5.1+ for <code>Disable-LocalUser</code> command (optional method)</li> </ul>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case Group Policy Management Console (GPMC) Windows Preferred method to disable local admin accounts across all workstations Net User (cmd) Windows Simple and quick disable PowerShell (Disable-LocalUser) Windows Scripted and remote disable LAPS (Local Administrator Password Solution) Windows Enterprise Recommended to manage local admin passwords and eliminate shared password usage"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Coordinate with enclave owner or business owner before disabling accounts.</li> <li> Use Group Policy for scalable and managed disablement.</li> <li> For manual work, use Net User or PowerShell.</li> <li> Validate disablement with test logon attempts or <code>net user administrator</code>.</li> <li> Document changes in incident records.</li> <li> Plan for re-enabling or removing GPO after IR activity.</li> </ul>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#best-practices","title":"Best Practices","text":"<ul> <li>Always prefer GPO for scalability and accountability.</li> <li>Disable, do not delete, Administrator accounts unless required.</li> <li>Use LAPS wherever possible to manage local admin credentials securely.</li> <li>Retain ability for emergency local logon where required (e.g. single use recovery account).</li> </ul>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#references","title":"References","text":"<p>Windows 7 Security Technical Implementation Guide Enable / Disable Administrator account Creating Group Policy Object</p>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 2.0 Full original + expanded operator methods (GPO, CLI, PowerShell), best practices, alternate tooling and checklist Leo"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/","title":"Verify Patch Compliance on All Hosts","text":""},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#task-verify-patch-compliance-on-all-host-systems","title":"Task Verify Patch Compliance on all Host Systems","text":""},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#conditions","title":"Conditions","text":"<p>Given domain credentials with the appropriate permissions, and a vulnerability scanner or OS-native update utility, perform vulnerability scans and patch audits from an incident response workstation.</p> <p>Operator Note: Patch management and validation is critical during incidents. Attackers often leverage missing patches for initial access and lateral movement. Verifying patch compliance ensures hosts are not vulnerable to known exploits.</p>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#standards","title":"Standards","text":"<ul> <li>Detect. Use approved scanning tool to scan systems for missing security patches.  </li> <li>Assess. Determine severity of missing patches and assess the risk to the enclave.  </li> <li>Approval. Obtain appropriate enclave approval prior to remediation procedures.  </li> <li>Document. Record actions and approval per change management procedures.  </li> <li>Acquire. Download patches if not addressed by existing security measures.  </li> <li>Test. Apply patch to test system and validate before production deployment.  </li> <li>Deploy. Apply patches to production hosts, validate apps are unaffected, and roll back if necessary.</li> </ul>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#end-state","title":"End State","text":"<p>All enclave target systems have been scanned and patch compliance verified. Any deficiencies are tracked and approved for remediation or accepted risk.</p>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#notes","title":"Notes","text":"<ul> <li>OpenVAS and MBSA provide automated scanning capabilities.  </li> <li>Native OS tooling can validate patch status at the host level.  </li> <li>Use a combination of methods to achieve confidence across OS platforms.</li> </ul>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#vulnerability-scanning","title":"Vulnerability Scanning","text":""},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#openvas-linux-cross-platform","title":"OpenVAS (Linux / Cross-platform)","text":"<ul> <li>Access web UI at <code>https://x.x.x.x:9392</code> </li> <li>Enter target IPs \u2192 <code>Start Scan</code> </li> <li>Review results \u2192 export report \u2192 verify against SOP/policy</li> </ul>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#mbsa-windows-legacy-gui","title":"MBSA (Windows Legacy / GUI)","text":"<ul> <li>Run MBSA \u2192 <code>Scan a computer</code> or <code>Scan more than one computer</code> </li> <li>Select <code>Check for security updates</code> only  </li> <li>Start scan \u2192 review report \u2192 download missing updates  </li> <li>Validate compliance against SOP</li> </ul>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#mbsa-command-line","title":"MBSA (Command Line)","text":"<pre><code>mbsacli /i 127.0.0.1 /n OS+IIS+SQL+PASSWORD\nmbsacli /c domain\\machinename /n OS+IIS+SQL+PASSWORD\nmbsacli /r 192.168.0.1-192.168.0.254 /n OS+IIS+SQL+PASSWORD\nmbsacli /d NameOfMyDomain /n OS+IIS+SQL+PASSWORD\n</code></pre>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#os-native-methods","title":"OS Native Methods","text":""},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#windows-powershell-modern-alternative-to-mbsa","title":"Windows PowerShell (Modern alternative to MBSA)","text":"<pre><code>Get-HotFix\n</code></pre> <p>Operator Note: Use <code>Get-HotFix</code> to list installed updates and patch level.</p>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#ubuntu-debian-based","title":"Ubuntu / Debian based:","text":"<pre><code>apt-get update\napt-get upgrade\napt-get dist-upgrade\n</code></pre>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#red-hat-enterprise-linux-21-4","title":"Red Hat Enterprise Linux 2.1-4:","text":"<pre><code>up2date\nup2date-nox --update\nup2date -u &lt;PACKAGE NAME&gt;\n</code></pre>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#red-hat-enterprise-linux-5","title":"Red Hat Enterprise Linux 5:","text":"<pre><code>pup\n</code></pre>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#red-hat-enterprise-linux-6","title":"Red Hat Enterprise Linux 6:","text":"<pre><code>yum update\nyum list installed &lt;PACKAGE NAME&gt;\nyum install &lt;PACKAGE NAME&gt;\nyum update &lt;PACKAGE NAME&gt;\n</code></pre>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#kali","title":"Kali:","text":"<pre><code>apt-get update &amp;&amp; apt-get upgrade\n</code></pre>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#running-script-example-script-for-windows-hosts","title":"Running Script (Example Script for Windows Hosts)","text":"<pre><code># Pull patch information from multiple Windows hosts\n$computers = @(\"Host1\", \"Host2\", \"Host3\")\n\nforeach ($computer in $computers) {\n    Get-HotFix -ComputerName $computer | Select-Object PSComputerName, HotFixID, InstalledOn | Export-Csv \".\\PatchStatus_$computer.csv\" -Append -NoTypeInformation\n}\n</code></pre> <p>Operator Note: This script pulls hotfix lists from remote hosts and saves them to CSV.</p>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#dependencies","title":"Dependencies","text":"<ul> <li>Scanning tool (OpenVAS, MBSA, Nessus, etc.)</li> <li>OS-native update utilities (apt, yum, PowerShell)</li> <li>Domain Admin credentials or local admin credentials</li> <li>Access to enclave patch repositories or internet (for patch download)</li> </ul>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case OpenVAS / Greenbone Cross-platform Full vulnerability scanning MBSA (Legacy) Windows Patch auditing (deprecated but useful for legacy) PowerShell (Get-HotFix) Windows Simple local/remote patch status WSUS Windows Enterprise Patch deployment + compliance SCCM (MEMCM) Windows Enterprise Enterprise patch management Qualys / Nessus Cross-platform Enterprise vulnerability scanning"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Identify scope and OS types of all hosts.</li> <li> Select appropriate scanning and auditing tools.</li> <li> Perform scans and local patch audits.</li> <li> Validate scan output against organization SOP.</li> <li> Document deficiencies and track in remediation plan.</li> <li> Obtain enclave approval before remediation.</li> <li> Apply/test patches and verify resolution.</li> </ul>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#best-practices","title":"Best Practices","text":"<ul> <li>Use OpenVAS or Qualys/Nessus for full environment audit.</li> <li>Use OS-native tooling for quick validation.</li> <li>Validate against vulnerability disclosure dates \u2192 prioritize critical patches.</li> <li>Document all exceptions and approved risk decisions.</li> </ul>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#references","title":"References","text":"<p>OpenVAS Setup Instructions OpenVAS Documentation Microsoft Baseline Security Analyzer NIST SP 800-42 Guidelines on Network Security Testing NIST SP 800-40 Creating a Patch and Vulnerability Management Program</p>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 2.0 Full original + enriched with multi-OS operator guidance, PowerShell, alternate tooling, checklist and best practices Leo"},{"location":"3.Containment/3.12_Enforce_Group_Policy/","title":"Enforce Group Policy Compliance","text":""},{"location":"3.Containment/3.12_Enforce_Group_Policy/#task-enforce-group-policy-compliance-across-workstations-and-servers","title":"Task Enforce Group Policy Compliance Across Workstations and Servers","text":""},{"location":"3.Containment/3.12_Enforce_Group_Policy/#conditions","title":"Conditions","text":"<p>Given a target Domain, domain credentials with appropriate permissions, and systems joined to Active Directory, the operator will validate and enforce Group Policy Objects (GPO) to ensure security baselines and containment policies are in effect.</p> <p>Operator Note: During an incident, it is critical that GPOs apply immediately and accurately to reduce attacker freedom of movement and ensure systems are properly hardened.</p>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#standards","title":"Standards","text":"<ul> <li>Team member determines appropriate scope (Workstations, Servers, or entire Domain).  </li> <li>Team member verifies that Group Policy Objects are correctly configured and linked.  </li> <li>Team member uses approved methods to force GPO updates to target systems.  </li> <li>Team member validates GPO application via system logs or resultant policy reporting.  </li> <li>Team member records actions and confirms impact with enclave or system owner.</li> </ul>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#end-state","title":"End State","text":"<p>Group Policy is confirmed to be applied to all in-scope systems and verified as compliant with incident containment requirements.</p>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#notes","title":"Notes","text":"<ul> <li>GPO is enforced automatically at defined intervals, but IR situations require manual enforcement.  </li> <li>Use Group Policy Management Console (GPMC) and <code>gpupdate</code> for immediate application.  </li> <li>PowerShell and enterprise tools can automate mass enforcement.</li> </ul>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.12_Enforce_Group_Policy/#method-1-group-policy-management-console-gpmc","title":"Method 1: Group Policy Management Console (GPMC)","text":""},{"location":"3.Containment/3.12_Enforce_Group_Policy/#open-gpmc","title":"Open GPMC","text":"<pre><code>gpmc.msc\n</code></pre>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#validate-gpo-link-and-enforcement","title":"Validate GPO Link and Enforcement","text":"<ul> <li>Ensure correct GPOs are linked to appropriate OUs.</li> <li>Check \"Enforced\" flag is enabled where applicable.</li> <li>Use \"Group Policy Results Wizard\" to verify resultant set of policies on targets.</li> </ul>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#method-2-force-gpo-refresh-gpupdate","title":"Method 2: Force GPO Refresh (gpupdate)","text":""},{"location":"3.Containment/3.12_Enforce_Group_Policy/#on-local-or-remote-systems","title":"On local or remote systems:","text":"<pre><code>gpupdate /force\n</code></pre> <p>Operator Note: <code>/force</code> reapplies all policies, not just those that have changed.</p>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#remote-with-powershell-single-system","title":"Remote with PowerShell (single system):","text":"<pre><code>Invoke-GPUpdate -Computer \"Workstation01\" -Force\n</code></pre>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#remote-with-powershell-bulk-systems","title":"Remote with PowerShell (bulk systems):","text":"<pre><code>Get-ADComputer -Filter * -SearchBase \"OU=Workstations,DC=example,DC=com\" |\nForEach-Object {\n    Invoke-GPUpdate -Computer $_.Name -Force\n}\n</code></pre> <p>Operator Note: Ensure WinRM is enabled for remote PowerShell invocation.</p>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#method-3-validate-gpo-application","title":"Method 3: Validate GPO Application","text":""},{"location":"3.Containment/3.12_Enforce_Group_Policy/#use-resultant-set-of-policy-rsop","title":"Use Resultant Set of Policy (RSOP)","text":"<pre><code>rsop.msc\n</code></pre> <p>Or via PowerShell:</p> <pre><code>Get-GPResultantSetOfPolicy -ReportType Html -Path \".\\GPOReport.html\"\n</code></pre> <p>Operator Note: This produces a full report of applied GPOs for validation.</p>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#method-4-local-group-policy-object-optional-for-non-domain-systems","title":"Method 4: Local Group Policy Object (Optional for non-domain systems)","text":"<pre><code>LGPO.exe /b backup_folder\nLGPO.exe /g\n</code></pre> <p>Operator Note: <code>LGPO.exe</code> is useful for standalone hosts but normally unnecessary in domain environments.</p>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#running-script-bulk-update-example","title":"Running Script (Bulk Update Example)","text":"<pre><code>$Computers = Get-ADComputer -Filter * -SearchBase \"OU=Workstations,DC=example,DC=com\"\n\nforeach ($Computer in $Computers) {\n    Invoke-GPUpdate -Computer $Computer.Name -Force\n}\n</code></pre> <p>Operator Note: This ensures that all workstations receive updated GPO during containment.</p>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#dependencies","title":"Dependencies","text":"<ul> <li>RSAT (Group Policy Management Console and PowerShell Module)</li> <li>Domain Admin or delegated Group Policy permissions</li> <li>WinRM enabled for remote enforcement</li> <li>Connectivity to Domain Controllers</li> </ul>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case GPMC (gpmc.msc) Windows Primary policy management and enforcement gpupdate (cmd) Windows Local refresh Invoke-GPUpdate (PowerShell) Windows Remote refresh rsop.msc Windows Validate resultant set of policies LGPO.exe Windows Standalone hosts or forensic application of local policy"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.12_Enforce_Group_Policy/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate GPO links and scope in GPMC.</li> <li> Identify target systems that need forced policy application.</li> <li> Use <code>gpupdate</code> or <code>Invoke-GPUpdate</code> to refresh GPO on target systems.</li> <li> Validate applied policies using RSOP or GPO reports.</li> <li> Document enforcement actions in IR tracking tools.</li> </ul>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#best-practices","title":"Best Practices","text":"<ul> <li>During incident response, enforce GPO only on impacted systems or OUs to minimize disruption.</li> <li>Use PowerShell for bulk enforcement actions when speed is required.</li> <li>Validate policies have successfully applied using <code>gpresult</code> or RSOP.</li> <li>Coordinate with enclave or system owners before pushing policy changes.</li> </ul>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#references","title":"References","text":"<p>Group Policy Management Console (GPMC) GPUpdate command documentation PowerShell Invoke-GPUpdate LGPO Utility</p>"},{"location":"3.Containment/3.12_Enforce_Group_Policy/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for enforcing GPO with methods, validation, and best practices Leo"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/","title":"Restrict Non-IR Personnel Access","text":""},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#task-restrict-access-to-critical-systems-to-only-authorized-incident-response-personnel","title":"Task Restrict Access to Critical Systems to Only Authorized Incident Response Personnel","text":""},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#conditions","title":"Conditions","text":"<p>Given domain credentials with the appropriate permissions and an incident in progress, the operator will limit access to sensitive systems, impacted hosts, and critical infrastructure to only members of the approved Incident Response (IR) team.</p> <p>Operator Note: Restricting access during containment prevents accidental or malicious tampering, reduces risk of malware spreading, and preserves forensic integrity.</p>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#standards","title":"Standards","text":"<ul> <li>Team member identifies and documents all impacted and critical systems.  </li> <li>Team member defines IR team user accounts or groups to be authorized for access.  </li> <li>Team member restricts logon access to critical systems through Group Policy, ACL modifications, or firewall rules.  </li> <li>Team member verifies that only IR team accounts can access the systems during containment.  </li> <li>Team member coordinates any exceptions with the enclave owner or system owner.</li> </ul>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#end-state","title":"End State","text":"<p>Non-IR personnel are prevented from logging into or accessing critical incident systems. Only designated IR team members have access until containment is complete.</p>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#notes","title":"Notes","text":"<ul> <li>Access restrictions should be temporary and lifted after containment and forensic tasks are completed.</li> <li>Coordinate with business and enclave owners to avoid disrupting critical business operations.</li> <li>Monitor access logs to ensure unauthorized attempts are detected and reviewed.</li> </ul>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#step-1-identify-impacted-systems","title":"Step 1: Identify Impacted Systems","text":"<ul> <li>Use AD OU structures, asset inventory, or IR logs to document affected systems.</li> <li>Prioritize containment zones \u2192 domain controllers, critical servers, compromised endpoints.</li> </ul>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#step-2-identify-and-prepare-ir-team-accounts","title":"Step 2: Identify and Prepare IR Team Accounts","text":"<ul> <li>Use existing IR team AD group (preferred) or create a temporary group:</li> </ul> <pre><code>New-ADGroup -Name \"IR-Access-Only\" -GroupScope Global -Path \"OU=IncidentResponse,DC=example,DC=com\"\nAdd-ADGroupMember -Identity \"IR-Access-Only\" -Members \"user1\",\"user2\",\"user3\"\n</code></pre> <p>Operator Note: If available, always use group membership vs. individual accounts for easy rollback.</p>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#step-3-restrict-access-using-group-policy-preferred","title":"Step 3: Restrict Access Using Group Policy (Preferred)","text":""},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#open-group-policy-management-console-gpmc","title":"Open Group Policy Management Console (GPMC):","text":"<pre><code>gpmc.msc\n</code></pre>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#create-or-edit-gpo","title":"Create or edit GPO:","text":"<pre><code>Computer Configuration \u2192 Windows Settings \u2192 Security Settings \u2192 Local Policies \u2192 User Rights Assignment \u2192 Allow log on locally\n</code></pre> <ul> <li>Remove \u201cDomain Users\u201d or \u201cAdministrators\u201d if necessary</li> <li>Add IR-Access-Only group</li> <li>Link GPO to impacted hosts\u2019 OU</li> <li>Force GPO update:</li> </ul> <pre><code>gpupdate /force\n</code></pre>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#step-4-block-remote-access-via-firewall-optional-enhancement","title":"Step 4: Block Remote Access via Firewall (Optional Enhancement)","text":"<pre><code>New-NetFirewallRule -DisplayName \"Block RDP\" -Direction Inbound -Protocol TCP -LocalPort 3389 -Action Block\n</code></pre> <p>Operator Note: Use this to prevent RDP access except from known IR jump hosts.</p>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#step-5-validate-access-restrictions","title":"Step 5: Validate Access Restrictions","text":"<ul> <li>Attempt logon with non-IR user \u2192 should fail</li> <li>Attempt logon with IR team user \u2192 should succeed</li> <li>Review event logs:</li> </ul> <pre><code>Get-EventLog -LogName Security -InstanceId 4625 -After (Get-Date).AddHours(-1)\n</code></pre> <p>Operator Note: Event ID 4625 indicates failed logon attempts.</p>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#running-script-automated-access-restriction","title":"Running Script (Automated Access Restriction)","text":"<pre><code># Create IR team group and restrict logon locally on target system\n$IRGroup = \"IR-Access-Only\"\nNew-ADGroup -Name $IRGroup -GroupScope Global -Path \"OU=IncidentResponse,DC=example,DC=com\"\nAdd-ADGroupMember -Identity $IRGroup -Members \"user1\",\"user2\"\n\n# Set local policy (manual via GPO recommended, but can script with LGPO or secedit)\n# Force GPO update\ngpupdate /force\n</code></pre>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#dependencies","title":"Dependencies","text":"<ul> <li>RSAT with Group Policy Management Console and AD Module</li> <li>Domain Admin or delegated permissions</li> <li>Coordination with enclave/business owners</li> <li>Firewall administrative rights (if blocking remote access)</li> </ul>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case GPMC (gpmc.msc) Windows Preferred method for large scale access restriction Local Group Policy Editor (gpedit.msc) Windows Non-domain systems PowerShell (New-ADGroup, Add-ADGroupMember) Windows IR team group management Windows Firewall (netsh, PowerShell) Windows Block remote access VPN or NAC solutions Cross-platform Network level access restriction"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Identify all critical and impacted systems.</li> <li> Create or validate IR team AD group.</li> <li> Apply logon restriction policies (GPO preferred).</li> <li> Optionally block remote access at host firewall level.</li> <li> Validate policy effectiveness and log any denied access attempts.</li> <li> Coordinate any exceptions with enclave owner.</li> <li> Remove restrictions post-incident after validation.</li> </ul>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#best-practices","title":"Best Practices","text":"<ul> <li>Always use AD groups to ease management and rollback.</li> <li>Use layered approach: GPO + host firewall.</li> <li>Document temporary restrictions and review before releasing.</li> <li>Coordinate closely with system owners and stakeholders.</li> </ul>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#references","title":"References","text":"<p>Microsoft Group Policy: User Rights Assignment PowerShell AD Module Documentation Windows Firewall PowerShell Commands</p>"},{"location":"3.Containment/3.13_Restrict_Non-IR_Personnel_Access/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for restricting non-IR access with GPO, PowerShell, firewall and checklist Leo"},{"location":"3.Containment/3.14_Block_External_Communication/","title":"Block External Communication Methods","text":""},{"location":"3.Containment/3.14_Block_External_Communication/#task-block-external-communication-methods-from-compromised-systems","title":"Task Block External Communication Methods from Compromised Systems","text":""},{"location":"3.Containment/3.14_Block_External_Communication/#conditions","title":"Conditions","text":"<p>Given systems identified as impacted or at risk, and access to endpoint and network controls, the operator will block all external communication capabilities to prevent command and control (C2), data exfiltration, or attacker pivoting.</p> <p>Operator Note: Blocking external communications reduces adversary capabilities while containment and eradication operations are underway. This prevents data loss and stops live connections.</p>"},{"location":"3.Containment/3.14_Block_External_Communication/#standards","title":"Standards","text":"<ul> <li>Team member identifies systems requiring external communications block.  </li> <li>Team member determines and implements appropriate blocking methods (host firewall, network firewall, DNS).  </li> <li>Team member validates block effectiveness.  </li> <li>Team member coordinates with enclave and network owners to avoid unintended disruption.  </li> <li>Team member documents all changes and actions taken.</li> </ul>"},{"location":"3.Containment/3.14_Block_External_Communication/#end-state","title":"End State","text":"<p>Compromised or impacted systems are fully isolated from external communications until remediation is complete.</p>"},{"location":"3.Containment/3.14_Block_External_Communication/#notes","title":"Notes","text":"<ul> <li>Blocking should be as granular as possible to avoid unnecessary disruption.  </li> <li>When possible, only block outbound traffic.  </li> <li>Use a layered approach \u2192 host firewall, network ACLs, DNS sinkholing.  </li> <li>Validate with packet captures or monitoring tools.</li> </ul>"},{"location":"3.Containment/3.14_Block_External_Communication/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.14_Block_External_Communication/#method-1-host-firewall-windows","title":"Method 1: Host Firewall (Windows)","text":""},{"location":"3.Containment/3.14_Block_External_Communication/#block-all-outbound-traffic-except-internal-ranges","title":"Block all outbound traffic except internal ranges","text":"<pre><code>New-NetFirewallRule -DisplayName \"Block External Outbound\" -Direction Outbound -RemoteAddress 0.0.0.0/0 -Action Block\nNew-NetFirewallRule -DisplayName \"Allow Internal Outbound\" -Direction Outbound -RemoteAddress 192.168.0.0/16,10.0.0.0/8 -Action Allow\n</code></pre> <p>Operator Note: Adjust internal ranges as necessary.</p>"},{"location":"3.Containment/3.14_Block_External_Communication/#method-2-host-firewall-linux-iptables","title":"Method 2: Host Firewall (Linux iptables)","text":"<pre><code>iptables -P OUTPUT DROP\niptables -A OUTPUT -d 192.168.0.0/16 -j ACCEPT\n</code></pre> <p>Operator Note: Be cautious. This blocks all external outbound unless explicitly allowed.</p>"},{"location":"3.Containment/3.14_Block_External_Communication/#method-3-dns-sinkhole-or-block-external-dns","title":"Method 3: DNS Sinkhole or Block External DNS","text":""},{"location":"3.Containment/3.14_Block_External_Communication/#example-windows-hosts-via-gpo","title":"Example - Windows hosts via GPO:","text":"<pre><code>Computer Configuration \u2192 Administrative Templates \u2192 Network \u2192 DNS Client \u2192 DNS Servers\n</code></pre> <ul> <li>Set DNS servers to internal only.</li> <li>Or block UDP/TCP 53 traffic to external DNS using firewall.</li> </ul>"},{"location":"3.Containment/3.14_Block_External_Communication/#method-4-network-firewall-router-acls","title":"Method 4: Network Firewall / Router ACLs","text":"<ul> <li>Block outbound traffic to external internet from impacted hosts\u2019 IP ranges.</li> <li>Only allow communication to IR tools or known trusted systems.</li> </ul>"},{"location":"3.Containment/3.14_Block_External_Communication/#method-5-remove-default-gateway-emergency-isolation","title":"Method 5: Remove Default Gateway (Emergency Isolation)","text":""},{"location":"3.Containment/3.14_Block_External_Communication/#windows","title":"Windows:","text":"<pre><code>Remove-NetRoute -DestinationPrefix \"0.0.0.0/0\"\n</code></pre>"},{"location":"3.Containment/3.14_Block_External_Communication/#linux","title":"Linux:","text":"<pre><code>ip route del default\n</code></pre> <p>Operator Note: This will block all internet access but retains local communications.</p>"},{"location":"3.Containment/3.14_Block_External_Communication/#running-script-windows-example-for-rapid-host-blocking","title":"Running Script (Windows example for rapid host blocking)","text":"<pre><code># Block all external traffic but allow internal\nNew-NetFirewallRule -DisplayName \"Block All External\" -Direction Outbound -RemoteAddress 0.0.0.0/0 -Action Block\nNew-NetFirewallRule -DisplayName \"Allow Internal\" -Direction Outbound -RemoteAddress 192.168.0.0/16,10.0.0.0/8 -Action Allow\n</code></pre>"},{"location":"3.Containment/3.14_Block_External_Communication/#dependencies","title":"Dependencies","text":"<ul> <li>RSAT and Firewall management permissions  </li> <li>Network firewall / switch ACL access  </li> <li>DNS server administration (if using sinkholing or blocking)  </li> <li>Endpoint control agents (optional)</li> </ul>"},{"location":"3.Containment/3.14_Block_External_Communication/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case Windows Firewall + PowerShell Windows Rapid per-host block Linux iptables / ufw Linux Host-level outbound blocking Network Firewall (Palo Alto, Cisco ASA, Fortigate) Network Segment or site-wide blocking DNS Sinkhole (Unbound, Bind, Infoblox) Network Block DNS-based outbound VPN or NAC solutions Enterprise Restrict network access"},{"location":"3.Containment/3.14_Block_External_Communication/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.14_Block_External_Communication/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Identify systems requiring external communications block.</li> <li> Determine level of block (DNS, firewall, gateway removal).</li> <li> Implement block using most appropriate method.</li> <li> Validate that outbound connections are denied.</li> <li> Log actions and communicate with enclave/network owner.</li> <li> Remove or adjust blocks after containment is complete.</li> </ul>"},{"location":"3.Containment/3.14_Block_External_Communication/#best-practices","title":"Best Practices","text":"<ul> <li>Use host firewalls for speed, network firewalls for scale.</li> <li>Avoid blanket blocking unless necessary \u2192 target impacted systems only.</li> <li>Use DNS blocklists or sinkholing for stealthy C2 detection and blocking.</li> <li>Document and review blocks regularly during IR operations.</li> </ul>"},{"location":"3.Containment/3.14_Block_External_Communication/#references","title":"References","text":"<p>Windows Defender Firewall PowerShell Cmdlets iptables Linux Firewall Guide DNS Sinkhole Strategies NIST SP 800-94 Guide to Intrusion Detection and Prevention Systems (IDPS)</p>"},{"location":"3.Containment/3.14_Block_External_Communication/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for blocking external communication via firewall, DNS, and ACLs Leo"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/","title":"Disable Scheduled Tasks and Jobs","text":""},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#task-disable-scheduled-tasks-and-jobs-on-compromised-or-at-risk-hosts","title":"Task Disable Scheduled Tasks and Jobs on Compromised or At-Risk Hosts","text":""},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#conditions","title":"Conditions","text":"<p>Given access to Windows or Linux hosts with local administrator or root privileges, the operator will identify, disable, and document scheduled tasks or jobs that may be abused by attackers for persistence or lateral movement.</p> <p>Operator Note: Threat actors frequently leverage scheduled tasks or cron jobs to maintain persistence or execute malicious payloads after reboots or on a timer. During incident response, disabling (not deleting) them preserves forensic evidence while disrupting adversary operations.</p>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#standards","title":"Standards","text":"<ul> <li>Team member identifies all scheduled tasks and jobs on impacted systems.  </li> <li>Team member documents and reviews all tasks for legitimacy and IR team coordination.  </li> <li>Team member disables suspicious or all non-critical tasks.  </li> <li>Team member confirms that disabled tasks no longer execute.  </li> <li>Team member preserves evidence (do not delete unless approved).</li> </ul>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#end-state","title":"End State","text":"<p>All malicious or unnecessary scheduled tasks are disabled on impacted systems. A record of actions is maintained for forensic review.</p>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#notes","title":"Notes","text":"<ul> <li>Disabling is preferred over deleting during active incidents to preserve forensic data.</li> <li>Changes should be documented carefully and validated through test execution.</li> <li>Tasks that may impact critical business operations should be reviewed before disabling.</li> </ul>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#windows-systems","title":"Windows Systems","text":""},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#view-all-scheduled-tasks","title":"View All Scheduled Tasks","text":""},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#powershell-preferred","title":"PowerShell (Preferred)","text":"<pre><code>Get-ScheduledTask | Select-Object TaskName, State\n</code></pre>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#schtasks-command-line","title":"schtasks (Command Line)","text":"<pre><code>schtasks /query /fo LIST /v\n</code></pre>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#disable-specific-scheduled-task","title":"Disable Specific Scheduled Task","text":""},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#powershell","title":"PowerShell","text":"<pre><code>Disable-ScheduledTask -TaskName \"TaskName\" -TaskPath \"\\\"\n</code></pre>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#schtasks","title":"schtasks","text":"<pre><code>schtasks /Change /TN \"\\TaskName\" /Disable\n</code></pre> <p>Operator Note: Disable suspicious or non-essential tasks only after reviewing.</p>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#export-scheduled-tasks-for-backup-forensic-review","title":"Export Scheduled Tasks (For backup / forensic review)","text":"<pre><code>Get-ScheduledTask | Export-Clixml -Path .\\ScheduledTasksBackup.xml\n</code></pre>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#linux-systems","title":"Linux Systems","text":""},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#view-cron-jobs-user-level","title":"View Cron Jobs (user level)","text":"<pre><code>crontab -l\n</code></pre>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#remove-or-comment-out-suspicious-entries","title":"Remove or comment out suspicious entries","text":"<pre><code>crontab -e\n</code></pre> <p>Comment suspicious tasks with <code>#</code> to disable but preserve evidence.</p>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#system-wide-cron-jobs-root-or-services","title":"System-wide Cron Jobs (root or services)","text":"<pre><code>cat /etc/crontab\nls -la /etc/cron.*\n</code></pre> <p>Operator Note: Review and comment out any suspicious jobs.</p>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#disable-systemd-timers","title":"Disable systemd timers","text":"<pre><code>systemctl list-timers\nsystemctl disable &lt;timer name&gt;\n</code></pre>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#view-and-remove-at-jobs","title":"View and Remove \"at\" Jobs","text":"<pre><code>atq\natrm &lt;job number&gt;\n</code></pre> <p>Operator Note: Attackers often use <code>at</code> for one-time malicious execution.</p>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#running-script-windows-bulk-disable-all-scheduled-tasks","title":"Running Script (Windows \u2192 Bulk Disable All Scheduled Tasks)","text":"<pre><code>Get-ScheduledTask | ForEach-Object {\n    Disable-ScheduledTask -TaskName $_.TaskName -TaskPath $_.TaskPath\n}\n</code></pre> <p>Operator Note: Use with caution. Recommended only for systems where complete lock-down is required.</p>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#dependencies","title":"Dependencies","text":"<ul> <li>Local Administrator or Domain Admin rights (Windows)  </li> <li>Root or sudo rights (Linux)  </li> <li>PowerShell (Windows)  </li> <li>Cron/systemctl/at utilities (Linux)  </li> <li>Coordination with system owners</li> </ul>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case PowerShell ScheduledTasks module Windows View/export/disable tasks schtasks.exe Windows CLI alternative Task Scheduler GUI (taskschd.msc) Windows Visual inspection crontab / systemctl / at Linux Cron, system timers, and at jobs management SIEM (Splunk, Sentinel) Cross-platform Detection of scheduled job execution"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Identify all scheduled tasks on impacted hosts.</li> <li> Document tasks prior to disabling.</li> <li> Disable malicious or non-essential scheduled tasks.</li> <li> Validate disabled tasks no longer execute.</li> <li> Leave tasks in place for forensic review unless removal is approved.</li> <li> Track all changes in IR documentation.</li> </ul>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#best-practices","title":"Best Practices","text":"<ul> <li>Disable rather than delete to preserve forensic evidence.</li> <li>Use PowerShell or scheduled task export for easy rollback.</li> <li>Comment cron jobs on Linux instead of deleting.</li> <li>Use systemd timers and \"at\" jobs review for advanced persistence detection.</li> <li>Validate tasks using IR or IT change records to avoid accidental disruption.</li> </ul>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#references","title":"References","text":"<p>Microsoft Scheduled Task Cmdlets Linux Crontab Manual Systemd Timers Documentation</p>"},{"location":"3.Containment/3.15_Disable_Scheduled_Jobs_and_Tasks/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide covering detection, disabling, and validation of scheduled tasks and jobs Leo"},{"location":"3.Containment/3.16_Disble_Windows_Services/","title":"Disable Windows Services","text":""},{"location":"3.Containment/3.16_Disble_Windows_Services/#task-disable-non-essential-or-suspicious-windows-services","title":"Task Disable Non-Essential or Suspicious Windows Services","text":""},{"location":"3.Containment/3.16_Disble_Windows_Services/#conditions","title":"Conditions","text":"<p>Given access to compromised or at-risk systems and local administrator or domain administrator permissions, the operator will identify and disable unnecessary or suspicious services to disrupt potential attacker persistence and limit lateral movement.</p> <p>Operator Note: Adversaries frequently abuse Windows services to maintain persistence, escalate privileges, or evade detection. Disabling unneeded or malicious services is a key containment tactic, but should be executed carefully to avoid service disruption.</p>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#standards","title":"Standards","text":"<ul> <li>Team member enumerates all active and configured services.  </li> <li>Team member identifies non-essential, suspicious, or malicious services.  </li> <li>Team member disables these services using appropriate tools and methods.  </li> <li>Team member validates the services are no longer running or able to restart.  </li> <li>Team member documents all services disabled and retains forensic evidence.</li> </ul>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#end-state","title":"End State","text":"<p>All unauthorized or non-essential services on impacted hosts are disabled, and operators have validated these services are no longer running.</p>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#notes","title":"Notes","text":"<ul> <li>Disabling services can have operational impact \u2192 coordinate with system owners where possible.</li> <li>Always collect forensic evidence and document service states before making changes.</li> <li>Use automated tooling for fleet-wide service analysis when available.</li> </ul>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.16_Disble_Windows_Services/#step-1-enumerate-all-services","title":"Step 1: Enumerate All Services","text":""},{"location":"3.Containment/3.16_Disble_Windows_Services/#powershell-preferred","title":"PowerShell (Preferred)","text":"<pre><code>Get-Service | Select-Object Name, DisplayName, Status, StartType\n</code></pre>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#command-line-sc-query","title":"Command Line (sc query)","text":"<pre><code>sc query type= service state= all\n</code></pre>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#windows-services-gui-servicesmsc","title":"Windows Services GUI (services.msc)","text":"<pre><code>services.msc\n</code></pre> <p>Operator Note: Use GUI for easier visual review when dealing with complex or unfamiliar services.</p>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#step-2-investigate-suspicious-services","title":"Step 2: Investigate Suspicious Services","text":"<p>Look for:</p> <ul> <li>Unexpected names (random strings, disguised as legit services)</li> <li>Non-Microsoft services running from unusual paths (AppData, Temp, etc)</li> <li>Recently installed services</li> </ul> <pre><code>Get-WmiObject Win32_Service | Select-Object Name, DisplayName, State, StartMode, PathName\n</code></pre>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#step-3-disable-a-service","title":"Step 3: Disable a Service","text":""},{"location":"3.Containment/3.16_Disble_Windows_Services/#powershell-recommended","title":"PowerShell (Recommended)","text":"<pre><code>Set-Service -Name \"ServiceName\" -StartupType Disabled\nStop-Service -Name \"ServiceName\" -Force\n</code></pre>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#command-line-sc-config","title":"Command Line (sc config)","text":"<pre><code>sc config \"ServiceName\" start= disabled\nsc stop \"ServiceName\"\n</code></pre> <p>Operator Note: Always stop the service after disabling to ensure it is not running.</p>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#step-4-validate-disabled-status","title":"Step 4: Validate Disabled Status","text":"<pre><code>Get-Service -Name \"ServiceName\"\n</code></pre> <p>Expected Status:</p> <pre><code>Status   Name               DisplayName\n------   ----               -----------\nStopped  ServiceName        Example Service\n</code></pre>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#step-5-back-up-list-of-services-optional-for-rollback-or-forensics","title":"Step 5: Back up list of services (optional for rollback or forensics)","text":"<pre><code>Get-Service | Export-Csv .\\ServicesBackup.csv -NoTypeInformation\n</code></pre>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#running-script-bulk-disable-suspicious-services-example","title":"Running Script (Bulk Disable Suspicious Services Example)","text":"<pre><code>$suspiciousServices = @(\"badsvc1\",\"malwareupdate\",\"strangeSvc\")\n\nforeach ($svc in $suspiciousServices) {\n    Set-Service -Name $svc -StartupType Disabled\n    Stop-Service -Name $svc -Force\n}\n</code></pre> <p>Operator Note: Update the array with service names identified during review.</p>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#dependencies","title":"Dependencies","text":"<ul> <li>Local Administrator or Domain Admin privileges  </li> <li>PowerShell  </li> <li>sc.exe (built into Windows)  </li> <li>WMI tools (optional)  </li> <li>Coordination with enclave or system owners</li> </ul>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case PowerShell (Get-Service, Set-Service) Windows Bulk review and disabling sc.exe Windows CLI method for disabling services.msc Windows Visual review and disable (manual) Sysinternals Autoruns Windows Detect services and startup programs WMI Windows Advanced service interrogation"},{"location":"3.Containment/3.16_Disble_Windows_Services/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.16_Disble_Windows_Services/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Enumerate all services on impacted hosts.</li> <li> Identify non-essential or suspicious services.</li> <li> Document suspicious services with executable path and config.</li> <li> Disable services (Set-Service or sc config).</li> <li> Validate service is stopped and does not restart.</li> <li> Export backup of services list for rollback and forensic purposes.</li> </ul>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#best-practices","title":"Best Practices","text":"<ul> <li>Avoid disabling Microsoft core OS services unless necessary.</li> <li>Disable and stop (do not delete) services for forensic retention.</li> <li>Coordinate service disablement during production hours to minimize impact.</li> <li>Use Sysinternals Autoruns for advanced detection of malicious persistence mechanisms.</li> </ul>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#references","title":"References","text":"<p>Microsoft Docs - Service Cmdlets in PowerShell sc.exe command-line reference Sysinternals Autoruns</p>"},{"location":"3.Containment/3.16_Disble_Windows_Services/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for disabling Windows services, multi-method instructions, forensic guidance Leo"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/","title":"Remove Unapproved Software and Tools","text":""},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#task-remove-unapproved-or-malicious-software-and-tools","title":"Task Remove Unapproved or Malicious Software and Tools","text":""},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#conditions","title":"Conditions","text":"<p>Given access to compromised or at-risk systems with local administrator/root permissions, and provided with an approved software baseline or whitelist, the operator will identify and remove unauthorized software or attacker tools to prevent persistence or further exploitation.</p> <p>Operator Note: Unapproved or malicious tools can provide threat actors with remote access, credential theft capabilities, or data exfiltration paths. During containment, unauthorized software should be removed or disabled carefully to preserve forensic evidence and avoid business disruption.</p>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#standards","title":"Standards","text":"<ul> <li>Team member inventories installed software and running processes to identify unauthorized tools.  </li> <li>Team member confirms unauthorized or suspicious nature of software with IR lead and/or enclave owner.  </li> <li>Team member removes, disables, or isolates identified software.  </li> <li>Team member preserves forensic copies if required.  </li> <li>Team member documents removal actions in IR log.</li> </ul>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#end-state","title":"End State","text":"<p>All unapproved or attacker-deployed software is removed or isolated from the environment, and removal actions are documented and validated.</p>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#notes","title":"Notes","text":"<ul> <li>Some attacker tools are memory-only \u2192 always supplement with memory capture before removal.  </li> <li>Coordinate software removal with enclave/system owners to prevent loss of business-critical functions.  </li> <li>Malware and attacker tools may resist removal or have persistence \u2192 monitor systems post-removal.</li> </ul>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#step-1-identify-installed-software-and-tools","title":"Step 1: Identify Installed Software and Tools","text":""},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#windows-installed-programs-powershell","title":"Windows - Installed Programs (PowerShell)","text":"<pre><code>Get-WmiObject -Class Win32_Product | Select-Object Name, Version\n</code></pre>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#windows-running-processes","title":"Windows - Running Processes","text":"<pre><code>Get-Process | Select-Object Name, Path\n</code></pre> <p>Operator Note: Look for non-standard paths (AppData, Temp, C:\\Users).</p>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#linux-installed-packages-debianubuntu","title":"Linux - Installed Packages (Debian/Ubuntu)","text":"<pre><code>dpkg -l\n</code></pre>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#linux-installed-packages-redhatcentos","title":"Linux - Installed Packages (RedHat/CentOS)","text":"<pre><code>rpm -qa\n</code></pre>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#linux-running-processes","title":"Linux - Running Processes","text":"<pre><code>ps aux | less\n</code></pre> <p>Operator Note: Use <code>lsof</code> or <code>netstat</code> to identify software with network activity.</p>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#macos-installed-applications","title":"macOS - Installed Applications","text":"<pre><code>system_profiler SPApplicationsDataType\n</code></pre>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#macos-running-processes","title":"macOS - Running Processes","text":"<pre><code>ps aux\n</code></pre>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#step-2-investigate-and-confirm","title":"Step 2: Investigate and Confirm","text":"<ul> <li>Validate unknown or unapproved software against approved software lists.</li> <li>Coordinate with IR lead or enclave owner for final approval to remove.</li> </ul>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#step-3-disable-or-remove-software","title":"Step 3: Disable or Remove Software","text":""},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#windows-uninstall","title":"Windows - Uninstall","text":"<pre><code>Get-WmiObject -Class Win32_Product -Filter \"Name='ToolName'\" | ForEach-Object { $_.Uninstall() }\n</code></pre>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#windows-manual-removal-advanced","title":"Windows - Manual Removal (Advanced)","text":"<ul> <li>Stop service or process</li> <li>Delete application folders</li> <li>Clean up registry if required (Regedit)</li> </ul>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#linux-uninstall-package","title":"Linux - Uninstall Package","text":"<pre><code>apt-get remove --purge packagename\nyum remove packagename\n</code></pre>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#linux-remove-binary-custom-tools","title":"Linux - Remove Binary / Custom Tools","text":"<pre><code>rm /path/to/binary\n</code></pre> <p>Operator Note: Retain a forensic copy before removal if necessary.</p>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#macos-uninstall-manual","title":"macOS - Uninstall (manual)","text":"<pre><code>sudo rm -rf /Applications/Tool.app\n</code></pre>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#step-4-validate-removal","title":"Step 4: Validate Removal","text":"<ul> <li>Verify process is no longer running</li> <li>Verify application no longer exists</li> <li>Review startup mechanisms (autoruns, crontab, launchctl)</li> </ul>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#running-script-windows-identify-suspicious-software","title":"Running Script (Windows - Identify Suspicious Software)","text":"<pre><code>Get-WmiObject -Class Win32_Product | Where-Object { $_.Name -notmatch \"Microsoft|Adobe|VMware|Cisco\" } | Select-Object Name, Version\n</code></pre> <p>Operator Note: Adjust exclusions based on organization whitelist.</p>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#dependencies","title":"Dependencies","text":"<ul> <li>Local Administrator or root access  </li> <li>Knowledge of approved software baseline  </li> <li>Coordination with enclave/system owners  </li> <li>Backup or forensic tools (optional)</li> </ul>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case PowerShell + WMI Windows Installed software and removal Autoruns (Sysinternals) Windows Identify software running at startup dpkg, rpm, yum, apt Linux Package management and removal ps, lsof, netstat Linux/macOS Running process identification Manual removal All Remove binaries or application files"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Inventory installed software and running processes.</li> <li> Validate against known good / approved software list.</li> <li> Obtain approval before removal.</li> <li> Disable or uninstall unapproved tools.</li> <li> Retain forensic copy if required.</li> <li> Validate removal and document actions.</li> </ul>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#best-practices","title":"Best Practices","text":"<ul> <li>Do not delete unless necessary \u2192 prefer disable or isolate where possible.</li> <li>Use forensic preservation before removal on suspicious/malicious tools.</li> <li>Automate bulk removal where safe (e.g., remove PUP or common attacker tools).</li> <li>Always review startup mechanisms post-removal.</li> </ul>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#references","title":"References","text":"<p>Windows PowerShell Get-WmiObject Linux Package Management Guide Sysinternals Autoruns</p>"},{"location":"3.Containment/3.17_Remove_Unapproved_Software_and_Tools/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for identifying and removing unapproved software across OS platforms Leo"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/","title":"Verify Containment is Successful","text":""},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#task-verify-that-containment-actions-were-fully-successful-and-no-adversary-presence-remains","title":"Task Verify That Containment Actions Were Fully Successful and No Adversary Presence Remains","text":""},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#conditions","title":"Conditions","text":"<p>Given containment actions (account disablement, network isolation, service disabling, removal of malicious tools) have been completed, the operator will validate that impacted systems and networks no longer exhibit signs of compromise or unauthorized access.</p> <p>Operator Note: Verification of containment is critical before proceeding to eradication and recovery. Failure to validate containment may result in reinfection or attacker re-entry.</p>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#standards","title":"Standards","text":"<ul> <li>Team member confirms previously compromised hosts are isolated or secured.  </li> <li>Team member validates that malicious services, scheduled tasks, unauthorized accounts and software have been removed or disabled.  </li> <li>Team member reviews network traffic to confirm C2 and exfiltration have ceased.  </li> <li>Team member ensures no new suspicious indicators are present post-containment.  </li> <li>Team member coordinates containment verification sign-off with IR lead or enclave owner.</li> </ul>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#end-state","title":"End State","text":"<p>Containment is validated through host, network, and user behavior review. Adversary access has been removed or blocked, and the environment is stabilized for eradication and recovery phases.</p>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#notes","title":"Notes","text":"<ul> <li>Verification must be multi-layered \u2192 do not trust single data source validation.  </li> <li>Use endpoint, network, and centralized logging to confirm environment state.  </li> <li>Coordination with SOC/IR team is critical for holistic validation.</li> </ul>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#step-1-validate-host-based-controls","title":"Step 1: Validate Host-Based Controls","text":""},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#review-for-active-attacker-tools-and-malware","title":"Review for active attacker tools and malware","text":"<pre><code>Get-Process\nGet-ScheduledTask\nGet-Service\n</code></pre> <p>Operator Note: Verify no malicious processes, tasks, or services remain enabled or running.</p>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#review-unauthorized-accounts","title":"Review unauthorized accounts","text":"<pre><code>net user\nGet-LocalUser\n</code></pre>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#check-for-open-network-connections","title":"Check for open network connections","text":"<pre><code>netstat -ano\n</code></pre>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#confirm-firewall-and-policy-enforcement","title":"Confirm firewall and policy enforcement","text":"<pre><code>Get-NetFirewallProfile | Format-Table Name, Enabled\n</code></pre>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#step-2-validate-network-level-controls","title":"Step 2: Validate Network-Level Controls","text":""},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#idsips-firewall","title":"IDS/IPS / Firewall","text":"<ul> <li>Confirm rules blocking external communications are still active.</li> <li>Validate no C2 traffic or anomalies are present.</li> </ul>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#dns-logging","title":"DNS Logging","text":"<ul> <li>Review for queries to known malicious domains or external IPs.</li> </ul>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#network-segmentation","title":"Network Segmentation","text":"<ul> <li>Validate isolation of impacted systems remains in place.</li> </ul>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#step-3-validate-enterprise-controls","title":"Step 3: Validate Enterprise Controls","text":""},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#central-loggingsiem","title":"Central Logging/SIEM","text":"<ul> <li>Search for recurring alerts related to:</li> <li>Unauthorized logons</li> <li>Malware detections</li> <li>Command and control signatures</li> </ul>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#endpoint-detection-and-response-edr","title":"Endpoint Detection and Response (EDR)","text":"<ul> <li>Verify hosts are clean and not running malicious processes.</li> <li>Validate alerts have stopped post-containment.</li> </ul>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#review-active-directory","title":"Review Active Directory","text":"<ul> <li>Validate that GPOs have applied successfully.</li> <li>Confirm no new admin accounts exist.</li> </ul>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#step-4-validate-user-behavior-and-access","title":"Step 4: Validate User Behavior and Access","text":"<ul> <li>Ensure only IR personnel are accessing impacted systems.</li> <li>Confirm no unusual logon patterns are detected.</li> <li>Review shared drives and email for signs of data theft or new phishing attempts.</li> </ul>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#running-script-windows-bulk-containment-verification","title":"Running Script (Windows Bulk Containment Verification)","text":"<pre><code>$computers = Get-ADComputer -Filter * -SearchBase \"OU=Workstations,DC=example,DC=com\"\n\nforeach ($computer in $computers) {\n    Invoke-Command -ComputerName $computer.Name -ScriptBlock {\n        Get-Service | Where-Object { $_.Status -eq \"Running\" }\n        Get-ScheduledTask | Where-Object { $_.State -eq \"Running\" }\n        Get-LocalUser\n    }\n}\n</code></pre> <p>Operator Note: Useful for verifying across multiple endpoints quickly.</p>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#dependencies","title":"Dependencies","text":"<ul> <li>Administrator access (Windows, Linux, AD)  </li> <li>Access to central SIEM, EDR, or logging tools  </li> <li>Network traffic monitoring tools (Firewall, IDS/IPS)  </li> <li>Endpoint host access (RDP, SSH, or EDR agent)</li> </ul>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case PowerShell / Task Manager Windows Validate local host state Netstat, Get-NetTCPConnection Windows/Linux Network connections EDR Tools (Defender ATP, CrowdStrike, SentinelOne) Cross-platform Validate endpoint state SIEM (Splunk, Sentinel, Elastic) Cross-platform Validate no new alerts IDS/IPS, Firewall Logs Network Validate no malicious activity DNS Logs Network Validate no malicious outbound communication"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate host-level controls \u2192 no malicious processes, accounts, services, tasks.</li> <li> Validate network controls \u2192 no external communication or beaconing.</li> <li> Validate enterprise controls \u2192 no SIEM alerts or EDR detections.</li> <li> Validate user access \u2192 only authorized IR personnel accessing.</li> <li> Coordinate with IR team lead and enclave owner for formal containment validation.</li> <li> Document containment verification in IR record.</li> </ul>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#best-practices","title":"Best Practices","text":"<ul> <li>Perform multi-layer validation \u2192 host, network, enterprise, user.</li> <li>Use automated scripts for broad validation across environment.</li> <li>Maintain containment state until eradication and recovery preparation is complete.</li> <li>Validate over time \u2192 monitor for delayed attacker activity or timers.</li> </ul>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#references","title":"References","text":"<p>Microsoft Defender ATP Hunting Queries NIST SP 800-61 Rev. 2 - Computer Security Incident Handling Guide</p>"},{"location":"3.Containment/3.18_Verify_Containment_is_Successful/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for verifying containment success at host, network, and enterprise levels Leo"},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/","title":"Conduct Containment Outbrief","text":""},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#task-conduct-a-formal-containment-outbrief-to-transition-to-eradication","title":"Task Conduct a Formal Containment Outbrief to Transition to Eradication","text":""},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#conditions","title":"Conditions","text":"<p>Given completed containment activities and coordination with IR stakeholders, the operator will lead or participate in an outbrief meeting to summarize actions, validate containment success, and enable transition to eradication and recovery phases.</p> <p>Operator Note: The containment outbrief ensures clarity and alignment between incident response team, IT operations, business stakeholders, and enclave/system owners. This step officially closes containment and prevents premature movement to next phases.</p>"},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#standards","title":"Standards","text":"<ul> <li>Team member prepares containment summary including actions, affected systems, and containment status.  </li> <li>Team member schedules and invites IR stakeholders to outbrief meeting.  </li> <li>Team member presents containment summary and validates containment success with participants.  </li> <li>Team member records meeting decisions and any action items.  </li> <li>Team member distributes outbrief notes and updates IR documentation.</li> </ul>"},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#end-state","title":"End State","text":"<p>Containment actions and their effectiveness have been validated and communicated to all stakeholders, and agreement has been reached to move to eradication phase.</p>"},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#notes","title":"Notes","text":"<ul> <li>The containment outbrief is both technical and operational \u2192 audience may include IT, business, and security.  </li> <li>The outbrief must confirm containment success to avoid premature progression.  </li> <li>All containment-related risks, exceptions, or challenges should be transparently discussed.</li> </ul>"},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#step-1-prepare-containment-summary-document","title":"Step 1: Prepare Containment Summary Document","text":"<p>Recommended format:</p> Action System(s) Date/Time Operator Status Notes Disabled malicious service Workstation-004 2025-05-02 09:00 L. Jones Completed No recurrence observed Blocked C2 traffic via firewall ACL Network Firewall 2025-05-02 09:30 K. Smith Completed No outbound traffic seen in past 24h <p>Also include:</p> <ul> <li>Overall number of impacted systems</li> <li>Description of containment methods used (network, host, user)</li> <li>Residual risk or known limitations</li> <li>Summary of validation steps completed</li> </ul>"},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#step-2-schedule-and-conduct-outbrief-meeting","title":"Step 2: Schedule and Conduct Outbrief Meeting","text":"<p>Recommended attendees:</p> <ul> <li>Incident Response Lead</li> <li>Incident Responders</li> <li>Enclave or System Owner</li> <li>IT Operations Lead</li> <li>Business Stakeholders (if needed)</li> </ul> <p>Recommended agenda:</p> <ol> <li>Overview of incident and containment objectives</li> <li>Summary of containment actions</li> <li>Validation of containment success</li> <li>Known gaps or residual risks</li> <li>Transition plan to eradication and recovery</li> <li>Open discussion and Q&amp;A</li> <li>Approval to proceed</li> </ol>"},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#step-3-record-outbrief-decisions","title":"Step 3: Record Outbrief Decisions","text":"<p>Capture key points and decisions:</p> <pre><code>Containment Summary: Approved\nEradication Phase Start: Approved to begin 2025-05-02 14:00\nRisks Noted: Some user accounts remain disabled pending investigation\nFollow-Up Actions: IT Operations to monitor overnight and report anomalies\n</code></pre> <p>Operator Note: Distribute notes to all participants after the outbrief.</p>"},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#running-script-powershell-example-for-containment-summary-generation","title":"Running Script (PowerShell Example for Containment Summary Generation)","text":"<pre><code>$containmentSummary = @()\n\n$containmentSummary += [PSCustomObject]@{\n    Action = \"Disabled malicious service\"\n    System = \"Workstation-004\"\n    DateTime = Get-Date\n    Operator = \"L. Jones\"\n    Status = \"Completed\"\n    Notes = \"No recurrence observed\"\n}\n\n$containmentSummary | Export-Csv -Path .\\ContainmentOutbrief.csv -NoTypeInformation\n</code></pre> <p>Operator Note: Use PowerShell to generate containment summary table quickly from logs or notes.</p>"},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#dependencies","title":"Dependencies","text":"<ul> <li>Incident Response documentation  </li> <li>IR team leader and decision makers available  </li> <li>Collaboration and scheduling tools (email, calendar, Teams, Zoom, etc.)</li> </ul>"},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case Markdown, Word, or PowerPoint Cross-platform Prepare containment summary document Ticketing system or incident management platform Enterprise Record and distribute outbrief notes Email or Collaboration Platform Cross-platform Send invites, notes, and decisions PowerShell Windows Generate containment action summary from logs"},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Prepare containment action summary document.</li> <li> Schedule outbrief meeting with key stakeholders.</li> <li> Present containment actions, validation, and residual risks.</li> <li> Record meeting notes and decisions.</li> <li> Distribute notes and update incident response documentation.</li> </ul>"},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#best-practices","title":"Best Practices","text":"<ul> <li>Be transparent about containment success and limitations.</li> <li>Gain formal approval before proceeding to eradication.</li> <li>Use plain language where necessary for non-technical stakeholders.</li> <li>Align containment completion with overall IR plan milestones.</li> </ul>"},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#references","title":"References","text":"<p>NIST SP 800-61 Rev. 2 - Computer Security Incident Handling Guide Incident Response Playbook Templates - CISA</p>"},{"location":"3.Containment/3.20_Conduct_Containment_Outbrief/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for conducting containment outbrief, agenda, checklist, and best practices Leo"},{"location":"3.Containment/3.20_Document_Containment_Actions/","title":"Document Containment Actions","text":""},{"location":"3.Containment/3.20_Document_Containment_Actions/#task-document-all-containment-actions-taken-during-incident-response","title":"Task Document All Containment Actions Taken During Incident Response","text":""},{"location":"3.Containment/3.20_Document_Containment_Actions/#conditions","title":"Conditions","text":"<p>Given access to incident response records, the operator will ensure all containment actions are documented in detail. Documentation should reflect who performed the action, when it occurred, what was done, and why it was necessary.</p> <p>Operator Note: Accurate documentation of containment activities is critical for post-incident analysis, lessons learned, recovery coordination, and legal or regulatory reporting requirements.</p>"},{"location":"3.Containment/3.20_Document_Containment_Actions/#standards","title":"Standards","text":"<ul> <li>Team member records every containment action taken, linked to impacted hosts or systems.  </li> <li>Team member records the justification and approval (if required) for each action.  </li> <li>Team member ensures timestamped records of who performed each action.  </li> <li>Team member stores documentation in approved IR management platform or file repository.  </li> <li>Team member ensures documentation is reviewed and available for post-incident activities.</li> </ul>"},{"location":"3.Containment/3.20_Document_Containment_Actions/#end-state","title":"End State","text":"<p>All containment actions are fully and accurately documented and accessible to authorized personnel for follow-up actions.</p>"},{"location":"3.Containment/3.20_Document_Containment_Actions/#notes","title":"Notes","text":"<ul> <li>Document actions as soon as possible after execution to avoid omissions.  </li> <li>Use a standard format to enable easy review and analysis.  </li> <li>Documentation should be detailed enough for another operator to understand what was done and why.</li> </ul>"},{"location":"3.Containment/3.20_Document_Containment_Actions/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.20_Document_Containment_Actions/#step-1-define-the-documentation-format-preferred-template","title":"Step 1: Define the Documentation Format (Preferred Template)","text":"Date/Time Operator Action Taken Host/System Justification Approval (If Required) 2025-05-02 09:13 L. Jones Disabled malicious service \"strsvc1\" Workstation-014 Service identified running from AppData, persistence attempt Approved by IR Lead <p>Operator Note: Use this format to track every action taken during containment.</p>"},{"location":"3.Containment/3.20_Document_Containment_Actions/#step-2-record-host-based-actions","title":"Step 2: Record Host-Based Actions","text":"<p>Examples of host-level containment actions to document:</p> <ul> <li>Disabled local administrator account on HostX  </li> <li>Renamed and disabled scheduled task on HostY  </li> <li>Removed unauthorized software (e.g., adfind.exe) from HostZ  </li> <li>Blocked external traffic from HostW via firewall</li> </ul>"},{"location":"3.Containment/3.20_Document_Containment_Actions/#step-3-record-network-level-actions","title":"Step 3: Record Network-Level Actions","text":"<p>Examples of network containment actions:</p> <ul> <li>Applied ACL on FirewallX to block external comms from Subnet 10.10.10.0/24  </li> <li>Sinkholed DNS queries for malicious domain <code>abcxyz.bad</code> </li> <li>Disabled VPN access for user \u201csuspiciousUser\u201d</li> </ul>"},{"location":"3.Containment/3.20_Document_Containment_Actions/#step-4-record-account-and-identity-actions","title":"Step 4: Record Account and Identity Actions","text":"<p>Examples of identity containment actions:</p> <ul> <li>Disabled user account <code>jsmith</code> due to confirmed credential compromise  </li> <li>Removed admin rights from <code>hrapp</code> service account temporarily</li> </ul>"},{"location":"3.Containment/3.20_Document_Containment_Actions/#step-5-record-validation-and-review","title":"Step 5: Record Validation and Review","text":"<ul> <li>Validated service disablement on all targeted hosts  </li> <li>Confirmed ACL applied and no external comms observed  </li> <li>Conducted team review and documented containment completion</li> </ul>"},{"location":"3.Containment/3.20_Document_Containment_Actions/#running-script-windows-example-to-export-containment-log","title":"Running Script (Windows Example to Export Containment Log)","text":"<pre><code>$containmentLog = @()\n\n$containmentLog += [PSCustomObject]@{\n    DateTime = Get-Date\n    Operator = \"Leo\"\n    Action = \"Disabled suspicious service strsvc1\"\n    Host = \"Workstation-014\"\n    Justification = \"AppData execution path - possible persistence\"\n    Approval = \"IR Lead\"\n}\n\n$containmentLog | Export-Csv -Path .\\ContainmentLog.csv -NoTypeInformation\n</code></pre> <p>Operator Note: Customize and use PowerShell to automate log capture if preferred.</p>"},{"location":"3.Containment/3.20_Document_Containment_Actions/#dependencies","title":"Dependencies","text":"<ul> <li>Approved documentation location (SharePoint, ticketing system, file share, etc.)  </li> <li>Access to IR actions and relevant logs  </li> <li>Team coordination (approval and review steps)</li> </ul>"},{"location":"3.Containment/3.20_Document_Containment_Actions/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case Markdown (.md) or Text files Cross-platform Quick and portable log format Ticketing Systems (Jira, ServiceNow) Enterprise Official incident recordkeeping SharePoint / OneDrive Enterprise Shared team documentation OneNote / Word Cross-platform IR team notes and logbooks PowerShell Export / Scripts Windows Automated log creation"},{"location":"3.Containment/3.20_Document_Containment_Actions/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.20_Document_Containment_Actions/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Record all containment actions as soon as possible.</li> <li> Use consistent format with date/time, operator, action, host, justification, and approval.</li> <li> Store logs in secure and approved location.</li> <li> Conduct review with IR lead or incident commander.</li> <li> Ensure documentation is complete before moving to eradication phase.</li> </ul>"},{"location":"3.Containment/3.20_Document_Containment_Actions/#best-practices","title":"Best Practices","text":"<ul> <li>Assign a scribe or dedicated recorder during large-scale incidents.</li> <li>Use timestamps and operator initials for traceability.</li> <li>Validate logs against actions recorded in IR ticketing system or command logs.</li> <li>Keep documentation professional and objective (avoid subjective language).</li> </ul>"},{"location":"3.Containment/3.20_Document_Containment_Actions/#references","title":"References","text":"<p>NIST SP 800-61 Rev. 2 - Computer Security Incident Handling Guide US-CERT Incident Handling Guidelines</p>"},{"location":"3.Containment/3.20_Document_Containment_Actions/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for documenting containment actions with format, checklist, and best practices Leo"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/","title":"Finalize Documentation and Transition to Eradication","text":""},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#task-finalize-containment-documentation-and-prepare-for-transition-to-eradication","title":"Task Finalize Containment Documentation and Prepare for Transition to Eradication","text":""},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#conditions","title":"Conditions","text":"<p>Given that containment actions have been completed and validated, the operator will ensure all containment documentation is finalized, verified, and prepared for transition to the eradication phase. This includes ensuring IR stakeholders are aligned and approve progression.</p> <p>Operator Note: This step is the bridge from containment to eradication. Accurate, complete documentation enables clear handoff, prevents gaps in incident response, and supports later lessons learned and reporting.</p>"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#standards","title":"Standards","text":"<ul> <li>Team member consolidates all containment records and documentation.  </li> <li>Team member ensures all containment actions, validations, and outbrief outcomes are fully logged.  </li> <li>Team member reviews and verifies documentation with IR lead and key stakeholders.  </li> <li>Team member updates incident timeline and artifacts in IR management platform or designated repository.  </li> <li>Team member facilitates transition meeting and receives formal approval to move into eradication.</li> </ul>"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#end-state","title":"End State","text":"<p>Containment documentation is finalized and reviewed, and the IR team and stakeholders agree that the incident is ready to move into eradication phase.</p>"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#notes","title":"Notes","text":"<ul> <li>The transition to eradication should never be automatic \u2192 formal sign-off is required.  </li> <li>Documentation should support future forensic analysis, recovery planning, and lessons learned activities.  </li> <li>Proper documentation also supports legal, regulatory, and audit requirements.</li> </ul>"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#step-1-consolidate-containment-documentation","title":"Step 1: Consolidate Containment Documentation","text":"<ul> <li>Collect action logs (scripts, operator notes, ticketing systems)  </li> <li>Include containment outbrief summary  </li> <li>Validate host-based, network-based, identity/account containment records  </li> <li>Collect validation evidence (screenshots, log excerpts, etc.)</li> </ul> <p>Operator Note: Review against containment checklist to ensure completeness.</p>"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#step-2-validate-with-ir-lead-and-stakeholders","title":"Step 2: Validate with IR Lead and Stakeholders","text":"<ul> <li>Review documentation in IR team meeting or async review  </li> <li>Validate that all containment actions are closed or risk-accepted  </li> <li>Obtain sign-off from IR lead or Incident Commander</li> </ul> <pre><code>[ ] Containment actions completed\n[ ] Validation completed\n[ ] Residual risk documented\n[ ] Approved to proceed to eradication\n</code></pre>"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#step-3-update-incident-timeline-and-repository","title":"Step 3: Update Incident Timeline and Repository","text":"<ul> <li>Update central IR tracker or playbook</li> <li>Upload finalized documentation to IR file repository (SharePoint, Confluence, ticketing system, etc.)</li> <li>Update incident timeline and summary document</li> </ul> <pre><code>2025-05-02 1400 - Containment Outbrief complete\n2025-05-02 1600 - Containment validation complete\n2025-05-02 1700 - Approved to begin eradication\n</code></pre>"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#step-4-facilitate-eradication-transition-meeting-optional-but-recommended","title":"Step 4: Facilitate Eradication Transition Meeting (Optional but Recommended)","text":"<p>Recommended attendees:</p> <ul> <li>IR Lead</li> <li>Incident Response Team</li> <li>Enclave/System Owner</li> <li>IT Operations Lead</li> <li>Recovery team lead (if defined)</li> </ul> <p>Recommended Agenda:</p> <ol> <li>Summary of containment actions and success</li> <li>Review of residual risks or exceptions</li> <li>Eradication plan overview and ownership</li> <li>Approval to transition</li> </ol> <p>Operator Note: Document meeting notes and decision in incident record.</p>"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#running-script-powershell-export-final-action-log","title":"Running Script (PowerShell - Export Final Action Log)","text":"<pre><code>$containmentFinal = @()\n\n$containmentFinal += [PSCustomObject]@{\n    Action = \"Block C2 IPs via Firewall ACL\"\n    System = \"Firewall-Edge01\"\n    Operator = \"Leo\"\n    Completed = \"Yes\"\n    Notes = \"No further outbound traffic observed\"\n}\n\n$containmentFinal | Export-Csv -Path .\\FinalContainmentActions.csv -NoTypeInformation\n</code></pre>"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#dependencies","title":"Dependencies","text":"<ul> <li>IR documentation repository (SharePoint, Wiki, Ticketing System)  </li> <li>IR lead and key stakeholders availability  </li> <li>Access to all containment action records  </li> <li>Transition plan for eradication phase</li> </ul>"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Use Case SharePoint / Confluence / Markdown Cross-platform Store finalized documentation Ticketing System (Jira, ServiceNow) Enterprise Track approvals and transitions Email / Teams / Zoom Cross-platform Outbrief and eradication planning PowerShell Windows Scripted export of logs and containment actions"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Consolidate all containment documentation</li> <li> Validate completeness and accuracy with IR team</li> <li> Obtain IR lead or Incident Commander sign-off</li> <li> Update central IR record and timeline</li> <li> Facilitate eradication transition meeting or communication</li> <li> Document transition approval and move to eradication</li> </ul>"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#best-practices","title":"Best Practices","text":"<ul> <li>Do not move to eradication without IR lead sign-off.</li> <li>Ensure all containment gaps or risks are formally recorded and tracked.</li> <li>Prepare eradication team with full context and known issues.</li> <li>Retain containment documentation in IR case files for future lessons learned and reporting.</li> </ul>"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#references","title":"References","text":"<p>NIST SP 800-61 Rev. 2 - Computer Security Incident Handling Guide US-CERT Incident Handling Guidelines</p>"},{"location":"3.Containment/3.21_Finalize_Containment_Documentation/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for finalizing containment documentation and transitioning to eradication Leo"},{"location":"4.Eradication/","title":"4. Eradication","text":""},{"location":"4.Eradication/#task-overview","title":"Task Overview","text":""},{"location":"4.Eradication/#purpose","title":"Purpose","text":"<p>During the eradication phase, the objective is to completely remove attacker presence and restore systems to a clean, trusted state. This phase follows successful containment and ensures that any persistence mechanisms, malware, or residual attacker artifacts are eliminated to prevent re-compromise.</p> <p>Operator Note: Eradication is not just about removing malware \u2014 it requires methodically identifying and eliminating ALL artifacts and attacker footholds across hosts, network infrastructure, accounts, and applications.</p>"},{"location":"4.Eradication/#standards","title":"Standards","text":"<ul> <li>Team members identify and document all attacker-controlled accounts, malware, rootkits, scripts, unauthorized tools, and backdoors.</li> <li>Team members remove malicious or unauthorized software and artifacts from all impacted systems.</li> <li>Team members clean and restore systems to a trusted state when necessary (rebuilds may be required).</li> <li>Team members validate that eradication steps were successful through scanning, host validation, and network monitoring.</li> <li>Team members document all eradication actions in the incident record.</li> <li>Team members receive approval from IR lead before transitioning to recovery.</li> </ul>"},{"location":"4.Eradication/#end-state","title":"End State","text":"<p>All attacker artifacts and malicious access mechanisms have been eliminated. Systems and accounts have been cleaned, validated, and are ready to be transitioned to recovery operations.</p>"},{"location":"4.Eradication/#notes","title":"Notes","text":"<ul> <li>Persistence must be fully eliminated. Missed scheduled tasks, registry keys, rootkits, or user accounts can lead to re-compromise.</li> <li>Rebuild vs Clean Decision: Some systems may need to be rebuilt or reimaged if assurance of cleanliness is not achievable.</li> <li>Document everything: Every eradication action should be logged, including validation results.</li> </ul>"},{"location":"4.Eradication/#eradication-manual-checklist","title":"Eradication Manual Checklist","text":""},{"location":"4.Eradication/#host-level","title":"Host-Level","text":"<ul> <li> Identify and remove malicious software, scripts, and tools.</li> <li> Disable and remove unauthorized user accounts.</li> <li> Remove persistence mechanisms (scheduled tasks, services, registry keys).</li> <li> Confirm system drivers and kernel are clean (anti-rootkit scans).</li> <li> Validate that security software (EDR, antivirus) is functional and up to date.</li> </ul>"},{"location":"4.Eradication/#network-level","title":"Network-Level","text":"<ul> <li> Confirm network indicators (C2, DNS, IPs) are no longer active.</li> <li> Remove temporary containment blocks and rules as appropriate.</li> <li> Verify network segmentation is in place where required.</li> </ul>"},{"location":"4.Eradication/#enterprisedomain-level","title":"Enterprise/Domain-Level","text":"<ul> <li> Remove attacker-created AD objects, accounts, and permissions.</li> <li> Validate GPO, DNS, and enterprise services integrity.</li> <li> Confirm all credentials used during incident are reset or rotated.</li> </ul>"},{"location":"4.Eradication/#recommended-tools-and-usage","title":"Recommended Tools and Usage","text":"Tool Platform Installation Usage Example Sysinternals Suite (Autoruns, Process Explorer) Windows Download from https://learn.microsoft.com/en-us/sysinternals/downloads/ Autoruns.exe \u2192 detect and remove persistence Malwarebytes / ESET / Windows Defender Offline Windows Install from vendor site Full disk scans to remove malware Velociraptor Windows/Linux/Mac Install via https://velociraptor.app/ Query endpoint artifacts (scheduled tasks, processes, registry) PowerShell Windows Built-in <code>Get-ScheduledTask</code>, <code>Remove-Item</code> YARA Cross-platform Install via pip or binary release Scan for malware indicators (<code>yara -r rules.yar /path</code>) ClamAV Linux/Mac <code>apt-get install clamav</code> or <code>brew install clamav</code> <code>clamscan -r /</code> for malware scanning GRR Rapid Response Cross-platform https://github.com/google/grr Enterprise artifact collection and validation <p>Operator Note: Always ensure tools used in eradication are sourced from trusted repositories and validated before use on production hosts.</p>"},{"location":"4.Eradication/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Use layered detection (EDR, AV, manual review) to identify malicious artifacts.</li> <li> Prefer clean removal methods (AV cleaning, tool removal) before considering rebuild.</li> <li> Validate removal by rescanning and checking persistence locations.</li> <li> Document each eradication action performed and validate success.</li> <li> Coordinate closely with IT/system owners during disruptive actions.</li> </ul>"},{"location":"4.Eradication/#best-practices","title":"Best Practices","text":"<ul> <li>Eradication should be carefully planned to avoid unintentional service disruption.</li> <li>Involve IT and system owners in rebuild decisions.</li> <li>Ensure IR team validates success through review and scanning before closing eradication.</li> <li>Do not rush \u2192 incomplete eradication can lead to reinfection.</li> </ul>"},{"location":"4.Eradication/#references","title":"References","text":"<p>NIST SP 800-61 Rev. 2 - Computer Security Incident Handling Guide Sysinternals Suite Velociraptor Incident Response Tool GRR Rapid Response</p>"},{"location":"4.Eradication/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Generated eradication phase introduction and operator guide Leo"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/","title":"Synchronize All Host Clocks","text":""},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#conditions","title":"Conditions","text":"<p>Given a known network configuration, an NTP data source(s), and system owner preferences on time synchronization within their enclave.</p>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#standards","title":"Standards","text":"<ul> <li>Identify or stand up Network Time Protocol (NTP) server.</li> <li>Ensure NTP server is set to synchronize from a known good time source (ex: time.nist.gov).</li> <li>Configure all non-Windows systems to synchronize from the local NTP server.</li> <li>Configure all Windows systems which are not members of a domain to synchronize from the local NTP server.</li> <li>Configure Windows primary domain controller to synchronize from the local NTP server and configure GPO settings for domain.</li> <li>Validate proper synchronization by checking host clocks and confirming drift is within acceptable thresholds (generally &lt; 5 seconds).</li> <li>Document NTP configuration and validation results.</li> </ul>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#end-state","title":"End State","text":"<p>All host clocks in the environment are synchronized from a known good time source, enabling operations and accurate forensic log analysis.</p>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#notes","title":"Notes","text":"<p>Windows domain member systems will automatically synchronize their time based on the primary domain controller (PDC). Best Practices for NTP configuration include filtering the NTP protocol at the firewall and blocking outbound NTP (to prevent being used in a Distributed Denial-of-Service (DDoS) attack).</p>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#windows","title":"Windows","text":"<ul> <li> <p>Check NTP Status: <pre><code>w32tm /query /status\n</code></pre></p> </li> <li> <p>Check NTP Configuration: <pre><code>w32tm /query /configuration\n</code></pre></p> </li> <li> <p>Start NTP Windows: <pre><code>net start w32time\n</code></pre></p> </li> <li> <p>Check NTP server settings in registry: <pre><code>reg QUERY HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Parameters\n</code></pre></p> </li> <li> <p>Check NTP settings in registry: <pre><code>reg QUERY HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\nw32tm /dumpreg\n</code></pre></p> </li> <li> <p>Get Date and Time: <pre><code>Get-Date -F o\n</code></pre></p> </li> <li> <p>Set NTP Server: <pre><code>w32tm /config /manualpeerlist:time.nist.gov /syncfromflags:manual /reliable:yes /update\n</code></pre></p> </li> <li> <p>Restore NTP settings back to default: <pre><code>net stop w32time\nw32tm /unregister\nw32tm /unregister (Yes run twice)\nw32tm /register\nnet start w32time\n</code></pre></p> </li> </ul>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#linux","title":"Linux","text":"<ul> <li> <p>Check synchronized clock status: <pre><code>systemctl status systemd-timesyncd.service\n</code></pre></p> </li> <li> <p>Check NTP Status: <pre><code>timedatectl status\n</code></pre></p> </li> <li> <p>Configure NTP Server selection options: <pre><code>/etc/systemd/timesyncd.conf\n</code></pre></p> </li> <li> <p>Current NTP settings: <pre><code>cat /etc/ntp.conf\n</code></pre></p> </li> <li> <p>Restart NTP service after configuration changes: <pre><code>/etc/init.d/ntp restart\n</code></pre></p> </li> <li> <p>Check NTP synchronized servers: <pre><code>ntpq -p\n</code></pre></p> </li> </ul>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#powershell-quick-validation-script","title":"PowerShell (Quick Validation Script)","text":"<pre><code>$computers = Get-ADComputer -Filter * -SearchBase \"OU=Workstations,DC=example,DC=com\"\n\nforeach ($computer in $computers) {\n    Invoke-Command -ComputerName $computer.Name -ScriptBlock {\n        w32tm /query /status\n    }\n}\n</code></pre> <p>Operator Note: This bulk queries domain-joined systems for NTP status to validate clock sync.</p>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#dependencies","title":"Dependencies","text":"<ul> <li>NTP Server (internal preferred, external (e.g. time.nist.gov) as fallback)</li> <li>Windows Time Service running on hosts</li> <li>NTP client on Linux hosts (ntpd or systemd-timesyncd)</li> <li>Firewall rule exceptions for NTP (UDP/123) if using external time source</li> <li>Administrative privileges on systems to check/set time settings</li> </ul>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage chrony Linux <code>apt install chrony</code> or <code>yum install chrony</code> Lightweight NTP client for Linux. <code>chronyc sources</code> to check sync. Meinberg NTP Windows Download Full-featured NTP daemon for Windows environments. ntpdate Linux (legacy) <code>apt install ntpdate</code> Quick, one-time sync: <code>ntpdate time.nist.gov</code> pool.ntp.org Cross-platform Pre-configured Free distributed NTP service, easy alternative source <p>Operator Note: chrony is recommended over ntpd for modern Linux distributions due to better performance and ease of configuration.</p>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Identify authoritative time source (internal NTP preferred).</li> <li> Validate that Domain Controllers and domain member systems sync properly.</li> <li> Validate that non-domain Windows and Linux hosts sync with correct source.</li> <li> Use group policy or scripts to enforce settings at scale.</li> <li> Validate after configuration using <code>w32tm /query</code> (Windows) or <code>ntpq -p</code> (Linux).</li> <li> Document NTP server used and time sync verification.</li> </ul>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#best-practices","title":"Best Practices","text":"<ul> <li>Prefer internal NTP servers to reduce reliance on internet resources.</li> <li>Harden NTP servers and restrict access to prevent abuse.</li> <li>Validate synchronization regularly \u2192 clock drift can impact log correlation and forensic timeline analysis.</li> <li>Include NTP validation as a post-eradication validation task.</li> </ul>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#references","title":"References","text":"<p>Good information on implementing NTP VMWare info on NTP for Windows Guest operating systems Cisco Best Practices</p>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Original content enhanced with tools, operator recommendations, validation scripts, and checklist Leo"},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/","title":"4.02-Enable Account Usage Auditing","text":""},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#task-enable-account-usage-auditing","title":"Task Enable Account Usage Auditing","text":""},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#conditions","title":"Conditions","text":"<p>Given a user account with necessary rights to modify audit policies and a target computer    </p>"},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#standards","title":"Standards","text":"<ul> <li>Team member enables of the following auditing  </li> <li>Credential validation - Success  </li> <li>Logon events - Success and Failure  </li> <li>Logoff events - Success  </li> <li>Computer account management - Success and Failure etc  </li> <li>Team member checks Windows Security event logs to ensure expected log entries are present        </li> </ul>"},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#end-state","title":"End State","text":"<p>System is configured to log account usage events in support of operational and forensic auditing that are compliant with the system owner's needs and meet regulatory compliance requirements for the enclave.   </p>"},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#notes","title":"Notes","text":"<p>Mission Element lead ought to request this capability of the business owner in order to secure accounts and organizational units  </p>"},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#manual-steps","title":"Manual Steps","text":"<ul> <li> <p>Set log auditing on for success and/or failure on subcategories. This will be for all subcategories   <pre><code>auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable    \nThe command was successfully executed.     \n</code></pre></p> </li> <li> <p>View the available log files, size, and retention limit   <pre><code>Get-EventLog -List\n  Max(K) Retain OverflowAction        Entries Log                                                                              \n  ------ ------ --------------        ------- ---                                                                              \n--snipped--                                                        \n  20,480      0 OverwriteAsNeeded      16,209 Security                                                                         \n  20,480      0 OverwriteAsNeeded       2,722 System                                                                           \n--snipped--\n</code></pre></p> </li> <li> <p>Partial list of Key Security Log Auditing events to monitor   <pre><code>Get-EventLog -Newest 3 -LogName Security \n\n  Index Time          EntryType   Source                 InstanceID Message                                                   \n  ----- ----          ---------   ------                 ---------- -------                                                   \n  407734 Aug 15 10:36  SuccessA... Microsoft-Windows...         4703 A token right was adjusted....                            \n  407733 Aug 15 10:36  SuccessA... Microsoft-Windows...         4703 A token right was adjusted....                            \n  407732 Aug 15 10:36  SuccessA... Microsoft-Windows...         4703 A token right was adjusted....\n</code></pre></p> </li> <li> <p>After running the script, you will see the following output:   <pre><code>--snipped--\n[+] There are 59 categories/subcategories.\n[+] Enabling logs for success and failure for: Security System Extension\n[+] Enabling logs for success and failure for: System Integrity\n--snipped--\n[+] There are 7 available logs:\n    --&gt; Information for Application\n            OverflowAction: OverwriteAsNeeded\n    --&gt; Information for HardwareEvents\n            OverflowAction: OverwriteAsNeeded\n--snipped--\n</code></pre></p> </li> </ul>"},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#references","title":"References","text":"<p>Windows Commands AuditPol </p>"},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/","title":"4.03 Deploy Network Intrusion Detection System (NIDS)","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#task","title":"Task","text":"<p>Deploy Network Intrusion Detection System (NIDS)  </p>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#conditions","title":"Conditions","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#deploy","title":"Deploy","text":"<p>IR Team supporting a mission partner or Guardnet/DoDIN enclave without appropriate Network IDS or IPS installations.  </p>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#evaluate","title":"Evaluate","text":"<p>IR Team supporting a mission partner or Guardnet/DoDIN enclave with access to appropriate systems/capabilities to evaluate existing Network IDS or IPS installations.  </p>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#standards","title":"Standards","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#deploy-in-addition-to-evaluate-below","title":"Deploy (in addition to Evaluate below)","text":"<ul> <li>Assess mission partner or Guardnet/DoDIN enclave networks for placement of IDPS capabilities.</li> <li>Deploy IDPS capabilities where directed.</li> <li>Once deployed, conduct the Evaluate process to assess operational effectiveness.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#identify-and-prepare-detection-systems","title":"Identify and prepare Detection Systems","text":"<ul> <li>Find what systems are available or what is necessary to the mission (likely directed if Unit is not authorized to decide).</li> <li>Identify/Rate strengths and weaknesses of systems.</li> <li>Install necessary programs/systems critical to mission.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#identify-or-obtain-login-credentials","title":"Identify or Obtain login credentials","text":"<ul> <li>Obtain IP path to login.</li> <li>Obtain/create User ID to login.</li> <li>Obtain/create Password (ensure strong password creation).</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#test-accessibility","title":"Test accessibility","text":"<ul> <li>Connect to the system with credentials.</li> <li>Report inconsistencies.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#develop-the-detection-scheme","title":"Develop the detection scheme","text":"<ul> <li>Establish detection plan following evaluation of the network (see Evaluate process below).</li> <li>Re-evaluate and improve detection throughout the mission.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#evaluate-assess-existing-nids","title":"Evaluate (Assess existing NIDS)","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#identify-and-correlate-current-system-to-typical-components-and-network-architectures","title":"Identify and correlate current system to typical components and network architectures","text":"<ul> <li>Build or utilize a Common Operating Picture (COP) for the team.</li> <li>See Figures 4-2 and 4-3 for reference architectures.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#identifylocate-potential-entry-points","title":"Identify/locate potential entry points","text":"<ul> <li>Identify Internet entry points.</li> <li>Identify contained wireless connections.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#identifylocate-choke-points-and-firewalls","title":"Identify/locate choke points and firewalls","text":"<ul> <li>Identify locations where traffic must pass through.</li> <li>Identify firewall control points and protected zones.</li> <li>Grade firewalls based on placement and coverage (per reference figures).</li> <li>Evaluate protection of zones and failure conditions (does loss of Zone A expose Zone B?).</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#identifylocate-current-detection-systems-and-sensors","title":"Identify/locate current detection systems and sensors","text":"<ul> <li>Locate detection systems on the network.</li> <li>Locate installed sensors on systems.</li> <li>Map paths from IR Team entry points to detection systems.</li> <li>Map paths from detection systems to network sensors.</li> <li>Grade sensors based on coverage of choke points and zones.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#identify-full-system-maintenance-schedule","title":"Identify full system maintenance schedule","text":"<ul> <li>Patch schedule for network components (routers, switches).</li> <li>Patch schedule for firewalls.</li> <li>Patch/update schedule for detection systems.</li> <li>Grade frequency and availability of patch/update mechanisms.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#components-and-architecture-for-reference","title":"Components and Architecture (For Reference)","text":"<ul> <li>Typical Components</li> <li>Network Architectures</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#security-capabilities-for-reference","title":"Security Capabilities (For Reference)","text":"<ul> <li>Information Gathering Capabilities</li> <li>Logging Capabilities</li> <li>Detection Capabilities</li> <li>Prevention Capabilities</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#management-for-reference","title":"Management (For Reference)","text":"<ul> <li>Implementation</li> <li>Operation and Maintenance</li> </ul> <p>Operator Note: Consider both Wired and Wireless IDPS capabilities.</p>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#end-state","title":"End State","text":"<ul> <li>NIDS/IDPS deployed or evaluated.</li> <li>Proper placement at critical network chokepoints.</li> <li>Detection capabilities validated.</li> <li>System integrated into monitoring workflows.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#notes","title":"Notes","text":"<ul> <li>NIDS/IDPS should not impact network performance.</li> <li>Sensors should cover ingress/egress and sensitive internal zones.</li> <li>Rules should be tuned to reduce false positives.</li> <li>Consider options for wired and wireless coverage.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#step-1-select-nids-platform-if-deploying","title":"Step 1: Select NIDS Platform (if Deploying)","text":"Tool Platforms Installation Notes Suricata Linux / BSD / Cloud <code>apt install suricata</code> or from source Balanced, high-performance IDS/IPS Zeek Linux / BSD / MacOS <code>apt install zeek</code> or from source Deep inspection and behavior analysis Snort Linux / BSD / Windows <code>apt install snort</code> or from source Mature signature-based detection <p>Operator Recommendation: Suricata is recommended for general purpose detection, while Zeek is excellent for detailed behavioral analysis.</p>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#step-2-plan-sensor-placement","title":"Step 2: Plan Sensor Placement","text":"<ul> <li>Obtain network diagrams or request from mission owner.</li> <li>Identify ingress/egress points, inter-zone choke points, and critical data paths.</li> <li>Plan sensor placement to maximize visibility without oversaturation.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#step-3-install-and-configure-nids","title":"Step 3: Install and Configure NIDS","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#suricata-example","title":"Suricata Example","text":"<pre><code>sudo apt update\nsudo apt install suricata\nsudo suricata-update\nsudo suricata -c /etc/suricata/suricata.yaml -i eth0\n</code></pre>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#zeek-example","title":"Zeek Example","text":"<pre><code>sudo apt update\nsudo apt install zeek\nsudo zeekctl deploy\n</code></pre>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#snort-example","title":"Snort Example","text":"<pre><code>sudo apt update\nsudo apt install snort\nsnort -v -i eth0\n</code></pre> <ul> <li>Configure rulesets (ET Open, Community, or custom mission-specific).</li> <li>Test detection via simulated benign activities (e.g., port scan).</li> <li>Tune rules to environment and mission.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#step-4-validate-accessibility-and-operational-status","title":"Step 4: Validate Accessibility and Operational Status","text":"<ul> <li>Verify SSH or management console access.</li> <li>Confirm alert and log generation.</li> <li>Confirm integration with SIEM or central log collection.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#step-5-implement-and-validate-detection-plan","title":"Step 5: Implement and Validate Detection Plan","text":"<ul> <li>Simulate attacks (port scans, malware downloads, brute-force logins).</li> <li>Confirm alerts trigger appropriately.</li> <li>Adjust and tune based on test results and false positives.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#step-6-establish-update-and-maintenance-process","title":"Step 6: Establish Update and Maintenance Process","text":"<ul> <li>Configure automatic rule updates.</li> </ul> <pre><code>sudo suricata-update\n</code></pre> <ul> <li>Define patch management plan.</li> <li>Schedule periodic detection plan reviews.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#running-script-example-suricata-health-check","title":"Running Script Example (Suricata Health Check)","text":"<pre><code>sudo systemctl status suricata\nsudo tail -f /var/log/suricata/fast.log\n</code></pre>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#dependencies","title":"Dependencies","text":"<ul> <li>Access to the network topology and infrastructure.</li> <li>Agreement and coordination with mission/network owners.</li> <li>Administrative permissions to deploy and maintain NIDS systems.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage pfSense + Snort/Suricata BSD Install via pfSense package manager Embedded NIDS solution Security Onion Linux ISO install Turnkey IDS/SIEM deployment Zeek Linux/MacOS apt or source Network behavior analysis Suricata Linux apt or source High performance IDS/IPS <p>Operator Note: Consider Security Onion for full integrated monitoring when applicable.</p>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Assess/evaluate or deploy NIDS solution.</li> <li> Identify and document network choke points and sensor placement.</li> <li> Install, configure, and validate NIDS operation.</li> <li> Tune and optimize detection for mission relevance.</li> <li> Establish update and maintenance plans.</li> <li> Integrate with enterprise monitoring and incident response workflows.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#best-practices","title":"Best Practices","text":"<ul> <li>Use layered detection (behavioral + signature based).</li> <li>Continuously tune rulesets to reduce false positives.</li> <li>Ensure sensors provide visibility without performance degradation.</li> <li>Plan for failover/redundancy when possible.</li> </ul>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#references","title":"References","text":"<p>Suricata IDS Zeek Network Security Monitor Security Onion NIST SP 800-94 IDPS Guide</p>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.1 Corrected and expanded version to reintegrate original mission planning and evaluation language with operator procedures and tools Leo"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/","title":"4.04 Monitor NIDS and Report Threats","text":""},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#task","title":"Task","text":"<p>Monitor Network Intrusion Detection System (NIDS) and Report Threats</p>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#conditions","title":"Conditions","text":"<p>Given a fully installed NIDS, e.g. Security Onion, connected to a span port or tap that monitors key terrain, an account for the NIDS, a known network topology and list of computers and provided services, and access to a second computer with Internet access for investigation.</p>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#standards","title":"Standards","text":"<ul> <li>Scan anomalies and irregularities within the interface to find possible malicious activity.</li> <li>Investigate suspicious anomalies to make a reasonable determination the NIDS information represents malicious activity.</li> <li>Use other tools (e.g. Zeek, Wireshark, Snort/Suricata) to validate the incident and rule out false positives.</li> <li>Report the incident to the intelligence team and the team leader.</li> <li>Collect all information relevant to the incident for a detailed report.</li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#end-state","title":"End State","text":"<p>After investigating NIDS reports and malicious activity is determined, the intelligence team and team leader are informed. The team leader then informs the network owner of the incident and begins the response process.</p>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#notes","title":"Notes","text":"<ul> <li>Continuous NIDS monitoring is essential during recovery and eradication phases.</li> <li>Focus on anomalies and patterns \u2014 single alerts are often benign, but combinations may be serious.</li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#step-1-login-to-the-nids-interface","title":"Step 1: Login to the NIDS Interface","text":"<ul> <li>Access Security Onion or other NIDS solution.</li> <li>Use secure login credentials.</li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#example-security-onion-web-ui","title":"Example (Security Onion web UI)","text":"<pre><code>https://[security-onion-IP]/app/dashboards\n</code></pre> <ul> <li>Verify that dashboards, alerts, and data are updating properly.</li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#step-2-scan-for-suspicious-activity","title":"Step 2: Scan for Suspicious Activity","text":"<ul> <li>Review dashboards for spikes or anomalies (connection attempts, data exfiltration, lateral movement).</li> <li>Investigate alerts for:</li> <li>Known malware signatures</li> <li>Excessive failed logins</li> <li>Connections to rare or unexpected destinations</li> <li>Abnormal ports and protocols</li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#security-onion-suricata-alert-view","title":"Security Onion (Suricata Alert View)","text":"<pre><code>cat /nsm/suricata/logs/fast.log\n</code></pre>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#zeek-example","title":"Zeek Example","text":"<pre><code>cat /nsm/bro/logs/current/conn.log | grep -i \"malware\"\n</code></pre>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#step-3-investigate-suspicious-events","title":"Step 3: Investigate Suspicious Events","text":"<ul> <li>Cross-check with other tools:</li> <li>Zeek \u2192 Connection logs, DNS queries</li> <li>Wireshark \u2192 PCAP analysis</li> <li>EDR \u2192 Host behavior context</li> <li>Threat Intelligence \u2192 IP/domain reputation</li> </ul> <p>Operator Note: Determine if anomalous behavior is a false positive, benign anomaly, or true malicious event.</p>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#step-4-report-confirmed-or-likely-malicious-activity","title":"Step 4: Report Confirmed or Likely Malicious Activity","text":"<ul> <li>Alert:</li> <li>Intelligence Team</li> <li>Incident Response Team Leader</li> <li>Network Owner (via chain of command)</li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#recommended-reporting-channels","title":"Recommended Reporting Channels","text":"<ul> <li>Create ticket in incident management platform.</li> <li>Email + phone escalation.</li> <li>Log entry into IR event tracker.</li> </ul> <p>Operator Note: Use tactical language in alerts: who, what, when, where, why (suspected).</p>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#step-5-collect-and-document-incident-information","title":"Step 5: Collect and Document Incident Information","text":"<ul> <li>Save NIDS logs (Suricata, Zeek) related to the incident.</li> <li>Capture screenshots of alert dashboards.</li> <li>Record investigation steps taken and outcome.</li> <li>Store in Incident Response shared location for handoff.</li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#running-script","title":"Running Script","text":"<pre><code># Example: Search Zeek for all connections to known bad IP\ngrep \"x.x.x.x\" /nsm/bro/logs/current/conn.log\n</code></pre> <p>Operator Note: Replace \"x.x.x.x\" with IOC or suspicious IP found.</p>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#dependencies","title":"Dependencies","text":"<ul> <li>Security Onion (or equivalent)</li> <li>Zeek (formerly Bro)</li> <li>Suricata / Snort</li> <li>SGUIL / Kibana</li> <li>Network Topology and Key Terrain identification</li> <li>IR Procedures and Escalation Paths</li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Splunk Cross-platform Enterprise or local install Log aggregation and IOC correlation Wireshark Cross-platform Install via package manager Deep packet inspection EDR Platform (CrowdStrike, SentinelOne) Enterprise Installed agent Host behavior and IOC correlation <p>Operator Note: Use layered detection and investigation to improve confidence before escalating.</p>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Log into NIDS platform and verify alerting is operational.</li> <li> Review dashboards and alerts for suspicious behavior.</li> <li> Investigate each suspicious alert using Zeek, Suricata, Wireshark.</li> <li> Determine whether alerts are false positives or true positives.</li> <li> Report true positive incidents to Intel and Team Lead.</li> <li> Collect artifacts and document investigation steps.</li> <li> Prepare handoff documentation for follow-on IR actions.</li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#best-practices","title":"Best Practices","text":"<ul> <li>Set threshold for reporting \u2192 balance between signal and noise.</li> <li>Ensure all IR team members can access NIDS and supporting tools.</li> <li>Regularly review and tune alert thresholds and rulesets.</li> <li>Monitor for evolving threats and new attack techniques.</li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#references","title":"References","text":"<ul> <li>Security Onion Solutions</li> <li>Zeek (formerly Bro)</li> <li>Suricata IDS</li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Corrected and expanded operator version incorporating original standards and detailed investigation steps Leo"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/","title":"4.05 Investigate Alerts from Network SIEM using IDS and Other Logs","text":""},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#task","title":"Task","text":"<p>Investigate Alerts from Network Security Information and Event Management (SIEM) using IDS and other Logs</p>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#conditions","title":"Conditions","text":"<p>Given a fully installed SIEM (e.g., Graylog or similar) configured to accept logs from network hosts, a logon account for the SIEM, and a known network topology.</p>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#standards","title":"Standards","text":"<ul> <li>Logon to the SIEM interface.</li> <li>Scan for potential malicious or abnormal user or system activity, possibly by filtering events by certain category (e.g., logon/logoff of privileged users) to locate abnormal or suspected malicious behavior.</li> <li>Using the reported information (user logon; privilege escalation; source/destination IP addresses, ports; file download information), conduct initial investigative steps to determine if activity can be deemed malicious.</li> <li>If necessary, coordinate with other team members or system owner to determine if the activity is normal.</li> <li>Notify Team Leader of suspected malicious activity and provide detailed information gathered from initial investigative steps.</li> </ul>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#end-state","title":"End State","text":"<p>Suspected abnormal activity reported by SIEM is investigated, determined to be malicious activity and reported to team intel member and Team Lead for further action.</p>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#notes","title":"Notes","text":"<ul> <li>Rarely will an alert displayed by a SIEM be sufficient to determine a course of action for the team.</li> <li>The SIEM operator must correlate reported activity against normal network and host activity often without the time to establish a proper baseline.</li> <li>SIEM activity is only a piece of the puzzle that may lead to establishing the presence of malicious activity on the network.</li> <li>The SIEM operator should be aware of the cyber key terrain including servers, administrator accounts, file storage and database locations that will likely be targeted.</li> <li>If Host-based Intrusion Detection Systems (HIDS) are not being aggregated into the SIEM, the operator must coordinate with Blue Team members and/or system owners to cross-check logs.</li> </ul>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#step-1-log-into-the-siem-platform","title":"Step 1: Log into the SIEM Platform","text":"<ul> <li>Access Graylog, Splunk, Security Onion, or other SIEM via secure connection.</li> </ul>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#example","title":"Example:","text":"<pre><code>https://[SIEM-IP]/login\n</code></pre>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#step-2-search-for-suspicious-alerts","title":"Step 2: Search for Suspicious Alerts","text":"<ul> <li>Use SIEM query capabilities to filter on:</li> <li>Authentication failures</li> <li>Privilege escalations</li> <li>Unusual outbound connections</li> <li>High-volume data transfers</li> <li>Rare process executions</li> </ul>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#graylog-example","title":"Graylog Example:","text":"<pre><code>event_type:\"authentication_failure\" AND user:\"admin\"\n</code></pre>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#splunk-example","title":"Splunk Example:","text":"<pre><code>index=main sourcetype=WinEventLog:Security EventCode=4625\n</code></pre> <p>Operator Tip: Prioritize high-value assets and privileged accounts.</p>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#step-3-investigate-event-context","title":"Step 3: Investigate Event Context","text":"<ul> <li>Gather:</li> <li>Usernames involved</li> <li>Source and destination IP addresses</li> <li>Timestamps</li> <li>Systems involved</li> <li> <p>Actions taken (e.g., login attempts, file downloads)</p> </li> <li> <p>Correlate findings with:</p> </li> <li>IDS alerts (Zeek, Suricata)</li> <li>Host logs (Windows Security Logs, Sysmon)</li> </ul>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#step-4-validate-with-other-data-sources","title":"Step 4: Validate with Other Data Sources","text":"<ul> <li>Cross-check suspicious events:</li> <li>Endpoint Detection and Response (EDR)</li> <li>Firewall logs</li> <li>DNS logs</li> <li> <p>Asset Inventory</p> </li> <li> <p>Determine if activity was:</p> </li> <li>Authorized</li> <li>Misconfiguration</li> <li>Malicious</li> </ul>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#step-5-report-findings","title":"Step 5: Report Findings","text":"<ul> <li>If malicious activity is suspected:</li> <li>Notify the Team Leader.</li> <li>Escalate to Intel Team.</li> <li>Document the alert, investigative steps, and evidence gathered.</li> </ul>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#running-script-example","title":"Running Script Example","text":""},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#quick-graylog-query-for-top-source-ips","title":"Quick Graylog Query for Top Source IPs","text":"<pre><code>source:\"*\" | count by source_ip\n</code></pre>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#splunk-top-talkers-example","title":"Splunk Top Talkers Example","text":"<pre><code>index=main | stats count by src_ip, dest_ip | sort -count\n</code></pre>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#dependencies","title":"Dependencies","text":"<ul> <li>Access to operational SIEM (Graylog, Splunk, Security Onion)</li> <li>Access to complementary data sources (IDS, Firewall, Host logs)</li> <li>List of privileged accounts and key cyber terrain</li> <li>IR escalation path documented</li> </ul>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Graylog Cross-platform Docker or VM install Open-source log aggregation and analysis Splunk Cross-platform Enterprise SIEM with rich query and correlation Security Onion Linux ISO install IDS/IPS/SIEM integration OSQuery Cross-platform Agent install Host-level event correlation and investigation"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Log into SIEM platform and verify log flow.</li> <li> Search for high-risk behaviors using targeted queries.</li> <li> Investigate user, host, and network context for suspicious events.</li> <li> Validate against external sources (IDS, EDR, firewall logs).</li> <li> Report and escalate suspicious findings.</li> <li> Document all investigation and findings thoroughly.</li> </ul>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#best-practices","title":"Best Practices","text":"<ul> <li>Know your environment: high-value assets, privileged users, normal behaviors.</li> <li>Search broadly first, then narrow based on context.</li> <li>Use pivoting \u2014 find additional context for every alert.</li> <li>Always assume SIEM alerts are a starting point, not a conclusion.</li> </ul>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#references","title":"References","text":"<ul> <li>Security Onion Solutions</li> <li>Splunk Enterprise Security</li> <li>SIEM Overview</li> </ul>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Corrected and expanded operator version for SIEM investigations and alert correlation Leo"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/","title":"4.06 Evaluate Host Kernel to Check for Rootkits","text":""},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#task","title":"Task","text":"<p>Evaluate Host Kernel to Check for Rootkits</p>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#conditions","title":"Conditions","text":"<p>Given a suspected compromised Windows desktop computer system, a local administrator account, incident response tools, and one or more Indicators of Compromise (IOCs).</p>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#standards","title":"Standards","text":"<ul> <li>The team member annotates the system name, serial number, manufacturer, and time of action in the Incident Log.</li> <li>The team member inserts media that contains the rootkit detection application.</li> <li>The team member runs the rootkit detection application with the correct parameters and exports the data to the local drive, external USB media, or network share.</li> <li>Note: Removal of the rootkit is not part of this evaluation, only identification.</li> <li>Review screen or tool log file for indicators of the presence of a rootkit against provided IOCs.</li> </ul>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#end-state","title":"End State","text":"<p>Rootkit-related elements are identified.</p>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#notes","title":"Notes","text":"<p>When a rootkit is suspected, there are various considerations for completing this task:</p> <ul> <li>Some rootkits may target removable storage or detection tools themselves.</li> <li>Use caution when introducing tools via USB \u2192 network transfer or remote execution (e.g. PSExec, WinRM) is preferable.</li> <li>Some tools may need to be renamed to avoid detection/blocking by malware.</li> </ul>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#for-linux","title":"For Linux","text":""},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#chkrootkit","title":"Chkrootkit","text":"<ul> <li>Install chkrootkit</li> </ul> <pre><code>sudo apt-get install chkrootkit\n</code></pre> <ul> <li>Run chkrootkit</li> </ul> <pre><code>chkrootkit\n</code></pre> <ul> <li>Investigate any findings</li> </ul> <pre><code>chkrootkit -h\n</code></pre>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#rkhunter","title":"Rkhunter","text":"<ul> <li>Install rkhunter</li> </ul> <pre><code>sudo apt-get install rkhunter\n</code></pre> <ul> <li>Run rkhunter with check mode</li> </ul> <pre><code>rkhunter -c\n</code></pre> <ul> <li>Review log file</li> </ul> <pre><code>cat /var/log/rkhunter.log\n</code></pre> <ul> <li>Investigate any findings.</li> </ul>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#for-windows","title":"For Windows","text":""},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#gmer","title":"GMER","text":"<ul> <li>Download GMER (http://www.gmer.net)</li> <li>Run as Administrator.</li> <li>Allow scan to complete.</li> <li>Review rootkit and hidden process detection results.</li> <li>Save log for incident documentation.</li> </ul>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#tdsskiller","title":"TDSSKiller","text":"<ul> <li>Download TDSSKiller (https://usa.kaspersky.com/downloads/tdsskiller)</li> <li>Run TDSSKiller as Administrator.</li> <li>Select \"Change parameters\" and enable deep scan options.</li> <li>Run scan and review results.</li> <li>Save scan log for records.</li> </ul>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#mcafee-rootkit-remover","title":"McAfee Rootkit Remover","text":"<ul> <li>Download (https://www.mcafee.com/us/downloads/free-tools/rootkitremover.aspx)</li> <li>Run executable and scan system.</li> <li>Review findings and export log.</li> </ul> <p>Operator Note: These tools should be used in Safe Mode or offline when possible to avoid interference from active rootkits.</p>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#for-macos","title":"For macOS","text":""},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#knockknock-objective-see","title":"KnockKnock (Objective-See)","text":"<ul> <li>Download from https://objective-see.org/products/knockknock.html</li> <li>Run application.</li> <li>Review persistent programs and rootkit indicators.</li> </ul>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#dependencies","title":"Dependencies","text":"<ul> <li>Administrative access to system (local admin account or remote access).</li> <li>Incident Response tools (Chkrootkit, Rkhunter, GMER, TDSSKiller, McAfee Rootkit Remover).</li> <li>Secure location for log export and retention.</li> <li>Access to IOC lists for comparison.</li> </ul>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Chkrootkit Linux apt or source Command line scanning Rkhunter Linux apt or source Command line rootkit checks GMER Windows Download Hidden process and rootkit detection TDSSKiller Windows Download Kernel rootkit detection McAfee Rootkit Remover Windows Download Known rootkit removal tool KnockKnock macOS Download Persistent and hidden programs inspection"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Record host information and start time in incident log.</li> <li> Prepare and safely transfer detection tools to target system.</li> <li> Run detection tool based on OS type and capture findings.</li> <li> Investigate and interpret results \u2192 compare against IOCs.</li> <li> Export results to secure location.</li> <li> Report findings to Incident Lead and document results.</li> </ul>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#best-practices","title":"Best Practices","text":"<ul> <li>Avoid USB use on compromised hosts when possible.</li> <li>Perform scans in offline or safe boot environments to avoid interference.</li> <li>Cross-check detection tool findings with forensic images when possible.</li> <li>Retain logs and screenshots for post-incident analysis.</li> </ul>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#references","title":"References","text":"<p>chkrootkit - Linux rkhunter - Linux GMER Windows Defender Offline TDSSKiller - Kaspersky McAfee Rootkit Remover KnockKnock (macOS)</p>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Corrected and expanded operator version incorporating Linux, Windows, macOS and advanced techniques Leo"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/","title":"4.07 Use Host Log Data to Evaluate System Processes","text":""},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#task","title":"Task","text":"<p>Use Host Log Data to Evaluate System Processes for Signs of Malicious Activity</p>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#conditions","title":"Conditions","text":"<p>Given a suspected compromised Windows desktop computer system, local administrator account credentials, one or more Indicators of Compromise (IOCs), and incident response software.</p>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#standards","title":"Standards","text":"<ul> <li>The team member annotates the system name, serial number, manufacturer, and time of action in the Incident Log.</li> <li>The team member logs into or connects remotely using administrator privileges.</li> <li>The team member obtains an image of the target computer's physical memory.</li> <li>The team member calculates cryptographic hashes (MD5 or SHA1) of the memory image.</li> <li>The team member gathers file hashes of all files on the system.</li> <li> <p>The team member uses incident response software to collect the following:</p> </li> <li> <p>System date/time and timezone</p> </li> <li>Operating system version and service pack</li> <li>RAM size</li> <li>Disk and filesystem details</li> <li>USB connection history</li> <li>Autorun software</li> <li>Services and status</li> <li>Installed software</li> <li>Scheduled tasks</li> <li>User accounts and groups</li> <li>Network interfaces, routing table, ARP cache, DNS cache</li> <li>Network connections (with associated processes)</li> <li>Loaded drivers</li> <li>Open files and handles</li> <li>Running processes and PID info</li> <li>Windows event logs</li> <li> <p>Antivirus/HIDS/Firewall logs</p> </li> <li> <p>The team member reviews logs for matches to IOCs.</p> </li> </ul>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#end-state","title":"End State","text":"<p>Log and text file entries are found and correlated to potential malicious behavior or known IOCs.</p>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#notes","title":"Notes","text":"<ul> <li>Host log and process data is essential for detecting rootkits, malware persistence, and lateral movement.</li> <li>Cross-reference logs with threat intelligence and previously discovered IOCs.</li> <li>Coordinate with system owners and IR lead before aggressive forensic analysis on production systems.</li> </ul>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#step-1-prepare-collection-tools","title":"Step 1: Prepare Collection Tools","text":"<ul> <li>Preferred IR Tools (Windows):</li> <li>Sysinternals Suite (Autoruns, PsList, Handle, TCPView)</li> <li>Velociraptor</li> <li> <p>PowerShell</p> </li> <li> <p>Preferred IR Tools (Linux/macOS):</p> </li> <li>lsof</li> <li>netstat / ss</li> <li>ps aux</li> <li>OSQuery</li> </ul>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#step-2-collect-system-process-and-host-information","title":"Step 2: Collect System Process and Host Information","text":""},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#windows-powershell-examples","title":"Windows (PowerShell examples)","text":"<pre><code># List running processes with PID, username and command line\nGet-WmiObject Win32_Process | Select-Object Name, ProcessId, CommandLine\n\n# List network connections with process info\nGet-NetTCPConnection | Select-Object LocalAddress, LocalPort, RemoteAddress, State, OwningProcess\n\n# List auto-start locations\nGet-ItemProperty -Path \"HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\"\n\n# List scheduled tasks\nGet-ScheduledTask | Select-Object TaskName, State\n</code></pre>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#linuxmacos","title":"Linux/macOS","text":"<pre><code># List running processes\nps aux\n\n# List network connections\nss -tulnp\n\n# List open files and network\nlsof -i\n\n# List autoruns (Linux example: cron jobs)\ncrontab -l\n</code></pre>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#step-3-collect-and-analyze-windows-event-logs","title":"Step 3: Collect and Analyze Windows Event Logs","text":"<pre><code># Export event logs\nwevtutil epl Security Security.evtx\nwevtutil epl System System.evtx\nwevtutil epl Application Application.evtx\n\n# Display failed logons\nGet-WinEvent -FilterHashtable @{LogName='Security';ID=4625} | Format-List\n</code></pre>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#step-4-collect-additional-metadata","title":"Step 4: Collect Additional Metadata","text":"<ul> <li>USB history \u2192 Registry or forensic tool (USBDeview or Velociraptor)</li> <li>Installed software \u2192 WMIC or PowerShell</li> <li>Drivers and loaded kernel modules \u2192 PowerShell or Autoruns</li> </ul>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#step-5-cross-reference-collected-data-with-iocs","title":"Step 5: Cross-reference Collected Data with IOCs","text":"<ul> <li>Use IOC list provided (hashes, domain names, IPs, filenames)</li> <li>Search logs and data for presence of any matches</li> <li>Flag any suspicious entries for escalation</li> </ul>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#step-6-save-and-export-findings","title":"Step 6: Save and Export Findings","text":"<ul> <li>Export collected data and analysis to secure storage (USB, IR share).</li> <li>Document findings in IR Case Management or Incident Log.</li> </ul>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#running-script-example-automated-collection","title":"Running Script Example (Automated Collection)","text":"<pre><code># Simple PowerShell collection script\nGet-Process | Out-File C:\\IR\\process_list.txt\nGet-NetTCPConnection | Out-File C:\\IR\\network_connections.txt\nGet-ScheduledTask | Out-File C:\\IR\\scheduled_tasks.txt\nGet-WinEvent -LogName Security -MaxEvents 1000 | Out-File C:\\IR\\security_events.txt\n</code></pre> <p>Operator Note: Use IR Collection Frameworks like Velociraptor for automated and scalable host data acquisition when available.</p>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#dependencies","title":"Dependencies","text":"<ul> <li>Local admin or elevated access on host</li> <li>Access to IOC lists</li> <li>Storage location for data export</li> <li>IR data collection toolkit</li> </ul>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Sysinternals Suite Windows Download Comprehensive host analysis Velociraptor Cross-platform Deploy agent Enterprise-scale host forensics OSQuery Cross-platform Install agent SQL-based query of host data PowerShell Windows Built-in Scripting and host interrogation lsof, ps, netstat Linux/macOS Built-in Process and network analysis"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Record system details and annotate in incident log.</li> <li> Collect process and network information.</li> <li> Collect autoruns, scheduled tasks, and startup programs.</li> <li> Collect event logs and scan for security-relevant entries.</li> <li> Cross-reference findings against IOCs.</li> <li> Document findings and export artifacts securely.</li> </ul>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#best-practices","title":"Best Practices","text":"<ul> <li>Automate collection where possible to reduce human error.</li> <li>Validate findings with threat intelligence team.</li> <li>Maintain chain of custody for collected forensic artifacts.</li> <li>Use standardized naming and file structure when exporting logs and analysis.</li> </ul>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#references","title":"References","text":"<ul> <li>Sysinternals Tools</li> <li>Velociraptor</li> <li>PowerShell Documentation</li> <li>OSQuery</li> </ul>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Corrected and expanded operator version with deep host process analysis guidance Leo"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/","title":"4.08 Deploy or Evaluate Host Sensors","text":""},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#task","title":"Task","text":"<p>Deploy or Evaluate Host Sensors (Prepare Security Onion to listen for Wazuh agents on the network)</p>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#conditions","title":"Conditions","text":"<p>Given access to a network and the ability to install and configure Security Onion.</p>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#standards","title":"Standards","text":"<ul> <li>Prepare Security Onion to listen for and receive Sysmon logs through deployed Wazuh agents.</li> <li>Configure Wazuh agents to forward local Sysmon logs on compromised hosts to Security Onion NIDS.</li> <li>Validate connectivity and log ingestion from all deployed Wazuh agents.</li> </ul>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#end-state","title":"End State","text":"<p>Hosts on the compromised network utilize Wazuh to forward Sysmon and event logs to Security Onion NIDS for parsing in Kibana.</p>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#notes","title":"Notes","text":"<ul> <li>Always validate that logs are being ingested after configuration.</li> <li>Ensure system clocks on hosts and Security Onion are synchronized to avoid log correlation issues.</li> <li>Use the correct version of Wazuh agent compatible with the Security Onion deployment version.</li> </ul>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#set-up","title":"Set Up","text":"<ul> <li>Security Onion Host (Linux - NIDS): This is the Security Onion box that we bring to the environment.</li> <li>Windows Workstations: These are the client hosts at the incident site which will be monitored.</li> </ul>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#configure-security-onion-to-receive-logs","title":"Configure Security Onion to Receive Logs","text":"<p>On the Security Onion system, log into the local system. Open two Terminal windows, further referred to as Terminal A and Terminal B.</p>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#terminal-a-stop-wazuh-temporarily","title":"Terminal A: Stop Wazuh temporarily","text":"<pre><code>sudo so-wazuh-stop\n</code></pre>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#terminal-b-run-ossec-authd-to-listen-for-agent-connections","title":"Terminal B: Run ossec-authd to listen for agent connections","text":"<pre><code>sudo /var/ossec/bin/ossec-authd -f\n</code></pre>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#terminal-a-restart-wazuh-service-after-enabling-agent-authentication","title":"Terminal A: Restart Wazuh service after enabling agent authentication","text":"<pre><code>sudo so-wazuh-start\n</code></pre> <p>Operator Note: ossec-authd running in foreground allows new agents to authenticate and register.</p>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#install-software-on-windows-hosts","title":"Install Software on Windows Hosts","text":"<ul> <li>The repository comes with all necessary files for deployment, but it is preferable to download the Wazuh agent directly from the currently deployed Security Onion system during the mission to ensure compatibility.</li> <li>Login to Security Onion, select Downloads from the menu on the left, and download the Wazuh agent for Windows. </li> <li>Once downloaded, right-click the installer \u2192 select Properties \u2192 check <code>Unblock</code> and apply the changes.</li> </ul>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#modify-configuration-files-on-windows-host","title":"Modify Configuration Files on Windows Host","text":""},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#edit-install-sysmonbat","title":"Edit <code>install-sysmon.bat</code>","text":"<ul> <li>Update the IP address inside this batch file to reflect your deployed Security Onion's IP address.</li> </ul>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#edit-ossecconf","title":"Edit <code>ossec.conf</code>","text":"<ul> <li>Update the <code>&lt;server&gt;</code> section in <code>ossec.conf</code> with the Security Onion sensor's IP address.</li> </ul> <p>Operator Note: Ensuring proper IP addressing here is critical for logs to reach Security Onion.</p>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#running-powershell-script-on-windows-hosts","title":"Running PowerShell Script on Windows Hosts","text":"<ul> <li>Execute the PowerShell deployment script:</li> </ul> <pre><code>scripts\\Software_Push.ps1\n</code></pre> <ul> <li>Input domain credentials and install parameters when prompted:</li> <li>User: Administrator@domain.name</li> <li>IP Address: The IP address of the system running the script.</li> <li>Domain Admin Password: Enter domain admin credentials.</li> <li> <p>Domain: The AD domain name.</p> </li> <li> <p>Click <code>Run</code> to allow PsExec to execute and deploy Sysmon and Wazuh agent to target host(s).</p> </li> </ul> <p></p> <p>Operator Note: Ensure PsExec is not blocked by local AV or endpoint protections. You may need to whitelist or run from administrative CMD or PowerShell with proper execution policies enabled.</p>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#listing-wazuh-agents-validation","title":"Listing Wazuh Agents (Validation)","text":"<p>After deployment, return to Security Onion to verify agents are reporting properly:</p> <pre><code>so-wazuh-agent-manage\n</code></pre> <ul> <li>Ensure all deployed agents appear in the list.</li> <li>Check agent status (should be active/connected).</li> <li>Validate log ingestion in Kibana or via log file review.</li> </ul> <p>Operator Note: Any agents not reporting may need to be reconfigured or network connectivity validated (firewall, DNS resolution).</p>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#dependencies","title":"Dependencies","text":"<ul> <li>Security Onion NIDS properly installed and configured.</li> <li>Privileged access to target hosts on network.</li> <li>Properly staged install packages for Wazuh and Sysmon.</li> <li>Domain admin or equivalent credentials for host deployment.</li> <li>PsExec or PowerShell Remoting enabled on target hosts.</li> </ul>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#other-available-tools","title":"Other Available Tools","text":"<ul> <li>OSSEC (as a lightweight alternative to Wazuh if necessary)</li> <li>Velociraptor (for more advanced host telemetry and collection)</li> <li>Winlogbeat (to forward Windows event logs directly to ELK/Security Onion if needed)</li> </ul>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Verify Security Onion is configured to accept new Wazuh agents.</li> <li> Download Wazuh agent from Security Onion Downloads page.</li> <li> Unblock and prepare agent installer on each host.</li> <li> Edit <code>install-sysmon.bat</code> and <code>ossec.conf</code> with correct IP addressing.</li> <li> Run <code>Software_Push.ps1</code> to deploy Sysmon and Wazuh agent.</li> <li> Confirm agent connection and log ingestion via <code>so-wazuh-agent-manage</code>.</li> <li> Validate event logs and Sysmon data are viewable in Kibana or Elastic.</li> </ul>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#best-practices","title":"Best Practices","text":"<ul> <li>Prefer agent download from deployed Security Onion \u2192 ensures compatibility.</li> <li>Validate log ingestion before moving on \u2192 missing logs = reduced visibility.</li> <li>Deploy during low-use hours when possible \u2192 reduces impact on production systems.</li> <li>Maintain version control of scripts and configs \u2192 easier troubleshooting later.</li> </ul>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#references","title":"References","text":"<p>Installing Wazuh Wazuh (Security Onion)</p>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully corrected and expanded version preserving original + expanded operator guidance with screenshots Leo"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/","title":"4.09.2 Configure Security Onion Syslog Server","text":""},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#task","title":"Task","text":"<p>Configure Security Onion to act as a Syslog server and ingest logs from external devices such as firewalls, switches, routers, and servers.</p>"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#conditions","title":"Conditions","text":"<p>Given an operational Security Onion deployment and external network devices capable of sending syslog events.</p>"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#standards","title":"Standards","text":"<ul> <li>Configure Security Onion syslog-ng to accept logs from the network.</li> <li>Create and manage firewall rules to permit syslog traffic (UDP/514 or TCP/514).</li> <li>Verify log ingestion and visibility in Kibana.</li> <li>Maintain logs according to retention and security best practices.</li> </ul>"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#end-state","title":"End State","text":"<p>Security Onion receives syslog messages from external sources and logs are searchable in Kibana for analysis.</p>"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#notes","title":"Notes","text":"<ul> <li>UDP/514 is standard but unreliable \u2192 consider TCP/514 if supported for critical logs.</li> <li>Source devices must be able to resolve Security Onion hostname or IP.</li> <li>Proper timezone and timestamp settings on source devices are critical for log correlation.</li> </ul>"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#step-1-validate-syslog-ng-is-running","title":"Step 1: Validate syslog-ng is running","text":"<p>Security Onion uses syslog-ng as its syslog receiver by default.</p> <p>Check syslog-ng service status:</p> <pre><code>sudo so-status\n</code></pre> <p>You should see:</p> <pre><code>[+] syslog-ng................. running\n</code></pre> <p>If not running:</p> <pre><code>sudo so-sensor-restart\n</code></pre>"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#step-2-configure-firewall-access","title":"Step 2: Configure Firewall Access","text":"<p>By default, Security Onion blocks incoming syslog from external networks.</p> <p>Allow specific networks or hosts to send syslog using <code>so-allow</code>:</p> <pre><code>sudo so-allow\n</code></pre> <p>Select Custom when prompted, and allow UDP/514 or TCP/514 from desired source IPs/subnets.</p> <p>Example:</p> <pre><code>Allowed CIDR \u2192 192.168.1.0/24\nProtocol \u2192 UDP\nPort \u2192 514\n</code></pre> <p>Operator Note: Always restrict allowed networks \u2014 never leave open to entire Internet.</p>"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#step-3-configure-source-devices","title":"Step 3: Configure Source Devices","text":"<p>On each external device (e.g. Palo Alto Firewall, Cisco Switch, Linux Server):</p> <ul> <li>Set Syslog Server IP \u2192 Security Onion management interface IP</li> <li>Set Port \u2192 514</li> <li>Set Protocol \u2192 UDP or TCP (UDP is default but TCP is preferred for reliability)</li> <li>Set Facility and Severity \u2192 Usually default settings (or informational/notice)</li> </ul> <p>Example (Linux server):</p> <pre><code>logger -n 192.168.1.10 -P 514 -d \"Test syslog message to Security Onion\"\n</code></pre>"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#step-4-validate-log-receipt","title":"Step 4: Validate Log Receipt","text":"<p>Logs sent to syslog-ng are stored locally before forwarding to Elastic stack.</p> <p>Check raw syslog data:</p> <pre><code>sudo tail -f /nsm/sensor_logs/syslog-ng/syslog-ng.log\n</code></pre> <p>Operator Note: If logs do not appear \u2192 verify network connectivity, firewall rules, and source configuration.</p>"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#step-5-validate-log-ingestion-in-kibana","title":"Step 5: Validate Log Ingestion in Kibana","text":"<ul> <li>Open Security Onion Web Interface</li> <li>Navigate to Kibana</li> <li>Select relevant index (ex: <code>logstash-*</code> or <code>syslog-*</code>)</li> <li>Search for your test message or source IP.</li> </ul> <p>Example search:</p> <pre><code>message:\"Test syslog message to Security Onion\"\n</code></pre> <p>You should see your log displayed.</p> <p>Operator Note: Timestamp and source IP should match sender \u2192 review parsing and timezone if discrepancies exist.</p>"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#dependencies","title":"Dependencies","text":"<ul> <li>Security Onion operational and accessible</li> <li>syslog-ng running</li> <li>External devices configured to send syslog</li> <li>Firewall rules allowing syslog traffic to Security Onion</li> </ul>"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage syslog-ng Built-in (Security Onion) Native Syslog reception and processing Kibana Web UI Native Searching and analyzing logs logger (Linux) Built-in Generate test syslog events"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Confirm syslog-ng is running on Security Onion.</li> <li> Open firewall using <code>so-allow</code> for source IPs and port 514.</li> <li> Configure external devices to forward syslog to Security Onion.</li> <li> Validate receipt using syslog-ng.log.</li> <li> Confirm logs are searchable in Kibana.</li> </ul>"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#best-practices","title":"Best Practices","text":"<ul> <li>Use TCP syslog when possible \u2192 improves reliability.</li> <li>Use meaningful hostname/identifiers on source devices \u2192 improves search and correlation.</li> <li>Document allowed networks in <code>so-allow</code> to ensure security posture.</li> <li>Monitor log volume \u2192 syslog can generate heavy traffic and consume disk space.</li> </ul>"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#references","title":"References","text":"<ul> <li>Security Onion Syslog</li> <li>Syslog-ng Documentation</li> </ul>"},{"location":"4.Eradication/4.09.02_Configure_SO_Syslog_Server/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with detailed operator guidance and configuration validation steps Leo"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/","title":"4.09.1 Configure Snort Rules","text":""},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#task","title":"Task","text":"<p>Configure Snort IDS Rules on Security Onion to detect and alert on network-based malicious activity.</p>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#conditions","title":"Conditions","text":"<p>Given access to a deployed Security Onion instance running Snort as its detection engine.</p>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#standards","title":"Standards","text":"<ul> <li>The operator must be able to locate and manage Snort rule sets.</li> <li>The operator should understand how to add, modify, and enable Snort rules.</li> <li>The operator will verify that new or modified rules are active and generating alerts on relevant traffic.</li> </ul>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#end-state","title":"End State","text":"<p>Snort rules are correctly configured, loaded, and active. Security Onion is generating alerts based on rule matches.</p>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#notes","title":"Notes","text":"<ul> <li>Security Onion automatically manages Snort rule updates and configurations. However, custom rules can and should be added when necessary.</li> <li>Rules can be used to detect specific Indicators of Compromise (IOCs) or network behaviors.</li> <li>Testing and tuning are critical \u2014 poorly written rules can result in false positives or missed detections.</li> </ul>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#step-1-access-security-onion","title":"Step 1: Access Security Onion","text":"<ul> <li>Log into Security Onion terminal with administrative privileges.</li> </ul> <pre><code>ssh analyst@securityonion.local\n</code></pre>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#step-2-locate-local-rules-file","title":"Step 2: Locate Local Rules File","text":"<ul> <li>Navigate to the local rules directory.</li> </ul> <pre><code>cd /opt/so/rules/nids/\nls -al\n</code></pre> <ul> <li>Look for <code>local.rules</code>. This is where custom rules should be placed.</li> </ul> <p>Operator Note: Always document changes to local.rules. Use comments (<code>#</code>) to record date and purpose.</p>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#step-3-add-custom-rule","title":"Step 3: Add Custom Rule","text":"<ul> <li>Open <code>local.rules</code> in nano or vim.</li> </ul> <pre><code>sudo nano local.rules\n</code></pre> <ul> <li>Example custom rule to detect outbound HTTP traffic to suspicious domain:</li> </ul> <pre><code>alert tcp any any -&gt; any 80 (msg:\"Suspicious HTTP domain access detected\"; content:\"badactor.com\"; http_host; sid:1000001; rev:1;)\n</code></pre> <p>Operator Note: <code>sid</code> (Snort ID) for local rules should start at 1000000+ to avoid overlap with community rules.</p> <ul> <li>Save the file after adding the rule.</li> </ul>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#step-4-validate-snort-configuration","title":"Step 4: Validate Snort Configuration","text":"<ul> <li>Check for syntax errors before reloading Snort.</li> </ul> <pre><code>sudo so-rulecheck\n</code></pre> <ul> <li>No errors should be reported. If errors are found, edit <code>local.rules</code> and fix them.</li> </ul>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#step-5-reload-snort-rules","title":"Step 5: Reload Snort Rules","text":"<ul> <li>To load new rules without rebooting:</li> </ul> <pre><code>sudo so-rule-update\n</code></pre> <ul> <li>This will process the <code>local.rules</code> file and apply the changes.</li> </ul> <p>Operator Note: Monitor <code>/opt/so/logs/snort</code> to verify Snort reload occurred successfully.</p>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#step-6-test-the-new-rule","title":"Step 6: Test the New Rule","text":"<ul> <li>Generate traffic matching your rule (e.g., access <code>badactor.com</code> from internal network).</li> <li>Open Security Onion\u2019s Kibana interface and search for alerts.</li> </ul> <pre><code>msg:\"Suspicious HTTP domain access detected\"\n</code></pre> <ul> <li>Verify your rule triggered.</li> </ul>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#step-7-tune-and-refine-rule-as-needed","title":"Step 7: Tune and Refine Rule as Needed","text":"<ul> <li>Adjust <code>content</code>, <code>pcre</code>, and other Snort options to reduce false positives.</li> <li>Use additional rule options such as <code>flow</code>, <code>depth</code>, <code>offset</code> for precision.</li> </ul>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#dependencies","title":"Dependencies","text":"<ul> <li>Security Onion deployed and configured with Snort as IDS.</li> <li>Analyst or administrator level access.</li> <li>List of relevant IOCs or detection criteria.</li> </ul>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Snort Security Onion / Linux Built-in IDS engine PulledPork (optional) Linux Manual install Automatically update community rules Suricata (if deployed) Security Onion / Linux Built-in alt. to Snort May use similar rule syntax"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate Snort is installed and running.</li> <li> Edit <code>local.rules</code> to add custom rules.</li> <li> Validate rules using <code>so-rulecheck</code>.</li> <li> Reload rules with <code>so-rule-update</code>.</li> <li> Test rules and verify alerts in Kibana.</li> <li> Tune rule for accuracy.</li> </ul>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#best-practices","title":"Best Practices","text":"<ul> <li>Use meaningful <code>msg</code> fields for easier triage.</li> <li>Start SID numbers for local rules at <code>1000000+</code>.</li> <li>Avoid overly broad content matches \u2192 they will create alert fatigue.</li> <li>Regularly review and prune local.rules \u2192 stale rules increase resource usage.</li> </ul>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#references","title":"References","text":"<ul> <li>Security Onion Snort Documentation</li> <li>Snort Rule Writing Guide</li> </ul>"},{"location":"4.Eradication/4.09.1_Configure_Snort_Rules/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with detailed operator-level guidance and examples Leo"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/","title":"4.09.3 Evaluate Network Baseline (Upgraded)","text":""},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#task","title":"Task","text":"<p>Evaluate and establish a baseline of normal network activity and detect deviations that may indicate malicious behaviors such as lateral movement, beaconing, exfiltration, or command and control (C2) activity.</p>"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#conditions","title":"Conditions","text":"<p>Given access to Security Onion, Zeek logs, Suricata alerts, full packet capture (PCAP), and knowledge of the environment\u2019s expected network layout and mission roles.</p>"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#standards","title":"Standards","text":"<ul> <li>Collect and analyze representative data to understand \"normal\" network traffic.</li> <li>Document common ports, protocols, hosts, destinations, and communication patterns.</li> <li>Identify deviations or anomalies that do not fit into the established baseline.</li> <li>Validate anomalies against threat intelligence and Indicators of Compromise (IOCs).</li> </ul>"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#end-state","title":"End State","text":"<p>A network baseline is documented and deviations from normal behavior are identified and tagged for escalation or eradication actions.</p>"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#notes","title":"Notes","text":"<ul> <li>Baselining allows identification of stealthy and advanced techniques which may not trigger signature-based alerts.</li> <li>Expect some unknown or ambiguous traffic \u2014 anomalies are not always malicious but must be explained.</li> </ul>"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#step-1-review-available-network-telemetry","title":"Step 1: Review Available Network Telemetry","text":"<p>Confirm which telemetry sources are active on Security Onion:</p> <pre><code>sudo so-status\n</code></pre> <ul> <li>Zeek \u2192 Metadata of every connection (conn.log), DNS, SSL/TLS, HTTP, files.</li> <li>Suricata \u2192 IDS/IPS alerts (snort-like signature matches).</li> <li>Stenographer (PCAP) \u2192 Full packet capture.</li> <li>Elastic/Kibana \u2192 Easy searching and visualization.</li> </ul> <p>Operator Note: If Zeek is down, restart sensors before proceeding. Zeek is critical for establishing the baseline.</p>"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#step-2-capture-and-identify-normal-network-behavior","title":"Step 2: Capture and Identify \"Normal\" Network Behavior","text":""},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#focus-areas","title":"Focus Areas","text":"Area What to Baseline Why Internal to Internal AD, DNS, SMB, RDP, File Shares Identify lateral movement pathways Internal to External Web, Email, VPN Identify normal business flows Inbound VPN, Reverse Proxies Ensure only expected services are exposed Outbound to Unusual Destinations Rare external IPs/Domains Potential C2 or data exfiltration"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#example-kibana-queries","title":"Example Kibana Queries:","text":"<ul> <li>Find top talkers:</li> </ul> <pre><code>event.dataset:zeek.conn AND network.direction:\"outbound\"\n</code></pre> <ul> <li>Find DNS queries:</li> </ul> <pre><code>event.dataset:zeek.dns\n</code></pre> <ul> <li>Find SSL connections (encrypted sessions):</li> </ul> <pre><code>event.dataset:zeek.ssl\n</code></pre> <p>Operator Note: Record observed legitimate hosts and expected domains (office365.com, google.com, internal NTP servers).</p>"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#step-3-identify-and-document-normal-services-and-ports","title":"Step 3: Identify and Document Normal Services and Ports","text":"<p>Using Zeek conn logs:</p> <pre><code>zcat /nsm/zeek/logs/current/conn.log.gz | zeek-cut id.orig_h id.resp_h id.resp_p service\n</code></pre> <p>Example results:</p> <pre><code>192.168.1.10 192.168.1.1 53 dns\n192.168.1.10 192.168.1.5 445 smb\n192.168.1.10 8.8.8.8 443 ssl\n</code></pre> <p>Document in table format:</p> Source IP Dest IP Port Service Notes 192.168.1.10 192.168.1.5 445 SMB Normal domain traffic 192.168.1.10 8.8.8.8 443 SSL Expected web traffic"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#step-4-identify-abnormal-patterns-and-ioc-signals","title":"Step 4: Identify Abnormal Patterns and IOC Signals","text":""},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#ioc-and-suspicious-signals-to-search-for","title":"IOC and Suspicious Signals to Search For","text":"Indicator Type How to Find Example IOC Beaconing Behavior Zeek conn logs \u2192 periodic, regular intervals conn.log \u2192 Check duration/intervals External Connections to Rare IPs Zeek conn logs + threat feeds IP addresses \u2192 known malicious IPs DNS Tunneling Zeek dns.log \u2192 very long query names suspicious.domain.exfil.data.com Non-standard Ports Zeek conn.log \u2192 high or unexpected ports RDP (3389) \u2192 from internal clients SMB/LDAP Lateral Movement Zeek smb.log or conn.log \u2192 host-to-host SMB traffic Multiple internal hosts communicating unexpectedly Cleartext Credentials Zeek http.log, Suricata alerts HTTP login forms over port 80 Unusual User-Agent Strings Zeek http.log Custom User-Agent indicating tool-based C2 <p>Operator Note: Use correlation and time-series views in Kibana to look for repeat patterns or relationships between hosts.</p>"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#step-5-validate-with-network-owners-and-documentation","title":"Step 5: Validate with Network Owners and Documentation","text":"<ul> <li>Confirm suspicious findings with network administrators or asset owners.</li> <li>Update baseline with verified \"normal\" activity.</li> <li>Flag unresolved anomalies for IR escalation.</li> </ul> <p>Operator Note: Always ask \u2192 many false positives can be ruled out by simple questions to owners.</p>"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#dependencies","title":"Dependencies","text":"<ul> <li>Security Onion sensors functioning (Zeek, Suricata, PCAP).</li> <li>Access to Kibana and/or CLI for log review.</li> <li>Understanding of network architecture and mission profile.</li> <li>Access to threat intelligence (MISP, commercial feeds, open-source feeds).</li> </ul>"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Zeek Built-in (Security Onion) Native Network metadata analysis Wireshark Cross-platform Package manager PCAP analysis ELK / Kibana Built-in (Security Onion) Native Search and visualization Threat Intelligence Feeds External N/A IOC correlation"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate all telemetry sources are operational.</li> <li> Collect normal traffic data from Zeek logs and PCAP.</li> <li> Document internal, outbound, and inbound traffic patterns.</li> <li> Identify anomalies \u2192 beaconing, rare destinations, unusual ports.</li> <li> Validate anomalies with owners or mission lead.</li> <li> Update baseline documentation.</li> </ul>"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#best-practices","title":"Best Practices","text":"<ul> <li>Use time-based views \u2192 stealthy C2 beaconing may only show over long periods.</li> <li>Use threat intel enrichments where possible \u2192 known bad IPs/domains can highlight hidden threats.</li> <li>Build simple playbooks for common protocols \u2192 know what SMB, DNS, SSL normally look like.</li> </ul>"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#references","title":"References","text":"<ul> <li>Zeek Documentation</li> <li>Security Onion Docs</li> <li>Wireshark Display Filter Reference</li> </ul>"},{"location":"4.Eradication/4.09.3_Evaluate_Network_Baseline/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 2.0 Fully expanded version with IOCs, examples, and deep operator context Leo"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/","title":"4.09.5 Evaluate Host Activity Baseline","text":""},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#task","title":"Task","text":"<p>Evaluate and establish a baseline of host activity to identify abnormal processes, services, user behavior, and persistence mechanisms on potentially compromised systems.</p>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#conditions","title":"Conditions","text":"<p>Given access to hosts across Windows, Linux, and macOS platforms and appropriate local or remote administrative privileges.</p>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#standards","title":"Standards","text":"<ul> <li>Collect representative data of running processes, services, network connections, and user activity.</li> <li>Document \"normal\" host behavior.</li> <li>Identify deviations or anomalies that may indicate malware, persistence, lateral movement, or exfiltration.</li> <li>Validate findings with system owners and mission requirements.</li> </ul>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#end-state","title":"End State","text":"<p>A documented host activity baseline exists, allowing rapid detection of anomalies and informing eradication and recovery plans.</p>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#notes","title":"Notes","text":"<ul> <li>Host baselining is critical when visibility is limited or during targeted attacks.</li> <li>\"Normal\" may vary based on host role \u2192 understand the mission and owner expectations.</li> <li>Establishing this early allows faster triage later.</li> </ul>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#step-1-determine-host-role-and-critical-functions","title":"Step 1: Determine Host Role and Critical Functions","text":"<ul> <li>Consult asset inventories, system owners, or prior assessments to determine:</li> <li>Is this a server, workstation, or appliance?</li> <li>What is its normal function (ex: Domain Controller, File Server, User Workstation)?</li> </ul> <p>Operator Note: Expectations differ greatly \u2192 A DC running RDP is normal, a user workstation running RDP server is suspicious.</p>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#step-2-collect-running-processes","title":"Step 2: Collect Running Processes","text":""},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#windows","title":"Windows","text":"<pre><code>Get-Process | Sort-Object ProcessName | Format-Table -AutoSize\n</code></pre> <p>Save output:</p> <pre><code>Get-Process | Out-File C:\\IR\\baseline_process_list.txt\n</code></pre>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#linux-macos","title":"Linux / macOS","text":"<pre><code>ps aux --sort=pid\n</code></pre> <p>Save output:</p> <pre><code>ps aux --sort=pid &gt; /tmp/baseline_process_list.txt\n</code></pre> <p>Operator Note: Look for unsigned, unusual named processes, or processes running from temp directories.</p>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#step-3-collect-network-connections","title":"Step 3: Collect Network Connections","text":""},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#windows_1","title":"Windows","text":"<pre><code>Get-NetTCPConnection | Format-Table -AutoSize\n</code></pre>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#linux-macos_1","title":"Linux / macOS","text":"<pre><code>ss -tulnp\n</code></pre> <p>Operator Note: Investigate processes listening on unexpected ports (ex: Powershell hosting a web server).</p>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#step-4-collect-scheduled-tasks-and-autoruns","title":"Step 4: Collect Scheduled Tasks and Autoruns","text":""},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#windows_2","title":"Windows","text":"<pre><code>Get-ScheduledTask | Format-Table -AutoSize\n</code></pre> <pre><code>reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n</code></pre>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#linux","title":"Linux","text":"<pre><code>crontab -l\nls /etc/cron* /var/spool/cron\n</code></pre>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#macos","title":"macOS","text":"<pre><code>launchctl list\n</code></pre> <p>Operator Note: Persistence mechanisms often hide here. Flag anything unfamiliar.</p>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#step-5-collect-user-activity","title":"Step 5: Collect User Activity","text":""},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#windows_3","title":"Windows","text":"<pre><code>quser\nGet-EventLog -LogName Security -InstanceId 4624 | Select-Object -First 20\n</code></pre>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#linuxmacos","title":"Linux/macOS","text":"<pre><code>who\nlast\n</code></pre> <p>Operator Note: Unexpected logins (especially at odd hours) \u2192 red flag.</p>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#step-6-collect-installed-applications-packages","title":"Step 6: Collect Installed Applications / Packages","text":""},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#windows_4","title":"Windows","text":"<pre><code>Get-WmiObject -Class Win32_Product | Select-Object Name\n</code></pre>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#linux_1","title":"Linux","text":"<pre><code>dpkg -l\n</code></pre>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#macos_1","title":"macOS","text":"<pre><code>system_profiler SPApplicationsDataType\n</code></pre> <p>Operator Note: Look for unauthorized or suspicious software.</p>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#step-7-document-and-establish-baseline","title":"Step 7: Document and Establish Baseline","text":"<p>Create a report documenting:</p> Hostname Normal Processes Normal Ports Installed Software Users/Logins Notes WIN-DC01 lsass.exe, svchost.exe 88, 135, 445 AV, Adobe Reader admin, svc-account DC - normal baseline USER-PC chrome.exe, outlook.exe none Chrome, Office user normal user profile"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#step-8-identify-and-investigate-anomalies","title":"Step 8: Identify and Investigate Anomalies","text":"<ul> <li>Flag anything outside of expected processes/ports</li> <li>Correlate suspicious processes with hashes and VirusTotal</li> <li>Investigate abnormal user accounts or logins</li> <li>Identify unscheduled persistence mechanisms</li> </ul> <p>Operator Note: Not everything unknown is bad \u2192 escalate suspicious findings to Intel or IR Lead.</p>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#dependencies","title":"Dependencies","text":"<ul> <li>Access to target hosts (local or remote).</li> <li>Administrative privileges.</li> <li>Ability to run system commands or scripts.</li> <li>Logging and recording capability.</li> </ul>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Sysinternals Suite (Autoruns, PsExec, Procmon) Windows Download Deep process and autorun analysis Velociraptor Cross-platform Deploy agent Enterprise-scale endpoint telemetry OSQuery Cross-platform Install agent SQL-based host visibility PowerShell / Bash Native Built-in Collect process and system info"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Determine host role and expected behavior.</li> <li> Collect and document running processes.</li> <li> Collect and document network connections.</li> <li> Collect and document autoruns and scheduled tasks.</li> <li> Collect and document logged-in users and historical login data.</li> <li> Collect and document installed applications.</li> <li> Review and analyze for anomalies.</li> <li> Validate findings with asset owner or IR lead.</li> </ul>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#best-practices","title":"Best Practices","text":"<ul> <li>Compare similar host roles against each other to spot outliers.</li> <li>Use hash validation and threat intelligence for unknown binaries.</li> <li>Automate collection across multiple systems when possible.</li> <li>Preserve all raw outputs \u2192 useful for later incident review.</li> </ul>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#references","title":"References","text":"<ul> <li>Sysinternals Suite</li> <li>Velociraptor</li> <li>OSQuery</li> </ul>"},{"location":"4.Eradication/4.09.4_Evaluate_Host_Baseline/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with deep operator-focused guidance and examples Leo"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/","title":"4.09.5 Detect and Remove Rogue Wireless Access Points","text":""},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#task","title":"Task","text":"<p>Detect and remove unauthorized (rogue) wireless access points (APs) that may have been installed by attackers or unauthorized personnel to facilitate unauthorized network access.</p>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#conditions","title":"Conditions","text":"<p>Given access to the target environment, wireless network monitoring tools, and physical or remote ability to investigate detected access points.</p>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#standards","title":"Standards","text":"<ul> <li>Identify wireless APs operating within the environment.</li> <li>Differentiate between authorized and unauthorized (rogue) APs.</li> <li>Validate and investigate suspicious APs.</li> <li>Disable, block, or physically remove rogue APs in coordination with network owners.</li> </ul>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#end-state","title":"End State","text":"<p>All rogue wireless access points are identified, verified, and removed or disabled. Authorized AP inventory is validated and up to date.</p>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#notes","title":"Notes","text":"<ul> <li>Rogue APs are a significant security risk \u2192 they bypass perimeter controls.</li> <li>Not all rogue APs are malicious \u2192 some may be accidental or for convenience (ex: personal hotspots).</li> <li>Detection is both passive (scanning/listening) and active (connecting and interrogating).</li> </ul>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#step-1-understand-the-authorized-wireless-environment","title":"Step 1: Understand the Authorized Wireless Environment","text":"<p>Before scanning:</p> <ul> <li>Obtain a list of authorized SSIDs and AP MAC addresses from network administrators.</li> <li>Understand expected channels and wireless bands (2.4 GHz, 5 GHz, 6 GHz if applicable).</li> <li>Note physical locations of legitimate APs.</li> </ul> <p>Operator Note: This prevents false positives during detection.</p>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#step-2-scan-for-wireless-networks-passive-detection","title":"Step 2: Scan for Wireless Networks (Passive Detection)","text":""},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#recommended-tools","title":"Recommended Tools:","text":"Tool Platform Usage Kismet Linux Passive wireless scanning WiFi Explorer macOS GUI wireless scanner Airodump-ng Linux CLI wireless scanner NetSpot Windows/macOS Visual wireless survey"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#example-kismet-linux","title":"Example: Kismet (Linux)","text":"<pre><code>sudo kismet -c wlan0\n</code></pre> <p>Kismet will display:</p> <ul> <li>Detected SSIDs</li> <li>Hidden SSIDs</li> <li>MAC addresses (BSSID)</li> <li>Channel and band</li> <li>First seen/last seen timestamps</li> </ul>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#example-airodump-ng-linux","title":"Example: Airodump-ng (Linux)","text":"<pre><code>sudo airodump-ng wlan0\n</code></pre> <p>Operator Note: Identify SSIDs or MAC addresses NOT on authorized list \u2192 these are potential rogues.</p>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#step-3-analyze-rogue-ap-indicators","title":"Step 3: Analyze Rogue AP Indicators","text":"<p>Look for:</p> Indicator Explanation SSIDs not in authorized list Obvious rogue or misconfigured AP MAC addresses not registered Spoofed or rogue AP SSIDs mimicking authorized SSIDs (Evil Twin) Attack attempt to harvest credentials Unusual channels or power levels Attempt to hide or avoid detection Hidden SSIDs with clients connected Malicious or stealthy rogue AP <p>Operator Note: Hidden SSIDs with connected clients \u2192 highest priority for investigation.</p>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#step-4-locate-rogue-ap-physically-if-required","title":"Step 4: Locate Rogue AP Physically (If Required)","text":""},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#options","title":"Options:","text":"<ul> <li>Use directional Wi-Fi antenna (Yagi) + Kismet \u2192 track signal strength.</li> <li>Use WiFi Explorer/NetSpot \u2192 heatmap mode to triangulate.</li> <li>Walk area with laptop or smartphone \u2192 observe signal strength increases.</li> </ul> <p>Operator Note: Coordinate with onsite personnel or physical security.</p>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#step-5-validate-and-investigate-rogue-ap","title":"Step 5: Validate and Investigate Rogue AP","text":"<p>For suspected rogue APs:</p> <ul> <li>Attempt to connect (if authorized to do so).</li> <li>Capture traffic using Wireshark or tcpdump:</li> </ul> <pre><code>sudo tcpdump -i wlan0 -w rogue_ap_capture.pcap\n</code></pre> <ul> <li>Look for:</li> <li>Unencrypted management frames</li> <li>Unusual DHCP/HTTP/FTP services</li> <li>C2 traffic</li> </ul> <p>Operator Note: Do NOT send active probes unless approved. Passive capture is preferred.</p>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#step-6-remove-or-disable-rogue-ap","title":"Step 6: Remove or Disable Rogue AP","text":"<p>Options:</p> Method Description Coordinate with network owners \u2192 shutdown via managed switch or network ACL Soft removal Physically disconnect device Hard removal Use Wireless IDS/WIPS to block (if available) Real-time block <p>Operator Note: Always document and confirm device removal to prevent return.</p>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#step-7-update-wireless-ap-inventory","title":"Step 7: Update Wireless AP Inventory","text":"<ul> <li>Add validated APs to authorized list.</li> <li>Document rogue AP detection and removal actions.</li> <li>Review and update detection methods.</li> </ul>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#dependencies","title":"Dependencies","text":"<ul> <li>Wireless NIC capable of monitoring mode</li> <li>Physical or remote access to environment</li> <li>List of authorized APs and network layout</li> <li>Coordination with IT or network security team</li> </ul>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Kismet Linux apt/yum Passive detection Airodump-ng Linux Aircrack-ng suite Passive detection WiFi Explorer macOS Download Visualization and detection NetSpot Windows/macOS Download Visualization and detection"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Obtain authorized AP list and understand network layout.</li> <li> Scan for APs using passive monitoring.</li> <li> Compare detected APs against authorized list.</li> <li> Analyze suspicious APs for rogue indicators.</li> <li> Locate rogue AP physically (if required).</li> <li> Investigate rogue AP \u2192 capture and analyze traffic.</li> <li> Remove rogue AP and validate removal.</li> <li> Update AP inventory and detection playbook.</li> </ul>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#best-practices","title":"Best Practices","text":"<ul> <li>Conduct regular wireless sweeps to catch short-term rogue APs.</li> <li>Work closely with physical security during physical detection.</li> <li>Avoid active interrogation unless approved \u2192 can disrupt legitimate users.</li> <li>Maintain historical records of rogue AP incidents for trend analysis.</li> </ul>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#references","title":"References","text":"<ul> <li>Kismet Wireless</li> <li>Aircrack-ng Suite</li> <li>WiFi Explorer</li> <li>Wireless Rogue AP Hunting Guide (SANS)</li> </ul>"},{"location":"4.Eradication/4.09.5_Detect_Rouge_Wireless_AP/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with deep operator-focused detection/removal procedures Leo"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/","title":"4.09.6 Detect and Remove Rogue Network Devices","text":""},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#task","title":"Task","text":"<p>Detect and remove unauthorized (rogue) network devices that may have been connected to the network to facilitate unauthorized access, sniffing, bridging, or lateral movement.</p>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#conditions","title":"Conditions","text":"<p>Given access to the network infrastructure (switches, routers), network scanning tools, physical access to network areas, and knowledge of expected network architecture.</p>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#standards","title":"Standards","text":"<ul> <li>Detect all active network devices connected to the environment.</li> <li>Differentiate between authorized and unauthorized devices.</li> <li>Investigate and validate unknown devices.</li> <li>Physically or logically remove rogue devices from the network.</li> </ul>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#end-state","title":"End State","text":"<p>Rogue network devices are detected, validated, and removed or disconnected. Network inventory is updated and reviewed with network owner.</p>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#notes","title":"Notes","text":"<ul> <li>Rogue network devices can include unmanaged switches, unauthorized wireless routers, hubs, and sniffing/bridging devices.</li> <li>These devices may be malicious (planted for sniffing or C2) or accidental (brought in by users).</li> <li>Physical and logical detection techniques must be combined for full coverage.</li> </ul>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#step-1-obtain-network-inventory-and-authorized-device-list","title":"Step 1: Obtain Network Inventory and Authorized Device List","text":"<ul> <li>Gather list of authorized switches, routers, APs, printers, and any other network-connected infrastructure.</li> <li>Obtain network diagrams if available.</li> <li>Understand authorized VLANs and subnet allocations.</li> </ul> <p>Operator Note: This will help you quickly identify unknown MAC and IP addresses later.</p>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#step-2-scan-network-for-active-devices","title":"Step 2: Scan Network for Active Devices","text":""},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#recommended-tools","title":"Recommended Tools:","text":"Tool Platform Usage Nmap Linux/Windows/macOS Network discovery and port scanning arp-scan Linux Layer 2 network discovery Angry IP Scanner Cross-platform Simple IP scanner Netdisco Linux Network inventory and discovery"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#example-nmap","title":"Example: Nmap","text":"<pre><code>nmap -sn 192.168.1.0/24\n</code></pre>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#example-arp-scan-linux","title":"Example: arp-scan (Linux)","text":"<pre><code>sudo arp-scan --interface=eth0 192.168.1.0/24\n</code></pre> <p>Results will show:</p> <ul> <li>IP address</li> <li>MAC address</li> <li>Vendor (if available)</li> </ul> <p>Operator Note: Devices with unfamiliar vendors (ex: \"Shenzhen Co.\") are high priority for review.</p>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#step-3-analyze-switch-cam-tables-for-unknown-mac-addresses","title":"Step 3: Analyze Switch CAM Tables for Unknown MAC Addresses","text":"<p>Access managed switches and dump the MAC address table:</p> <pre><code>show mac address-table\n</code></pre> <p>or</p> <pre><code>show mac-address-table dynamic\n</code></pre> <p>Look for:</p> <ul> <li>MAC addresses on ports where no device should be connected.</li> <li>Ports showing multiple MAC addresses (indicating rogue switches or hubs).</li> <li>Unknown vendors in MAC OUI (Organizational Unique Identifier).</li> </ul> <p>Operator Note: Multiple MACs on a port often indicates a switch/hub \u2192 rogue network expansion risk.</p>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#step-4-physically-locate-suspect-devices","title":"Step 4: Physically Locate Suspect Devices","text":""},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#methods","title":"Methods:","text":"<ul> <li>Use port documentation to identify physical location (patch panel labels, switch port mapping).</li> <li>Use tone generator and probe kit to trace cabling.</li> <li>Walk area and visually inspect \u2192 look for unmanaged switches, Wi-Fi routers, or small Ethernet devices.</li> </ul> <p>Operator Note: Work with facility or building management if access to secured areas is needed.</p>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#step-5-validate-device-authorization","title":"Step 5: Validate Device Authorization","text":"<ul> <li>Compare against asset inventory and consult network owners.</li> <li>Validate with end users if device ownership is unclear.</li> </ul> <p>Example unauthorized devices:</p> Device Type Example Unmanaged Switch $20 switch connected to expand network access Wi-Fi Router Personal router \u2192 risk of DHCP conflicts or open AP Raspberry Pi / Small PC Potential rogue C2 node IP Phone with PC passthrough used improperly Risky but not always malicious <p>Operator Note: Not every rogue device is malicious \u2192 accidental misconfigurations should still be removed.</p>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#step-6-disable-or-remove-rogue-devices","title":"Step 6: Disable or Remove Rogue Devices","text":"<p>Options:</p> Method Description Disable switch port Prevent rogue device from communicating Physically remove device Preferred for unknown or malicious devices Block MAC address Secondary control if physical removal not immediately possible <p>Example (Cisco Switch):</p> <pre><code>configure terminal\ninterface FastEthernet0/10\nshutdown\n</code></pre> <p>Operator Note: Always coordinate with network owners \u2192 avoid accidental outages.</p>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#step-7-document-and-update-network-inventory","title":"Step 7: Document and Update Network Inventory","text":"<ul> <li>Document rogue device detection and removal.</li> <li>Update switch port mappings and network diagrams.</li> <li>Inform network owners of updates and actions taken.</li> </ul>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#dependencies","title":"Dependencies","text":"<ul> <li>Access to network switches and routers</li> <li>Ability to run scans and pull MAC address tables</li> <li>Physical access or support for physical device location</li> <li>Network owner coordination</li> </ul>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Nmap Cross-platform Package manager Network discovery arp-scan Linux Package manager Layer 2 scan Switch CLI Switches Native Show MAC tables Netdisco Linux Web-based tool Network device inventory"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Obtain and validate network inventory and authorized device list.</li> <li> Conduct active network scans to identify all devices.</li> <li> Review switch CAM tables for unknown MAC addresses.</li> <li> Investigate and physically locate suspicious devices.</li> <li> Validate device legitimacy with network owner.</li> <li> Disable or remove rogue devices.</li> <li> Update documentation and communicate findings.</li> </ul>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#best-practices","title":"Best Practices","text":"<ul> <li>Always correlate discovered MAC addresses with vendor OUI.</li> <li>Review ports with multiple MACs carefully \u2192 often rogue switches.</li> <li>Plan detection sweeps during off-peak hours if possible.</li> <li>Establish periodic rogue device detection as part of security hygiene.</li> </ul>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#references","title":"References","text":"<ul> <li>Nmap Reference Guide</li> <li>arp-scan User Guide</li> <li>Cisco Switch Port Security</li> </ul>"},{"location":"4.Eradication/4.09.6_Detect_Remove_Rouge_Network_Devices/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with deep operator guidance and practical detection/removal procedures Leo"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/","title":"4.09 Install and Deploy Security Onion","text":""},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#task","title":"Task","text":"<p>Install and Deploy Security Onion</p>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#conditions","title":"Conditions","text":"<p>Given a Linux Security Onion machine.</p>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#standards","title":"Standards","text":"<ul> <li>Configuring Security Onion (SO) from an instantiated virtual machine.</li> <li>Setup Security Onion firewall rules.</li> <li>Connecting to Security Onion from another box for log visibility and analyst access.</li> </ul>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#end-state","title":"End State","text":"<p>Fully functioning Security Onion NIDS receiving and parsing logs from target network segments.</p>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#configuring-security-onion-from-an-instantiated-virtual-machine","title":"Configuring Security Onion from an instantiated virtual machine","text":"<ul> <li> <p>Login to SO.</p> <p>Note: for lab/range use credentials from SharePoint.</p> </li> <li> <p>Open Terminal \u2192 Click <code>Applications</code> \u2192 <code>Utilities</code> \u2192 <code>Terminal</code>. Leave terminal off to the side.</p> </li> <li> <p>Launch setup \u2192 Double click setup icon on desktop.</p> <p>Note: Use password from Step 1.1 in setup.</p> </li> <li> <p>Select <code>Yes, Continue!</code></p> </li> <li> <p>Select <code>Yes, configure /etc/...</code></p> </li> <li> <p>Select the management interface:</p> </li> <li>In Terminal type <code>ip address</code></li> <li> <p>Verify the interface IPv4 address matches what is selected.</p> </li> <li> <p>Set a static IP \u2192 Make sure static is selected \u2192 Select <code>Ok</code>.</p> </li> <li> <p>Input IPv4 address \u2192 select <code>Ok</code> \u2192 refer to Terminal output.</p> </li> <li> <p>Input your subnet CIDR \u2192 select <code>Ok</code>.</p> </li> <li> <p>Input your gateway: <pre><code>ip route\n</code></pre></p> </li> <li> <p>Use IP after <code>default via</code> for gateway.</p> </li> <li> <p>Input your DNS \u2192 In Terminal: <pre><code>nslookup google.com\n</code></pre></p> </li> <li> <p>Use displayed DNS servers.</p> </li> <li> <p>Input your domain name: <pre><code>hostname -f\n</code></pre></p> </li> <li> <p>Input everything after first period \u2192 select <code>Ok</code>.</p> </li> <li> <p>Configure sniffing interfaces \u2192 select <code>Yes, configure...</code></p> </li> <li> <p>Ensure management interface is NOT selected \u2192 select <code>Ok</code>.</p> </li> <li> <p>Select <code>Yes, make changes!</code></p> </li> <li> <p>Select <code>Yes, Reboot!</code></p> </li> <li> <p>Login to SO again \u2192 Use original credentials.</p> </li> <li> <p>Launch setup again \u2192 double click setup icon.</p> </li> <li> <p>Input system logon password.</p> </li> <li> <p>Select <code>Yes, Continue</code> to configure services.</p> </li> <li> <p>Select <code>Yes, skip...</code> to skip prior config.</p> </li> <li> <p>Select <code>Production Mode</code>.</p> </li> <li> <p>Select <code>New</code> deployment.</p> </li> <li> <p>Input first user account (not default) \u2192 set password twice.</p> </li> <li> <p>Select <code>Best Practices</code>.</p> </li> <li> <p>Select <code>Emerging Threats Open</code> ruleset.</p> </li> <li> <p>Select <code>Snort</code> IDS engine.</p> </li> <li> <p>Select <code>Enable our sensors</code>.</p> </li> <li> <p>Accept default port configurations \u2192 Select <code>Ok</code>.</p> </li> <li> <p>Review monitoring interfaces \u2192 confirm management interface NOT selected \u2192 Select <code>Ok</code>.</p> </li> <li> <p>Define HOME_NET subnets \u2192 Input each subnet in CIDR \u2192 comma separated.</p> </li> <li> <p>Store logs locally \u2192 Select <code>Yes</code>.</p> </li> <li> <p>Accept default log size \u2192 Select <code>Ok</code>.</p> </li> <li> <p>Finish configuration \u2192 Select <code>Yes, proceed...</code></p> </li> <li> <p>Confirm and accept defaults until complete \u2192 Select <code>Ok</code> six times.</p> </li> </ul>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#setup-security-onion-firewall-rules-so-allow","title":"Setup Security Onion Firewall Rules (so-allow)","text":"<p>After initial setup, configure local firewall to permit necessary communications.</p> <ul> <li>Open Terminal: <pre><code>sudo so-allow\n</code></pre></li> </ul>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#allow-analyst-access","title":"Allow analyst access","text":"<p>Allows workstations or ranges to access SO web interfaces. <pre><code>sudo so-allow\n</code></pre> </p>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#allow-elasticsearch-access","title":"Allow Elasticsearch access","text":"<p>Allows other SO boxes or apps to connect to Elasticsearch. <pre><code>sudo so-allow\n</code></pre> </p>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#allow-pan-syslog-device","title":"Allow PAN syslog device","text":"<p>Allows Palo Alto to forward logs to SO. <pre><code>sudo so-allow\n</code></pre> </p>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#allow-wazuhossec-agent-connectivity","title":"Allow Wazuh/OSSEC agent connectivity","text":"<p>Allows workstations/servers running Wazuh agent to report into SO. <pre><code>sudo so-allow\n</code></pre> </p> <p>Operator Note: Always validate and limit scope \u2192 use DAPE (Deny All, Permit by Exception) logic.</p>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#connecting-to-security-onion-from-another-box","title":"Connecting to Security Onion from Another Box","text":"<ul> <li>On analyst laptop:</li> <li>Open web browser.</li> <li> <p>Enter IP of Security Onion management interface.</p> </li> <li> <p>If connection fails:</p> </li> <li>Validate analyst workstation is in same subnet.</li> <li> <p>Check firewall rules: <pre><code>sudo ufw status numbered\nsudo ufw delete &lt;rule_number&gt;\n</code></pre></p> </li> <li> <p>Once connected \u2192 Open Kibana from web interface.</p> </li> <li>Login using credentials created in step 1.15.</li> </ul> <p>Operator Note: This step validates operational readiness \u2192 Kibana access confirms sensors and ingestion are online.</p>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#dependencies","title":"Dependencies","text":"<ul> <li>Security Onion virtual machine.</li> <li>Network access and static IP configuration.</li> <li>Proper subnet and CIDR information.</li> <li>Access to Security Onion and analyst workstations.</li> </ul>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage so-allow Security Onion Built-in Configures firewall access rules Kibana Web UI Built-in Visualize and search logs ElasticSearch Backend Built-in Stores log data"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Install and configure Security Onion from virtual machine.</li> <li> Assign static IP, gateway, subnet, DNS, and domain during setup.</li> <li> Complete production mode configuration and sensor setup.</li> <li> Configure firewall rules via <code>so-allow</code> for analyst, PAN, Wazuh, and OSSEC agents.</li> <li> Validate remote analyst access to SO web interface.</li> <li> Verify Kibana log visibility for HOME_NET.</li> </ul>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#best-practices","title":"Best Practices","text":"<ul> <li>Use <code>so-allow</code> cautiously \u2192 opening too much access weakens NIDS.</li> <li>Verify all subnets and IP ranges carefully \u2192 especially HOME_NET.</li> <li>Regularly test Kibana and sensor ingestion after deployment.</li> <li>Create snapshot or backup after successful install for quick redeployment.</li> </ul>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#references","title":"References","text":"<p>Security Onion Docs Security Onion Docs - Local Security Onion Walkthrough</p>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Final corrected version preserving original + expanded operator instructions, validation, and context Leo"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/","title":"PAN Forward Syslog to Security Onion","text":""},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#task","title":"Task","text":"<p>Configure Palo Alto Networking Device to forward all alerts and logs to Security Onion Syslog server for ingestion and analysis.</p>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#conditions","title":"Conditions","text":"<p>Given a Palo Alto Networking device and Security Onion / Syslog server.</p>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#standards","title":"Standards","text":"<ul> <li>Team member validates that Palo Alto device is properly receiving and processing network traffic.</li> <li>Team member configures log forwarding to Security Onion correctly and confirms log flow.</li> <li>Security Onion receives logs and they are parsed and visible in Kibana.</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#end-state","title":"End State","text":"<p>Logs from PAN firewall are forwarded to Security Onion, parsed by NIDS and available for analysis and alerting.</p>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#notes","title":"Notes","text":"<ul> <li>Syslog forwarding uses UDP or TCP \u2192 UDP may drop packets but is simple, TCP more reliable but heavier.</li> <li>Source interface and addresses are critical \u2192 must be in same subnet as Syslog/Security Onion server.</li> <li>Security Profile Groups enforce logging rules across different threat categories \u2192 misconfiguration here can result in lost telemetry.</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#step-1-access-palo-alto-webui","title":"Step 1: Access Palo Alto WebUI","text":"<ul> <li>Login to Palo Alto WebUI  </li> <li>Username: Admin  </li> <li>Password: Obtain from network owner  </li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#step-2-configure-syslog-service-route","title":"Step 2: Configure Syslog Service Route","text":"<ul> <li>Navigate to Device \u2192 Setup \u2192 Services \u2192 Service Route Configuration</li> <li>Customize routes</li> <li>Change Syslog source interface and IP to match subnet of Syslog/Security Onion server</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#step-3-create-syslog-server-profile","title":"Step 3: Create Syslog Server Profile","text":"<ul> <li>Navigate to Device \u2192 Server Profiles \u2192 Syslog</li> <li>Click Add \u2192 name profile</li> <li>Add server \u2192 enter IP of Security Onion</li> <li>Select Transport (UDP or TCP based on network design)</li> <li>Default port: 514</li> </ul> <p>Operator Note: Use TCP where reliable delivery is mandatory.</p>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#step-4-create-security-profiles","title":"Step 4: Create Security Profiles","text":""},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#antivirus","title":"Antivirus","text":"<ul> <li>Create Antivirus profile</li> <li>Change Actions and Wildfire Actions \u2192 Alert</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#anti-spyware","title":"Anti-Spyware","text":"<ul> <li>Create Anti-Spyware profile</li> <li>Change Actions \u2192 Alert</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#dns-signatures","title":"DNS Signatures","text":"<ul> <li>Change Action on DNS Queries \u2192 Alert</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#vulnerability-protection","title":"Vulnerability Protection","text":"<ul> <li>Add Rule \u2192 Change Action \u2192 Alert</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#url-filtering","title":"URL Filtering","text":"<ul> <li>Add Profile \u2192 set Site Access + User Credential Submission \u2192 Alert</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#file-blocking","title":"File Blocking","text":"<ul> <li>Add Rule \u2192 Action \u2192 Alert</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#step-5-create-security-profile-group","title":"Step 5: Create Security Profile Group","text":"<ul> <li>Combine all profiles \u2192 new Profile Group</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#step-6-create-log-forwarding-profile","title":"Step 6: Create Log Forwarding Profile","text":"<ul> <li>Navigate \u2192 Objects \u2192 Log Forwarding</li> <li>Click Add \u2192 create profile</li> <li>Add \u2192 under Syslog \u2192 select created Syslog Server Profile</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#step-7-apply-security-profiles-to-security-policy","title":"Step 7: Apply Security Profiles to Security Policy","text":"<ul> <li>Navigate \u2192 Policies \u2192 Security \u2192 Edit active policy</li> <li>Actions \u2192 Profile Type \u2192 Group \u2192 select created Profile Group</li> <li>Log Settings \u2192 Log at Session Start + End \u2192 select Log Forwarding Profile</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#step-8-configure-log-settings-for-systemconfiguration-events","title":"Step 8: Configure Log Settings for System/Configuration Events","text":"<ul> <li>Navigate \u2192 Device \u2192 Log Settings</li> <li>For each type (System, Configuration, User-ID, HIP Match, IP-Tag) \u2192 Add + select Syslog Profile</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#step-9-commit-changes","title":"Step 9: Commit Changes","text":"<ul> <li>Commit all changes and add description of work performed</li> </ul> <p>Operator Note: Always add change description \u2192 assists during audit or troubleshooting.</p>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#step-10-validate-logging","title":"Step 10: Validate Logging","text":"<ul> <li>On Security Onion \u2192 check /var/log/syslog or Kibana</li> <li>Confirm logs are flowing and correctly parsed</li> <li>Generate test traffic if necessary (malicious domain block, AV detection)</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#dependencies","title":"Dependencies","text":"<ul> <li>Palo Alto Firewall with admin access</li> <li>Security Onion Syslog Receiver (configured to receive on port 514)</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Wireshark Cross-platform Package manager Validate syslog traffic arriving"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate PAN interfaces and routing (service route properly configured).</li> <li> Validate Syslog Server Profile configured with correct IP and port.</li> <li> Confirm Security Profiles configured \u2192 all alert actions selected.</li> <li> Apply Profile Group and Log Forwarding to active policies.</li> <li> Validate log receipt at Security Onion \u2192 real events are visible.</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#best-practices","title":"Best Practices","text":"<ul> <li>Use TCP where reliable delivery is important.</li> <li>Alerting-only profile avoids blocking during incident response.</li> <li>Use profile groups for consistent application across rules.</li> <li>Validate logs using end-to-end test \u2192 not just UI config.</li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#references","title":"References","text":"<p>PAN OS 9.0 Admin Guide PAN Syslog Setup KB</p>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Corrected and expanded version preserving original + operator guidance Leo"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/","title":"4.11 Monitoring Account Creation (SO + Local + Cloud)","text":""},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#task","title":"Task","text":"<p>Monitor for the creation of new user or service accounts across enterprise environments including Security Onion (SO), local systems, and cloud platforms to identify potentially unauthorized access and persistence mechanisms.</p>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>A Security Onion server and admin account to query account creations</li> <li>Access to incident response workstation</li> <li>Access to local and cloud platforms for account creation monitoring</li> </ul>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#standards","title":"Standards","text":"<ul> <li>Team member queries the Security Onion Server to obtain the following minimum information:</li> <li>Account Name</li> <li>Account Domain</li> <li>Machine the account was created on (if the account was created locally)</li> <li>SID of new account</li> <li>Team member outputs the account creation data to a comma-separated values (CSV) file and compares the entries to existing user accounts.</li> <li>Team member checks information on accounts used to create new accounts against known IOCs or system owner activities to determine if accounts are legitimate.</li> </ul>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#end-state","title":"End State","text":"<p>All new user or service account creation events are discovered, logged, validated, and confirmed to be legitimate or escalated as suspicious.</p>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#notes","title":"Notes","text":"<p>Security Onion is able to detect local and domain account creations.</p>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#security-onion-primary-method","title":"Security Onion (Primary Method)","text":""},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#use-the-following-security-onion-search-query","title":"Use the following Security Onion search query:","text":"<pre><code>winlog.event_id:\"4720\" | groupby event.module event.dataset\n</code></pre> <p>This query will identify new user account creation events on Windows systems.</p>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#export-to-csv","title":"Export to CSV:","text":"<ol> <li>Select query results.</li> <li>Use export feature to save as CSV.</li> <li>Compare against known user list.</li> </ol>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#validate","title":"Validate","text":"<ul> <li>Cross-reference new accounts with authorized account request forms or owner approval.</li> <li>Investigate accounts without approval or context.</li> </ul>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#windows-event-viewer-alternative-local","title":"Windows Event Viewer (Alternative / Local)","text":""},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#using-windows-event-viewer","title":"Using Windows Event Viewer:","text":"<p>Event ID to search:</p> <pre><code>Event ID: 4720 (A user account was created)\n</code></pre> <p>Steps:</p> <ol> <li>Open Event Viewer \u2192 Windows Logs \u2192 Security</li> <li>Use filter or search for <code>4720</code></li> <li>Validate account creation events manually</li> </ol> <p>Operator Note: Use PowerShell for automation where needed.</p> <pre><code>Get-WinEvent -FilterHashtable @{LogName='Security'; Id=4720}\n</code></pre>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#linux-and-macos-local-account-monitoring","title":"Linux and macOS (Local Account Monitoring)","text":""},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#audit-new-users-from-etcpasswd-linuxmacos","title":"Audit new users from <code>/etc/passwd</code> (Linux/macOS)","text":"<pre><code>awk -F':' '{ print $1}' /etc/passwd\n</code></pre>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#monitor-user-addition-with-auditd-linux","title":"Monitor user addition with auditd (Linux)","text":"<pre><code>ausearch -m ADD_USER\n</code></pre>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#macos-unified-log-new-accounts","title":"macOS Unified Log (New Accounts)","text":"<pre><code>log show --predicate 'eventMessage CONTAINS \"Added user account\"' --info\n</code></pre> <p>Operator Note: Configure OSSEC or Auditbeat where applicable for automated account monitoring.</p>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#cloud-monitoring","title":"Cloud Monitoring","text":""},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#aws-cloudtrail","title":"AWS (CloudTrail)","text":"<pre><code>aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=CreateUser\n</code></pre> <p>Look for:</p> <ul> <li>IAM user creation \u2192 Cross-reference who performed action</li> <li>Automated scripts vs human interaction</li> </ul>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#aws-guardduty","title":"AWS GuardDuty","text":"<ul> <li>Will also alert on suspicious account creations (optional cross-check)</li> </ul>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#azure-azure-ad-audit-logs","title":"Azure (Azure AD Audit Logs)","text":"<pre><code>Search-UnifiedAuditLog -StartDate (Get-Date).AddDays(-1) -Operations \"Add user\"\n</code></pre> <p>or Azure Portal \u2192 Azure AD \u2192 Audit Logs</p> <p>Look for:</p> <ul> <li>New user additions</li> <li>Role assignments</li> </ul>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#gcp-cloud-audit-logs","title":"GCP (Cloud Audit Logs)","text":"<pre><code>gcloud logging read \"protoPayload.methodName=\\\"google.iam.admin.v1.CreateServiceAccount\\\"\"\n</code></pre> <p>or</p> <pre><code>gcloud logging read \"protoPayload.methodName=\\\"google.admin.directory.user.insert\\\"\"\n</code></pre> <p>Look for:</p> <ul> <li>Service account creations</li> <li>User account insertions</li> </ul> <p>Operator Note: API-based or externally sourced account additions should be reviewed closely.</p>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#validate-and-investigate","title":"Validate and Investigate","text":"<p>For all platforms:</p> <ul> <li>Cross-check against authorized change requests or HR/user management systems.</li> <li>Investigate automated creations without owner.</li> <li>Validate service accounts \u2192 what apps/infra are using them?</li> </ul>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#running-script","title":"Running Script","text":"<p>TBD \u2192 Automated script examples may be generated for PowerShell, Bash, and Cloud CLIs to consolidate across platforms.</p>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#dependencies","title":"Dependencies","text":"<ul> <li>Security Onion access and Winlogbeat or Sysmon integration.</li> <li>Access to local OS logs (Windows Event Viewer, Linux auditd, macOS Unified Logs).</li> <li>Cloud provider admin/reader role to audit IAM user creations.</li> <li>CSV export capability for analysis.</li> </ul>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Security Onion Network Native Windows Account Creation Events OSSEC / Wazuh Cross-platform Package Manager / VM Local User Account Monitoring Auditbeat Linux/macOS Package Manager Real-time user event monitoring AWS CloudTrail + GuardDuty AWS Native IAM user creation detection Azure AD Audit Logs + Sentinel Azure Native Account creation monitoring GCP Cloud Logging + SCC GCP Native Account creation and IAM service account monitoring"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Run Security Onion query and export CSV</li> <li> Compare new accounts to known user lists</li> <li> Investigate accounts created outside normal processes</li> <li> Validate local Windows Event Log (4720) entries</li> <li> Validate Linux/macOS for user additions</li> <li> Validate Cloud platforms (AWS, Azure, GCP) for IAM/User/Service Account creations</li> <li> Investigate unknown or automated-created accounts</li> <li> Confirm approved ownership for all new accounts</li> <li> Document all findings and close legitimate cases</li> </ul>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#best-practices","title":"Best Practices","text":"<ul> <li>Run queries daily or with automated alerting to detect account creation quickly.</li> <li>Ensure cloud-native alerting is integrated to SIEM/SOAR.</li> <li>Service accounts should have owner tags/annotations in cloud IAM.</li> <li>Perform weekly audit and reconciliation for shadow accounts.</li> </ul>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#references","title":"References","text":"<ul> <li>EventID 4720</li> <li>AWS IAM CloudTrail Events</li> <li>Azure AD Audit Logs</li> <li>GCP Cloud Audit Logs</li> </ul>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.1 Enhanced with operator checklist, recommendations, and multi-platform account monitoring workflow Leo"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/","title":"4.12 Detect Network Vulnerability Scans (SO + SMB + Local + Cloud)","text":""},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#task","title":"Task","text":"<p>Identify SMB traffic and network vulnerability scanning activities using Security Onion and other data sources. This includes both SMB-based indicators (such as Cobalt Strike SMB P2P) and other network scanning attempts (Nmap, Masscan, Nessus).</p>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>A Security Onion server with admin access</li> <li>Access to Security Onion Alerts and Hunt dashboards</li> <li>Local endpoint access (optional)</li> <li>Cloud environment access (optional)</li> </ul>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#standards","title":"Standards","text":"<ul> <li>Login into Security Onion</li> <li>Select Alerts on the left panel</li> <li>Ensure Alerts are properly configured:</li> <li>Group: rule.name</li> <li>Group: event.module</li> <li>Group: event.severity_label</li> <li>Set timeframe for your scan period</li> <li>Click on column title <code>event.severity_label</code> to sort alerts</li> <li>Search for SMB alert signatures (ex: <code>ET POLICY SMB Executable File Transfer</code>)</li> <li>Use Hunt function to analyze SMB traffic patterns</li> <li>Expand analysis to broader vulnerability scan detection patterns:</li> <li>Nmap</li> <li>Masscan</li> <li>Nessus</li> <li>Any unusual port sweep / probing patterns</li> <li>Investigate findings, determine legitimacy or malicious intent, and document results.</li> </ul>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#end-state","title":"End State","text":"<p>All suspicious or unauthorized scanning (SMB + general vulnerability scanning) is detected and validated for legitimacy.</p>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#notes","title":"Notes","text":"<p>Security Onion is capable of detecting:</p> <ul> <li>SMB traffic</li> <li>Nmap / Masscan / Nessus scanning</li> <li>Cobalt Strike and P2P SMB trojan activity</li> <li>Slow or stealthy scans via Hunt and advanced queries</li> </ul>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#detect-smb-traffic-using-security-onion-original-repository-steps","title":"Detect SMB Traffic Using Security Onion (Original Repository Steps)","text":""},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#alerts-workflow","title":"Alerts Workflow","text":"<ol> <li>Login into Security Onion</li> <li>Select Alerts on the left panel</li> <li>Ensure Alerts are properly configured:<ul> <li>Group: <code>rule.name</code></li> <li>Group: <code>event.module</code></li> <li>Group: <code>event.severity_label</code></li> </ul> </li> <li>Set timeframe (next to refresh button, use dropdown):<ul> <li>Recommended: Last 6 hours or Last 1 day</li> </ul> </li> <li>Sort alerts by <code>event.severity_label</code> (High \u2192 Low)</li> <li>Search for SMB Alerts (i.e. <code>ET POLICY SMB Executable File Transfer</code>)</li> </ol>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#hunt-workflow","title":"Hunt Workflow","text":"<ol> <li>Left-click the SMB alert \u2192 Click \"Actions\" \u2192 Select Hunt</li> <li>Ensure timeframe matches the alert timeframe</li> <li>Clear search bar quotes \u2192 leave only <code>SMB</code></li> <li>Confirm <code>Group: event.module</code> and <code>Group: event.dataset</code> are active (if not, click the down arrow \u2192 select <code>| groupby event.module event.dataset</code>)</li> <li>Click Hunt</li> <li>Scroll to Events</li> <li>Sort using <code>rule.name</code> or <code>event.severity_label</code></li> </ol> <p>Expected result example:</p> <pre><code>ET TROJAN CobaltStrike SMB P2P Default Msagent Named Pipe Interaction\nA Network Trojan was detected \u2192 High Severity\n</code></pre>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#detect-network-vulnerability-scans-expanded-procedure","title":"Detect Network Vulnerability Scans (Expanded Procedure)","text":""},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#security-onion-alerts-broader-scan-signatures","title":"Security Onion Alerts \u2192 Broader Scan Signatures","text":"<p>Common scan rules to look for:</p> <pre><code>ET SCAN Nmap Scripting Engine User-Agent Detected\nET SCAN Potential Masscan Activity\nET POLICY Nessus Scan Detected\nET SCAN Possible SQL Scanner\n</code></pre> <p>Operator Note: Apply same workflow as SMB for hunting these alerts.</p>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#security-onion-hunt","title":"Security Onion Hunt","text":"<p>Example search:</p> <pre><code>Nmap OR Masscan OR Nessus OR SMB | groupby event.module event.dataset\n</code></pre> <p>Review:</p> <ul> <li>Source IP</li> <li>Destination IP ranges</li> <li>Number of destination ports</li> </ul> <p>Multiple destinations/ports in a short time \u2192 Indicates scanning.</p>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#local-host-monitoring-supplemental","title":"Local Host Monitoring (Supplemental)","text":""},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#windows","title":"Windows","text":"<pre><code>Get-NetTCPConnection | Group-Object -Property State\n</code></pre> <p>Look for:</p> <ul> <li>Large SYN_SENT counts \u2192 possible scan from this host</li> </ul>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#linuxmacos","title":"Linux/macOS","text":"<pre><code>ss -ant | grep SYN\n</code></pre> <p>or</p> <pre><code>netstat -ant | grep SYN\n</code></pre>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#cloud-monitoring","title":"Cloud Monitoring","text":""},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#aws-guardduty-vpc-flow","title":"AWS (GuardDuty + VPC Flow)","text":"<p>Look for GuardDuty Findings:</p> <pre><code>Recon:EC2/PortProbeUnprotectedPort\nRecon:IAMUser/PortProbe\n</code></pre>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#azure-nsg-flow-logs-defender-for-cloud","title":"Azure (NSG Flow Logs + Defender for Cloud)","text":"<p>Azure Sentinel query:</p> <pre><code>AzureNetworkAnalytics_CL\n| where FlowType_s == \"Inbound\"\n| summarize count() by SourceIP_s, DestinationPort_s\n</code></pre>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#gcp-cloud-logging-scc","title":"GCP (Cloud Logging + SCC)","text":"<pre><code>gcloud logging read \"resource.type=gce_subnetwork AND jsonPayload.connection.protocol=TCP\"\n</code></pre> <p>Security Command Center \u2192 Reconnaissance \u2192 Port Scanning findings</p>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#validate-and-investigate","title":"Validate and Investigate","text":"<p>For all detections:</p> <ul> <li>Determine authorized vs unauthorized scans</li> <li>Validate IP source and ownership</li> <li>Document investigation outcome</li> </ul>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#running-script","title":"Running Script","text":"<p>TBD \u2192 scripting possible for continuous aggregation and pattern detection.</p>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#dependencies","title":"Dependencies","text":"<ul> <li>Security Onion installed and Alerts configured</li> <li>Hunt view enabled</li> <li>Local administrative access to endpoints (optional)</li> <li>Cloud access to GuardDuty / Azure Sentinel / GCP SCC</li> </ul>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Security Onion (Alerts + Hunt) Network Native Scan + SMB detection OSSEC / Wazuh Cross-platform Package Manager Port scanning detection AWS GuardDuty + VPC Flow Logs AWS Native Detect port scanning Azure Defender + NSG Flow Logs Azure Native Detect port scanning GCP Security Command Center + Flow Logs GCP Native Detect port scanning Nmap / Nessus (Red Team / Baseline) Cross-platform Native Detection validation"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Confirm Security Onion Alerts properly configured (SMB + Scans)</li> <li> Detect SMB alerts (Cobalt Strike, SMB File Transfer)</li> <li> Perform SMB Hunt and analyze patterns</li> <li> Detect Nmap / Masscan / Nessus alerts</li> <li> Perform Hunt for other scan patterns</li> <li> Validate and correlate to determine legitimacy</li> <li> Review cloud environments for scan patterns</li> <li> Document unauthorized activities and escalate</li> </ul>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#best-practices","title":"Best Practices","text":"<ul> <li>Detect slow and distributed scan patterns (Hunt \u2192 time range + patterning)</li> <li>Tag authorized scanner IPs to reduce false positives</li> <li>Use automated detection pipelines (SIEM/SOAR integration)</li> <li>Perform periodic reviews of scan rule effectiveness</li> </ul>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#references","title":"References","text":"<ul> <li>Security Onion Alerts</li> <li>Security Onion Hunt</li> <li>AWS GuardDuty Findings</li> <li>Azure Defender for Cloud</li> <li>GCP Security Command Center</li> </ul>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.1 Rebuilt with original SMB detection + expanded multi-platform scan detection + operator workflow Leo"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/","title":"4.13 Detect SMB using Security Onion (SO)","text":""},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#task","title":"Task","text":"<p>Identify SMB traffic and monitor SMB-based activity using Security Onion to detect unauthorized SMB file transfers or lateral movement techniques (such as Cobalt Strike SMB P2P).</p>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#conditions","title":"Conditions","text":"<p>While using Security Onion Alerts and Hunt dashboards, identify SMB traffic.</p>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#standards","title":"Standards","text":"<ul> <li>Login into Security Onion.</li> <li>Select Alerts on the left panel.</li> <li>Ensure Alerts are properly configured:</li> <li>Group: <code>rule.name</code></li> <li>Group: <code>event.module</code></li> <li>Group: <code>event.severity_label</code></li> <li>Set timeframe for your scan period:</li> <li>Click the underlined area to the left of the refresh button.</li> <li>If listed as calendar and hours \u2192 click the calendar icon and select desired timeframe (e.g., Last 1 Day or Last 6 hours).</li> <li>Click on column title <code>event.severity_label</code> to sort alerts by severity (High \u2192 Low).</li> <li>Search for SMB alert signatures (i.e. <code>ET POLICY SMB Executable File Transfer</code>)</li> <li>Left click on the SMB alert \u2192 scroll down \u2192 Actions \u2192 Hunt</li> <li>Click the Hunt tab on the left side of the dashboard.</li> <li>Ensure timeframe matches the alert.</li> <li>In the search bar:</li> <li>Delete everything in quotations \u2192 leave only <code>SMB</code></li> <li>Confirm <code>Group: event.module</code> and <code>Group: event.dataset</code> are still active</li> <li>If not, click down arrow next to search bar \u2192 select <code>| groupby event.module event.dataset</code></li> <li>Click on Hunt.</li> <li>Scroll down to Events \u2192 sort by <code>rule.name</code> and/or <code>event.severity_label</code>.</li> </ul> <p>You may see results like:</p> <pre><code>ET TROJAN CobaltStrike SMB P2P Default Msagent Named Pipe Interaction\nA Network Trojan was detected \u2192 High\n</code></pre>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#end-state","title":"End State","text":"<ul> <li>SMB traffic is identified and monitored for unauthorized file transfers or suspicious lateral movement activities.</li> </ul>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#notes","title":"Notes","text":"<p>Security Onion is able to detect SMB-based threats using Suricata rules and Hunt investigations. Typical examples include:</p> <ul> <li>Unauthorized file transfer attempts</li> <li>Named pipe interactions</li> <li>Cobalt Strike SMB beacon activity</li> </ul>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#manual-steps","title":"Manual Steps","text":"<ul> <li>See above Security Onion Alerts and Hunt steps.</li> </ul>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#expanded-detection-methods-operator-enhancement","title":"Expanded Detection Methods (Operator Enhancement)","text":""},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#zeek-smb-logs-optional","title":"Zeek SMB Logs (Optional)","text":"<p>Zeek (formerly Bro) monitors SMB traffic and logs into SMB log files.</p> <pre><code>cat /nsm/bro/logs/current/smb_files.log\n</code></pre> <p>Look for:</p> <ul> <li>File transfer events</li> <li>Access attempts</li> <li>Unexpected usernames</li> </ul> <p>Example fields:</p> <pre><code>ts | uid | id.orig_h | id.resp_h | command | path | name\n</code></pre>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#search-for-executables","title":"Search for executables","text":"<pre><code>grep \".exe\" /nsm/bro/logs/current/smb_files.log\n</code></pre>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#cloud-and-hybrid-detection-optional","title":"Cloud and Hybrid Detection (Optional)","text":"<p>If network extends into VPN or Cloud-connected environments:</p>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#aws","title":"AWS","text":"<ul> <li>VPC Flow Logs will show port 445 connections \u2192 suspicious if not expected</li> </ul> <pre><code>aws logs filter-log-events --log-group-name VPCFlowLogs --filter-pattern \"port 445\"\n</code></pre>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#azure","title":"Azure","text":"<ul> <li>NSG Flow Logs + Azure Defender \u2192 SMB protocol detection (Unusual Inbound SMB Traffic alert)</li> </ul>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#gcp","title":"GCP","text":"<ul> <li>VPC Flow Logs + Security Command Center \u2192 Look for TCP/445 traffic alerts</li> </ul> <p>Operator Note: SMB traffic between cloud environments is often unexpected and should be reviewed immediately.</p>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#running-script","title":"Running Script","text":"<p>N/A \u2192 Can be scripted if frequent Zeek log review is required.</p>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#dependencies","title":"Dependencies","text":"<ul> <li>Security Onion running and properly configured</li> <li>Suricata / Zeek enabled in Security Onion</li> <li>Alerts and Hunt dashboard access</li> </ul>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Security Onion (Alerts + Hunt + Zeek SMB logs) Network Native SMB traffic detection and analysis OSSEC / Wazuh Cross-platform Package Manager Detect SMB-based file access or login attempts Cloud native flow logs + alerts (AWS, Azure, GCP) Cloud Native Detect SMB traffic across hybrid cloud"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate Alerts view and hunt for SMB activity</li> <li> Detect and investigate SMB alerts (ET POLICY, ET TROJAN CobaltStrike SMB)</li> <li> Use Hunt to drill down and analyze SMB patterns</li> <li> Review Zeek SMB logs \u2192 look for file transfers and executable sharing</li> <li> Validate cloud environments \u2192 review VPC/NSG Flow Logs for unexpected SMB traffic</li> <li> Confirm with asset owners if detected SMB activity is authorized</li> <li> Document all findings and escalate unauthorized or suspicious activity</li> </ul>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#best-practices","title":"Best Practices","text":"<ul> <li>Monitor both alerts and Hunt for SMB \u2014 attackers may generate low/no alerts but Hunt will show patterns.</li> <li>Zeek SMB logs provide file-level insights \u2192 critical for lateral movement detection.</li> <li>Block SMB traffic at perimeter or cloud security groups unless explicitly required.</li> <li>Enable slow scan and anomaly-based SMB detection in Suricata / SO rules.</li> </ul>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#references","title":"References","text":"<ul> <li>Security Onion Alerts</li> <li>Security Onion Hunt</li> <li>Zeek SMB Protocol Analyzer</li> </ul>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Original retained and expanded with multi-method SMB detection + operator checklist Leo"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/","title":"4.14 Monitor AD New Account Creation (Local + Cloud)","text":""},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#task","title":"Task","text":"<p>Monitor Active Directory (AD) and cloud environments for new user or service account creation events, validate for legitimacy, and document findings.</p>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>Access to Domain Controllers (DCs)</li> <li>A domain account with permissions to query AD and read event logs</li> <li>Incident response workstation with PowerShell</li> <li>Access to cloud native logging platforms</li> </ul>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#standards","title":"Standards","text":"<ul> <li>Team member queries the DC to obtain:</li> <li>Name of user who created new account</li> <li>Security Identifier (SID) of the creator</li> <li>Logon ID (semi-unique tracker of session)</li> <li>Name and SID of new account</li> <li>Domain of new account</li> <li>Output to CSV and compare against authorized user list</li> <li>Investigate account creator and validate authorization</li> <li>Optional: Execute PR.AC-1.1 to obtain all user attributes for advanced comparison</li> </ul>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#end-state","title":"End State","text":"<p>All new account creations (local + cloud) are discovered, validated, and documented.</p>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#notes","title":"Notes","text":"<ul> <li>Primary Windows Event IDs:</li> <li><code>4720</code> \u2192 User account created (Windows 7+/Windows Server 2008+)</li> <li><code>624</code> \u2192 User account created (Windows 2003 and older)</li> <li>Other useful Event IDs:</li> <li><code>4722</code> \u2192 Account enabled</li> <li><code>4725</code> \u2192 Account disabled</li> <li><code>4726</code> \u2192 Account deleted</li> </ul>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#powershell-active-directory","title":"PowerShell \u2192 Active Directory","text":"<p>List users created in last 5 days:</p> <pre><code>$When = ((Get-Date).AddDays(-5)).Date\nGet-ADUser -Filter {whenCreated -ge $When} -Properties whenCreated\n</code></pre> <p>Alternative AD query:</p> <pre><code>import-module activedirectory\nGet-QADUser -CreatedAfter (Get-Date).AddDays(-5)\nGet-ADUser -Filter * -Properties whenCreated | Where-Object {$_.whenCreated -ge ((Get-Date).AddDays(-5)).Date}\n</code></pre>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#powershell-security-event-logs-direct-account-creation-events","title":"PowerShell \u2192 Security Event Logs (Direct account creation events)","text":"<pre><code>Get-EventLog Security -InstanceId 4720 -after ((get-date).AddDays(-1))\n</code></pre> <p>Operator Note: 4720 is the most important \u2192 direct user creation.</p>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#additional-sid-queries-and-investigations","title":"Additional SID Queries and Investigations","text":""},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#get-sid-of-ad-group","title":"Get SID of AD Group","text":"<pre><code>Get-ADGroup -Identity \"some_group_name\"\n</code></pre>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#get-group-from-sid","title":"Get Group from SID","text":"<pre><code>Get-ADGroup -Identity S-1-5-32-544\n</code></pre>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#local-user-sid","title":"Local User SID","text":"<pre><code>wmic useraccount where name='some_username' get sid\n</code></pre>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#current-user-sid","title":"Current User SID","text":"<pre><code>whoami /user\n</code></pre>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#local-admin-sid","title":"Local Admin SID","text":"<pre><code>wmic useraccount where (name='administrator' and domain='%computername%') get name,sid\n</code></pre>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#find-username-from-sid","title":"Find username from SID","text":"<pre><code>wmic useraccount where sid='S-1-3-12-XYZAA-1111' get name\n</code></pre>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#cloud-platform-user-creation-monitoring","title":"Cloud Platform User Creation Monitoring","text":""},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#aws-cloudtrail","title":"AWS \u2192 CloudTrail","text":"<pre><code>aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=CreateUser\n</code></pre> <ul> <li>Review IAM user creation events</li> </ul>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#azure-azure-ad-audit-logs","title":"Azure \u2192 Azure AD Audit Logs","text":"<pre><code>Search-UnifiedAuditLog -StartDate (Get-Date).AddDays(-1) -Operations \"Add user\"\n</code></pre> <p>or via Portal \u2192 Azure AD \u2192 Audit Logs</p>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#gcp-cloud-audit-logs","title":"GCP \u2192 Cloud Audit Logs","text":"<pre><code>gcloud logging read \"protoPayload.methodName=\\\"google.admin.directory.user.insert\\\"\"\n</code></pre> <p>Operator Note: Validate if new user/service account was provisioned automatically or manually.</p>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#running-script","title":"Running Script","text":"<p><code>.\\\\AD_AccountCreationDetection.ps1</code></p> <p>Operator Note: This should be run at intervals (command-directed or daily).</p>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#dependencies","title":"Dependencies","text":"<ul> <li>AD Module for PowerShell</li> <li>Event Log Access</li> <li>Cloud Admin roles (reader for audit logs)</li> </ul>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Security Onion (via Winlogbeat) Network Native SMB + AD event ingest BloodHound AD Native Visualize and audit AD permissions and accounts OSSEC / Wazuh Cross-platform Native Detect user additions AWS CloudTrail AWS Native IAM user creation Azure AD Audit Logs Azure Native User creation tracking GCP Cloud Audit Logs GCP Native Service/User account creation"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Run PowerShell commands for local AD \u2192 capture new user creations</li> <li> Collect SID and Logon ID of creator and new account</li> <li> Validate if account creation was authorized \u2192 request/approval</li> <li> Review Event IDs for suspicious enable/delete/disabling post-creation</li> <li> Review cloud (AWS, Azure, GCP) audit logs for new user/service account additions</li> <li> Investigate accounts not aligned with change control</li> <li> Document findings and close cases or escalate</li> </ul>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#best-practices","title":"Best Practices","text":"<ul> <li>Automate queries into SIEM/SOAR for real-time alerts</li> <li>Validate service account creations \u2192 often targets for persistence</li> <li>Include cloud in daily/weekly reviews</li> <li>Tag or annotate all authorized service accounts</li> </ul>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#references","title":"References","text":"<ul> <li>PowerShell Get Recently Created Users</li> <li>AWS CloudTrail CreateUser</li> <li>Azure AD Audit Logs</li> <li>GCP Cloud Audit Logs</li> </ul>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Original retained and expanded for cloud + operator workflow Leo"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/","title":"4.15 Monitor DHCP for New Reservations (Local + Cloud)","text":""},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#task","title":"Task","text":"<p>Monitor DHCP servers for new reservations or leases that could indicate unauthorized device connections or adversary persistence mechanisms.</p>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>Access to Dynamic Host Configuration Protocol (DHCP) server</li> <li>Administrator-level account</li> <li>Incident response workstation with PowerShell</li> <li>Access to cloud DHCP-equivalent services for review</li> </ul>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#standards","title":"Standards","text":"<ul> <li>Team member determines if audit logging is enabled within the DHCP Management Console.</li> <li>Team member enables logging if not already enabled.</li> <li>Team member connects to the DHCP server log and determines the presence of new reservations.</li> <li>Team member exports applicable Windows events to an external file for documentation and comparison.</li> <li>Team member compares against known good reservation list.</li> </ul>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#end-state","title":"End State","text":"<p>All new DHCP reservations and lease assignments are discovered, logged, validated, and documented.</p>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#notes","title":"Notes","text":"<p>There are various ways to do this task. From an incident response perspective, the best choice (when supported) is a PowerShell script that queries DHCP event logs or leverages DHCP cmdlets to capture reservations and lease events.</p> <ul> <li>The applicable log on Server 2008+ is:</li> </ul> <pre><code>Microsoft-Windows-DHCP Server Events/Operational\n</code></pre> <ul> <li>Applicable Event ID:</li> </ul> <pre><code>Event ID 106 \u2192 New reservation created\n</code></pre> <ul> <li> <p>CSV files from DHCP exports can be parsed with PowerShell via the <code>Get-Content</code> Cmdlet.</p> </li> <li> <p>Windows Server 2012 and higher support DHCP PowerShell module commands that may also leave traces in PowerShell logs.</p> </li> </ul>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#windows-dhcp-server-enable-logging","title":"Windows DHCP Server \u2192 Enable Logging","text":"<pre><code>reg add HKLM\\System\\CurrentControlSet\\Services\\DhcpServer\\Parameters /v ActivityLogFlag /t REG_DWORD /d 1\n</code></pre>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#default-log-location","title":"Default log location:","text":"<pre><code>%windir%\\System32\\Dhcp\n</code></pre>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#view-dhcp-event-logs-event-id-106","title":"View DHCP Event Logs \u2192 Event ID 106","text":"<pre><code>Get-WinEvent -LogName \"Microsoft-Windows-DHCP Server Events/Operational\" -FilterXPath \"*[System/EventID=106]\"\n</code></pre> <p>Look for:</p> <ul> <li>IP Address</li> <li>MAC Address</li> <li>Client Hostname</li> <li>Reservation details</li> </ul>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#linux-dhcp-monitoring-optional","title":"Linux DHCP Monitoring (optional)","text":""},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#view-dhcp-lease-logs","title":"View DHCP lease logs","text":"<pre><code>grep -Ei 'dhcp' /var/log/syslog.1\n</code></pre>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#real-time-view","title":"Real-time view:","text":"<pre><code>tail -f dhcpd.log\n</code></pre>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#powershell-script-compare-new-dhcp-leases-to-baseline","title":"PowerShell Script \u2192 Compare new DHCP leases to baseline","text":"<pre><code># Gather DHCP lease info\nnetsh dhcp server scope &lt;IP ADDRESS&gt; show clients 1 &gt; C:\\Monitor\\New_dhcp_list.txt\n\n# Remove top and bottom lines\n$file = cat C:\\Monitor\\New_dhcp_list.txt | select -skip 8\n$len = $file.length-4\n$file = $file[0..($len)]\n\n# Extract relevant columns\n$file | foreach-object{$_.split()[0,4,7,18] -join ' '} &gt; C:\\Monitor\\New_dhcp_list.txt\n\n# Compare to known good and alert if different\nCompare-Object $(Get-Content .\\Known_good_dhcp_list.txt) $(Get-Content .\\new_dhcp_list.txt) &gt;&gt; .\\Domain_Changes_Log.txt\nif ((Compare-Object $(Get-Content .\\Known_good_dhcp_list.txt) $(Get-Content .\\New_dhcp_list.txt)) -ne $null) {\n    [System.Reflection.Assembly]::LoadWithPartialName(\"System.Windows.Forms\")\n    $oReturn=[system.windows.forms.messagebox]::show(\"DHCP Client has been added! This change needs to be verified.\")\n}\n</code></pre>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#cloud-environment-monitoring","title":"Cloud Environment Monitoring","text":""},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#aws-dhcp-options-sets-and-network-leases-vpc","title":"AWS \u2192 DHCP Options Sets and Network Leases (VPC)","text":"<ul> <li>DHCP Options Sets \u2192 Static \u2192 not typically used for dynamic reservations.</li> <li>Use CloudWatch + VPC Flow Logs \u2192 Detect unexpected clients.</li> </ul> <pre><code>aws ec2 describe-dhcp-options\naws ec2 describe-instances --query 'Reservations[*].Instances[*].PrivateIpAddress'\n</code></pre>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#azure-dhcp-via-vnets-dynamic-by-default","title":"Azure \u2192 DHCP via VNets (Dynamic by default)","text":"<ul> <li>NSG + Azure Monitor \u2192 Detect new IP to MAC bindings</li> <li>Optionally enable Network Watcher + Flow logs</li> </ul>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#gcp-cloud-dhcp-vpc-internal-ip-assignment","title":"GCP \u2192 Cloud DHCP (VPC internal IP assignment)","text":"<ul> <li>VPC Flow Logs \u2192 Detect new devices pulling IPs</li> <li>GCP SCC \u2192 Detect unmanaged assets appearing on network</li> </ul>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#dependencies","title":"Dependencies","text":"<ul> <li>Windows DHCP Server / Domain Admin Access</li> <li>PowerShell for automation</li> <li>Cloud provider IAM access (reader roles)</li> <li>Network visibility for DHCP-bound traffic (optional)</li> </ul>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage DHCP Server Logs Windows Native Reservation + lease logging PowerShell DHCP Module Windows Native (2012+) Query + automate DHCP monitoring Linux Syslog / DHCPD Logs Linux Native DHCP lease monitoring AWS CloudWatch + VPC Flow Logs AWS Native Detect network DHCP activity Azure Monitor + NSG Flow Logs Azure Native Detect new IP/MAC pairs GCP VPC Flow Logs + SCC GCP Native Detect new DHCP clients"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate that DHCP server logging is enabled.</li> <li> Collect and review DHCP event logs \u2192 look for Event ID 106.</li> <li> Execute PowerShell script and compare new leases to baseline.</li> <li> Investigate any new reservations or leases \u2192 validate with system owner.</li> <li> Check for unusually short or long lease times.</li> <li> Review cloud DHCP-equivalent \u2192 AWS, Azure, GCP \u2192 look for new clients/IP bindings.</li> <li> Document all findings and escalate unknown devices.</li> </ul>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#best-practices","title":"Best Practices","text":"<ul> <li>Monitor for new DHCP reservations \u2192 adversaries may use persistent MAC addresses</li> <li>Compare reservation list daily/weekly \u2192 look for drift</li> <li>In cloud \u2192 unexpected DHCP usage or dynamic IP \u2192 high risk indicator</li> <li>Integrate DHCP monitoring into broader asset discovery and management process</li> </ul>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#references","title":"References","text":"<ul> <li>DHCP Diagnostics</li> <li>DHCP Operational Events</li> <li>Get-Content Commandlet</li> </ul>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Original retained and expanded with cloud + operator workflow + recommendations Leo"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/","title":"4.16 Monitor AD for New DNS Names (Local + Cloud)","text":""},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#task","title":"Task","text":"<p>Monitor Active Directory (AD) DNS zones for new domain names and DNS entries that may indicate unauthorized hosts, attacker infrastructure, or persistence mechanisms.</p>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>Access to Domain Controllers with DNS Server role installed</li> <li>Domain account with required permissions</li> <li>Workstation with Remote Server Administration Tools (RSAT) or PowerShell</li> <li>Access to cloud provider DNS services if applicable (AWS, Azure, GCP)</li> </ul>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#standards","title":"Standards","text":"<ul> <li>Team member opens DNS Console \u2192 navigates to Forward Lookup Zones</li> <li>Export records \u2192 Save locally</li> <li>Repeat task on defined schedule \u2192 Compare for new entries</li> <li>OR \u2192 Team member uses command-line tool/script to export DNS zones</li> <li>Repeat and compare outputs periodically to detect new entries</li> </ul>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#end-state","title":"End State","text":"<p>All new DNS zone records are discovered, recorded, validated, and confirmed as authorized or escalated.</p>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#notes","title":"Notes","text":"<p>This task can be repetitive. Operators should automate where possible:</p> <ul> <li>PowerShell \u2192 preferred for export + diff</li> <li>File comparison \u2192 manual (Kdiff) or automated PowerShell compare-object</li> <li>Cloud DNS \u2192 API / CLI polling + diff</li> </ul>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#windows-server-dns-console-manual-export","title":"Windows Server DNS Console (Manual Export)","text":"<ol> <li>Open DNS Management Console</li> <li>Expand Forward Lookup Zones</li> <li>Right-click Zone \u2192 Export List \u2192 Save as <code>.txt</code> or <code>.csv</code></li> <li>Repeat later \u2192 Compare saved lists manually</li> </ol>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#powershell-export-dns-records-recommended","title":"PowerShell \u2192 Export DNS Records (Recommended)","text":""},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#all-dns-records-wmi-method","title":"All DNS Records (WMI Method)","text":"<pre><code>Get-WmiObject -Namespace root\\MicrosoftDNS -Class MicrosoftDNS_ResourceRecord | \nSelect-Object __Class, ContainerName, DomainName, RecordData, OwnerName |\nOut-GridView\n</code></pre>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#root-hints","title":"Root Hints","text":"<pre><code>Get-WmiObject -Namespace root\\MicrosoftDNS -Class MicrosoftDNS_ResourceRecord |\nWhere-Object {$_.DomainName -eq \"..roothints\"} |\nOut-GridView\n</code></pre>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#powershell-export-and-compare-automated-detection","title":"PowerShell \u2192 Export and Compare (Automated Detection)","text":""},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#export","title":"Export","text":"<pre><code>Get-DnsServerResourceRecord -ZoneName \"corp.example.com\" | \nSelect-Object HostName, RecordType, RecordClass, RecordData |\nExport-Csv \"C:\\Monitor\\AD_DNS_Snapshot.csv\" -NoTypeInformation\n</code></pre>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#compare","title":"Compare","text":"<pre><code>Compare-Object -ReferenceObject (Get-Content C:\\Monitor\\AD_DNS_Snapshot.csv) `\n-DifferenceObject (Get-Content C:\\Monitor\\AD_DNS_Snapshot_2.csv)\n</code></pre> <p>Operator Note: Schedule export + compare daily \u2192 alert if diff found</p>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#cloud-environment-dns-monitoring","title":"Cloud Environment DNS Monitoring","text":""},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#aws-route53","title":"AWS Route53","text":"<pre><code>aws route53 list-resource-record-sets --hosted-zone-id ZONEID\n</code></pre> <ul> <li>Save JSON \u2192 Compare daily \u2192 Look for new entries</li> </ul>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#azure-dns","title":"Azure DNS","text":"<pre><code>Get-AzDnsRecordSet -ResourceGroupName \"RG\" -ZoneName \"example.com\"\n</code></pre> <ul> <li>Save to file \u2192 Compare</li> </ul>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#gcp-cloud-dns","title":"GCP Cloud DNS","text":"<pre><code>gcloud dns record-sets list --zone=\"example-zone\"\n</code></pre> <ul> <li>Export and compare</li> </ul> <p>Operator Note: New external-facing records (e.g. subdomains) \u2192 high risk \u2192 verify owners</p>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#running-script","title":"Running Script","text":"<p>Operators should automate periodic snapshots and compare results daily or weekly.</p> <pre><code># Example Scheduled Task\npowershell.exe -File C:\\Scripts\\Monitor_AD_DNS.ps1\n</code></pre>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#dependencies","title":"Dependencies","text":"<ul> <li>RSAT + DNS Management Tools (Windows)</li> <li>PowerShell DNS Module or WMI access</li> <li>Cloud CLI tools (AWS CLI, Azure CLI, GCP SDK)</li> </ul>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage DNS Console (Export List) Windows Native Manual export PowerShell DNS Cmdlets Windows Native Automated export + compare Kdiff / WinMerge Cross-platform Installable Manual compare AWS Route53 CLI AWS Native DNS record export Azure CLI DNS Azure Native DNS record export GCP gcloud DNS GCP Native DNS record export"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate access to AD DNS \u2192 Confirm ability to export</li> <li> Collect and export current zone records</li> <li> Compare to baseline \u2192 Look for new additions</li> <li> Investigate \u2192 Check with system owner for unauthorized entries</li> <li> Review cloud DNS zones (AWS, Azure, GCP) \u2192 Detect new records</li> <li> Validate DNS record types (A, CNAME, TXT) \u2192 Suspicious types escalate</li> <li> Document findings and escalate unauthorized names</li> </ul>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#best-practices","title":"Best Practices","text":"<ul> <li>Automate export + diff \u2192 reduces operator burden</li> <li>Investigate unknown A records \u2192 lateral movement risk</li> <li>Review TXT records \u2192 attacker may use for C2/commands</li> <li>Integrate DNS detection with SIEM/SOAR for real-time alerts</li> </ul>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#references","title":"References","text":"<ul> <li>Dnscmd tool reference</li> <li>Scripting with PowerShell</li> <li>PowerShell DNS</li> <li>AWS Route53 CLI</li> <li>Azure DNS PowerShell</li> <li>GCP Cloud DNS</li> </ul>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Original retained + expanded to include automation, cloud DNS, operator procedures Leo"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/","title":"4.17 Respond to Alerts About Unauthorized Users","text":""},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#task","title":"Task","text":"<p>Respond to alerts about unauthorized users or unsuccessful logins. Investigate, triage, and escalate as necessary using established incident response processes.</p>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#conditions","title":"Conditions","text":"<ul> <li>Proper controls and security practices applied to Active Directory or other directory platform</li> <li>Effective use of log management and SIEM (Security Information and Event Management)</li> <li>Working in concert with Team Leader\u2019s priorities and interactions with mission partner</li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#standards","title":"Standards","text":"<ul> <li>Ensure Active Directory logs are integrated into log management tool and test SIEM alerting</li> <li>Responding party should have knowledge of environment and understand the incident response process</li> <li>Incident response process should detail:</li> <li>Escalation criteria</li> <li>Remediation plan</li> <li>Ability to investigate or collect evidence</li> <li>Abnormal activity should be logged and remediated until resolved</li> <li>Accounts should be suspended, terminated, or monitored with advanced logging if necessary</li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#end-state","title":"End State","text":"<p>Unauthorized user alerts are identified, investigated, and resolved utilizing the proper incident response procedure and documentation.</p>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#notes","title":"Notes","text":"<ul> <li>Unauthorized user activities can indicate compromised credentials, rogue accounts, or misconfiguration.</li> <li>Immediate investigation, correlation, and escalation is required.</li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#security-onion-siem","title":"Security Onion / SIEM","text":"<ul> <li>Login to SIEM interface (e.g. Kibana)</li> <li>Select Dashboard \u2192 Choose Sysmon \u2192 Host Hunting</li> <li>Validate Active Directory logs are populating properly</li> <li>Look for relevant events:</li> <li>Event ID 4624 (Logon Success)</li> <li>Event ID 4625 (Logon Failed)</li> <li>Event ID 4720 (User Account Created)</li> <li>Event ID 4726 (User Account Deleted)</li> <li>Event ID 4728/4732 (User Added to Group)</li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#advanced-filtering-kibana-example","title":"Advanced Filtering (Kibana Example):","text":"<pre><code>event.code:4625 AND user.name:* AND NOT user.name:knownadmin\n</code></pre> <ul> <li>Detect login failures not from known admins</li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#active-directory-powershell","title":"Active Directory / PowerShell","text":""},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#search-for-recently-created-accounts","title":"Search for recently created accounts:","text":"<pre><code>Get-ADUser -Filter * -Properties whenCreated | Where-Object {$_.whenCreated -gt (Get-Date).AddDays(-1)}\n</code></pre>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#search-for-last-login-time-for-newsuspicious-users","title":"Search for last login time for new/suspicious users:","text":"<pre><code>Get-ADUser -Filter * -Properties LastLogonTimestamp | Select-Object Name,LastLogonTimestamp\n</code></pre>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#review-group-membership-privileged-group-check","title":"Review Group Membership (Privileged Group Check)","text":"<pre><code>Get-ADGroupMember -Identity \"Domain Admins\"\n</code></pre>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#linux-macos-validation","title":"Linux / macOS Validation","text":""},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#check-for-new-local-accounts","title":"Check for new local accounts:","text":"<pre><code>cat /etc/passwd | grep -v \"/nologin\" | grep -v \"false\"\n</code></pre>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#check-failed-logins","title":"Check failed logins:","text":"<pre><code>cat /var/log/auth.log | grep \"Failed password\"\n</code></pre> <p>or</p> <pre><code>lastb\n</code></pre>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#cloud-iam-monitoring","title":"Cloud IAM Monitoring","text":""},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#aws-cloudtrail-guardduty","title":"AWS \u2192 CloudTrail + GuardDuty","text":"<pre><code>aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=CreateUser\n</code></pre> <ul> <li>Look for unauthorized IAM users</li> </ul> <p>GuardDuty Findings:</p> <ul> <li>UnauthorizedAccess:IAMUser/AnomalousBehavior</li> <li>Recon:IAMUser/PasswordBruteForce</li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#azure-azure-ad-audit-logs","title":"Azure \u2192 Azure AD Audit Logs","text":"<pre><code>Search-UnifiedAuditLog -StartDate (Get-Date).AddDays(-1) -Operations \"Add user\",\"Update user\",\"Add member to group\"\n</code></pre> <p>or via Portal \u2192 Azure AD \u2192 Audit Logs \u2192 Filter for user creation and role changes</p>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#gcp-cloud-audit-logs","title":"GCP \u2192 Cloud Audit Logs","text":"<pre><code>gcloud logging read \"protoPayload.methodName=google.admin.directory.user.insert\"\n</code></pre> <ul> <li>Detect unauthorized or unexpected user account creation</li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#dependencies","title":"Dependencies","text":"<ul> <li>Sysmon</li> <li>Wazuh</li> <li>Wazuh configuration file (ossec.conf)</li> <li>Security Onion</li> <li>Elasticsearch</li> <li>Active Directory PowerShell module</li> <li>Cloud CLI tools (AWS CLI, Azure CLI, gcloud)</li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Security Onion / Wazuh Network Native SIEM/Log aggregation PowerShell Windows Native AD investigation OSSEC / Wazuh Cross-platform Native Local log detection AWS CloudTrail + GuardDuty AWS Native IAM unauthorized detection Azure AD Audit Logs + Sentinel Azure Native User and login anomalies GCP Cloud Audit Logs GCP Native User creation and login anomalies"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Review and validate SIEM alert for unauthorized user event</li> <li> Correlate \u2192 Determine AD, Local, Cloud origin</li> <li> Investigate \u2192 Determine WHO created user, WHERE they logged in, and WHAT they accessed</li> <li> Validate account owner and intended usage</li> <li> If unauthorized \u2192 Disable / remove user account immediately</li> <li> Review group membership and permissions of unauthorized account</li> <li> Search for follow-on activity (logon, RDP, file access)</li> <li> Document all findings, preserve evidence</li> <li> Escalate per IR plan if threat actor confirmed or lateral movement suspected</li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#best-practices","title":"Best Practices","text":"<ul> <li>Implement alerting for user creation + privilege escalation (automated detection)</li> <li>Perform daily review of newly created accounts</li> <li>Establish quarantine OU for suspicious accounts</li> <li>Integrate cloud and on-prem user creation into centralized SIEM</li> <li>Disable interactive logon rights for service accounts (limit exposure)</li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#references","title":"References","text":"<ul> <li>Microsoft Unauthorized User</li> <li>Microsoft Login Failed</li> <li>AWS GuardDuty IAM Findings</li> <li>Azure AD Audit Logs</li> <li>GCP Cloud Audit Logs</li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Original retained + expanded for IR workflow, multi-platform unauthorized user detection Leo"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/","title":"4.18 Compare Hashes of Suspected Malware","text":""},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#task","title":"Task","text":"<p>Perform Hash Analysis and Signature check of Suspected Malware to identify malware samples, support incident response investigations, and validate against known-good and known-bad datasets.</p>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>A suspected malware file or files</li> <li>File hashing tools</li> <li>Access to internal hash repositories and/or external threat intelligence sources (VirusTotal, Hybrid Analysis, Abuse.ch)</li> </ul>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#standards","title":"Standards","text":"<ul> <li>Team member obtains a hash (MD5, SHA1, SHA256 preferred) and saves them to a text file</li> <li>Compare hash value against previously identified IOCs or known good hashsets</li> <li>Use VirusTotal and other threat intelligence platforms to identify malware detections</li> <li>Determine file signature using appropriate tools (Sigcheck, SignTool) to assess trustworthiness</li> <li>Record and document findings for IR process</li> </ul>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#end-state","title":"End State","text":"<p>All file hashes of suspected malware have been analyzed, compared, validated, and documented.</p>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#notes","title":"Notes","text":"<ul> <li>Hash lookups do not upload the file itself \u2192 safer option (avoid uploading sensitive files when possible)</li> <li>Uploading the full file \u2192 creates searchable record visible to external parties (potential risk during IR)</li> <li>Validate using multiple sources \u2192 public intelligence + internal allow/block lists</li> <li>Use multiple algorithms \u2192 MD5 (legacy), SHA1 (common), SHA256 (preferred)</li> </ul>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#gathering-hash-of-files","title":"Gathering Hash of Files","text":""},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#macos","title":"MacOS","text":"<pre><code>openssl md5 README.md\nopenssl sha1 README.md\n</code></pre>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#linux","title":"Linux","text":"<pre><code>md5 filename\nsha1sum filename\n</code></pre>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#windows","title":"Windows","text":""},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#certutil","title":"CertUtil","text":"<pre><code>certutil -hashfile C:\\Malware\\sample.exe SHA256\n</code></pre>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#powershell","title":"PowerShell","text":"<pre><code>Get-FileHash -Path \"C:\\Malware\\sample.exe\" -Algorithm SHA256\n</code></pre>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#hashdeep-optional","title":"Hashdeep (optional)","text":"<pre><code>hashdeep.exe -c md5,sha1,sha256 -r C:\\Malware\\sample.exe\n</code></pre>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#submitting-hashes-to-virustotal-using-sysinternals-suite","title":"Submitting Hashes to VirusTotal using Sysinternals Suite","text":""},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#process-explorer","title":"Process Explorer","text":"<ul> <li>Run ProcExp.exe</li> <li>Right-click Columns \u2192 <code>Select Columns</code> \u2192 enable <code>VirusTotal</code></li> <li>Accept Terms of Service</li> <li>Hashes will be submitted automatically for running processes</li> </ul>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#sigcheckexe","title":"SigCheck.exe","text":"<pre><code>sigcheck.exe -vt file.exe\nsigcheck.exe -v -c C:\\\n</code></pre> <ul> <li><code>-vt</code> \u2192 submit to VirusTotal  </li> <li><code>-c</code> \u2192 generate CSV  </li> <li><code>-v</code> \u2192 include signature information</li> </ul>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#signature-checking-verify-file-authenticity","title":"Signature Checking (Verify File Authenticity)","text":"<ul> <li>Sigcheck.exe \u2192 native signature checks</li> <li>SignTool.exe (part of Visual Studio SDK)</li> </ul> <pre><code>signtool verify /pa file.exe\n</code></pre>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#advanced-cloudremote-intelligence-check-expanded","title":"Advanced Cloud/Remote Intelligence Check (Expanded)","text":""},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#virustotal-api-web","title":"VirusTotal (API + Web)","text":"<pre><code>https://www.virustotal.com/gui/file/&lt;hash&gt;\n</code></pre>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#hybrid-analysis","title":"Hybrid Analysis","text":"<pre><code>https://www.hybrid-analysis.com/search?query=&lt;hash&gt;\n</code></pre>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#abusech-malwarebazaar","title":"Abuse.ch MalwareBazaar","text":"<pre><code>https://bazaar.abuse.ch/search.php?query=&lt;hash&gt;\n</code></pre>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#cloud-environment-workflow","title":"Cloud Environment Workflow","text":""},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#aws-guardduty","title":"AWS GuardDuty","text":"<ul> <li>Uses threat intelligence feeds \u2192 hash matching automatic</li> <li>Manual submission \u2192 not supported natively \u2192 use external VirusTotal submission</li> </ul>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#azure-defender-for-endpoint","title":"Azure Defender for Endpoint","text":"<ul> <li>Hash submissions automatic for detections</li> <li>Review suspicious file hashes via Defender Portal</li> </ul>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#gcp-virustotal-native-integration","title":"GCP VirusTotal (native integration)","text":"<ul> <li>Hash submission and review directly supported in GCP \u2192 use portal or CLI/API</li> </ul>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#running-script","title":"Running Script","text":"<p>Automated scheduled collection example (Windows):</p> <pre><code>Get-ChildItem -Path \"C:\\Malware\\\" -File | ForEach-Object {\n    Get-FileHash -Path $_.FullName -Algorithm SHA256 | Export-Csv \"C:\\Hashes\\collected_hashes.csv\" -Append -NoTypeInformation\n}\n</code></pre>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#dependencies","title":"Dependencies","text":"<ul> <li>CertUtil</li> <li>PowerShell</li> <li>OpenSSL / sha1sum / md5sum</li> <li>Sysinternals (Process Explorer, SigCheck)</li> <li>Optional: VirusTotal API key (for automated queries)</li> </ul>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage CertUtil Windows Native Single hash calculation PowerShell Windows Native Single/multi hash calculation Hashdeep Windows/Linux/macOS Open Source Multi-hash file integrity Process Explorer Windows Sysinternals Running process hash + VirusTotal Sigcheck Windows Sysinternals Signature + VirusTotal hash VirusTotal Cloud Web/API Threat intelligence lookup Hybrid Analysis Cloud Web Threat intelligence lookup AWS GuardDuty Cloud Native Automatic hash intel Azure Defender Cloud Native Automatic hash intel GCP VirusTotal Cloud Native Hash submission and review"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Acquire suspected malware file (forensic chain of custody)</li> <li> Calculate hash (MD5, SHA1, SHA256)</li> <li> Verify hash with VirusTotal, Hybrid Analysis, MalwareBazaar</li> <li> Run signature check \u2192 SigCheck + SignTool</li> <li> Review cloud security platform detections (if applicable)</li> <li> Document findings + submit to incident management system</li> <li> Escalate samples with malicious or unknown results to malware analysis team</li> <li> Update allow/block lists with findings</li> </ul>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#best-practices","title":"Best Practices","text":"<ul> <li>Always calculate hashes prior to executing/handling malware</li> <li>Use multiple hash algorithms for better detection coverage</li> <li>Avoid uploading sensitive/internal files to public services without proper approval</li> <li>Maintain local hash repositories for quick verification</li> <li>Automate daily/weekly hash collection + comparison via scripts</li> </ul>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#references","title":"References","text":"<ul> <li>VirusTotal</li> <li>Hybrid Analysis</li> <li>Abuse.ch Malware Bazaar</li> <li>Sysinternals Process Explorer + VirusTotal</li> <li>Sysinternals Sigcheck + VirusTotal</li> <li>MD5Deep / Hashdeep</li> <li>SignTool</li> </ul>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Original retained + expanded with multi-platform hashing, cloud, operator workflow Leo"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/","title":"4.19-Perform Manual Host Analysis","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/#tasks-perform-manual-host-analysis","title":"Tasks Perform Manual Host Analysis","text":"<p>4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows 4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File 4.19.3_Create_Hard_Disk_Image </p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/","title":"4.19.1 Perform Manual Host Analysis \u2013 Live Physical Host - Windows","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#task","title":"Task","text":"<p>Perform manual analysis of a suspected compromised live physical Windows host to collect volatile data and identify artifacts matching known Indicators of Compromise (IOCs).</p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>A suspected compromised Windows system.</li> <li>Local administrator account credentials.</li> <li>USB device or incident response workstation with memory analysis and forensic tools.</li> <li>One or more Indicators of Compromise (IOCs).</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#standards","title":"Standards","text":"<ul> <li>Team member inserts a USB device containing memory analysis tools into the suspected compromised computer.</li> <li>Team member loads and runs analysis software from the USB drive to capture volatile data (memory, processes, connections, etc.) and outputs the results to the USB drive.</li> <li>Team member analyzes the output and validates presence of known IOCs.</li> <li>If malware infection risk exists for removable media, output results should be transmitted over network to a secure share instead.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#end-state","title":"End State","text":"<ul> <li>Processes, files, registry entries, memory artifacts, and/or network connections that match one or more IOCs are identified and documented.</li> <li>Analysis results are saved and transferred securely for further investigation.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#notes","title":"Notes","text":"<ul> <li>Be cautious when working on live systems \u2014 running malware may detect analysis tools or alter artifacts.</li> <li>External tools should be run from removable read-only media or isolated IR jumpkits.</li> <li>USB should not be used if IOC suggests malware propagation via USB \u2192 use network share or remote analysis.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#tools","title":"Tools","text":"<ul> <li>Redline (Mandiant) - Analyzes live memory and running processes from external media.</li> <li>Sysinternals Suite (Microsoft) - Tools like <code>PsList</code>, <code>PsLoggedOn</code>, <code>TCPView</code>, <code>Autoruns</code> for live analysis.</li> <li>WinPMEM (Velociraptor project) - Lightweight memory capture tool.</li> <li>FTK Imager (AccessData) - Can capture live memory and disk images.</li> <li>LiveKatz / Mimikatz (use carefully with authorization) - Credential artifacts.</li> <li>Sysmon (if pre-installed) - Check for suspicious process execution history.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#step-1-prepare-usb-or-ir-workstation","title":"Step 1 \u2192 Prepare USB or IR Workstation","text":"<ul> <li>Load memory analysis tools (e.g. Redline, Sysinternals) onto a clean USB or IR laptop.</li> <li>Validate hashes of toolset before deployment.</li> <li>If USB use is discouraged (USB malware IOC), prepare secure share location.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#step-2-insert-tools-and-collect-memory-snapshot","title":"Step 2 \u2192 Insert Tools and Collect Memory Snapshot","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#example-with-redline-preferred","title":"Example with Redline (Preferred)","text":"<ul> <li>Insert USB</li> <li>Launch Redline collection configuration wizard</li> <li>Select \"Create a Standard Collector\" \u2192 choose collection options (Processes, DLLs, Network Connections, Registry).</li> <li>Output directory \u2192 select USB or network share</li> <li>Run collection \u2192 wait for memory capture and parsing.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#example-with-ftk-imager-alternate","title":"Example with FTK Imager (Alternate)","text":"<ul> <li>FTK Imager \u2192 File \u2192 Capture Memory</li> <li>Choose Destination \u2192 USB or network share</li> <li>Start capture \u2192 Validate capture completion and metadata.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#example-with-winpmem-cli-memory-capture","title":"Example with WinPMEM (CLI memory capture)","text":"<pre><code>winpmem.exe --output C:\\Evidence\\memory.aff4\n</code></pre>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#step-3-analyze-captured-memory-for-ioc-artifacts","title":"Step 3 \u2192 Analyze Captured Memory for IOC Artifacts","text":"<ul> <li>Use Redline's Analysis Mode \u2192 load captured memory dataset.</li> <li>Search for known IOCs:</li> <li>Process names</li> <li>DLL hashes</li> <li>Network IPs/domains</li> <li> <p>Registry persistence keys</p> </li> <li> <p>Document any matches.</p> </li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#step-4-capture-live-host-process-connection-state","title":"Step 4 \u2192 Capture Live Host Process / Connection State","text":"<ul> <li>Use Sysinternals \u2192 PsList, TCPView</li> </ul> <pre><code>pslist\ntcpview\n</code></pre> <ul> <li>Export process list and network connections.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#step-5-collect-registry-and-autorun-entries","title":"Step 5 \u2192 Collect Registry and Autorun Entries","text":"<ul> <li>Run Autoruns (Sysinternals) and export startup entries:</li> </ul> <pre><code>autorunsc -accepteula -a * -c &gt; autoruns.csv\n</code></pre>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#step-6-transfer-results-securely","title":"Step 6 \u2192 Transfer Results Securely","text":"<ul> <li>If using USB \u2192 safely eject and hand-off to IR analysis team.</li> <li>If using network share \u2192 validate upload and access restrictions.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#running-script","title":"Running Script","text":"<pre><code># Example live collection with Redline\nStart-Process \"D:\\Redline\\RunRedline.exe\"\n\n# FTK Imager CLI Memory Dump (Optional)\n\"ftkimager.exe\" --capture-memory --destination \"X:\\CapturedMemory.mem\"\n</code></pre>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#dependencies","title":"Dependencies","text":"<ul> <li>USB drive or secure share</li> <li>Memory analysis tools</li> <li>Administrative credentials</li> <li>Pre-defined IOC list</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Redline Windows Standalone Memory + IOC scanning Sysinternals Suite Windows Standalone Live process + network analysis FTK Imager Windows Installable Memory + Disk image WinPMEM Windows Portable Memory dump Autoruns Windows Portable Registry autoruns"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#operator-recommendations-and-best-practices","title":"Operator Recommendations and Best Practices","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#checklist","title":"Checklist","text":"<ul> <li> Confirm incident scope and indicators before analysis</li> <li> Validate tools prior to usage (hashes, clean versions)</li> <li> Use network share if USB usage poses risk</li> <li> Capture volatile memory before shutting down or rebooting system</li> <li> Analyze captured artifacts \u2192 match with IOC set</li> <li> Record and escalate findings if suspicious indicators are identified</li> <li> Maintain chain of custody for evidence artifacts</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#best-practices","title":"Best Practices","text":"<ul> <li>Prefer automated collections (Redline) for consistency.</li> <li>Avoid unnecessary interaction on compromised host.</li> <li>Always capture volatile artifacts FIRST before disk.</li> <li>Use isolated analysis environments when reviewing live capture results.</li> <li>Be prepared to escalate for deeper malware analysis if advanced threats are identified.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#references","title":"References","text":"<ul> <li>FireEye Redline</li> <li>Sysinternals Suite</li> <li>Velociraptor WinPMEM</li> <li>FTK Imager</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Original retained + expanded with operator workflow + multi-platform and advanced tooling Leo"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/","title":"4.19.2 Perform Manual Host Analysis \u2013 Memory Image File","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#task","title":"Task","text":"<p>Perform analysis of a captured memory image file to identify suspicious processes, artifacts, and evidence matching Indicators of Compromise (IOCs). This is often done after initial acquisition to allow deeper analysis without impacting the live host.</p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>A memory image from a suspected compromised system</li> <li>Memory analysis tools (Volatility, Memoryze, Rekall, etc.)</li> <li>Known Indicators of Compromise (IOCs)</li> <li>A validated copy of the memory image</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#standards","title":"Standards","text":"<ul> <li>Team member copies the memory image to the incident response workstation.</li> <li>Team member performs hash verification to ensure image integrity.</li> <li>Team member uses memory analysis tools to extract forensic artifacts and compare them to IOCs.</li> <li>Analysis should include (but not limited to):</li> <li>Running processes and hidden processes</li> <li>DLLs loaded</li> <li>Network connections</li> <li>User command history</li> <li>Registry hives</li> <li>Extracted credentials or tokens</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#end-state","title":"End State","text":"<p>Suspicious processes, files, network connections, and/or command history matching IOCs are identified and documented. Artifacts are preserved for deeper forensic or malware analysis.</p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#notes","title":"Notes","text":"<p>Memory analysis can reveal active malware, fileless malware, credential stealing attacks, and lateral movement attempts. The responder should approach this methodically to not overlook artifacts:</p> <ul> <li>Always validate hashes to confirm no corruption.</li> <li>Avoid running unverified scripts or plugins from unknown sources.</li> <li>Review tool documentation regularly for updated profiles and plugins.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#tools","title":"Tools","text":"<ul> <li>Volatility - The most widely used memory analysis framework.</li> <li>Memoryze (FireEye) - Alternative GUI and CLI memory analysis tool.</li> <li>Rekall - Advanced fork of Volatility (Python-based).</li> <li>LiME + Volatility (Linux) - Memory acquisition and analysis.</li> <li>FTK Imager (For acquisition + viewing)</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#step-1-copy-memory-image-to-ir-workstation","title":"Step 1 \u2192 Copy Memory Image to IR Workstation","text":"<ul> <li>Ensure write-blocking or read-only mount of evidence media</li> <li>Copy to dedicated analysis drive</li> <li>Calculate and validate hash:</li> </ul> <pre><code># Windows\ncertutil -hashfile memory.raw sha256\n\n# Linux / macOS\nsha256sum memory.raw\n</code></pre> <ul> <li>Verify against original capture hash.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#step-2-identify-operating-system-and-profile-volatility","title":"Step 2 \u2192 Identify Operating System and Profile (Volatility)","text":"<pre><code>volatility -f memory.raw imageinfo\n</code></pre> <ul> <li>Returns suggested profile(s), such as <code>Win7SP1x64</code>.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#step-3-list-running-processes","title":"Step 3 \u2192 List Running Processes","text":"<pre><code>volatility -f memory.raw --profile=Win7SP1x64 pslist\n</code></pre> <ul> <li>Review process names, parent-child relationships.</li> <li>Look for suspicious or unsigned processes.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#step-4-identify-hidden-or-injected-processes","title":"Step 4 \u2192 Identify Hidden or Injected Processes","text":"<pre><code>volatility -f memory.raw --profile=Win7SP1x64 psscan\nvolatility -f memory.raw --profile=Win7SP1x64 malfind\n</code></pre> <ul> <li>Hidden processes = potential malware</li> <li>Malfind \u2192 review injected code and memory sections</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#step-5-list-open-network-connections","title":"Step 5 \u2192 List Open Network Connections","text":"<pre><code>volatility -f memory.raw --profile=Win7SP1x64 netscan\n</code></pre> <ul> <li>Look for connections to unusual IP addresses or ports.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#step-6-extract-dlls-loaded-by-processes","title":"Step 6 \u2192 Extract DLLs loaded by processes","text":"<pre><code>volatility -f memory.raw --profile=Win7SP1x64 dlllist\n</code></pre> <ul> <li>Review DLL paths \u2192 Unusual or temp directory DLLs may indicate malware.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#step-7-extract-registry-hives-and-review","title":"Step 7 \u2192 Extract Registry Hives and Review","text":"<pre><code>volatility -f memory.raw --profile=Win7SP1x64 hivelist\nvolatility -f memory.raw --profile=Win7SP1x64 printkey -K \"Path_to_key\"\n</code></pre> <ul> <li>Identify persistence mechanisms or malware config.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#step-8-extract-command-history-cli-usage","title":"Step 8 \u2192 Extract Command History (CLI Usage)","text":"<pre><code>volatility -f memory.raw --profile=Win7SP1x64 consoles\n</code></pre> <ul> <li>Review for attacker use of PowerShell, cmd.exe, etc.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#step-9-extract-strings-optional-bulk-review","title":"Step 9 \u2192 Extract Strings (optional bulk review)","text":"<pre><code>strings memory.raw | grep \"suspicious_keyword\"\n</code></pre> <ul> <li>Fast and simple \u2192 may reveal malware commands, passwords, etc.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#optional-cloud-workflows-if-analyzing-vm-memory-dump","title":"Optional Cloud Workflows (if analyzing VM memory dump)","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#aws","title":"AWS","text":"<ul> <li>Memory image from EC2 can be acquired via forensic acquisition (EBS snapshots).</li> <li>Process with Volatility after conversion to raw format.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#azure-gcp","title":"Azure / GCP","text":"<ul> <li>Use snapshots or disk capture \u2192 process same as physical.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#running-script","title":"Running Script","text":"<pre><code># Example Volatility Run\nvolatility -f memory.raw --profile=Win7SP1x64 pslist &gt; pslist.txt\nvolatility -f memory.raw --profile=Win7SP1x64 netscan &gt; netscan.txt\nvolatility -f memory.raw --profile=Win7SP1x64 malfind &gt; malfind.txt\n</code></pre>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#dependencies","title":"Dependencies","text":"<ul> <li>Python 2.x / 3.x (for Volatility or Rekall)</li> <li>Volatility Framework</li> <li>Administrative access on IR workstation</li> <li>Memory image file + hash verification tool</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Volatility Windows/Linux/macOS Python-based Deep memory analysis Rekall Windows/Linux/macOS Python-based Memory analysis (modern alternative) Memoryze Windows Installable GUI + CLI analysis FTK Imager Windows Installable Memory acquisition + viewing strings (Sysinternals or GNU) Cross-platform Native/Open Source Extract readable content"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#operator-recommendations-and-best-practices","title":"Operator Recommendations and Best Practices","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate integrity of memory image (hash comparison)</li> <li> Identify operating system profile using <code>imageinfo</code></li> <li> Extract and review:</li> <li> Running processes (<code>pslist</code>)</li> <li> Hidden processes (<code>psscan</code>)</li> <li> Injected/malicious code (<code>malfind</code>)</li> <li> Open network connections (<code>netscan</code>)</li> <li> Loaded DLLs (<code>dlllist</code>)</li> <li> Registry persistence (<code>hivelist</code>)</li> <li> Command history (<code>consoles</code>)</li> <li> Compare artifacts to IOC set</li> <li> Document and escalate suspicious findings</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#best-practices","title":"Best Practices","text":"<ul> <li>Use a dedicated forensic workstation for analysis</li> <li>Always hash evidence pre/post-processing</li> <li>Avoid uploading memory images to cloud/public sites</li> <li>Use multiple plugins \u2192 attackers may hide artifacts in obscure memory sections</li> <li>Review findings with malware analyst for confirmation</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#references","title":"References","text":"<ul> <li>Volatility Command Reference</li> <li>Stuxnet Trojan Memory Forensics</li> <li>FireEye Memoryze</li> <li>Rekall Memory Forensics</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Original retained + expanded with operator workflow, multi-platform analysis and advanced tooling Leo"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/","title":"4.19.3 Create Hard Disk Image","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#task","title":"Task","text":"<p>Create a forensically sound image of a hard disk from a live or offline system to preserve evidence for analysis without altering the original data.</p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>A Windows or Linux machine suspected of compromise</li> <li>Hard drive acquisition tools (dc3dd, dd, FTK Imager, Guymager)</li> <li>Access to destination storage or network share</li> <li>One or more Indicators of Compromise (IOCs) identified</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#standards","title":"Standards","text":"<ul> <li>Team member connects to the machine and creates a physical disk image using supported tools.</li> <li>Team member must provide a log file and cryptographic hash (MD5/SHA256 preferred) to validate image integrity.</li> <li>Team member must store the image in a secure location for further forensic analysis.</li> </ul> <p>Examples</p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#windows","title":"Windows","text":"<pre><code>dc3dd.exe if=\\\\.\\c: of=d:\\&lt;TARGET DRIVE&gt;\\&lt;IMAGE NAME&gt;.dd hash=md5 log=d:\\&lt;LOG DIRECTORY&gt;\\&lt;LOG NAME&gt;.log\n</code></pre>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#linux-remote-copy","title":"Linux (Remote Copy)","text":"<pre><code>dd if=/dev/sdX | ssh user@destination_ip \"dd of=/destination_path/image.dd\"\n</code></pre> <p>Note: Replace <code>/dev/sdX</code> with source disk identifier (e.g., <code>/dev/sda</code>).</p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#ftk-imager-gui-windows","title":"FTK Imager GUI (Windows)","text":"<ul> <li>Launch FTK Imager</li> <li>Select \"Create Disk Image\"</li> <li>Choose Physical Drive</li> <li>Configure output \u2192 raw (dd) or E01 format</li> <li>Enable hash calculation</li> <li>Complete acquisition and review log/hash report</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#guymager-gui-linux","title":"Guymager GUI (Linux)","text":"<ul> <li>Launch Guymager</li> <li>Select physical drive</li> <li>Configure acquisition \u2192 raw or EWF</li> <li>Enable hashing + logging</li> <li>Start imaging process</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#end-state","title":"End State","text":"<ul> <li>A verified and complete physical image of the source disk is created.</li> <li>Hash integrity value is recorded and log files retained.</li> <li>Image is ready for forensic analysis without impacting source disk.</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#notes","title":"Notes","text":"<p>Imaging can be performed from:</p> <ul> <li>Live systems (volatile + disk capture possible)</li> <li>Offline systems (safer, reduces risk of anti-forensic techniques)</li> <li>Network acquisition (if physical access is limited)</li> </ul> <p>Important: Ensure chain of custody with logging, hashing, and evidence bagging procedures.</p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#tools","title":"Tools","text":"<ul> <li>dc3dd (Windows/Linux) \u2192 CLI imaging + hashing tool (enhanced dd)</li> <li>dd (Linux/macOS) \u2192 Standard disk imaging utility</li> <li>FTK Imager (Windows) \u2192 GUI-based forensic disk imager</li> <li>Guymager (Linux) \u2192 Fast, GUI-based forensic imager</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#step-1-prepare-destination","title":"Step 1 \u2192 Prepare Destination","text":"<ul> <li>Validate enough space exists (raw image sizes = size of disk)</li> <li>Prepare evidence storage \u2192 USB, NAS, forensic server</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#step-2-prepare-imaging-tool","title":"Step 2 \u2192 Prepare Imaging Tool","text":"<ul> <li>Use verified tool binaries (hash validated)</li> <li>Configure for log + hash calculation</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#step-3-perform-acquisition","title":"Step 3 \u2192 Perform Acquisition","text":"<ul> <li>Start disk acquisition (dc3dd, dd, FTK Imager, or Guymager)</li> <li>Monitor process for errors</li> <li>Upon completion \u2192 validate hash (automated or manual comparison)</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#step-4-secure-and-document","title":"Step 4 \u2192 Secure and Document","text":"<ul> <li>Move image + log + hash file to secure evidence storage</li> <li>Document process in forensic acquisition worksheet</li> <li>Notify IR lead or forensic team</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#automated-cli-linux-example","title":"Automated CLI (Linux Example)","text":"<pre><code>dc3dd if=/dev/sda of=/mnt/evidence/disk_image.dd hash=sha256 log=/mnt/evidence/disk_image.log\nsha256sum /mnt/evidence/disk_image.dd &gt; /mnt/evidence/disk_image.dd.sha256\n</code></pre>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#automated-cli-windows-example","title":"Automated CLI (Windows Example)","text":"<pre><code>dc3dd.exe if=\\\\.\\PhysicalDrive0 of=E:\\evidence\\disk_image.dd hash=sha256 log=E:\\evidence\\disk_image.log\n</code></pre>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#dependencies","title":"Dependencies","text":"<ul> <li>USB or network storage location</li> <li>IR toolkit with imaging utilities</li> <li>Local administrator access</li> <li>Verified toolsets (dc3dd, dd, FTK Imager, Guymager)</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage dc3dd Windows/Linux Download from Sourceforge Imaging + hashing dd Linux/macOS Native Imaging FTK Imager Windows Installer GUI imaging + hashing Guymager Linux Pre-installed on many distros Fast GUI imaging"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#operator-recommendations-and-best-practices","title":"Operator Recommendations and Best Practices","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate and prepare destination storage (enough space + permissions)</li> <li> Select correct disk \u2192 avoid imaging wrong device</li> <li> Validate hashing and logging options enabled</li> <li> Execute acquisition and monitor progress</li> <li> Validate resulting hash matches log hash</li> <li> Record imaging process in IR documentation</li> <li> Secure evidence storage \u2192 immutable location if possible</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#best-practices","title":"Best Practices","text":"<ul> <li>Always hash BEFORE and AFTER transfers (ensures integrity)</li> <li>Avoid writing to source disk during acquisition</li> <li>Use write blockers when available (especially offline capture)</li> <li>For large drives \u2192 consider segmenting or using EWF (E01) for management</li> <li>Encrypt evidence if stored long-term or moved between sites</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#references","title":"References","text":"<ul> <li>Sourceforge DC3DD</li> <li>FTK Imager</li> <li>Guymager forensic image</li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Original retained + expanded with detailed operator workflow, multi-platform guidance, and procedural checklist Leo"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/","title":"4.20 Investigate Alerts From Host Sensors","text":""},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#task","title":"Task","text":"<p>Investigate and analyze alerts generated from host-based intrusion detection systems (HIDS) and endpoint detection agents to confirm malicious activity, identify related artifacts, and escalate findings for containment and eradication actions.</p>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>HIDS agents installed on all relevant hosts (e.g. Wazuh, Sysmon, OSSEC).</li> <li>Fully configured SIEM receiving host sensor telemetry (e.g. Security Onion, Elasticsearch, Splunk).</li> <li>Notification of a host sensor alert.</li> <li>Access to the impacted host(s) with administrative credentials.</li> <li>Approval from network or system owner to conduct analysis on host(s).</li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#standards","title":"Standards","text":""},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#network-analyst-responsibilities","title":"Network Analyst Responsibilities","text":"<ul> <li>Recognize and triage host sensor alerts in SIEM.</li> <li>Rule out false positives using available context (e.g. threat intel, whitelisting).</li> <li>Correlate with network telemetry \u2192 connections, suspicious destinations, etc.</li> <li>Notify team leader and hand off findings to Host Analyst team.</li> <li>Continue monitoring host and related infrastructure for additional indicators or lateral movement.</li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#host-analyst-responsibilities","title":"Host Analyst Responsibilities","text":"<ul> <li>Determine host Operating System (Windows, Linux, MacOS).</li> <li>Log into host using authorized credentials.</li> <li>Use native OS tools to validate suspicious activity:</li> <li>Windows:<ul> <li>Network \u2192 <code>netstat</code>, <code>Get-NetTCPConnection</code>, <code>TCPView</code></li> <li>Processes \u2192 <code>tasklist</code>, <code>Get-Process</code>, <code>Process Explorer</code></li> <li>Accounts \u2192 <code>net user</code>, <code>Get-LocalUser</code></li> <li>Persistence \u2192 <code>autoruns</code>, <code>reg query</code></li> <li>Event Logs \u2192 <code>eventvwr.msc</code>, <code>Get-WinEvent</code></li> </ul> </li> <li>Linux:<ul> <li>Network \u2192 <code>netstat -an</code>, <code>ss -tuln</code></li> <li>Processes \u2192 <code>ps aux</code>, <code>top</code>, <code>htop</code></li> <li>Accounts \u2192 <code>cat /etc/passwd</code>, <code>last</code>, <code>who</code></li> <li>Logs \u2192 <code>/var/log/auth.log</code>, <code>journalctl</code></li> </ul> </li> <li> <p>macOS:</p> <ul> <li>Network \u2192 <code>lsof -i</code>, <code>netstat -an</code></li> <li>Processes \u2192 <code>top</code>, <code>ps aux</code></li> <li>Accounts \u2192 <code>dscl . list /Users</code></li> <li>Logs \u2192 <code>Console.app</code>, <code>log show</code></li> </ul> </li> <li> <p>Use third-party tools if available:</p> </li> <li>Sysinternals Suite (Windows) \u2192 <code>Procmon</code>, <code>Process Explorer</code>, <code>TCPView</code></li> <li>Lsof (Linux/macOS) \u2192 Review file and network activity</li> <li> <p>Security Agents \u2192 Wazuh/OSSEC local agent logs</p> </li> <li> <p>Investigate potential compromised accounts:</p> </li> <li>Login anomalies</li> <li>Recent password changes</li> <li>Privilege escalations</li> <li> <p>Suspicious service account activity</p> </li> <li> <p>Investigate lateral movement:</p> </li> <li>SMB sessions \u2192 <code>net session</code> (Windows)</li> <li>Remote logins \u2192 <code>/var/log/secure</code>, <code>last</code> (Linux)</li> <li>Remote desktop activity \u2192 Event Logs (Windows)</li> <li> <p>MacOS screen sharing \u2192 <code>log show</code></p> </li> <li> <p>Gather IOC artifacts:</p> </li> <li>Suspicious process hashes</li> <li>Malicious command line executions</li> <li>Dropped malware files</li> <li>Registry persistence keys (Windows)</li> <li>Crontabs/systemd units (Linux)</li> <li> <p>Launch agents (macOS)</p> </li> <li> <p>Document all findings and prepare detailed report for escalation to IR leadership.</p> </li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#end-state","title":"End State","text":"<ul> <li>All host-based alerts are validated, triaged, and investigated.</li> <li>Any confirmed or suspected malicious activity is documented with relevant artifacts.</li> <li>Findings are escalated to incident commander / team lead for containment and eradication decisions.</li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#notes","title":"Notes","text":"<ul> <li>Host sensor alerts are critical early warnings. They must be reviewed in detail \u2014 ignore at your peril.</li> <li>False positives (e.g. legitimate admin tools) must be ruled out carefully.</li> <li>Always preserve volatile artifacts (memory, running processes) before taking remediation actions (such as kill process or reboot).</li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#from-siem-security-onion-kibana-splunk","title":"From SIEM (Security Onion / Kibana / Splunk)","text":"<ul> <li>Login to SIEM</li> <li>Query alerts \u2192 Filter by host sensor detections</li> <li>Review correlated network activity (connections, IPs, downloads)</li> <li>Review host telemetry:</li> <li>Process activity</li> <li>Parent-child process relationships</li> <li>Network connections</li> <li>Persistence attempts</li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#validate-on-host","title":"Validate on Host","text":"<ul> <li>RDP/SSH or physically access system (if authorized)</li> <li>Run OS native commands to confirm process and network state</li> <li>Dump running processes</li> <li>Dump network connections</li> <li>Collect persistence artifacts (startup, autoruns)</li> <li>Review local security and system logs</li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#correlate-and-report","title":"Correlate and Report","text":"<ul> <li>Confirm or refute malicious behavior</li> <li>Summarize findings \u2192 IOC presence, process ancestry, privilege levels</li> <li>Report to team lead \u2192 Include screenshots, logs, commands used</li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#running-script","title":"Running Script","text":"<ul> <li>From previously referenced Sysmon deployment in <code>4.Eradication/4.08_Deploy_or_evaluate_host_sensors/scripts/Sysmon_Wazuh_push.ps1</code></li> </ul> <pre><code># Example to pull all events from Sysmon for review\nGet-WinEvent -LogName \"Microsoft-Windows-Sysmon/Operational\" | Export-Csv SysmonLogs.csv\n</code></pre>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#dependencies","title":"Dependencies","text":"<ul> <li>Sysmon (Windows)</li> <li>Wazuh / OSSEC agent</li> <li>Security Onion or Splunk</li> <li>Native OS tools (cmd, PowerShell, Bash, Console)</li> <li>Admin credentials to access hosts</li> <li>Network connectivity to hosts or console access</li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Sysinternals Suite Windows Portable Process, network, autorun analysis Lsof Linux/macOS Native File and network descriptor analysis Event Viewer / Get-WinEvent Windows Native Event log review Kibana / Elasticsearch Cross-platform Pre-installed in Security Onion Alert review + correlation Splunk Cross-platform Installable Alert review + correlation"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#operator-recommendations-and-best-practices","title":"Operator Recommendations and Best Practices","text":""},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Triage alert in SIEM \u2192 Determine severity + impacted host</li> <li> Confirm host OS \u2192 Validate correct tooling</li> <li> Access host \u2192 Use native and third-party tools to validate process, network, and persistence</li> <li> Investigate user accounts and privilege escalation indicators</li> <li> Determine if IOC is confirmed \u2192 Malicious file/process/behavior</li> <li> Correlate lateral movement indicators</li> <li> Document all findings and escalate</li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#best-practices","title":"Best Practices","text":"<ul> <li>Use snapshot/backup or memory capture prior to intrusive investigation</li> <li>Do not delete/alter suspicious artifacts until analysis complete</li> <li>Cross-reference process hashes and command lines with threat intelligence (VirusTotal, Hybrid Analysis)</li> <li>Avoid cloud uploads without proper authorization</li> <li>Coordinate handoff with containment team immediately upon confirmed compromise</li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#references","title":"References","text":"<ul> <li>Security Onion Documentation</li> <li>Sysinternals Suite</li> <li>Wazuh Documentation</li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Original retained + expanded with operator workflow, validation procedures, and escalation guidance Leo"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/","title":"4.21 Find and Contain Rogue Workstations","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#task","title":"Task","text":"<p>Locate rogue or unauthorized workstations on the network and isolate them to prevent potential damage, data exfiltration, or continued attacker access.</p>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>Notification of suspicious host activity or rogue workstation alert.</li> <li>Network access and scanning tools (Nmap, Nessus).</li> <li>Switch and firewall administrative access.</li> <li>Administrator credentials and network documentation (known hosts, DHCP, AD).</li> <li>One or more Indicators of Compromise (IOCs) suggesting rogue or unauthorized devices.</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#standards","title":"Standards","text":"<ul> <li>Rogue workstation indicators are validated and confirmed.</li> <li>The network is scanned and analyzed to locate unauthorized workstations.</li> <li>Identified rogue workstations are isolated immediately from the production environment using switch ports, firewall rules, and DHCP controls.</li> <li>All steps are documented and reported to the incident response lead.</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#end-state","title":"End State","text":"<ul> <li>Rogue workstations are successfully identified and removed or contained.</li> <li>Network is restored to a secure state.</li> <li>Post-incident review identifies prevention and detection improvements.</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#notes","title":"Notes","text":"<ul> <li>Rogue workstations may be unauthorized employee devices, attacker-controlled systems, or compromised hosts acting outside of normal boundaries.</li> <li>Finding rogue workstations requires correlation of network data, endpoint visibility, and configuration baselines.</li> <li>Always coordinate containment actions with the network owner or responsible party.</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#detection-phase-identify-rogue-workstation","title":"Detection Phase - Identify Rogue Workstation","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#indicators-of-rogue-workstations","title":"Indicators of Rogue Workstations","text":"<ul> <li>New or unknown MAC addresses on network switches</li> <li>Unauthorized IP addresses in DHCP</li> <li>Unknown or suspicious workstation names in Active Directory</li> <li>Devices detected using WiFi scans but not registered</li> <li>Devices communicating with C2 infrastructure</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#step-by-step-detection-procedures","title":"Step-by-Step Detection Procedures","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#1-validate-the-alert-or-suspicion","title":"1. Validate the Alert or Suspicion","text":"<ul> <li>Review SIEM alerts</li> <li>Review DHCP logs \u2192 Look for unknown MAC addresses</li> <li>Review AD \u2192 Look for newly joined or renamed workstations</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#2-scan-network-for-unauthorized-devices","title":"2. Scan Network for Unauthorized Devices","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#nmap-options","title":"Nmap Options:","text":"<pre><code># List Scan - See what hosts are visible\nnmap -sL &lt;IP Address/Subnet&gt;\n\n# Ping Scan - Find active hosts\nnmap -sn &lt;IP Address/Subnet&gt;\n\n# ARP Scan - Fast local network discovery\nnmap -PR &lt;IP Address/Subnet&gt;\n\n# No ping scan (useful if hosts block ping)\nnmap -Pn &lt;IP Address/Subnet&gt;\n</code></pre>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#additional-detection-methods","title":"Additional detection methods","text":"<ul> <li>Use Wireshark to sniff new MAC addresses on local subnet</li> <li>Review switch CAM tables:</li> </ul> <pre><code>show mac address-table\n</code></pre> <ul> <li>Use <code>arp -a</code> on known hosts to review detected devices</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#nessus-scan-if-authorized","title":"Nessus Scan (if authorized)","text":"<ul> <li>Perform host discovery scan to fingerprint unknown systems</li> <li>Review OS, hostname, open ports, and services</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#containment-phase-isolate-rogue-workstation","title":"Containment Phase - Isolate Rogue Workstation","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#step-by-step-containment-procedures","title":"Step-by-Step Containment Procedures","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#option-1-switch-port-shutdown","title":"Option 1 \u2192 Switch Port Shutdown","text":"<ul> <li>Locate MAC address on switch</li> <li>Disable port:</li> </ul> <pre><code>interface GigabitEthernet1/0/24\nshutdown\n</code></pre> <ul> <li>Dispatch Security to investigate physical location</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#option-2-switch-access-layer-acl","title":"Option 2 \u2192 Switch Access Layer ACL","text":"<ul> <li>Create ACL to drop all traffic from rogue host IP or MAC</li> <li>Apply ACL to VLAN or port</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#option-3-boundary-firewall","title":"Option 3 \u2192 Boundary Firewall","text":"<ul> <li>Apply deny rule on edge firewall for rogue workstation IP</li> <li>Block all inbound/outbound traffic</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#option-4-dhcp-deny-list-windows-dhcp","title":"Option 4 \u2192 DHCP Deny List (Windows DHCP)","text":"<ul> <li>DHCP Manager \u2192 IPv4 \u2192 Filters \u2192 Deny</li> <li>Add rogue MAC address to deny list</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#option-5-group-policy-gpo","title":"Option 5 \u2192 Group Policy (GPO)","text":"<ul> <li>Apply Windows Firewall rule to block rogue IP across domain joined hosts</li> <li>Apply policy to the OU where rogue workstation was detected</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#reporting-and-follow-up","title":"Reporting and Follow-up","text":"<ul> <li>Document:</li> <li>MAC, IP, hostname, username (if applicable), location</li> <li>Detection and containment steps</li> <li>Associated IOC (if known)</li> <li>Coordinate forensic acquisition (if necessary)</li> <li>Notify network and security stakeholders</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#running-script-examples","title":"Running Script Examples","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#nmap-full-discovery-example","title":"Nmap Full Discovery Example","text":"<pre><code>nmap -sn 192.168.1.0/24\nnmap -PR 192.168.1.0/24\n</code></pre>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#windows-dhcp-deny-mac-manual-method","title":"Windows DHCP Deny MAC (manual method)","text":"<ul> <li>DHCP Console \u2192 IPv4 \u2192 Filters \u2192 Deny \u2192 Add MAC</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#switch-port-example-cisco","title":"Switch Port Example (Cisco)","text":"<pre><code>show mac address-table\ninterface GigabitEthernet1/0/24\nshutdown\n</code></pre>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#dependencies","title":"Dependencies","text":"<ul> <li>Network scanning utilities (Nmap, Nessus)</li> <li>Switch and firewall administrative access</li> <li>DHCP administrative access</li> <li>Active Directory credentials and access</li> <li>Physical security coordination (for physical rogue workstations)</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Nmap Cross-platform Native or installed Network discovery Nessus Cross-platform Installed Vulnerability and host scanning Wireshark Cross-platform Installed MAC / ARP / IP analysis Switch CLI Network Native to switch Port control and MAC review DHCP Manager Windows Server Native Manage DHCP deny/allow lists Group Policy Windows Domain controllers Enforce network rules"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#operator-recommendations-and-best-practices","title":"Operator Recommendations and Best Practices","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Confirm alert \u2192 Validate that rogue device exists</li> <li> Determine IP, MAC, Hostname</li> <li> Scan subnet to identify rogue workstation</li> <li> Validate against asset inventory</li> <li> Initiate containment:</li> <li> Switch port shutdown or ACL</li> <li> Firewall block</li> <li> DHCP deny</li> <li> GPO block</li> <li> Document containment action</li> <li> Notify IR lead for further action</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#best-practices","title":"Best Practices","text":"<ul> <li>Always confirm rogue status before containment \u2192 avoid impacting legitimate devices</li> <li>Coordinate with network team \u2192 avoid bypassing change control or policy</li> <li>Maintain logs of all network modifications (audit trail)</li> <li>Validate rogue workstation isolation post-containment \u2192 retest reachability</li> <li>Collect forensic image (if applicable) prior to removal</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#references","title":"References","text":"<ul> <li>NMAP Host Discovery</li> <li>SANS Whitepaper - Detecting and Preventing Rogue Devices</li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Original retained + expanded with operator workflow, containment methods, tool usage, and escalation guidance Leo"},{"location":"4.Eradication/4.22_Block_unauthorized_software/","title":"4.22 Block Unauthorized Software","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#task","title":"Task","text":"<p>Identify and block unauthorized or potentially malicious software from executing on affected hosts to prevent further compromise, persistence, or data exfiltration during an incident.</p>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>Active incident where unauthorized software has been identified or is suspected.</li> <li>Access to endpoint management tools (e.g. Group Policy, Endpoint Protection, Application Control platforms).</li> <li>Administrative access to affected systems.</li> <li>Approved software baseline or application whitelist.</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#standards","title":"Standards","text":"<ul> <li>Unauthorized software is identified through host analysis, IOC matching, user reports, or security monitoring.</li> <li>Software is reviewed and validated as unauthorized or suspicious.</li> <li>Blocking mechanisms are deployed using appropriate tooling (GPO, EDR policies, application control).</li> <li>Blocking actions are verified and logged for incident response reporting.</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#end-state","title":"End State","text":"<ul> <li>Unauthorized software is prevented from executing on affected systems.</li> <li>Blocking measures are enforced across affected organizational systems.</li> <li>Operator logs and reports actions taken for IR documentation and potential lessons learned.</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#notes","title":"Notes","text":"<ul> <li>Blocking unauthorized software is a containment action. It should be done carefully to avoid interrupting legitimate business operations.</li> <li>In large environments, blocking should be staged (test \u2192 pilot \u2192 global) unless emergency dictates immediate enterprise-wide enforcement.</li> <li>Unauthorized software may include:</li> <li>Malware (confirmed malicious executables)</li> <li>Hacking tools (mimikatz, metasploit payloads)</li> <li>Shadow IT (user-installed unsupported software)</li> <li>Outdated or vulnerable versions of legitimate software</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#step-1-identify-unauthorized-software","title":"Step 1 \u2192 Identify Unauthorized Software","text":"<ul> <li>Analyze host artifacts (process listings, file system, registry, installed programs list).</li> <li>Review endpoint alerts and security monitoring (EDR, SIEM).</li> <li>Leverage IOC sweeps \u2192 Hashes, filenames, paths.</li> <li>Validate against enterprise software inventory / approved software list.</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#toolscommands","title":"Tools/Commands","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#windows","title":"Windows","text":"<pre><code># List installed programs\nGet-WmiObject -Class Win32_Product | Select-Object Name, Version\n\n# List running processes\nGet-Process\n\n# Get autoruns\nautorunsc -accepteula -a * -c &gt; autoruns.csv\n</code></pre>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#linuxmacos","title":"Linux/macOS","text":"<pre><code># List running processes\nps aux\n\n# List installed packages (Linux Debian/Ubuntu)\ndpkg --list\n\n# List installed packages (macOS)\nbrew list\n</code></pre>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#step-2-determine-blocking-mechanism","title":"Step 2 \u2192 Determine Blocking Mechanism","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#windows-options","title":"Windows Options","text":"<ul> <li>Group Policy - Software Restriction Policies (SRP) \u2192 Block by hash, path, or publisher.</li> <li>Group Policy - AppLocker \u2192 Allow/deny execution by path, publisher, or hash.</li> <li>Windows Defender Application Control (WDAC) \u2192 Advanced binary blocking (requires planning).</li> <li>Windows Defender Antivirus / EDR (Defender for Endpoint) \u2192 Custom Indicators \u2192 Block hash or filename.</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#linuxmacos-options","title":"Linux/macOS Options","text":"<ul> <li>AppArmor (Linux) \u2192 Deny execution of unauthorized software.</li> <li>SELinux (Linux) \u2192 Enforce execution control via policies.</li> <li>macOS Gatekeeper and MDM \u2192 Block unauthorized apps via configuration profiles.</li> <li>EDR Agents (Linux/macOS) \u2192 Block by hash or path (Crowdstrike, SentinelOne, etc.)</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#step-3-apply-blocking-policy","title":"Step 3 \u2192 Apply Blocking Policy","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#example-windows-group-policy-srp-block-by-path","title":"Example \u2192 Windows Group Policy SRP (Block by Path)","text":"<ul> <li>Open <code>Group Policy Management Console</code></li> <li>Navigate \u2192 <code>Computer Configuration &gt; Policies &gt; Windows Settings &gt; Security Settings &gt; Software Restriction Policies</code></li> <li>Create new path rule:</li> <li>Path: <code>C:\\Path\\To\\UnauthorizedSoftware\\*</code></li> <li>Security Level: Disallowed</li> <li>Force policy update:</li> </ul> <pre><code>gpupdate /force\n</code></pre>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#example-defender-for-endpoint-ioc-block","title":"Example \u2192 Defender for Endpoint IOC Block","text":"<ul> <li>Go to Security Center \u2192 Threat Intelligence \u2192 Indicators \u2192 Files</li> <li>Add hash and select \"Block execution\"</li> <li>Assign policy to affected systems</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#example-apparmor-profile-linux","title":"Example \u2192 AppArmor Profile (Linux)","text":"<pre><code>sudo aa-complain /etc/apparmor.d/usr.bin.exampleapp\n</code></pre> <p>Or set enforce mode:</p> <pre><code>sudo aa-enforce /etc/apparmor.d/usr.bin.exampleapp\n</code></pre>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#example-macos-mdm-jamf-intune","title":"Example \u2192 macOS MDM (Jamf, Intune)","text":"<ul> <li>Create custom configuration profile</li> <li>Add unauthorized app bundle ID or path</li> <li>Deploy profile to targeted macOS endpoints</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#step-4-verify-blocking","title":"Step 4 \u2192 Verify Blocking","text":"<ul> <li>Attempt to execute unauthorized software \u2192 Validate it is denied.</li> <li>Check system event logs / security tools for block events.</li> <li>Report success or troubleshooting required.</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#step-5-report-and-document","title":"Step 5 \u2192 Report and Document","text":"<ul> <li>Log:</li> <li>Unauthorized software identified</li> <li>Method of blocking implemented</li> <li>Validation of enforcement</li> <li>Hostnames, usernames, timestamps</li> <li>Notify incident commander and document in IR management platform.</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#running-script-examples","title":"Running Script Examples","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#block-by-hash-windows-defender-via-powershell-advanced-threat-protection-api","title":"Block by Hash (Windows Defender via PowerShell + Advanced Threat Protection API)","text":"<pre><code>Add-MpPreference -AttackSurfaceReductionRules_Ids &lt;hash&gt; -AttackSurfaceReductionRules_Actions Block\n</code></pre>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#block-by-filename-path-linux-via-chmod","title":"Block by Filename Path (Linux via chmod)","text":"<pre><code>chmod 000 /path/to/unauthorized_binary\n</code></pre>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#block-via-windows-software-restriction-policy-srp-path-rule","title":"Block via Windows Software Restriction Policy (SRP) Path Rule","text":"<pre><code>gpupdate /force\n</code></pre>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#dependencies","title":"Dependencies","text":"<ul> <li>Administrative access to systems</li> <li>Approved software baseline</li> <li>Group Policy Management tools</li> <li>Endpoint Protection platform (Windows Defender ATP, CrowdStrike, SentinelOne, etc)</li> <li>Network connectivity to push policies</li> <li>IR case tracking platform</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Group Policy (SRP, AppLocker) Windows Native Application control Windows Defender ATP / Intune Windows Native + cloud Custom IOC blocking AppArmor / SELinux Linux Native Mandatory Access Control MDM (Jamf / Intune) macOS Cloud / Installed Application blocking EDR Tools (Crowdstrike, SentinelOne) Cross-platform Installed IOC + binary blocking"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#operator-recommendations-and-best-practices","title":"Operator Recommendations and Best Practices","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Confirm software is unauthorized/malicious</li> <li> Validate hash/path and location</li> <li> Select appropriate blocking mechanism (GPO, EDR, etc)</li> <li> Apply block and confirm enforcement</li> <li> Validate blocking is working properly (execution fails)</li> <li> Document action and escalate if widespread deployment needed</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#best-practices","title":"Best Practices","text":"<ul> <li>Favor hash blocking for precise control \u2192 Less risk of false positive.</li> <li>Path-based blocking is useful for quick containment.</li> <li>Blocking via enterprise endpoint agent provides easiest global enforcement.</li> <li>Avoid deleting unauthorized binaries until forensics complete.</li> <li>Work with IT to identify legitimate exceptions or business impact.</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#references","title":"References","text":"<ul> <li>Microsoft AppLocker</li> <li>Windows Defender Antivirus Custom Indicators</li> <li>SELinux User Guide</li> <li>AppArmor Documentation</li> </ul>"},{"location":"4.Eradication/4.22_Block_unauthorized_software/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Generated full version with operator workflow, procedural steps, and blocking options for Windows, Linux, and macOS Leo"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/","title":"4.23 Stop Credential Reuse Attack","text":""},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#task","title":"Task","text":"<p>Detect, investigate, and stop the reuse of compromised credentials on the network to prevent lateral movement, unauthorized access, and escalation of privileges during an incident.</p>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>Active security monitoring (SIEM, EDR, Identity Protection tools).</li> <li>User accounts are suspected or confirmed compromised.</li> <li>Ability to interact with domain controllers, identity platforms, and endpoints.</li> <li>Administrative access to relevant tools and network devices.</li> <li>Threat intelligence or incident indicators identifying credential reuse attempts.</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#standards","title":"Standards","text":"<ul> <li>Investigate and validate the source and scope of credential reuse attempts.</li> <li>Identify accounts involved in malicious or unauthorized authentications.</li> <li>Prevent further unauthorized access by disabling accounts or enforcing password resets.</li> <li>Block identified attacker hosts from the network or authentication mechanisms.</li> <li>Document the response and findings thoroughly.</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#end-state","title":"End State","text":"<ul> <li>Credential reuse is stopped.</li> <li>Attacker-controlled sessions are terminated.</li> <li>Accounts are reset or disabled to prevent re-compromise.</li> <li>Blocking measures are enforced at the network, endpoint, and identity layers.</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#notes","title":"Notes","text":"<p>Credential reuse attacks often follow phishing, password spraying, or prior compromise of privileged credentials. These attacks typically target:</p> <ul> <li>Domain Controllers</li> <li>Cloud Identity Providers (Azure AD, Okta, Google Workspace)</li> <li>VPN portals</li> <li>Remote Desktop Gateways</li> <li>SaaS Applications</li> </ul> <p>Indicators of Credential Reuse:</p> <ul> <li>Logins from unusual geographies</li> <li>Multiple accounts authenticating from same IP</li> <li>Service accounts being used interactively</li> <li>Logons outside normal working hours</li> <li>Accounts accessing systems they normally don't use</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#step-1-validate-alerts-and-identify-affected-accounts","title":"Step 1 \u2192 Validate Alerts and Identify Affected Accounts","text":""},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#tools-sources","title":"Tools / Sources","text":"<ul> <li>SIEM (Splunk, Elastic, Security Onion)</li> <li>Azure AD Sign-in Logs / M365 Defender / Sentinel</li> <li>EDR (CrowdStrike, Defender for Endpoint)</li> <li>Firewall/VPN logs</li> <li>On-prem AD Security Event Logs</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#examples","title":"Examples","text":""},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#windows-event-logs","title":"Windows Event Logs","text":"<pre><code>Get-WinEvent -LogName Security | Where-Object {$_.Id -eq 4624} | Select-Object -First 20\n</code></pre>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#azure-ad-sign-in","title":"Azure AD Sign-in","text":"<ul> <li>Azure Portal \u2192 Azure AD \u2192 Sign-ins \u2192 Filter for failure and unusual sign-in attempts.</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#edr","title":"EDR","text":"<ul> <li>Review \"Account Authentication\" or \"Lateral Movement\" detection alerts.</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#step-2-confirm-credential-reuse-pattern","title":"Step 2 \u2192 Confirm Credential Reuse Pattern","text":"<ul> <li>Look for multiple failed logins followed by successful ones.</li> <li>Identify source IP addresses \u2192 Are they shared across different user accounts?</li> <li>Identify repeat logins from non-corporate IPs or foreign locations.</li> <li>Validate user behavior with managers if necessary.</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#step-3-contain-and-block-the-attack","title":"Step 3 \u2192 Contain and Block the Attack","text":""},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#on-prem-ad","title":"On-Prem AD","text":"<ul> <li>Disable compromised accounts immediately.</li> </ul> <pre><code>Disable-ADAccount -Identity username\n</code></pre> <ul> <li>Force password resets on suspected compromised accounts.</li> </ul> <pre><code>Set-ADAccountPassword -Identity username -Reset -NewPassword (ConvertTo-SecureString -AsPlainText \"NewPassword!\" -Force)\n</code></pre> <ul> <li>Check for attacker-created accounts and disable/remove.</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#cloud-identity-azure-ad-okta-google-workspace","title":"Cloud Identity (Azure AD / Okta / Google Workspace)","text":"<ul> <li>Disable sign-in for compromised accounts.</li> <li>Enforce password reset.</li> <li>Revoke sessions and tokens.</li> </ul> <pre><code>Revoke-AzureADUserAllRefreshToken -ObjectId \"&lt;userObjectId&gt;\"\n</code></pre> <ul> <li>Enable MFA (if not already enabled).</li> <li>Apply conditional access to block login from suspicious IPs or locations.</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#network-contain-attacker-infrastructure","title":"Network (Contain attacker infrastructure)","text":"<ul> <li>Add malicious source IP addresses to perimeter block lists (firewall ACLs).</li> </ul> <pre><code>iptables -A INPUT -s &lt;attacker_ip&gt; -j DROP\n</code></pre> <ul> <li>Disable rogue VPN accounts or sessions.</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#endpoints","title":"Endpoints","text":"<ul> <li>Use EDR to isolate endpoints controlled by attackers.</li> </ul> <pre><code># CrowdStrike Example\nfalconctl -g --isolation\n</code></pre>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#step-4-review-for-persistence-and-lateral-movement","title":"Step 4 \u2192 Review for Persistence and Lateral Movement","text":"<ul> <li>Check scheduled tasks, new services, and startup items on compromised hosts.</li> <li>Review RDP and remote management access.</li> <li>Look for shadow admin accounts or group membership changes.</li> <li>Conduct memory or disk analysis if malware was used.</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#step-5-restore-and-monitor","title":"Step 5 \u2192 Restore and Monitor","text":"<ul> <li>Reset all compromised accounts.</li> <li>Rotate privileged account passwords (Domain Admins, Service Accounts).</li> <li>Enhance monitoring with temporary alerting rules for affected users.</li> <li>Conduct user security awareness refresh \u2192 credential hygiene.</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#running-script-examples","title":"Running Script Examples","text":""},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#example-detect-multiple-authentication-attempts-windows-ad","title":"Example \u2192 Detect multiple authentication attempts (Windows AD)","text":"<pre><code>Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4625} | Select-Object TimeCreated, Message | Out-GridView\n</code></pre>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#example-block-malicious-ip-on-windows-firewall","title":"Example \u2192 Block malicious IP on Windows firewall","text":"<pre><code>New-NetFirewallRule -DisplayName \"Block Attacker IP\" -Direction Inbound -RemoteAddress &lt;Attacker IP&gt; -Action Block\n</code></pre>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#dependencies","title":"Dependencies","text":"<ul> <li>Administrative access to Identity Platform (AD / Azure AD / Okta / Google)</li> <li>SIEM / Log Aggregator</li> <li>Endpoint Detection and Response (EDR)</li> <li>Network Firewall or ACL Management</li> <li>User Notification and Password Reset Process</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Active Directory PowerShell Module Windows Installed Manage AD users and accounts AzureAD / MSGraph PowerShell Modules Windows / Cloud Installed Cloud account management CrowdStrike / SentinelOne / Defender EDR Cross-platform Installed Contain endpoints, detect behavior Splunk / Security Onion Cross-platform Installed Detect authentication anomalies VPN Gateway Cross-platform Installed Review/terminate rogue sessions"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#operator-recommendations-and-best-practices","title":"Operator Recommendations and Best Practices","text":""},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate alert and identify affected user accounts</li> <li> Confirm pattern of credential reuse or lateral movement</li> <li> Disable or restrict affected accounts immediately</li> <li> Block malicious IPs / isolate attacker-controlled endpoints</li> <li> Rotate passwords for compromised or high-risk accounts</li> <li> Investigate lateral movement and persistence</li> <li> Enable MFA where applicable and review access policies</li> <li> Document entire process and escalate for post-incident review</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#best-practices","title":"Best Practices","text":"<ul> <li>Always validate and isolate before removal actions to avoid tipping off attackers.</li> <li>Use MFA to reduce impact of stolen credentials.</li> <li>Rotate all shared / privileged accounts even if only one appears compromised.</li> <li>Work with IT + Helpdesk to coordinate password resets smoothly.</li> <li>Monitor affected users and accounts post containment.</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#references","title":"References","text":"<ul> <li>Azure AD Sign-in Logs</li> <li>Active Directory PowerShell Guide</li> <li>CrowdStrike Containment Documentation</li> <li>Splunk Authentication Monitoring</li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Generated detailed operator workflow with containment, investigation, and recovery process Leo"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/","title":"4.24 Stop Brute Force Attack","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#task","title":"Task","text":"<p>Detect and stop active brute force attacks against local, domain, cloud, and application accounts in order to prevent unauthorized access, credential compromise, and potential lateral movement.</p>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>Security alerts indicating multiple authentication failures or login attempts.</li> <li>Access to authentication logs (Windows, Linux, Cloud, VPN, SaaS).</li> <li>Ability to interact with network appliances, domain controllers, endpoint security, and IAM platforms.</li> <li>Administrative privileges to take containment actions (account lockout, firewall rules, etc.).</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#standards","title":"Standards","text":"<ul> <li>Detection of brute force behavior through log review, SIEM alerts, or identity protection systems.</li> <li>Identification of targeted accounts and source IP addresses.</li> <li>Containment and blocking of attack sources at firewall, endpoint, or identity platform level.</li> <li>Disruption of brute force attack in progress and prevention of continued attempts.</li> <li>Documentation of incident and response actions.</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#end-state","title":"End State","text":"<ul> <li>Brute force attack is halted.</li> <li>Attacker source IP addresses are blocked or isolated.</li> <li>Compromised or targeted accounts are secured.</li> <li>System configurations or policies are adjusted to prevent recurrence.</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#notes","title":"Notes","text":"<p>Brute force attacks can occur in many locations:</p> <ul> <li>Domain Controllers (Windows AD authentication)</li> <li>Linux/Unix SSH servers</li> <li>VPN gateways and remote access portals</li> <li>Cloud identity platforms (Azure AD, Okta, Google Workspace)</li> <li>SaaS applications with public login portals</li> </ul> <p>Brute force attacks may use:</p> <ul> <li>Password spraying (single password across many accounts)</li> <li>Dictionary or credential stuffing attacks</li> <li>Targeted password guessing</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#step-1-detect-brute-force-activity","title":"Step 1 \u2192 Detect Brute Force Activity","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#indicators","title":"Indicators","text":"<ul> <li>Multiple login failures from a single IP</li> <li>Login attempts from unusual geographies</li> <li>Same account targeted repeatedly across time</li> <li>High volume login attempts across many accounts</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#toolscommands","title":"Tools/Commands","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#windows-domain-controller-event-logs","title":"Windows (Domain Controller Event Logs)","text":"<pre><code>Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4625} | Select-Object TimeCreated, Message\n</code></pre>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#linux-ssh-brute-force","title":"Linux (SSH Brute Force)","text":"<pre><code>cat /var/log/auth.log | grep \"Failed password\"\ngrep \"Invalid user\" /var/log/auth.log\n</code></pre>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#azure-ad","title":"Azure AD","text":"<ul> <li>Azure Portal \u2192 Azure AD \u2192 Sign-ins \u2192 Filter for failures</li> <li>Look for IPs with many failures across accounts</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#vpn-logs","title":"VPN Logs","text":"<ul> <li>Check RADIUS / VPN concentrator logs for repeated failures</li> <li>Look for same IP and/or usernames repeated</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#siem-edr","title":"SIEM / EDR","text":"<ul> <li>Review alerts tagged as \"Brute Force\", \"Account Lockout\", or \"Password Spraying\"</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#step-2-contain-attack-sources","title":"Step 2 \u2192 Contain Attack Sources","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#block-source-ip","title":"Block Source IP","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#windows-firewall","title":"Windows Firewall","text":"<pre><code>New-NetFirewallRule -DisplayName \"Block Brute Force Attacker\" -Direction Inbound -RemoteAddress &lt;IP&gt; -Action Block\n</code></pre>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#linux-firewall-iptables","title":"Linux Firewall (iptables)","text":"<pre><code>iptables -A INPUT -s &lt;attacker_ip&gt; -j DROP\n</code></pre>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#cloud-azure","title":"Cloud (Azure)","text":"<ul> <li>Add attacker IP to Conditional Access policy \u2192 Block.</li> <li>Apply Azure Firewall rule.</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#cloud-aws","title":"Cloud (AWS)","text":"<ul> <li>Use AWS WAF or Security Group to block IP.</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#cloud-gcp","title":"Cloud (GCP)","text":"<ul> <li>Add firewall rule to block external IP.</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#step-3-secure-targeted-accounts","title":"Step 3 \u2192 Secure Targeted Accounts","text":"<ul> <li>Force password reset for accounts that may be compromised.</li> </ul> <pre><code>Set-ADAccountPassword -Identity username -Reset -NewPassword (ConvertTo-SecureString -AsPlainText \"NewPassword!\" -Force)\n</code></pre> <ul> <li>Enable MFA (if not already enabled).</li> <li>Check for any lockouts or suspicious account behavior.</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#azure-ad_1","title":"Azure AD","text":"<ul> <li>Block sign-in for account if necessary.</li> <li>Require password change on next sign-in.</li> <li>Enable Conditional Access for stronger authentication requirements.</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#linux","title":"Linux","text":"<pre><code>passwd -l username  # Lock the account\npasswd username     # Reset password\n</code></pre>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#step-4-monitor-and-validate-block","title":"Step 4 \u2192 Monitor and Validate Block","text":"<ul> <li>Continue monitoring authentication logs for recurring attempts.</li> <li>Use SIEM to create custom rules or dashboards to visualize attack metrics.</li> <li>Confirm IP blocks are working \u2192 no further authentication attempts logged.</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#step-5-implement-long-term-mitigation","title":"Step 5 \u2192 Implement Long-Term Mitigation","text":"<ul> <li>Enable Account Lockout Policies (Windows / Linux)</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#windows-gpo","title":"Windows (GPO)","text":"<ul> <li>Computer Config \u2192 Windows Settings \u2192 Security Settings \u2192 Account Policies \u2192 Account Lockout Policy</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#linux-pam_tally2-faillock","title":"Linux (pam_tally2 / faillock)","text":"<pre><code>faillock --user username\n</code></pre> <ul> <li>Enable MFA where possible.</li> <li>Enforce strong passwords.</li> <li>Implement geo-blocking and Conditional Access in cloud environments.</li> <li>Deploy network intrusion prevention systems (NIDS/IPS) for brute force pattern detection.</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#running-script-examples","title":"Running Script Examples","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#example-linux-block-ip-after-detection","title":"Example \u2192 Linux Block IP After Detection","text":"<pre><code>iptables -A INPUT -s 192.168.1.200 -j DROP\n</code></pre>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#example-windows-gpo-lockout-configuration","title":"Example \u2192 Windows GPO Lockout Configuration","text":"<pre><code>secedit /export /cfg C:\\secpol.cfg\nnotepad C:\\secpol.cfg\n# Edit Lockout settings manually and apply using:\nsecedit /configure /db secedit.sdb /cfg C:\\secpol.cfg /areas SECURITYPOLICY\n</code></pre>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#example-azure-block-sign-in-immediately","title":"Example \u2192 Azure Block Sign-in Immediately","text":"<ul> <li>Azure AD \u2192 User \u2192 Block Sign-in \u2192 Save</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#dependencies","title":"Dependencies","text":"<ul> <li>SIEM or central log aggregator</li> <li>Administrative access to firewalls, endpoints, and cloud IAM</li> <li>Active Directory / Azure AD / Okta / IAM management access</li> <li>Network security tooling (IDS/IPS, VPN Logs)</li> <li>EDR tooling (for process and connection containment)</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Splunk, Security Onion, ELK Cross-platform Installed Authentication and brute force detection Fail2Ban Linux Installed Auto-ban brute force attempts Azure Conditional Access Cloud Configured Block based on IP or login failure patterns AWS WAF Cloud Configured Block IPs at edge CrowdStrike / SentinelOne Cross-platform Installed Detect + isolate brute force tools running"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#operator-recommendations-and-best-practices","title":"Operator Recommendations and Best Practices","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Confirm alert and identify brute force attack patterns</li> <li> Identify targeted accounts and source IP</li> <li> Block IP addresses and isolate attacker hosts</li> <li> Disable / reset passwords for targeted accounts</li> <li> Enable MFA for vulnerable accounts</li> <li> Monitor for continued attempts and validate blocks</li> <li> Review policies and strengthen protections post-incident</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#best-practices","title":"Best Practices","text":"<ul> <li>Always review blocking policies to avoid collateral damage (VPN providers, shared IPs).</li> <li>Coordinate with IT on password resets and lockouts \u2192 avoid impacting end users unnecessarily.</li> <li>Ensure temporary IP blocks are reviewed regularly \u2192 avoid long-term deny lists without validation.</li> <li>Implement automated blocking (Fail2Ban, cloud IP blocklists) for repeat attackers.</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#references","title":"References","text":"<ul> <li>Windows Account Lockout Policy</li> <li>Azure AD Sign-in Monitoring</li> <li>Fail2Ban</li> <li>AWS WAF IP Block</li> </ul>"},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Generated detailed operator workflow with containment, blocking, and recovery process Leo"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/","title":"4.25 Stop Malware / Rootkit","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#task","title":"Task","text":"<p>Identify, contain, and remove active malware or rootkits from compromised hosts across Windows, Linux, and macOS systems to prevent persistence, lateral movement, and data exfiltration.</p>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>Malware/rootkit detection alerts (EDR, SIEM, AV).</li> <li>Suspicious process, file, or kernel-level anomaly.</li> <li>Administrative access to infected endpoints.</li> <li>Tools for live response, malware triage, and rootkit detection.</li> <li>Malware/rootkit removal tools available and authorized.</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#standards","title":"Standards","text":"<ul> <li>Validate malware/rootkit presence via detection tools or manual inspection.</li> <li>Identify malware process, file, persistence mechanisms, and in-memory artifacts.</li> <li>Isolate impacted system from network.</li> <li>Remove or quarantine identified malware/rootkit using best practices.</li> <li>Validate system integrity post-cleanup.</li> <li>Document actions taken and escalate for forensic analysis if needed.</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#end-state","title":"End State","text":"<ul> <li>Malware/rootkit is removed or fully contained.</li> <li>No residual persistence mechanisms remain.</li> <li>System is returned to normal operation or scheduled for reimaging.</li> <li>Post-eradication review conducted and documented.</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#notes","title":"Notes","text":"<p>Rootkits are stealthy and may hide processes, drivers, and files. Detection and removal require careful handling:</p> <ul> <li>Prefer containment and forensic imaging before removal in high-risk cases.</li> <li>Some malware/rootkits will survive simple file deletion \u2014 registry, services, drivers, and bootkits may exist.</li> <li>Always preserve original artifacts for analysis.</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#step-1-detect-malware-rootkit","title":"Step 1 \u2192 Detect Malware / Rootkit","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#using-edr-or-av","title":"Using EDR or AV","text":"<ul> <li>Review alerts (Crowdstrike, SentinelOne, Windows Defender ATP).</li> <li>Identify detection related to:</li> <li>Kernel/Driver manipulation</li> <li>Suspicious unsigned or hidden processes</li> <li>DLL injection</li> <li>Anomalous process behavior</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#using-sysinternals-suite-windows","title":"Using Sysinternals Suite (Windows)","text":"<pre><code># List running processes\nprocexp.exe\n\n# Verify signatures and VirusTotal lookup\nsigcheck.exe -vt -c c:\\\n</code></pre>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#using-rootkit-detection-tools","title":"Using Rootkit Detection Tools","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#windows","title":"Windows","text":"<ul> <li>GMER \u2192 Advanced rootkit detection</li> <li>Malwarebytes Anti-Rootkit \u2192 Scan for known rootkits</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#linux","title":"Linux","text":"<pre><code>chkrootkit\nrkhunter --check\n</code></pre>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#macos","title":"macOS","text":"<pre><code>sudo kextstat | grep -v com.apple\n</code></pre> <ul> <li>Review unsigned kernel extensions</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#networkcommand-line-behavior","title":"Network/Command Line Behavior","text":"<ul> <li>Look for beaconing or unusual outbound connections.</li> <li>Detect unauthorized scheduled tasks, services, registry keys.</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#step-2-isolate-system","title":"Step 2 \u2192 Isolate System","text":"<ul> <li>Remove from network via switch port or EDR isolation command.</li> </ul> <pre><code># Example (Crowdstrike)\nfalconctl -g --isolation\n</code></pre> <ul> <li>Avoid rebooting unless instructed by malware analysis team.</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#step-3-quarantine-or-remove-malware-rootkit","title":"Step 3 \u2192 Quarantine or Remove Malware / Rootkit","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#automated-tools","title":"Automated Tools","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#windows_1","title":"Windows","text":"<ul> <li>Malwarebytes \u2192 Scan and remove</li> <li>Defender ATP \u2192 Quarantine malicious files</li> <li>GMER \u2192 Manually remove hidden objects</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#linux_1","title":"Linux","text":"<ul> <li>Remove suspicious binaries manually or via ClamAV/Chkrootkit findings.</li> <li>Inspect crontabs, /etc/init.d, systemd for persistence.</li> </ul> <pre><code>rm /usr/bin/.malwarehidden\n</code></pre>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#macos_1","title":"macOS","text":"<ul> <li>Remove LaunchAgents/LaunchDaemons</li> </ul> <pre><code>sudo rm ~/Library/LaunchAgents/com.malware.plist\n</code></pre> <ul> <li>Use Malwarebytes for Mac or KnockKnock to validate autoruns.</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#manual-file-removal-if-necessary","title":"Manual File Removal (if necessary)","text":"<ul> <li>Use safe-mode or recovery environments if malware blocks deletion.</li> <li>Remove file with built-in utilities.</li> </ul> <pre><code>Remove-Item -Force -Path \"C:\\malwarepath\\malicious.exe\"\n</code></pre>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#step-4-validate-removal-and-perform-post-cleanup","title":"Step 4 \u2192 Validate Removal and Perform Post-Cleanup","text":"<ul> <li>Rescan with rootkit and malware detection tools.</li> <li>Check autorun entries, registry, crontabs, scheduled tasks.</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#windows_2","title":"Windows","text":"<pre><code>Get-ScheduledTask\n</code></pre>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#linux_2","title":"Linux","text":"<pre><code>crontab -l\nls /etc/cron.*\n</code></pre>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#macos_2","title":"macOS","text":"<pre><code>launchctl list\n</code></pre> <ul> <li>Monitor network connections and logs for re-occurrence.</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#running-script-examples","title":"Running Script Examples","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#example-windows-sigcheck-for-hidden-unsigned-malwarerootkit","title":"Example \u2192 Windows Sigcheck for hidden unsigned malware/rootkit","text":"<pre><code>sigcheck.exe -e -v -c c:\\\n</code></pre>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#example-linux-find-hidden-files","title":"Example \u2192 Linux Find hidden files","text":"<pre><code>find / -name \".*\" -type f\n</code></pre>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#example-macos-list-unsigned-kernel-extensions","title":"Example \u2192 macOS List unsigned kernel extensions","text":"<pre><code>kextstat | grep -v com.apple\n</code></pre>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#dependencies","title":"Dependencies","text":"<ul> <li>Administrative access to infected hosts</li> <li>Malware/rootkit detection and cleaning utilities</li> <li>EDR platform access (isolation/quarantine)</li> <li>SIEM access for ongoing monitoring</li> <li>Network-level isolation controls (NAC, Switches)</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage GMER Windows Portable Rootkit detection Malwarebytes Windows/macOS Installed Malware and rootkit removal Sysinternals Suite Windows Portable File, process, autorun analysis rkhunter / chkrootkit Linux Installed Rootkit detection KnockKnock macOS Installed Autorun analysis"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#operator-recommendations-and-best-practices","title":"Operator Recommendations and Best Practices","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Confirm detection of malware/rootkit</li> <li> Isolate host immediately</li> <li> Use multiple tools to verify hidden objects</li> <li> Remove malware/rootkit via automated or manual means</li> <li> Validate no persistence mechanisms remain</li> <li> Document actions taken and validate cleanup</li> <li> Escalate for forensic imaging if advanced/root-level malware was detected</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#best-practices","title":"Best Practices","text":"<ul> <li>Do not reboot unless required \u2014 malware/rootkits may be memory-resident only.</li> <li>Prioritize removal of network access first to prevent spread or exfiltration.</li> <li>Keep forensic copy or snapshot before aggressive cleanup.</li> <li>Review system integrity post-removal \u2014 missing/altered files may require reimaging.</li> <li>For heavily infected hosts \u2192 prefer rebuild rather than trust post-cleanup state.</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#references","title":"References","text":"<ul> <li>GMER Rootkit Detector</li> <li>Chkrootkit</li> <li>Sysinternals Suite</li> <li>Malwarebytes Anti-Rootkit</li> </ul>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Generated detailed operator workflow with detection, containment, and eradication process Leo"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/","title":"4.26 Stop Data Exfiltration","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#task","title":"Task","text":"<p>Stop data exfiltration</p>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#conditions","title":"Conditions","text":"<ul> <li>Given a network with sensitive data</li> <li>Harden host nodes against data exfiltration</li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#standards","title":"Standards","text":"<ul> <li>Prevention or mitigation of the exfiltration of information from a network is accomplished when the following conditions are met:</li> <li>Prevention of information from being transferred/burned to CD/DVD.</li> <li>Prevention of information from being transferred to removable or additional storage drives.</li> <li>Education on Social Engineering and Phishing Attacks that lead to data exfiltration.</li> <li>Minimize the size of data allowed to be emailed.</li> <li>Minimize the size of data allowed to be sent out of the network.</li> <li>Detection and active prevention of suspicious outbound network traffic, including cloud storage and covert exfiltration channels.</li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#end-state","title":"End State","text":"<ul> <li>All unauthorized processes, users, and channels for exfiltration are disabled or removed.</li> <li>Exfiltration attempt is stopped and verified.</li> <li>Endpoint and network controls are enforced to prevent recurrence.</li> <li>Full incident documentation completed for post-incident review.</li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#notes","title":"Notes","text":"<p>The methods described here help prevent host-based data exfiltration. However, network-centric controls should complement host controls:</p> <ul> <li>FTP, SFTP, SCP, and HTTP/S ports</li> <li>Email (attachments, SMTP)</li> <li>Cloud storage access (Dropbox, Google Drive, OneDrive)</li> <li>DNS tunneling and C2 channels</li> <li>USB and removable media</li> </ul> <p>Considerations: Blocking exfiltration can impact operations. Work closely with stakeholders and IT to minimize business disruption.</p>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#prevent-removable-media-exfiltration","title":"Prevent Removable Media Exfiltration","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#disable-usb-storage-windows","title":"Disable USB Storage (Windows)","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#prevent-usb-storage-device-installation","title":"Prevent USB Storage Device Installation","text":"<ol> <li>Open Windows Explorer \u2192 <code>%SystemRoot%\\Inf</code></li> <li>Right-click <code>Usbstor.pnf</code> \u2192 Properties \u2192 Security</li> <li>Add users \u2192 Deny \u2192 Full Control</li> <li>Add SYSTEM account \u2192 Deny \u2192 Full Control</li> <li>Repeat for <code>Usbstor.inf</code>.</li> </ol>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#disable-usb-storage-through-registry","title":"Disable USB Storage through Registry","text":"<pre><code>Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR\\\" -Name \"Start\" -Value 4\n</code></pre>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#disable-usb-storage-macos","title":"Disable USB Storage (macOS)","text":"<pre><code>sudo kextunload /System/Library/Extensions/IOUSBMassStorageClass.kext\n</code></pre> <p>Re-enable (if needed):</p> <pre><code>sudo kextload /System/Library/Extensions/IOUSBMassStorageClass.kext\n</code></pre>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#disable-cddvd-burning","title":"Disable CD/DVD Burning","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#group-policy-method-windows","title":"Group Policy Method (Windows)","text":"<ol> <li>Open Local Group Policy Editor.</li> <li>User Configuration \u2192 Administrative Templates \u2192 Windows Components \u2192 File Explorer</li> <li>Enable \u2192 Remove CD Burning features.</li> </ol>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#registry-method","title":"Registry Method","text":"<pre><code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\nNoCDBurning = 1 (DWORD)\n</code></pre>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#employee-training-and-awareness","title":"Employee Training and Awareness","text":"<ul> <li>Train staff to:</li> <li>Identify sensitive information.</li> <li>Understand risks of data exfiltration.</li> <li>Follow secure handling policies.</li> <li>Regularly distribute and update training materials.</li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#detect-and-block-network-based-exfiltration","title":"Detect and Block Network-Based Exfiltration","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#siem-or-network-monitoring","title":"SIEM or Network Monitoring","text":"<ul> <li>Monitor for large outbound transfers, unusual ports, or cloud uploads.</li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#splunk-query-example","title":"Splunk Query Example","text":"<pre><code>index=network sourcetype=proxy OR sourcetype=firewall | stats sum(bytes_out) by dest_ip, user\n</code></pre>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#firewall-acls-windowslinuxcloud","title":"Firewall / ACLs (Windows/Linux/Cloud)","text":"<pre><code>iptables -A OUTPUT -p tcp --dport 443 -d &lt;exfil_ip&gt; -j DROP\n</code></pre>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#dns-firewall","title":"DNS Firewall","text":"<ul> <li>Block known exfiltration domains.</li> <li>Implement DNS tunneling detection.</li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#block-cloud-storage-and-saas-channels","title":"Block Cloud Storage and SaaS Channels","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#cloud-iam-and-storage-controls","title":"Cloud IAM and Storage Controls","text":"<ul> <li>Revoke upload rights for affected users.</li> <li>Enable DLP policies.</li> <li>Block uploads during active incidents.</li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#aws-example","title":"AWS Example","text":"<pre><code>aws s3api put-bucket-policy --bucket mybucket --policy file://deny-upload-policy.json\n</code></pre>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#google-workspace","title":"Google Workspace","text":"<ul> <li>Admin \u2192 Drive \u2192 Sharing settings \u2192 Disable external sharing and uploads.</li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#email-exfiltration-controls","title":"Email Exfiltration Controls","text":"<ul> <li>Limit outbound attachment size.</li> <li>Block executable and archive formats during incidents.</li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#validate-exfiltration-stoppage","title":"Validate Exfiltration Stoppage","text":"<ul> <li>Verify no additional outbound exfiltration attempts.</li> <li>Use SIEM to confirm that traffic has stopped.</li> <li>Increase monitoring sensitivity temporarily.</li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#running-script-examples","title":"Running Script Examples","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#disable-usb-storage-windows_1","title":"Disable USB Storage (Windows)","text":"<pre><code>Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR\\\" -Name \"start\" -Value 4\n</code></pre>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#block-domainip-on-windows-firewall","title":"Block Domain/IP on Windows Firewall","text":"<pre><code>New-NetFirewallRule -DisplayName \"Block Exfil IP\" -Direction Outbound -RemoteAddress &lt;IP&gt; -Action Block\n</code></pre>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#block-ip-on-linux-iptables","title":"Block IP on Linux (iptables)","text":"<pre><code>iptables -A OUTPUT -p tcp --dport 443 -d &lt;exfil_ip&gt; -j DROP\n</code></pre>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#dependencies","title":"Dependencies","text":"<ul> <li>Administrative access to host, network, and cloud platforms.</li> <li>SIEM, IDS/IPS, and EDR deployment.</li> <li>Group Policy or MDM tools for USB and CD/DVD restrictions.</li> <li>Cloud IAM and DLP policies.</li> <li>Trained and aware user base.</li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Microsoft Intune Windows/macOS Cloud USB + removable media policy enforcement CrowdStrike / SentinelOne Cross-platform Installed Detect and block malicious behavior Splunk / Elastic / Security Onion Cross-platform Installed Monitor outbound traffic and DNS AWS GuardDuty / CloudTrail Cloud Configured Detect exfil-related activities iptables / pfSense Linux / Network Installed Block IPs and protocols"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#operator-recommendations-and-best-practices","title":"Operator Recommendations and Best Practices","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Disable removable media (USB/CD/DVD).</li> <li> Block unauthorized cloud uploads and sharing.</li> <li> Enforce size and file type restrictions on email.</li> <li> Block suspicious outbound network destinations.</li> <li> Isolate systems showing signs of exfiltration.</li> <li> Validate exfiltration channels are closed.</li> <li> Document response actions in the incident report.</li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#best-practices","title":"Best Practices","text":"<ul> <li>Always confirm before blocking \u2192 avoid false positives.</li> <li>Use layered controls \u2192 block at host, network, and cloud levels.</li> <li>For incidents involving sensitive data, preserve forensic evidence before removal.</li> <li>Coordinate with IT and Legal for high-sensitivity incidents.</li> <li>Update detection content and training post-incident.</li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#references","title":"References","text":"<ul> <li>Windows Disable USB Storage Devices</li> <li>Windows Disable burning DVD/CD</li> <li>AWS GuardDuty Data Exfiltration</li> <li>Azure Sentinel Exfiltration Playbook</li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.1 Merged original host-focused content and expanded with network, cloud, and SaaS controls for comprehensive operator guidance Leo"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/","title":"4.27 Stop Malware Backdoor","text":""},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#task","title":"Task","text":"<p>Stop malware backdoor</p>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#conditions","title":"Conditions","text":"<p>Given:</p> <ul> <li>A compromised system, perform steps to stop malware backdoors and Command and Control (C2) beaconing.</li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#standards","title":"Standards","text":"<ul> <li>Execute <code>Stop_malware_backdoor.ps1</code> to initiate analysis.</li> <li>An executable named <code>Cerberus.exe</code> will appear. </li> <li>Cerberus.exe must be run with administrator privileges.</li> <li>Use Cerberus to analyze, suspend, or kill malware backdoor or C2 beaconing threads.</li> <li>Removal is precise \u2014 Cerberus targets malicious threads only, not entire processes.</li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#end-state","title":"End State","text":"<ul> <li>System processes are cleared of malicious code injections.</li> <li>Backdoors and C2 beaconing activities are halted.</li> <li>Normal system operations are preserved without requiring process restarts.</li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#notes","title":"Notes","text":"<ul> <li> <p>Precision Control:   Cerberus will only target malicious threads. It will NOT kill the hosting process, reducing operational disruption.</p> </li> <li> <p>Suspension and Kill Options: </p> </li> <li><code>--suspend</code> suspends malicious threads without killing them.</li> <li> <p><code>--kill</code> terminates malicious threads completely.</p> </li> <li> <p>This procedure also applies to 4.28 Stop C2 Beaconing as C2 backdoors are often intertwined.</p> </li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#step-1-run-backdoor-script-and-analyzer","title":"Step 1 \u2192 Run Backdoor Script and Analyzer","text":""},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#execute-powershell-script","title":"Execute PowerShell Script","text":"<pre><code>.\\Stop_malware_backdoor.ps1\n</code></pre> <ul> <li>This script will prepare the environment and spawn Cerberus.exe.</li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#run-cerberusexe-with-analyze-mode","title":"Run Cerberus.exe with Analyze Mode","text":"<pre><code>Cerberus.exe --analyze\n</code></pre> <ul> <li>This analyzes all running processes and identifies malicious threads.</li> <li>Outputs suspicious processes and thread IDs.</li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#step-2-suspend-identified-malicious-threads","title":"Step 2 \u2192 Suspend Identified Malicious Threads","text":"<pre><code>Cerberus.exe --suspend\n</code></pre> <ul> <li>This pauses execution of malicious threads to stop backdoor/C2 activity without crashing processes.</li> <li>Useful if malware should not be killed immediately (forensics, validation, etc.).</li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#step-3-kill-malicious-threads","title":"Step 3 \u2192 Kill Malicious Threads","text":"<pre><code>Cerberus.exe --kill\n</code></pre> <ul> <li>This terminates malicious threads permanently.</li> <li>Process remains running, but malicious code is eradicated.</li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#step-4-validate-process-and-network-status","title":"Step 4 \u2192 Validate Process and Network Status","text":"<ul> <li>Confirm no malicious threads are running.</li> <li>Use EDR and network monitoring tools:</li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#windows","title":"Windows","text":"<pre><code>Get-Process\nnetstat -anob\n</code></pre>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#linuxmacos-for-completeness-if-backdoor-affects-multiple-os","title":"Linux/macOS (for completeness if backdoor affects multiple OS)","text":"<pre><code>ps aux\nss -tulnp\n</code></pre> <ul> <li>Ensure no unauthorized C2 beaconing persists.</li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#running-script","title":"Running Script","text":"<pre><code># Example running the backdoor mitigation script\n.\\Stop_malware_backdoor.ps1\n\n# Example running Cerberus in analyze mode\nCerberus.exe --analyze\n\n# Suspend malicious threads\nCerberus.exe --suspend\n\n# Kill malicious threads\nCerberus.exe --kill\n</code></pre>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#dependencies","title":"Dependencies","text":"<ul> <li>Cerberus.exe (deployed by Stop_malware_backdoor.ps1)</li> <li>Administrator privileges</li> <li>EDR or Process Monitoring Tools</li> <li>Network access to validate beaconing has stopped</li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Cerberus.exe Windows Generated by script Malware thread analysis + control Sysinternals Suite Windows Portable Process, autoruns, and threads monitoring EDR Solutions (CrowdStrike, SentinelOne) Cross-platform Installed Network and process behavior monitoring Volatility (optional) Cross-platform Installed Memory analysis if rootkit suspected"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#operator-recommendations-and-best-practices","title":"Operator Recommendations and Best Practices","text":""},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Run <code>Stop_malware_backdoor.ps1</code> to deploy Cerberus</li> <li> Run Cerberus in <code>--analyze</code> mode to identify threads</li> <li> Run Cerberus in <code>--suspend</code> to halt malicious activity if required</li> <li> Run Cerberus in <code>--kill</code> to permanently stop malicious threads</li> <li> Validate via EDR or process monitor that no malicious code is running</li> <li> Document eradication steps and handoff for post-incident review</li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#best-practices","title":"Best Practices","text":"<ul> <li>Only use <code>--kill</code> after validation that malicious threads are not essential for production processes.</li> <li>Prefer <code>--suspend</code> when analysis is ongoing or forensic collection is needed.</li> <li>Document each execution for audit and evidence chain.</li> <li>Use memory analysis tools if malware is suspected to use advanced persistence (rootkits).</li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#references","title":"References","text":"<ul> <li>Sysinternals Autoruns</li> <li>Volatility Framework</li> <li>CrowdStrike Falcon Sensor Documentation</li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.1 Merged original manual steps and Cerberus usage with advanced eradication detail and expanded operator workflow Leo"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/","title":"4.28 Stop C2 Beaconing","text":""},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#task","title":"Task","text":"<p>Stop Command and Control (C2) Beaconing</p>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#conditions","title":"Conditions","text":"<ul> <li>Given a network environment with potential malware infections or unauthorized backdoors</li> <li>Monitoring tools available to detect and analyze outbound network traffic</li> <li>Administrative access to DNS, firewall, and endpoint security infrastructure</li> </ul>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#standards","title":"Standards","text":"<ul> <li>Detect and identify C2 beaconing behavior using network, DNS, and endpoint analysis.</li> <li>Identify and document suspicious DNS names, IP addresses, and ports associated with C2 channels.</li> <li>Block malicious IPs/domains at the firewall, endpoint, and DNS resolver.</li> <li>Flush DNS caches to prevent re-resolution.</li> <li>Create DNS sinkhole zones for malicious domains to prevent external resolution.</li> <li>Remove associated malware/backdoors/persistence mechanisms from infected hosts.</li> <li>Validate and monitor for beaconing cessation.</li> </ul>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#end-state","title":"End State","text":"<ul> <li>All C2 beaconing activity has ceased.</li> <li>Suspicious domains no longer resolve externally.</li> <li>Endpoint persistence mechanisms have been removed.</li> <li>Network and endpoint telemetry confirms eradication.</li> <li>IOC and response actions are documented.</li> </ul>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#notes","title":"Notes","text":"<p>C2 Beaconing Techniques Include:</p> <ul> <li>DNS tunneling (subdomain beaconing)</li> <li>HTTPS encrypted beaconing (POST and GET requests to staging servers)</li> <li>HTTP non-standard port beaconing (8080, 8443, etc.)</li> <li>TCP/IP covert channels</li> <li>Cloud relay infrastructure usage</li> </ul> <p>Known Ports and Protocols (Example \u2014 Cobalt Strike):</p> Protocol Port Notes HTTPS (TCP) 443 Default beaconing (encrypted) HTTP (TCP) 80 C2 in clear-text TCP (custom ports) 50050, 2222, 8080, 8443 Often used in red team or attacker deployments DNS (UDP/TCP) 53 DNS beaconing and tunneling <p>Cobalt Strike \u2014 one of the most common commercial/offensive C2 platforms \u2014 often uses HTTP/HTTPS and DNS-based beaconing as default profiles.</p>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#step-1-detect-beaconing","title":"Step 1 \u2192 Detect Beaconing","text":""},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#using-network-tools-zeek-wireshark-siem","title":"Using Network Tools (Zeek, Wireshark, SIEM)","text":"<ul> <li>Look for frequent, regular interval outbound connections to unknown domains/IPs.</li> <li>Review DNS queries \u2192 Look for strange subdomains and high entropy.</li> </ul>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#example-zeek-command","title":"Example Zeek command:","text":"<pre><code>zeek -r traffic.pcap dns.log http.log conn.log\n</code></pre>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#suspicious-dns-example","title":"Suspicious DNS Example:","text":"<pre><code>xyz987dnscommand.c2malicious.net\n</code></pre>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#using-edr-av-telemetry","title":"Using EDR / AV Telemetry","text":"<ul> <li>Detect parent processes generating outbound connections.</li> <li>Look for svchost.exe, rundll32.exe, or powershell.exe contacting external IPs.</li> </ul>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#using-dns-server-logs","title":"Using DNS Server Logs","text":"<ul> <li>Windows DNS \u2192 Enable and query DNS analytical logs.</li> <li>BIND/Linux \u2192 Review <code>named</code> query logs.</li> </ul>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#step-2-isolate-infected-hosts","title":"Step 2 \u2192 Isolate Infected Hosts","text":""},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#edr-isolation","title":"EDR Isolation","text":"<pre><code>falconctl -g --isolation\n</code></pre>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#manual-isolation","title":"Manual Isolation","text":"<ul> <li>Disable network adapters.</li> <li>Block outbound access via local firewall rules.</li> </ul> <pre><code>New-NetFirewallRule -DisplayName \"Block C2 IP\" -Direction Outbound -RemoteAddress &lt;C2_IP&gt; -Action Block\n</code></pre>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#step-3-block-malicious-domains-and-ips","title":"Step 3 \u2192 Block Malicious Domains and IPs","text":""},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#flush-dns-cache-local","title":"Flush DNS Cache (Local)","text":"<pre><code>ipconfig /flushdns\n</code></pre> <pre><code>sudo systemd-resolve --flush-caches\n</code></pre> <pre><code>sudo killall -HUP mDNSResponder\n</code></pre>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#block-at-dns-sinkhole","title":"Block at DNS (Sinkhole)","text":""},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#windows-dns","title":"Windows DNS","text":"<ol> <li>Open DNS Manager.</li> <li>New Zone \u2192 Primary \u2192 <code>maliciousdomain.com</code>.</li> <li>Disable dynamic updates.</li> <li>Add A record \u2192 Point to 127.0.0.1.</li> </ol>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#linux-bind","title":"Linux (Bind)","text":"<pre><code>zone \"maliciousdomain.com\" {\n    type master;\n    file \"/etc/bind/db.null\";\n};\n</code></pre>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#aws-route53-azure-dns","title":"AWS Route53 / Azure DNS","text":"<ul> <li>Create Private Hosted Zone \u2192 Add A record \u2192 Point to internal IP (blocking exfil).</li> </ul>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#block-at-network-firewall","title":"Block at Network Firewall","text":"<pre><code>iptables -A OUTPUT -p tcp --dport 443 -d &lt;C2_IP&gt; -j DROP\n</code></pre> <ul> <li>Block HTTP/HTTPS, DNS, and custom ports associated with Cobalt Strike or other C2 infrastructure.</li> </ul>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#step-4-remove-malware-backdoors-related-to-beaconing","title":"Step 4 \u2192 Remove Malware Backdoors (Related to Beaconing)","text":"<ul> <li>Use Cerberus (as in 4.27) to identify injected threads and malicious memory artifacts.</li> </ul> <pre><code>Cerberus.exe --analyze\nCerberus.exe --kill\n</code></pre> <ul> <li>Validate persistence mechanisms (Autoruns, Scheduled Tasks, Services, Registry Run keys).</li> <li>Remove accordingly across:</li> </ul>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#windows","title":"Windows","text":"<pre><code>Remove-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" -Name \"Backdoor\"\n</code></pre>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#macos","title":"macOS","text":"<pre><code>launchctl remove com.malware.launcher\n</code></pre>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#linux","title":"Linux","text":"<pre><code>crontab -l\ncrontab -r\n</code></pre>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#step-5-monitor-and-validate","title":"Step 5 \u2192 Monitor and Validate","text":"<ul> <li>Confirm sinkholed domains resolve to localhost/internal IP.</li> <li>Monitor network traffic for any fallback domains or C2 IPs.</li> <li>Review EDR/network telemetry for re-attempts.</li> </ul> <pre><code>zeek -i eth0 dns.log http.log conn.log\n</code></pre>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#running-script-examples","title":"Running Script Examples","text":""},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#block-domain-via-hosts-file-quick-block","title":"Block Domain via Hosts File (Quick Block)","text":"<pre><code>Add-Content -Path \"C:\\Windows\\System32\\drivers\\etc\\hosts\" -Value \"`n127.0.0.1 beacon.badactor.com\"\n</code></pre>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#block-ip-via-firewall-linux","title":"Block IP via Firewall (Linux)","text":"<pre><code>iptables -A OUTPUT -p tcp -d 192.168.100.100 --dport 8080 -j DROP\n</code></pre>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#dependencies","title":"Dependencies","text":"<ul> <li>DNS server access (internal and cloud hosted)</li> <li>Firewall or proxy policy management</li> <li>EDR with process and network telemetry</li> <li>SIEM or Zeek for traffic analysis</li> <li>Administrative access to endpoints</li> </ul>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Zeek Cross-platform Installed Network and DNS beaconing detection Splunk Cross-platform Installed Detect C2 beaconing CrowdStrike / SentinelOne Cross-platform Installed Endpoint and C2 process detection Cerberus Windows Included in toolkit Identify + kill injected threads BIND Linux Installed Sinkhole domains Windows DNS Server Windows Installed Create sinkhole zones"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#operator-recommendations-and-best-practices","title":"Operator Recommendations and Best Practices","text":""},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Detect and confirm C2 beaconing activity</li> <li> Identify domains/IPs and communication ports</li> <li> Flush DNS caches</li> <li> Block or sinkhole domains via DNS</li> <li> Block outbound IP traffic via firewall (host/network)</li> <li> Remove malware backdoors and persistence</li> <li> Validate beaconing has stopped</li> <li> Monitor for re-infection or fallback channels</li> </ul>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#best-practices","title":"Best Practices","text":"<ul> <li>Sinkhole malicious domains for visibility and validation rather than simply blocking.</li> <li>Document all IOC findings and coordinate with threat intelligence teams.</li> <li>Monitor after eradication for new domains, domain-fluxing, or alternate C2 channels.</li> <li>Use layered blocking (host, network, DNS) to prevent re-establishment.</li> </ul>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#references","title":"References","text":"<ul> <li>Cobalt Strike C2 Profiles</li> <li>Zeek DNS Tunneling Detection</li> <li>Windows DNS Sinkhole Zones</li> <li>CrowdStrike Isolation Documentation</li> </ul>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.2 Integrated original instructions + expanded with Cobalt Strike ports, advanced C2 detection, blocking, and DNS handling Leo"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/","title":"4.30 Security Onion Hunting","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#task","title":"Task","text":"<p>Conduct advanced threat hunting using Security Onion to identify suspicious or malicious activities, such as:</p> <ul> <li>Command and Control (C2) beaconing</li> <li>Malware artifacts</li> <li>Abnormal network traffic or protocol use</li> <li>Exploit attempts</li> <li>Lateral movement and privilege escalation</li> </ul>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#conditions","title":"Conditions","text":"<ul> <li>Security Onion installed and configured to receive log forwarding from Wazuh agents.</li> <li>Endpoints configured with Sysmon using ionstorm config.</li> <li>Wazuh agent installed and forwarding logs (Sysmon + Security logs).</li> <li>Network traffic is captured and PCAPs are available for analysis.</li> <li>Operator has access to Kibana, Hunt, so-event, and PCAP review tools.</li> </ul>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#standards","title":"Standards","text":"<p>Threat hunting must cover detection and analysis for the following threat activity categories with the appropriate tools and techniques:</p> Threat Type Tools Example Indicators / Where to Look C2 Beaconing Zeek, Suricata, Hunt, Kibana DNS queries, JA3/SNI anomalies, periodic HTTP/S POST requests, SMB beacons Malware Artifacts Sysmon, Kibana, Hunt, so-event File writes, autoruns, suspicious parent-child process creation Abnormal Traffic Zeek, Suricata, PCAP analysis Unusual protocols, large outbound traffic, DNS tunneling Exploit Attempts Suricata, so-event RPC/DCERPC, SMB exploits, brute force logins Lateral Movement Sysmon, Suricata, Zeek CreateRemoteThread, WinRM, SMB access, credential dumping"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#end-state","title":"End State","text":"<ul> <li>Hunting is performed thoroughly and findings documented.</li> <li>Any suspicious activity is triaged and escalated as required.</li> <li>Eradication actions are initiated if malicious activity is confirmed.</li> </ul>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#notes","title":"Notes","text":"<p>Security Onion provides a unified interface for analyzing host and network telemetry:</p> <ul> <li>Kibana: Powerful log search and visualization</li> <li>Hunt: Fast IOC and behavior-based hunting interface</li> <li>so-event: Correlated IDS alerts and event metadata</li> <li>PCAP Analysis (so-pcap, Wireshark): Deep packet inspection</li> </ul> <p>Hunting requires combining IOC-based and behavior-based methods.</p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#step-1-access-security-onion-interfaces","title":"Step 1 \u2014 Access Security Onion Interfaces","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#kibana","title":"Kibana","text":"<ul> <li>Navigate to <code>https://[SecurityOnionIP]</code></li> <li>Click Kibana</li> <li>Use search to locate event types, suspicious processes, and network activity.</li> </ul> <p>Example Screenshot:</p> <p></p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#hunt","title":"Hunt","text":"<ul> <li>From Security Onion, open Hunt.</li> <li>Use Hunt for rapid IOC queries and pattern-based analysis.</li> </ul> <p>Example Screenshot:</p> <p></p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#so-event","title":"so-event","text":"<ul> <li>View alerts and correlated metadata.</li> <li>Pivot between events, PCAPs, and logs for enriched context.</li> </ul> <p>Example Screenshot:</p> <p></p> <p>These first examples are events from Sysmon showing some of the common tactics used by threat actors.  The events have been generated using MetaSploit and  CobaltStrike  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#lateral-movement","title":"Lateral Movement","text":"<p>A common tactic for lateral movement is to push an executable to a remote system and start a service, similar to how psexec.exe works  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#metasploit-lateral-movement-using-a-service-to-initiate-callback","title":"Metasploit lateral movement using a service to initiate callback","text":"<pre><code>Registry value set:\nRuleName: MitreRef=T1060,Technique=Registry Autorun Keys,Tactic=Persistence\nEventType: SetValue\nUtcTime: 2021-06-12 03:49:29.470\nProcessGuid: {298db6a9-2c67-60c4-eeb3-000000000000}\nProcessId: 620\nImage: C:\\Windows\\system32\\services.exe\nTargetObject: HKLM\\System\\CurrentControlSet\\Services\\DpRHdvsE\\Start\nDetails: DWORD (0x00000003)\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#metasploit-lateral-movement-using-a-service-to-initiate-callback-second-event","title":"Metasploit lateral movement using a service to initiate callback, second event","text":"<pre><code>Registry value set:\nRuleName: MitreRef=T1060,Technique=Registry Autorun Keys,Tactic=Persistence\nEventType: SetValue\nUtcTime: 2021-06-12 03:49:29.470\nProcessGuid: {298db6a9-2c67-60c4-eeb3-000000000000}\nProcessId: 620\nImage: C:\\Windows\\system32\\services.exe\nTargetObject: HKLM\\System\\CurrentControlSet\\Services\\DpRHdvsE\\ImagePath\nDetails: %%COMSPEC%% /b /c start /b /min powershell.exe -nop -w hidden -noni -c \"if([IntPtr]::Size -eq 4){$b='powershell.exe'}else{$b=$env:windir+'\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe'};$s=New-Object System.Diagnostics.ProcessStartInfo;$s.FileName=$b;$s.Arguments='-noni -nop -w hidden -c &amp;([scriptblock]::create((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GzipStream((New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String(''H4sIAMguxGACA7shortentedforreadability''))),[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))';$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.WindowStyle='Hidden';$s.CreateNoWindow=$true;$p=[System.Diagnostics.Process]::Start($s);\"\n</code></pre> <p>Process create is a useful event to look for.  It is common for an infected to host to create additional processes when performing other tasks such as, credential dumping or lateral movement  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#process-create-event","title":"Process create event","text":"<pre><code>Process Create:\nRuleName: technique_id=T1086,technique_name=PowerShell\nUtcTime: 2018-09-01 02:26:12.384\nProcessGuid: {79579f2b-f8c4-5b89-0000-0010a8e24300}\nProcessId: 5568\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nFileVersion: 10.0.14393.0 (rs1_release.160715-1616)\nDescription: Windows PowerShell\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nCommandLine: powershell.exe  -nop -w hidden -encodedcommand JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkAT\nCurrentDirectory: C:\\Windows\\system32\\\nUser: computer\\user\nLogonGuid: {79579f2b-f60c-5b89-0000-0020415e0600}\nLogonId: 0x65E41\nTerminalSessionId: 1\nIntegrityLevel: High\nHashes: SHA1=044A0CF1F6BC478A7172BF207EEF1E201A18BA02,MD5=097CE5761C89434367598B34FE32893B,SHA256=BA4038FD20E474C047BE8AAD5BFACDB1BFC1DDBE12F803F473B7918D8D819436,IMPHASH=CAEE994F79D85E47C06E5FA9CDEAE453\nParentProcessGuid: {79579f2b-f737-5b89-0000-0010a2d22200}\nParentProcessId: 2764\nParentImage: C:\\Windows\\System32\\cmd.exe\nParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\"\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#process-create-event-for-lateral-movement","title":"Process create event for lateral movement","text":"<pre><code>Process Create:\nRuleName: -\nUtcTime: 2021-06-24 02:44:23.786\nProcessGuid: {f3da3d38-f187-60d3-b099-6a1600000000}\nProcessId: 7072\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nFileVersion: 10.0.14393.206 (rs1_release.160915-0644)\nDescription: Windows PowerShell\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: PowerShell.EXE\nCommandLine: powershell.exe -nop -w hidden -enc SQBFAFgAIAAoACgAbgBlAHcALQBvA==\nCurrentDirectory: C:\\WINDOWS\\system32\\\nUser: computer\\user\nLogonGuid: {f3da3d38-f187-60d3-e798-6a1600000000}\nLogonId: 0x166A98E7\nTerminalSessionId: 0\nIntegrityLevel: High\nHashes: MD5=097CE5761C89434367598B34FE32893B,SHA256=BA4038FD20E474C047BE8AAD5BFACDB1BFC1DDBE12F803F473B7918D8D819436,IMPHASH=CAEE994F79D85E47C06E5FA9CDEAE453\nParentProcessGuid: {f3da3d38-d166-60cb-4b31-020000000000}\nParentProcessId: 2868\nParentImage: C:\\Windows\\System32\\wbem\\WmiPrvSE.exe\nParentCommandLine: C:\\WINDOWS\\system32\\wbem\\wmiprvse.exe -secured -Embedding\n</code></pre> <p>Malware almost always has to connect back to a C2 system for follow on instructions and to maintain persistance  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#network-event-this-is-an-example-of-powershell-used-as-the-initial-infection-making-a-call-back-not-a-great-example-since-it-was-done-locally-in-vmware","title":"Network event.  This is an example of powershell used as the initial infection making a call back.  Not a great example, since it was done locally in vmware","text":"<pre><code>Network connection detected:\nRuleName: technique_id=T1218,technique_name=Signed Binary Proxy Execution\nUtcTime: 2018-09-01 02:26:19.331\nProcessGuid: {79579f2b-f8c7-5b89-0000-0010f4864400}\nProcessId: 5552\nImage: C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe\nUser: computer\\user\nProtocol: tcp\nInitiated: true\nSourceIsIpv6: false\nSourceIp: 192.168.1.130\nSourceHostname: computer\nSourcePort: 1907\nSourcePortName: \nDestinationIsIpv6: false\nDestinationIp: 192.168.1.143\nDestinationHostname: \nDestinationPort: 443\nDestinationPortName: https\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#credential-events","title":"Credential Events","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#mimikatz-grabbing-credentials-from-current-logged-on-users","title":"mimikatz grabbing credentials from current logged on users","text":"<pre><code>Process accessed:\nRuleName: technique_id=T1003,technique_name=Credential Dumping\nUtcTime: 2018-09-01 02:40:12.833\nSourceProcessGUID: {79579f2b-fc0c-5b89-0000-001097eb6f00}\nSourceProcessId: 5212\nSourceThreadId: 6996\nSourceImage: C:\\Windows\\System32\\rundll32.exe\nTargetProcessGUID: {79579f2b-f5fa-5b89-0000-00105a9c0000}\nTargetProcessId: 604\nTargetImage: C:\\Windows\\system32\\lsass.exe\nGrantedAccess: 0x1010\nCallTrace: C:\\Windows\\SYSTEM32\\ntdll.dll+a6574|C:\\Windows\\System32\\KERNELBASE.dll+20edd|UNKNOWN(000001C7A2AA710D)\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#mimikatz-grabbing-hashes-from-the-local-accounts","title":"mimikatz grabbing hashes from the local accounts","text":"<pre><code>Process accessed:\nRuleName: technique_id=T1003,technique_name=Credential Dumping\nUtcTime: 2018-09-01 02:45:26.030\nSourceProcessGUID: {79579f2b-fd45-5b89-0000-0010c5657300}\nSourceProcessId: 6420\nSourceThreadId: 4172\nSourceImage: C:\\Windows\\System32\\rundll32.exe\nTargetProcessGUID: {79579f2b-f5fa-5b89-0000-00105a9c0000}\nTargetProcessId: 604\nTargetImage: C:\\Windows\\system32\\lsass.exe\nGrantedAccess: 0x1FFFFF\nCallTrace: C:\\Windows\\SYSTEM32\\ntdll.dll+a6574|C:\\Windows\\System32\\KERNELBASE.dll+20edd|UNKNOWN(0000022B28BB1D25)\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#process-injection","title":"Process Injection","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#registry-object-added-or-deleted-createremotethread-detected-rulename-utctime-2021-06-24-031058927-sourceprocessguid-f3da3d38-f187-60d3-b099-6a1600000000-sourceprocessid-7072-sourceimage-cwindowssystem32windowspowershellv10powershellexe-targetprocessguid-f3da3d38-d163-60cb-f2d1-010000000000-targetprocessid-1316-targetimage-cprogram-filesvmwarevmware-toolsvmtoolsdexe-newthreadid-4032-startaddress-0x000001a4bc400000-startmodule-startfunction-","title":"<pre><code>Registry object added or deleted:\nCreateRemoteThread detected:\nRuleName: -\nUtcTime: 2021-06-24 03:10:58.927\nSourceProcessGuid: {f3da3d38-f187-60d3-b099-6a1600000000}\nSourceProcessId: 7072\nSourceImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nTargetProcessGuid: {f3da3d38-d163-60cb-f2d1-010000000000}\nTargetProcessId: 1316\nTargetImage: C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe\nNewThreadId: 4032\nStartAddress: 0x000001A4BC400000\nStartModule: -\nStartFunction: -\n</code></pre>","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#step-2-execute-hunting-queries","title":"Step 2 \u2014 Execute Hunting Queries","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#c2-beaconing","title":"C2 Beaconing","text":"<p>DNS Example (Kibana or Hunt)</p> <pre><code>dns.question.name:*.xyz AND dns.answers.data:\"&lt;external_ip&gt;\"\n</code></pre> <p>HTTP Periodic Beaconing</p> <pre><code>event.module:http AND event.dataset:zeek.http AND http.request.method:POST\n</code></pre> <p>Cobalt Strike Beacon Pattern (Zeek)</p> <pre><code>server.packets &gt;8 AND server.packets &lt;12\n</code></pre> <p>PCAP (Wireshark)</p> <pre><code>ip.dst == [malicious_ip] &amp;&amp; tcp.port == 443\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#malware-artifacts","title":"Malware Artifacts","text":"<p>Registry Autorun Key Modification (Sysmon)</p> <pre><code>HKLM\\System\\CurrentControlSet\\Services\\[malicious]\\Start\n</code></pre> <pre><code>event.module:\"sysmon\" AND event.dataset:\"registry_value_set\"\n</code></pre> <p>Malware Process Creation (Sysmon)</p> <pre><code>event.module:\"sysmon\" AND event.dataset:\"process_create\" AND process.command_line.keyword:\"powershell -nop\"\n</code></pre> <p>Executable File Dropped</p> <pre><code>file.mime_type.keyword: application/x-dosexec\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#abnormal-protocol-or-traffic-patterns","title":"Abnormal Protocol or Traffic Patterns","text":"<p>SMB Executable File Transfer</p> <pre><code>rule.name: \"ET POLICY SMB Executable File Transfer\"\nevent.dataset.keyword: smb_files\nfile.name.keyword: *.exe\n</code></pre> <p>DNS Tunneling (Zeek)</p> <pre><code>dns.query.name.keyword:* AND dns.query.type_name.keyword:A\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#exploit-attempts","title":"Exploit Attempts","text":"<p>Remote Service Control Access (DCERPC)</p> <pre><code>rule.name: \"ET RPC DCERPC SVCCTL - Remote Service Control Manager Access\"\ndce_rpc.operation.keyword: OpenSCManagerA\n</code></pre> <p>WinRM (Lateral Movement)</p> <pre><code>rule.name: \"ET POLICY WinRM wsman Access - Possible Lateral Movement\"\nrule.metadata.tag.keyword: WinRM\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#lateral-movement-and-privilege-escalation","title":"Lateral Movement and Privilege Escalation","text":"<p>Remote Thread Injection (Sysmon CreateRemoteThread)</p> <pre><code>event.module:\"sysmon\" AND event.dataset:\"create_remote_thread\"\n</code></pre> <p>Credential Dumping (LSASS access)</p> <pre><code>event.module:\"sysmon\" AND event.dataset:\"create_remote_thread\" AND winlog.event_data.targetImage:\"*lsass.exe\"\n</code></pre> <p>NTLM Pass-the-Hash (Zeek NTLM Events)</p> <pre><code>event.dataset.keyword: ntlm\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#step-3-analyze-pcap-optional-step","title":"Step 3 \u2014 Analyze PCAP (optional step)","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#using-so-pcap-gui","title":"Using so-pcap GUI","text":"<ul> <li>Select timeframe or relevant alert from so-event.</li> <li>Download PCAP or analyze inline using Wireshark.</li> </ul> <p>Example Wireshark Filters</p> <pre><code>tcp.port == 443 and ip.dst == [suspicious_ip]\n</code></pre> <ul> <li>Look for SSL/TLS handshakes with abnormal JA3 or periodic beaconing.</li> </ul>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#running-scripts-optional","title":"Running Scripts (optional)","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#example-kibana-export","title":"Example Kibana Export","text":"<pre><code>GET _search\n{\n  \"query\": {\n    \"match\": {\n      \"dns.question.name\": \"maliciousdomain.com\"\n    }\n  }\n}\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#blocking-malicious-domains","title":"Blocking Malicious Domains","text":"<pre><code>Add-Content -Path \"C:\\Windows\\System32\\drivers\\etc\\hosts\" -Value \"`n127.0.0.1 malicious.badactor.com\"\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#dependencies","title":"Dependencies","text":"<ul> <li>Fully deployed Security Onion Stack (Kibana, Hunt, so-event, so-pcap)</li> <li>Sysmon + ionstorm config installed on endpoints</li> <li>Wazuh agent forwarding logs</li> <li>Analyst operator trained on MITRE ATT&amp;CK, network analysis, and incident response playbooks</li> </ul>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Zeek Cross-platform Installed Network protocol inspection and correlation Suricata Cross-platform Installed IDS/IPS alerting Sysmon Windows Installed on endpoints Process, Registry, and network activity monitoring Wireshark Cross-platform Installed PCAP analysis Sigma Rules + Elastalert Optional Installed or cloud Convert hunting queries to detection rules"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#operator-recommendations-and-best-practices","title":"Operator Recommendations and Best Practices","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Access Kibana, Hunt, and so-event interfaces.</li> <li> Run hunting queries for C2, malware artifacts, abnormal traffic, exploits, and lateral movement.</li> <li> Analyze PCAP if necessary for beaconing and covert channels.</li> <li> Document findings in hunt log with screenshots, queries, and notes.</li> <li> Submit findings for eradication or closure as appropriate.</li> </ul>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#best-practices","title":"Best Practices","text":"<ul> <li>Pivot frequently between host and network telemetry.</li> <li>Use IOC and behavior-based queries together.</li> <li>Work collaboratively and validate suspicious findings.</li> <li>Document everything for Lessons Learned and detection rule creation.</li> </ul>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#references","title":"References","text":"<ul> <li>Windows Event Log Examples</li> <li>Sigma Rules</li> <li>RUNDLL32 Internet Connection Article</li> <li>Security Onion Quick Malware Analysis</li> <li>Security Onion Malware Traffic Analysis</li> </ul>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.3 FULL MERGE: Original content + screenshots + advanced standards + multi-platform procedures and examples for technical operators Leo"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/","title":"4.31 Run Vulnerability Scan","text":""},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#task-run-vulnerability-scan-on-impacted-and-at-risk-hosts","title":"Task Run Vulnerability Scan on Impacted and At-Risk Hosts","text":""},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#conditions","title":"Conditions","text":"<p>Given access to a vulnerability scanning platform and the environment is contained and stabilized, the operator will execute comprehensive vulnerability scans on impacted and surrounding systems to identify unpatched software, misconfigurations, or weaknesses that could be exploited again.</p> <p>Operator Note: Running a vulnerability scan during eradication ensures the environment is hardened before recovery and normal operations resume. Vulnerability scanning should include both impacted systems and adjacent/related assets.</p>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#standards","title":"Standards","text":"<ul> <li>Team member selects and configures a vulnerability scanning tool appropriate to the environment.</li> <li>Team member conducts credentialed scans whenever possible for completeness.</li> <li>Team member scans all previously impacted systems, systems in proximity, and critical infrastructure.</li> <li>Team member reviews findings and coordinates with system owners to plan remediation.</li> <li>Team member documents vulnerability scan results and actions taken.</li> </ul>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#end-state","title":"End State","text":"<p>All vulnerable and misconfigured systems are identified and scheduled for remediation before recovery operations proceed.</p>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#notes","title":"Notes","text":"<ul> <li>Credentialed scans (using local administrator/root access) provide deeper and more reliable results.  </li> <li>Scanning should be coordinated with IT and system owners to avoid unintentional disruptions.  </li> <li>Scans should be retained as part of incident record for future lessons learned.</li> </ul>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#step-1-select-and-prepare-vulnerability-scanner","title":"Step 1: Select and Prepare Vulnerability Scanner","text":"<p>Recommended Open-Source and Commercial Tools:</p> Tool Platform Installation Usage OpenVAS / Greenbone Linux <code>apt install openvas</code> \u2192 <code>gvm-setup</code> Web UI or CLI \u2192 Full network scan Nessus Essentials Cross-platform Download Web UI \u2192 Local and remote host scans Nmap with Vulners NSE script Cross-platform <code>apt install nmap</code> or <code>brew install nmap</code> <code>nmap -sV --script vuln &lt;target&gt;</code> Qualys Vulnerability Scanner (commercial) Cloud Subscription required Web UI \u2192 Schedule and review scans <p>Operator Note: Nessus Essentials (free) and OpenVAS are highly recommended for small/mid environments due to ease of use and no-cost licensing.</p>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#step-2-define-scan-targets","title":"Step 2: Define Scan Targets","text":"<ul> <li>Impacted hosts identified during containment</li> <li>Critical servers and applications</li> <li>Systems adjacent to impacted networks (lateral movement potential)</li> <li>Domain controllers and infrastructure systems</li> </ul>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#step-3-configure-and-execute-scan","title":"Step 3: Configure and Execute Scan","text":""},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#example-nessus-essentials-web-ui","title":"Example - Nessus Essentials (Web UI)","text":"<ul> <li>Launch scanner and create new scan \u2192 \u201cAdvanced Scan\u201d</li> <li>Enter target IPs or hostnames</li> <li>Configure scan credentials (administrator/root credentials if approved)</li> <li>Configure scanning policies (enable thorough plugin set)</li> <li>Start scan and monitor</li> </ul>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#example-openvas","title":"Example - OpenVAS","text":"<pre><code>gvm-cli socket --gmp-username admin --gmp-password password \"start_task task_id\"\n</code></pre>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#example-nmap","title":"Example - Nmap","text":"<pre><code>nmap -sV --script vuln 192.168.1.100\n</code></pre> <p>Operator Note: Nmap + Vulners script is good for quick snapshot, but full vulnerability scanners are preferred for enterprise use.</p>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#step-4-review-scan-results","title":"Step 4: Review Scan Results","text":"<ul> <li>Filter for Critical and High severity vulnerabilities</li> <li>Note unpatched software, insecure services, and configuration issues</li> <li>Coordinate with IT to plan remediation timeline</li> <li>Validate false positives where necessary</li> </ul>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#step-5-document-and-report","title":"Step 5: Document and Report","text":"<ul> <li>Export scan reports (PDF, CSV, JSON as supported)</li> <li>Log high severity findings in IR tracking/ticketing system</li> <li>Document remediation plan and ownership per asset</li> </ul>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#running-script-nmap-vulners-quick-scan-example","title":"Running Script (Nmap + Vulners Quick Scan Example)","text":"<pre><code>nmap -sV --script vulners 192.168.1.0/24 -oA vulnscan_results\n</code></pre> <p>Operator Note: Generates XML and grepable output for easy parsing and documentation.</p>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#dependencies","title":"Dependencies","text":"<ul> <li>Vulnerability scanner installed and licensed (if required)</li> <li>Network access to targets</li> <li>Administrative credentials (for credentialed scans)</li> <li>Coordination with system owners and IT operations</li> <li>IR lead approval to conduct scans (ensure scans will not disrupt operations)</li> </ul>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage OpenVAS Linux <code>apt install openvas</code> \u2192 <code>gvm-setup</code> Full-featured vulnerability management Nessus Essentials Cross-platform Download from vendor User-friendly, widely adopted scanner Nmap Vulners Script Cross-platform <code>nmap --script vulners</code> Fast, script-based scan for known CVEs Qualys / Rapid7 Enterprise Vendor provided Comprehensive enterprise solutions <p>Operator Note: Choose scanner based on environment size, criticality, and licensing availability.</p>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Select and deploy vulnerability scanning solution.</li> <li> Conduct credentialed scan on impacted and related systems.</li> <li> Validate and analyze scan findings.</li> <li> Coordinate remediation with system owners.</li> <li> Document results and remediation plan in IR record.</li> <li> Retain scan results for lessons learned and reporting.</li> </ul>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#best-practices","title":"Best Practices","text":"<ul> <li>Prefer credentialed scans for completeness.</li> <li>Avoid scanning sensitive systems without coordination.</li> <li>Perform post-remediation re-scans to confirm vulnerability closure.</li> <li>Integrate vulnerability scan into post-eradication validation steps.</li> </ul>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#references","title":"References","text":"<p>Nessus Essentials - Free Vulnerability Scanner OpenVAS / Greenbone Community Edition Nmap NSE Scripts - Vulners</p>"},{"location":"4.Eradication/4.41_Run_Vuln_Scan/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for running vulnerability scans, tool usage, operator checklist Leo"},{"location":"4.Eradication/4.43_Check_for_Rootkits/","title":"4.33 Check for Rootkits","text":""},{"location":"4.Eradication/4.43_Check_for_Rootkits/#task-check-systems-for-rootkits-and-hidden-malware-artifacts","title":"Task Check Systems for Rootkits and Hidden Malware Artifacts","text":""},{"location":"4.Eradication/4.43_Check_for_Rootkits/#conditions","title":"Conditions","text":"<p>Given access to impacted systems and elevated permissions, the operator will utilize rootkit detection tools and procedures to identify hidden malware, kernel-level implants, and unauthorized hooks that could subvert eradication efforts.</p> <p>Operator Note: Rootkits are designed to hide attacker presence and evade detection. Checking for rootkits is critical during eradication to ensure no hidden persistence mechanisms remain.</p>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#standards","title":"Standards","text":"<ul> <li>Team member selects and deploys appropriate rootkit detection tools for the platform.</li> <li>Team member performs thorough scans using automated tools and manual verification methods.</li> <li>Team member reviews and validates any detections, escalating as necessary.</li> <li>Team member documents rootkit scan results and confirms clean status.</li> <li>Team member initiates remediation or reimaging procedures for systems with confirmed rootkits.</li> </ul>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#end-state","title":"End State","text":"<p>Impacted systems have been scanned for rootkits and hidden malware. Any detections have been remediated, and the environment is validated as clean.</p>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#notes","title":"Notes","text":"<ul> <li>Rootkit detection requires elevated privileges (Administrator, root).</li> <li>Some rootkits may not be detectable by userland tools \u2192 forensic validation or reimaging may be necessary.</li> <li>Perform rootkit scanning in safe mode or from trusted boot media when possible.</li> </ul>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.43_Check_for_Rootkits/#step-1-select-rootkit-detection-tools","title":"Step 1: Select Rootkit Detection Tools","text":"Tool Platform Installation Usage GMER Windows Download GUI \u2192 Scan for hooks, hidden processes Windows Defender Offline Scan Windows Built-in \u2192 Settings \u2192 Virus &amp; Threat Protection \u2192 Offline Scan Scans outside OS environment Rootkit Hunter (rkhunter) Linux <code>apt install rkhunter</code> or <code>yum install rkhunter</code> <code>rkhunter --check</code> chkrootkit Linux <code>apt install chkrootkit</code> or <code>yum install chkrootkit</code> <code>chkrootkit</code> KnockKnock macOS Install via Objective-See website GUI \u2192 View persistent items and unsigned code <p>Operator Note: Use multiple tools for high assurance. Rootkit detection is prone to false negatives.</p>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#step-2-prepare-system-for-scanning","title":"Step 2: Prepare System for Scanning","text":"<ul> <li>Ensure antivirus and security software are updated and running.</li> <li>Stop unnecessary services to reduce noise.</li> <li>Where possible, boot into Safe Mode or from trusted recovery media.</li> </ul>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#step-3-perform-rootkit-scans","title":"Step 3: Perform Rootkit Scans","text":""},{"location":"4.Eradication/4.43_Check_for_Rootkits/#windows-gmer","title":"Windows (GMER)","text":"<ul> <li>Launch GMER</li> <li>Select \"Scan\" \u2192 allow full scan to complete</li> <li>Review for hidden modules, hooks, and processes</li> </ul>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#windows-defender-offline-scan","title":"Windows Defender Offline Scan","text":"<ul> <li>From Windows Security \u2192 Virus &amp; Threat Protection</li> <li>Select \"Offline Scan\" and reboot</li> <li>Review results after reboot</li> </ul>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#linux-rootkit-hunter","title":"Linux (Rootkit Hunter)","text":"<pre><code>sudo rkhunter --update\nsudo rkhunter --check\n</code></pre>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#linux-chkrootkit","title":"Linux (chkrootkit)","text":"<pre><code>sudo chkrootkit\n</code></pre>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#macos-knockknock","title":"macOS (KnockKnock)","text":"<ul> <li>Run KnockKnock</li> <li>Review unsigned, persistent, or hidden launch agents and daemons</li> </ul>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#step-4-review-findings","title":"Step 4: Review Findings","text":"<ul> <li>Validate results (some detections may be false positives)</li> <li>Escalate or initiate reimaging procedures for confirmed rootkit infections</li> <li>For suspicious but unconfirmed results \u2192 perform secondary scans or forensic analysis</li> </ul>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#step-5-document-results","title":"Step 5: Document Results","text":"<ul> <li>Record scan tool(s) used, date/time, results, and actions taken</li> <li>Document as clean or infected</li> <li>Retain logs as part of IR case file</li> </ul>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#running-script-linux-rootkit-hunter-scan-and-output","title":"Running Script (Linux - Rootkit Hunter Scan and Output)","text":"<pre><code>sudo rkhunter --check --report-warnings-only &gt; rkhunter_scan_results.txt\n</code></pre> <p>Operator Note: Always redirect output to file for review and inclusion in incident documentation.</p>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#dependencies","title":"Dependencies","text":"<ul> <li>Administrative/root access on systems</li> <li>Rootkit detection tools installed and updated</li> <li>Network or local access to systems (consider offline boot media for high-risk cases)</li> <li>Coordination with enclave/system owners before running intrusive scans</li> </ul>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage GMER Windows Manual download GUI based, advanced rootkit scanning Windows Defender Offline Windows Built-in Scans outside running OS Rootkit Hunter Linux <code>apt/yum install rkhunter</code> Command line scan for rootkits and anomalies chkrootkit Linux <code>apt/yum install chkrootkit</code> Simple command-line rootkit scanner KnockKnock macOS Download from Objective-See GUI detection of unsigned and persistent items <p>Operator Note: If rootkits are detected, consider reimaging the system as part of eradication best practices.</p>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.43_Check_for_Rootkits/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Deploy rootkit detection tools appropriate to platform.</li> <li> Update tools and signatures where applicable.</li> <li> Perform full rootkit scans on impacted hosts.</li> <li> Review scan results and validate findings.</li> <li> Document results and remediation actions.</li> <li> If rootkits are confirmed, escalate to IR lead and initiate system rebuild if necessary.</li> </ul>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#best-practices","title":"Best Practices","text":"<ul> <li>Perform rootkit scans early during eradication \u2192 before recovery begins.</li> <li>Use multiple detection methods for higher confidence.</li> <li>Offline scanning is preferred for highly sensitive or mission critical systems.</li> <li>Retain scan logs and evidence for forensic analysis.</li> </ul>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#references","title":"References","text":"<p>GMER Rootkit Scanner Rootkit Hunter (rkhunter) chkrootkit KnockKnock - Objective-See</p>"},{"location":"4.Eradication/4.43_Check_for_Rootkits/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for rootkit scanning with tools, installation, operator recommendations Leo"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/","title":"4.44 Remove Unauthorized User Accounts","text":""},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#task-identify-and-remove-unauthorized-or-attacker-created-user-accounts","title":"Task Identify and Remove Unauthorized or Attacker-Created User Accounts","text":""},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#conditions","title":"Conditions","text":"<p>Given access to impacted systems and domain infrastructure, the operator will enumerate user accounts across hosts and domain, validate account legitimacy, and remove any unauthorized, malicious, or attacker-created accounts.</p> <p>Operator Note: Attackers often create new user accounts, escalate privileges of existing accounts, or hide in unused accounts to maintain access. Detection and removal of unauthorized accounts is critical for successful eradication.</p>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#standards","title":"Standards","text":"<ul> <li>Team member enumerates all user accounts across impacted systems and the domain.</li> <li>Team member validates accounts against approved and known user/account lists.</li> <li>Team member disables and removes unauthorized or attacker-created accounts.</li> <li>Team member records actions and retains audit logs of removed accounts.</li> <li>Team member coordinates with system owners to validate no business accounts are accidentally removed.</li> </ul>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#end-state","title":"End State","text":"<p>All attacker-created or unauthorized accounts have been identified, validated, removed, and documented. Access control integrity has been restored.</p>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#notes","title":"Notes","text":"<ul> <li>Always disable accounts before deleting \u2192 this prevents accidental loss of evidence or impacting system services.</li> <li>Work with system owners and HR/management to validate questionable accounts.</li> <li>Retain logs of removed accounts and actions for lessons learned and forensic evidence.</li> </ul>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#step-1-enumerate-user-accounts-on-hosts","title":"Step 1: Enumerate User Accounts on Hosts","text":""},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#windows-local-accounts","title":"Windows (Local Accounts)","text":"<pre><code>Get-LocalUser\nnet user\n</code></pre>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#domain-accounts-active-directory","title":"Domain Accounts (Active Directory)","text":"<pre><code>Get-ADUser -Filter * | Select-Object Name, SamAccountName, Enabled, LastLogonDate\n</code></pre>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#linux-local-accounts","title":"Linux (Local Accounts)","text":"<pre><code>cat /etc/passwd\ngetent passwd\n</code></pre>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#macos-local-accounts","title":"macOS (Local Accounts)","text":"<pre><code>dscl . list /Users\n</code></pre> <p>Operator Note: Pay close attention to accounts with UID &lt; 500 on macOS (system accounts) and accounts without login history or descriptions.</p>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#step-2-identify-unauthorized-or-suspicious-accounts","title":"Step 2: Identify Unauthorized or Suspicious Accounts","text":"<ul> <li>Look for:</li> <li>Accounts created recently during attack timeframe.</li> <li>Accounts with administrative privileges.</li> <li>Accounts with non-standard naming schemes (e.g., <code>svc-updates</code>, <code>test123</code>, <code>adm1n</code>).</li> <li> <p>Accounts that never logged in or have no owner.</p> </li> <li> <p>Validate with:</p> </li> <li>HR records (employee/contractor list).</li> <li>System/application owners.</li> <li>IR Team and enclave owner.</li> </ul>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#step-3-disable-suspicious-or-unauthorized-accounts","title":"Step 3: Disable Suspicious or Unauthorized Accounts","text":""},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#windows-local","title":"Windows (Local)","text":"<pre><code>Disable-LocalUser -Name \"suspiciousaccount\"\n</code></pre>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#windows-domain","title":"Windows (Domain)","text":"<pre><code>Disable-ADAccount -Identity \"suspiciousaccount\"\n</code></pre>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#linux","title":"Linux","text":"<pre><code>sudo usermod --lock suspiciousaccount\n</code></pre>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#macos","title":"macOS","text":"<pre><code>sudo pwpolicy -u suspiciousaccount disableuser\n</code></pre>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#step-4-remove-unauthorized-accounts-post-validation","title":"Step 4: Remove Unauthorized Accounts (Post Validation)","text":""},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#windows-local_1","title":"Windows (Local)","text":"<pre><code>Remove-LocalUser -Name \"suspiciousaccount\"\n</code></pre>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#windows-domain_1","title":"Windows (Domain)","text":"<pre><code>Remove-ADUser -Identity \"suspiciousaccount\"\n</code></pre>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#linux_1","title":"Linux","text":"<pre><code>sudo userdel suspiciousaccount\n</code></pre>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#macos_1","title":"macOS","text":"<pre><code>sudo dscl . -delete /Users/suspiciousaccount\n</code></pre>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#step-5-document-actions","title":"Step 5: Document Actions","text":"<ul> <li>Log account name, system, actions taken, and operator performing the action.</li> <li>Retain before/after snapshots of account lists.</li> <li>Note justification for account removal.</li> </ul> <pre><code>[2025-05-02] Removed unauthorized user \"svc-update\" from HOST123. Account confirmed attacker-created. Approved by IR Lead. Operator: Leo\n</code></pre>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#running-script-windows-list-all-users-and-last-login","title":"Running Script (Windows - List All Users and Last Login)","text":"<pre><code>Get-LocalUser | Select-Object Name, Enabled, LastLogon\n</code></pre>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#linux-identify-users-with-no-logins","title":"Linux (Identify Users With No Logins)","text":"<pre><code>lastlog | grep \"**Never logged in**\"\n</code></pre> <p>Operator Note: Accounts with no logins and unusual names are often used as backdoors.</p>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#dependencies","title":"Dependencies","text":"<ul> <li>Administrative/root access on all hosts and domain controllers</li> <li>Coordination with system owners and HR for validation</li> <li>Audit logs or historical account data (if available)</li> <li>IR team approval for account removal actions</li> </ul>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage PowerShell Windows Built-in Enumerate and remove local/domain users Active Directory Users &amp; Computers Windows (Domain) Built-in MMC snap-in Visual account validation and removal dscl macOS Built-in Manage local users and groups userdel / passwd Linux Built-in Remove and lock local users <p>Operator Note: Always lock/disable first before deleting to prevent accidental service impact.</p>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Enumerate all user accounts (host + domain).</li> <li> Validate all accounts against approved lists.</li> <li> Disable unauthorized accounts prior to removal.</li> <li> Remove unauthorized accounts after validation.</li> <li> Document removal actions and update incident records.</li> <li> Retain logs and audit trails for future reference.</li> </ul>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#best-practices","title":"Best Practices","text":"<ul> <li>Coordinate with HR and system owners to prevent false positives.</li> <li>Disable accounts first to allow rollback if removal impacts critical services.</li> <li>Use native OS tools whenever possible for auditability.</li> <li>Document extensively \u2192 account removal is often reviewed in post-incident reporting.</li> </ul>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#references","title":"References","text":"<p>Microsoft PowerShell Local Accounts Cmdlets Linux User Management Apple macOS dscl Command</p>"},{"location":"4.Eradication/4.44_Remove_Unauthorized_User_Accounts/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for removing unauthorized accounts with platform guidance, tools, checklist Leo"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/","title":"4.45 Check for Unauthorized Scheduled Tasks and Services","text":""},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#task-identify-and-remove-unauthorized-scheduled-tasks-and-services","title":"Task Identify and Remove Unauthorized Scheduled Tasks and Services","text":""},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#conditions","title":"Conditions","text":"<p>Given access to impacted systems and elevated permissions, the operator will enumerate, review, and remove attacker-created or unauthorized scheduled tasks and services designed to maintain persistence or execute malicious code.</p> <p>Operator Note: Scheduled tasks and unauthorized services are often used by attackers for persistence. Thorough review and cleanup of these artifacts is critical during eradication.</p>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#standards","title":"Standards","text":"<ul> <li>Team member enumerates all scheduled tasks and services across impacted systems.</li> <li>Team member validates each task and service against known good baselines.</li> <li>Team member disables and removes unauthorized tasks and services.</li> <li>Team member documents all removals and retains records for post-incident review.</li> <li>Team member validates removal and confirms no residual unauthorized entries remain.</li> </ul>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#end-state","title":"End State","text":"<p>All unauthorized and attacker-created scheduled tasks and services have been identified, validated, removed, and documented. No malicious persistence mechanisms remain.</p>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#notes","title":"Notes","text":"<ul> <li>Unauthorized tasks and services may have misleading or disguised names.</li> <li>Removal should be coordinated with system owners to prevent accidental removal of legitimate services.</li> <li>Retain forensic copies and documentation of malicious tasks and services removed.</li> </ul>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#step-1-enumerate-scheduled-tasks","title":"Step 1: Enumerate Scheduled Tasks","text":""},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#windows","title":"Windows","text":"<pre><code>Get-ScheduledTask | Where-Object {$_.State -ne \"Disabled\"} | Format-Table TaskName, State, LastRunTime\nschtasks /query /fo LIST /v\n</code></pre>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#linux-cron-jobs","title":"Linux (cron jobs)","text":"<pre><code>crontab -l\nls /etc/cron.*\ncat /etc/crontab\nsystemctl list-timers\n</code></pre>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#macos-launchd-and-cron","title":"macOS (launchd and cron)","text":"<pre><code>launchctl list\ncrontab -l\n</code></pre> <p>Operator Note: Pay attention to tasks with non-standard user names, random file names, or unusual execution paths (AppData, Temp folders).</p>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#step-2-enumerate-services","title":"Step 2: Enumerate Services","text":""},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#windows_1","title":"Windows","text":"<pre><code>Get-Service | Where-Object {$_.Status -eq \"Running\"} | Format-Table Name, DisplayName, Status\nGet-WmiObject win32_service | Select-Object Name, StartMode, State, PathName\n</code></pre>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#linux","title":"Linux","text":"<pre><code>systemctl list-units --type=service --state=running\nchkconfig --list\n</code></pre>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#macos","title":"macOS","text":"<pre><code>launchctl list\nsudo launchctl print system\n</code></pre>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#step-3-investigate-suspicious-tasks-and-services","title":"Step 3: Investigate Suspicious Tasks and Services","text":"<p>Criteria for suspicious tasks/services:</p> <ul> <li>Created recently (within incident timeframe)</li> <li>Random, non-descriptive names (e.g., \"svc-host\", \"update123\")</li> <li>Execution path pointing to temp or user folders</li> <li>Run as SYSTEM or root</li> <li>No corresponding legitimate application or vendor</li> </ul> <p>Operator Note: Coordinate findings with IR and system/application owners.</p>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#step-4-disable-and-remove-unauthorized-entries","title":"Step 4: Disable and Remove Unauthorized Entries","text":""},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#windows-disable-and-remove-scheduled-task","title":"Windows (Disable and Remove Scheduled Task)","text":"<pre><code>Disable-ScheduledTask -TaskName \"MaliciousTask\"\nUnregister-ScheduledTask -TaskName \"MaliciousTask\" -Confirm:$false\n</code></pre>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#windows-disable-and-remove-service","title":"Windows (Disable and Remove Service)","text":"<pre><code>Stop-Service -Name \"MaliciousService\"\nsc.exe delete \"MaliciousService\"\n</code></pre>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#linux-remove-cron-jobs","title":"Linux (Remove Cron Jobs)","text":"<pre><code>crontab -r -u attackeruser\nsudo rm /etc/cron.d/maliciouscron\nsudo systemctl disable malicious.service\nsudo systemctl stop malicious.service\nsudo rm /etc/systemd/system/malicious.service\n</code></pre>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#macos-remove-launch-agentdaemon","title":"macOS (Remove Launch Agent/Daemon)","text":"<pre><code>sudo launchctl bootout system /Library/LaunchDaemons/malicious.plist\nsudo rm /Library/LaunchDaemons/malicious.plist\n</code></pre>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#step-5-validate-removal","title":"Step 5: Validate Removal","text":"<ul> <li>Re-enumerate tasks/services to confirm removal</li> <li>Review logs to ensure no restarts/re-creations</li> <li>Monitor system for signs of persistence attempts</li> </ul>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#running-script-windows-find-non-microsoft-running-services","title":"Running Script (Windows - Find Non-Microsoft Running Services)","text":"<pre><code>Get-WmiObject win32_service | Where-Object {$_.PathName -notlike \"*Microsoft*\"} | Format-Table Name, State, PathName\n</code></pre> <p>Operator Note: Focus on non-standard service paths and names during eradication validation.</p>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#dependencies","title":"Dependencies","text":"<ul> <li>Administrative/root access on hosts</li> <li>Baseline of authorized services/tasks (if available)</li> <li>Coordination with system/application owners</li> <li>IR team approval for disabling/removal</li> </ul>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Autoruns (Sysinternals) Windows Download from Sysinternals View all scheduled tasks, services, and persistence PowerShell Windows Built-in View, disable, remove scheduled tasks/services systemctl / crontab Linux Built-in Manage services and scheduled tasks launchctl macOS Built-in Manage launch daemons and agents <p>Operator Note: Autoruns is highly recommended for full Windows persistence review during eradication.</p>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Enumerate all scheduled tasks and services.</li> <li> Validate each task/service \u2192 identify unauthorized entries.</li> <li> Disable and remove unauthorized or suspicious tasks and services.</li> <li> Validate removal and absence of re-creation.</li> <li> Document findings and actions.</li> </ul>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#best-practices","title":"Best Practices","text":"<ul> <li>Prefer disabling before deletion for rollback and evidence preservation.</li> <li>Use multiple detection methods (built-in commands + tools like Autoruns).</li> <li>Retain forensic copies of malicious task/service configuration where possible.</li> <li>Validate all systems post-eradication to confirm no persistence mechanisms remain.</li> </ul>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#references","title":"References","text":"<p>Microsoft Sysinternals Autoruns systemd - Linux Services Apple macOS launchctl Reference</p>"},{"location":"4.Eradication/4.45_Check_for_Unauthorized_Scheduled_Tasks_Services/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for checking/removing unauthorized scheduled tasks and services with platform guidance Leo"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/","title":"4.46 Check for Unauthorized Software and Tools","text":""},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#task-identify-and-remove-unauthorized-or-malicious-software-installed-by-attackers","title":"Task Identify and Remove Unauthorized or Malicious Software Installed by Attackers","text":""},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#conditions","title":"Conditions","text":"<p>Given access to impacted systems and administrative privileges, the operator will enumerate installed software and tools, investigate suspicious or unauthorized programs, and remove any attacker-installed software to ensure eradication is complete.</p> <p>Operator Note: Attackers often install tools (credential dumpers, remote access software, persistence frameworks) to aid in lateral movement and post-compromise activities. These must be thoroughly removed.</p>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#standards","title":"Standards","text":"<ul> <li>Team member enumerates all installed software and executables across impacted hosts.</li> <li>Team member validates each item against an approved software baseline or with system owners.</li> <li>Team member removes unauthorized or malicious software.</li> <li>Team member documents findings, actions taken, and retains logs or forensic evidence.</li> <li>Team member validates removal and confirms system integrity.</li> </ul>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#end-state","title":"End State","text":"<p>Unauthorized and attacker-installed software has been fully identified, validated, removed, and documented across the environment.</p>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#notes","title":"Notes","text":"<ul> <li>Some software may appear benign (e.g., \"Remote Utilities\", \"7zip\") but may have been used maliciously \u2192 context matters.</li> <li>Use caution when removing software to avoid disruption of legitimate services.</li> <li>Retain forensic artifacts for post-incident analysis.</li> </ul>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#step-1-enumerate-installed-software","title":"Step 1: Enumerate Installed Software","text":""},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#windows","title":"Windows","text":"<pre><code>Get-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, InstallDate\nGet-ItemProperty HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, InstallDate\nwmic product get name, installlocation\n</code></pre>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#linux","title":"Linux","text":"<pre><code>dpkg -l   # Debian/Ubuntu\nrpm -qa   # RHEL/CentOS\nfind / -type f -executable -exec ls -la {} \\; 2&gt;/dev/null | grep -i suspicious\n</code></pre>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#macos","title":"macOS","text":"<pre><code>system_profiler SPApplicationsDataType\nls /Applications\nfind /usr/local/bin /usr/bin /bin -type f -perm +111\n</code></pre> <p>Operator Note: Focus on unusual install paths (AppData, /tmp, user folders) and unknown publishers.</p>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#step-2-investigate-suspicious-software","title":"Step 2: Investigate Suspicious Software","text":"<p>Indicators of suspicious or unauthorized software:</p> <ul> <li>Installed during the attack timeframe</li> <li>Unusual publisher or no publisher info</li> <li>Located in user-space or temporary directories</li> <li>Known hacking, remote access, or admin tools used by attackers (e.g., Mimikatz, PsExec, AnyDesk)</li> </ul> <p>Operator Note: Cross-reference with threat intelligence sources and MITRE ATT&amp;CK for known attacker tooling.</p>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#step-3-remove-unauthorized-or-malicious-software","title":"Step 3: Remove Unauthorized or Malicious Software","text":""},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#windows_1","title":"Windows","text":"<pre><code>Get-WmiObject -Class Win32_Product | Where-Object {$_.Name -like \"*SuspiciousSoftware*\"} | ForEach-Object { $_.Uninstall() }\n</code></pre> <p>OR via Control Panel / Apps &amp; Features for GUI removal.</p>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#linux_1","title":"Linux","text":"<pre><code>sudo apt remove suspiciouspackage\nsudo yum remove suspiciouspackage\nsudo rm /path/to/suspicious/file\n</code></pre>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#macos_1","title":"macOS","text":"<pre><code>sudo rm -rf /Applications/SuspiciousApp.app\nbrew uninstall suspiciouspackage\n</code></pre> <p>Operator Note: Validate removal after using package managers or manual methods.</p>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#step-4-validate-removal-and-monitor","title":"Step 4: Validate Removal and Monitor","text":"<ul> <li>Re-enumerate installed software list</li> <li>Confirm no related services, scheduled tasks, or residual files remain</li> <li>Monitor logs for reinstallation attempts or indicators of persistence</li> </ul>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#running-script-windows-enumerate-installed-apps-and-save-to-file","title":"Running Script (Windows - Enumerate Installed Apps and Save to File)","text":"<pre><code>Get-ItemProperty HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* |\nSelect-Object DisplayName, InstallDate |\nExport-Csv InstalledSoftware.csv -NoTypeInformation\n</code></pre> <p>Operator Note: Retain lists before and after eradication for recordkeeping.</p>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#dependencies","title":"Dependencies","text":"<ul> <li>Administrative/root access on hosts</li> <li>System baseline (if available) or coordination with system owners</li> <li>Threat intelligence for identifying attacker tooling</li> <li>IR lead approval for software removal actions</li> </ul>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Autoruns (Sysinternals) Windows Download from Sysinternals Detect non-standard software loading at startup PowerShell Windows Built-in Enumerate, remove software Package managers (apt, yum, brew) Linux/macOS Built-in Remove installed software EDR/XDR Platforms Cross-platform Enterprise deployment Detect and alert on unauthorized software <p>Operator Note: Autoruns and EDR solutions are highly effective for detecting hidden/unauthorized software.</p>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Enumerate installed software and tools across all impacted hosts.</li> <li> Validate findings against approved baseline or system owner input.</li> <li> Investigate and document suspicious or unauthorized software.</li> <li> Remove unauthorized or malicious software safely.</li> <li> Validate removal and monitor for reappearance.</li> <li> Document actions and retain before/after software inventory.</li> </ul>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#best-practices","title":"Best Practices","text":"<ul> <li>Remove software during eradication when risk of disruption is low.</li> <li>Prefer automated removal tools where available to ensure completeness.</li> <li>Coordinate with system/application owners before removing borderline software.</li> <li>Include software audit results in post-incident documentation and lessons learned.</li> </ul>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#references","title":"References","text":"<p>Windows PowerShell Get-WmiObject for Installed Software Linux Package Management (APT/YUM) macOS Command Line Tools Sysinternals Autoruns</p>"},{"location":"4.Eradication/4.46_Check_for_Unauthorized_Software_Tools/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for checking/removing unauthorized software and attacker tools with platform-specific guidance Leo"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/","title":"4.47 Remove Attacker Persistence Mechanisms","text":""},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#task-identify-and-remove-all-attacker-persistence-mechanisms","title":"Task Identify and Remove All Attacker Persistence Mechanisms","text":""},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#conditions","title":"Conditions","text":"<p>Given administrative access to impacted systems, the operator will enumerate and remove all attacker-installed persistence mechanisms. These include scheduled tasks, services, startup items, registry entries, scripts, user profiles, and other footholds left to maintain access.</p> <p>Operator Note: Persistence can be stealthy and layered. Operators must carefully search, validate, and remove ALL unauthorized persistence mechanisms to prevent re-compromise.</p>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#standards","title":"Standards","text":"<ul> <li>Team member conducts full review of known persistence vectors on each impacted system.</li> <li>Team member uses validated tools and commands to enumerate and detect persistence artifacts.</li> <li>Team member removes or disables identified unauthorized persistence mechanisms.</li> <li>Team member documents all findings and actions taken, including validation of removal.</li> <li>Team member ensures post-removal verification is performed.</li> </ul>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#end-state","title":"End State","text":"<p>All attacker persistence mechanisms have been removed and validated. Systems are free of unauthorized tasks, services, registry keys, startup items, and other persistence artifacts.</p>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#notes","title":"Notes","text":"<ul> <li>Use layered detection methods (manual inspection, automated tools, EDR telemetry).</li> <li>Always document persistence artifacts before removal (evidence + lessons learned).</li> <li>Validate system functionality after removal \u2192 some attackers use hijacked legitimate mechanisms.</li> </ul>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#step-1-enumerate-common-persistence-mechanisms","title":"Step 1: Enumerate Common Persistence Mechanisms","text":""},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#scheduled-tasks-and-cron-jobs","title":"Scheduled Tasks and Cron Jobs","text":""},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#windows","title":"Windows","text":"<pre><code>Get-ScheduledTask | Select-Object TaskName, State, Actions\nschtasks /query /fo LIST /v\n</code></pre>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#linux","title":"Linux","text":"<pre><code>crontab -l\nls -alh /etc/cron.*\nsystemctl list-timers\n</code></pre>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#macos","title":"macOS","text":"<pre><code>launchctl list\ncrontab -l\n</code></pre>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#services-and-daemons","title":"Services and Daemons","text":""},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#windows_1","title":"Windows","text":"<pre><code>Get-Service | Where-Object {$_.Status -eq \"Running\"} | Format-Table Name, DisplayName, PathName\n</code></pre>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#linux_1","title":"Linux","text":"<pre><code>systemctl list-units --type=service\nchkconfig --list\n</code></pre>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#macos_1","title":"macOS","text":"<pre><code>launchctl list\n</code></pre>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#registry-and-startup-items-windows","title":"Registry and Startup Items (Windows)","text":"<pre><code>Get-ItemProperty -Path \"HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\"\nGet-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\"\n</code></pre> <p>Operator Note: Also review <code>HKLM\\SYSTEM\\CurrentControlSet\\Services</code> for driver-level persistence.</p>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#wmi-event-subscriptions-windows","title":"WMI Event Subscriptions (Windows)","text":"<pre><code>Get-WmiObject -Namespace root\\subscription -Class __EventFilter\n</code></pre> <p>Operator Note: WMI persistence is common for fileless malware and advanced actors.</p>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#user-profiles-and-login-items","title":"User Profiles and Login Items","text":""},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#windows_2","title":"Windows","text":"<pre><code>Get-ChildItem \"C:\\Users\" -Force\n</code></pre>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#linuxmacos","title":"Linux/macOS","text":"<pre><code>ls -la /home\nls -la /Users\n</code></pre> <p>Operator Note: Review <code>.bash_profile</code>, <code>.bashrc</code>, <code>.zshrc</code>, <code>.login</code> files for script-based persistence.</p>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#step-2-investigate-and-validate-suspicious-entries","title":"Step 2: Investigate and Validate Suspicious Entries","text":"<p>Indicators of malicious persistence:</p> <ul> <li>Non-standard names (random strings, benign looking names)</li> <li>File paths in user directories or temp folders</li> <li>Unknown publishers or unsigned executables</li> <li>Recently created tasks, services, or registry entries</li> </ul> <p>Coordinate with IR lead and system owner for validation prior to removal.</p>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#step-3-remove-unauthorized-persistence-mechanisms","title":"Step 3: Remove Unauthorized Persistence Mechanisms","text":""},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#scheduled-tasks","title":"Scheduled Tasks","text":"<pre><code>Unregister-ScheduledTask -TaskName \"MaliciousTask\" -Confirm:$false\n</code></pre>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#services","title":"Services","text":"<pre><code>Stop-Service -Name \"MaliciousService\"\nsc.exe delete \"MaliciousService\"\n</code></pre>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#registry-startup-keys","title":"Registry Startup Keys","text":"<pre><code>Remove-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" -Name \"BadStartupEntry\"\n</code></pre>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#wmi-subscriptions","title":"WMI Subscriptions","text":"<pre><code>Get-WmiObject -Namespace root\\subscription -Class __EventFilter | Remove-WmiObject\n</code></pre>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#linuxmacos-cron-jobs-and-startup-files","title":"Linux/macOS Cron Jobs and Startup Files","text":"<pre><code>crontab -r -u malicioususer\nrm /etc/cron.d/maliciouscron\nrm ~/.bash_profile\nrm /Library/LaunchDaemons/malicious.plist\nlaunchctl bootout system /Library/LaunchDaemons/malicious.plist\n</code></pre>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#step-4-validate-removal-and-monitor","title":"Step 4: Validate Removal and Monitor","text":"<ul> <li>Re-enumerate persistence vectors to ensure no entries remain.</li> <li>Monitor system logs for unauthorized task/service creation attempts.</li> <li>Validate with EDR/XDR or audit log collection.</li> </ul>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#running-script-windows-quick-scheduled-task-audit","title":"Running Script (Windows - Quick Scheduled Task Audit)","text":"<pre><code>Get-ScheduledTask | Select-Object TaskName, Description, State, Actions | Export-Csv ScheduledTasks.csv -NoTypeInformation\n</code></pre> <p>Operator Note: Retain before/after audit records for incident documentation.</p>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#dependencies","title":"Dependencies","text":"<ul> <li>Administrative/root access on target systems</li> <li>IR toolkit including PowerShell, Autoruns, systemctl, launchctl, and WMI modules</li> <li>Approval from IR lead for removal actions</li> <li>Coordination with system owners for validation</li> </ul>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Autoruns (Sysinternals) Windows Download from Microsoft Sysinternals Visualize and remove autorun and startup entries PowerShell Windows Built-in Enumerate and remove tasks, services, WMI EDR/XDR Platforms (e.g., Crowdstrike, SentinelOne) Cross-platform Enterprise deployment Detect and alert on unauthorized persistence systemctl + crontab Linux Built-in Manage services and scheduled tasks KnockKnock macOS Download from Objective-See GUI analysis of persistent login items <p>Operator Note: Always prefer using trusted enterprise tooling (EDR/XDR) to supplement manual detection and removal.</p>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Enumerate all common persistence vectors (tasks, services, registry, WMI, startup).</li> <li> Validate suspicious entries \u2192 determine authorized vs unauthorized.</li> <li> Disable and remove unauthorized persistence.</li> <li> Validate removal and monitor for re-creation attempts.</li> <li> Document all actions and preserve artifacts where possible.</li> </ul>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#best-practices","title":"Best Practices","text":"<ul> <li>Prefer disabling over deletion where possible to preserve evidence.</li> <li>Validate with system/application owners before removing borderline entries.</li> <li>Use multiple discovery methods (manual + automated).</li> <li>Retain forensic images or audit logs of persistence mechanisms before removal.</li> </ul>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#references","title":"References","text":"<p>Sysinternals Autoruns WMI Persistence (MITRE ATT&amp;CK T1546.003) Launchd and launchctl on macOS </p>"},{"location":"4.Eradication/4.47_Remove_Attacker_Persistence/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for attacker persistence removal with platform techniques and tools Leo"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/","title":"4.48 Validate Eradication Completion","text":""},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#task-validate-that-all-malicious-artifacts-have-been-removed-and-environment-is-ready-for-recovery","title":"Task Validate That All Malicious Artifacts Have Been Removed and Environment is Ready for Recovery","text":""},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#conditions","title":"Conditions","text":"<p>After completing eradication activities (malware removal, persistence elimination, unauthorized accounts removal), the operator will execute validation steps to confirm that the environment is clean and no attacker footholds or residual risks remain.</p> <p>Operator Note: This is a critical control gate before transition to recovery. No recovery action should begin until eradication validation is complete and documented.</p>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#standards","title":"Standards","text":"<ul> <li>Team member performs validation activities across all impacted and at-risk systems.</li> <li>Team member uses tools and manual review to confirm eradication success.</li> <li>Team member coordinates validation efforts with stakeholders (IT, IR lead, system owners).</li> <li>Team member documents all validation actions and results.</li> <li>Team member escalates any residual detections for further eradication before recovery begins.</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#end-state","title":"End State","text":"<p>Validation confirms that all malicious artifacts have been removed, systems are clean, and no persistence or unauthorized access points remain. The environment is approved for transition to recovery.</p>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#notes","title":"Notes","text":"<ul> <li>Validation is a multi-layered process \u2192 host, network, and enterprise levels.</li> <li>Thoroughness is critical to avoid re-infection or re-compromise.</li> <li>Engage system owners during validation to ensure all business-critical components are reviewed.</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#step-1-validate-host-level-cleanliness","title":"Step 1: Validate Host-Level Cleanliness","text":""},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#malware-scan","title":"Malware Scan","text":"<ul> <li>Re-scan all hosts with antivirus and anti-malware tools.</li> <li>Tools: Windows Defender, Malwarebytes, ClamAV, ESET</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#persistence-review","title":"Persistence Review","text":"<ul> <li>Confirm no unauthorized scheduled tasks, services, registry keys, startup items.</li> <li>Tools: Autoruns (Windows), systemctl + crontab (Linux), KnockKnock (macOS)</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#user-accounts","title":"User Accounts","text":"<ul> <li>Verify no unauthorized accounts exist.</li> <li>Validate account permissions and group memberships.</li> <li>Tools: PowerShell, getent passwd, dscl</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#logs-review","title":"Logs Review","text":"<ul> <li>Review system, security, and application logs for signs of malware or attacker activity.</li> <li>Tools: Event Viewer (Windows), /var/log/ (Linux), Console.app (macOS)</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#step-2-validate-network-level-cleanliness","title":"Step 2: Validate Network-Level Cleanliness","text":""},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#network-connections","title":"Network Connections","text":"<ul> <li>Verify no unexpected open ports or persistent connections.</li> <li>Tools: netstat, ss, TCPView (Windows)</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#firewall-and-idsips-logs","title":"Firewall and IDS/IPS Logs","text":"<ul> <li>Review logs for any ongoing malicious traffic or indicators of compromise.</li> <li>Tools: pfSense, Suricata, Palo Alto Panorama, Security Onion</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#dns-and-proxy","title":"DNS and Proxy","text":"<ul> <li>Validate that all DNS queries are legitimate and no C2 domains are being accessed.</li> <li>Tools: Zeek (Security Onion), DNS server logs</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#step-3-validate-enterprise-and-domain-integrity","title":"Step 3: Validate Enterprise and Domain Integrity","text":""},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#active-directory","title":"Active Directory","text":"<ul> <li>Review Group Policy Objects, user rights assignments, delegated permissions.</li> <li>Verify no rogue domain controllers or replication issues.</li> <li>Tools: PowerShell, ADUC, BloodHound (for advanced validation)</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#email-and-collaboration-tools","title":"Email and Collaboration Tools","text":"<ul> <li>Review mail flow rules, external forwarding, unauthorized accounts.</li> <li>Tools: Exchange Admin Center, M365 Defender, Google Workspace Admin</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#cloud-and-saas","title":"Cloud and SaaS","text":"<ul> <li>Confirm that no unauthorized access tokens or integrations exist.</li> <li>Tools: AWS GuardDuty, Azure Security Center, Okta logs</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#step-4-validate-backups-and-business-systems","title":"Step 4: Validate Backups and Business Systems","text":"<ul> <li>Confirm backups are intact and tested (ransomware defense).</li> <li>Validate business-critical applications are clean and operational.</li> <li>Tools: Backup software console, application/system owners coordination</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#step-5-document-and-approve","title":"Step 5: Document and Approve","text":"<ul> <li>Create eradication validation report.</li> <li>Include findings, validation methods, results, and any follow-up actions.</li> <li>Submit report to IR Lead and System Owner for approval to transition to recovery.</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#running-script-windows-recheck-for-suspicious-scheduled-tasks","title":"Running Script (Windows - Recheck for Suspicious Scheduled Tasks)","text":"<pre><code>Get-ScheduledTask | Where-Object {$_.State -ne \"Disabled\"} | Select-Object TaskName, Actions\n</code></pre>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#running-script-linux-check-for-suspicious-services-and-cron-jobs","title":"Running Script (Linux - Check for Suspicious Services and Cron Jobs)","text":"<pre><code>systemctl list-units --type=service\ncrontab -l\n</code></pre>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#dependencies","title":"Dependencies","text":"<ul> <li>Access to all eradicated systems and supporting infrastructure</li> <li>Antivirus, EDR, and IR toolkit available for validation scans</li> <li>Coordination with IT/system owners</li> <li>IR Lead oversight and approval to proceed to recovery</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Antivirus (Defender, Malwarebytes, ClamAV) Cross-platform Pre-installed or download Re-scan hosts Autoruns (Sysinternals) Windows Download from Microsoft Validate autoruns and persistence EDR/XDR Platform (Crowdstrike, SentinelOne) Enterprise Deployed agent Confirm eradication Security Onion / Zeek Network Deployed sensor Confirm network activity is clean PowerShell / bash Cross-platform Built-in Enumerate accounts, services, tasks <p>Operator Note: Use layered validation \u2192 no single tool will catch everything.</p>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate host-level eradication (malware, persistence, accounts, logs).</li> <li> Validate network-level eradication (traffic, DNS, firewall logs).</li> <li> Validate enterprise-level eradication (AD, email, SaaS/cloud).</li> <li> Validate backups and critical applications are clean.</li> <li> Document validation efforts and findings.</li> <li> Escalate and eradicate if anything is found.</li> <li> Obtain IR Lead approval before recovery begins.</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#best-practices","title":"Best Practices","text":"<ul> <li>Perform validation in a structured and systematic manner.</li> <li>Engage cross-functional teams (network, system owners, IT).</li> <li>Use clean baseline systems or recovery media to verify suspicious systems.</li> <li>Never skip validation \u2192 missed eradication steps often result in repeat incidents.</li> </ul>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#references","title":"References","text":"<p>Sysinternals Autoruns MITRE ATT&amp;CK Persistence Techniques Zeek Network Security Monitor Windows Defender Antivirus</p>"},{"location":"4.Eradication/4.48_Validate_Eradication_Completion/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for validating eradication completion with detailed checklist and tools Leo"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/","title":"4.49 Coordinate Transition to Recovery","text":""},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#task-coordinate-the-transition-from-eradication-to-recovery-operations","title":"Task Coordinate the Transition from Eradication to Recovery Operations","text":""},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#conditions","title":"Conditions","text":"<p>Following successful eradication and validation activities, the operator will work with the Incident Response Lead, IT Operations, System Owners, and other stakeholders to formally transition from incident eradication to recovery. This includes ensuring all preconditions are met and appropriate approvals are obtained.</p> <p>Operator Note: The transition to recovery is a critical step. Recovering too early can lead to re-infection or missed attacker footholds. Ensure the environment is confirmed clean and authorized before recovery.</p>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#standards","title":"Standards","text":"<ul> <li>Team member confirms all eradication validation tasks are complete and documented.</li> <li>Team member coordinates transition planning with recovery team and system owners.</li> <li>Team member documents and obtains approval for transition to recovery.</li> <li>Team member communicates the transition status and readiness to all stakeholders.</li> <li>Team member ensures transition occurs in a controlled and monitored manner.</li> </ul>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#end-state","title":"End State","text":"<p>A controlled and coordinated transition to recovery occurs with all parties informed, and the environment is confirmed ready for restoration and resumption of normal operations.</p>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#notes","title":"Notes","text":"<ul> <li>Transition to recovery marks the formal end of active eradication and containment activities.</li> <li>All critical stakeholders should be informed before recovery actions begin.</li> <li>A rollback plan should be in place in case post-recovery issues arise.</li> </ul>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#step-1-confirm-eradication-is-complete","title":"Step 1: Confirm Eradication is Complete","text":"<ul> <li>Review eradication validation reports (see 4.48).</li> <li>Ensure all affected systems have passed validation checks.</li> <li>Confirm no outstanding eradication tasks remain.</li> </ul> <p>Operator Note: No transition should occur with unresolved eradication issues.</p>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#step-2-coordinate-with-recovery-team-and-stakeholders","title":"Step 2: Coordinate with Recovery Team and Stakeholders","text":"<ul> <li>Identify recovery stakeholders:</li> <li>Incident Response Lead</li> <li>IT Operations</li> <li>System and Application Owners</li> <li>Cybersecurity Team</li> <li> <p>Executive / Crisis Management Team (if applicable)</p> </li> <li> <p>Schedule recovery planning meeting or coordination session.</p> </li> </ul> <p>Operator Note: Use collaborative tools (Teams, Zoom, Slack) or phone bridge for coordination during large incidents.</p>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#step-3-prepare-recovery-plan-and-obtain-approvals","title":"Step 3: Prepare Recovery Plan and Obtain Approvals","text":"<ul> <li>Develop recovery plan that includes:</li> <li>Systems and services to be brought online.</li> <li>Recovery order of operations.</li> <li> <p>Validation/monitoring actions during recovery.</p> </li> <li> <p>Obtain formal approval to proceed:</p> </li> <li>Incident Response Lead</li> <li>System/Business Owners</li> <li>IT Operations Management</li> </ul> <p>Operator Note: Approval can be written (email, ticketing system) or verbal \u2192 document method in incident record.</p>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#step-4-communicate-transition","title":"Step 4: Communicate Transition","text":"<ul> <li>Announce transition to all affected teams and stakeholders:</li> <li>\"Transitioning from eradication to recovery at \" <li> <p>Highlight any special instructions or considerations.</p> </li> <li> <p>Update incident tracking/ticketing system:</p> </li> <li>Mark eradication as completed.</li> <li>Note start of recovery activities.</li> <p>Operator Note: Use communication templates if available (e.g., IR status email templates).</p>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#step-5-conduct-transition-and-monitor","title":"Step 5: Conduct Transition and Monitor","text":"<ul> <li>Begin recovery actions per plan:</li> <li> <p>System restorations, re-imaging, rebuilding, user reactivation, etc.</p> </li> <li> <p>Monitor environment closely during recovery:</p> </li> <li>EDR/XDR alerts</li> <li>Network traffic</li> <li> <p>System and application logs</p> </li> <li> <p>Be prepared to pause or rollback if indicators of compromise reappear.</p> </li> </ul>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#running-script-windows-confirm-av-and-edr-ready-before-recovery","title":"Running Script (Windows - Confirm AV and EDR Ready Before Recovery)","text":"<pre><code>Get-MpComputerStatus\n</code></pre> <p>Operator Note: Ensure all systems entering recovery are fully monitored by EDR and AV.</p>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#dependencies","title":"Dependencies","text":"<ul> <li>Completion of eradication and validation activities</li> <li>Formal approval from IR Lead and System Owners</li> <li>Recovery plan and responsible teams identified</li> <li>Communication channels established</li> </ul>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Ticketing/ITSM (ServiceNow, Jira) Cross-platform Enterprise tool Document transition and approvals Collaboration Tools (Teams, Slack, Zoom) Cross-platform Enterprise tool Coordinate transition and recovery activities EDR/XDR (Crowdstrike, SentinelOne) Cross-platform Enterprise tool Monitor systems during recovery Email/Communications Templates Cross-platform N/A Notify stakeholders of transition to recovery <p>Operator Note: Use enterprise tooling to document and monitor all transition actions and communications.</p>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Confirm eradication validation complete and approved.</li> <li> Coordinate recovery plan with IR Lead, IT Ops, and system owners.</li> <li> Obtain formal approval to transition to recovery.</li> <li> Communicate transition to stakeholders.</li> <li> Begin recovery actions in controlled and monitored manner.</li> <li> Monitor systems for signs of issues during recovery.</li> <li> Document transition activities and approvals.</li> </ul>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#best-practices","title":"Best Practices","text":"<ul> <li>Do not rush \u2192 confirm eradication is truly complete.</li> <li>Engage system owners early and often.</li> <li>Prepare rollback plans in case recovery encounters issues.</li> <li>Retain all documentation for Lessons Learned phase.</li> </ul>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#references","title":"References","text":"<p>NIST SP 800-61 - Computer Security Incident Handling Guide US-CERT - Recovering from Cybersecurity Incidents</p>"},{"location":"4.Eradication/4.49_Coordinate_Transition_to_Recovery/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for coordinating eradication to recovery transition with detailed checklist Leo"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/","title":"4.50 Perform Handoff to Recovery Teams","text":""},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#task-perform-formal-handoff-of-remediation-and-restoration-activities-to-recovery-teams","title":"Task Perform Formal Handoff of Remediation and Restoration Activities to Recovery Teams","text":""},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#conditions","title":"Conditions","text":"<p>With eradication activities completed and transition approved, the operator will perform a structured handoff to recovery teams. This includes sharing key information about the incident, eradication steps, any residual risks, and recovery guidance to ensure smooth and secure restoration of normal operations.</p> <p>Operator Note: Poor handoff can lead to gaps in recovery and re-introduction of risks. Treat handoff as a critical milestone with required artifacts and approval steps.</p>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#standards","title":"Standards","text":"<ul> <li>Team member ensures all eradication actions and validation are documented and complete.</li> <li>Team member prepares and delivers a formal handoff package to recovery teams.</li> <li>Team member ensures recovery teams fully understand the eradication context and any caveats.</li> <li>Team member obtains confirmation from recovery team lead that handoff is accepted.</li> <li>Team member records handoff completion in incident tracking system.</li> </ul>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#end-state","title":"End State","text":"<p>All required eradication information, residual risk guidance, and recovery caveats have been handed off and accepted by recovery teams. Recovery activities begin with full situational awareness.</p>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#notes","title":"Notes","text":"<ul> <li>Handoff should be planned and scheduled as a formal event or meeting when possible.</li> <li>Recovery teams should include IT Operations, System Administrators, Application Owners, and IT Security.</li> <li>Retain handoff package and meeting records for after-action review and compliance.</li> </ul>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#step-1-prepare-handoff-package","title":"Step 1: Prepare Handoff Package","text":"<p>Create handoff documentation that includes:</p> <ul> <li>Incident Summary</li> <li>Timeline of incident</li> <li>Impacted systems</li> <li> <p>Root cause summary (if available)</p> </li> <li> <p>Eradication Summary</p> </li> <li>Actions taken to eradicate malicious artifacts</li> <li>Validation steps and results</li> <li> <p>Outstanding issues or risks</p> </li> <li> <p>Recovery Guidance</p> </li> <li>Systems ready for recovery</li> <li>Order of recovery (e.g., infrastructure \u2192 apps \u2192 users)</li> <li> <p>Special instructions (e.g., rebuild instead of restore)</p> </li> <li> <p>Residual Risks and Monitoring Requirements</p> </li> <li>What to watch for (possible indicators of reinfection)</li> <li>Monitoring plan (EDR, firewall, DNS, etc.)</li> <li>Rollback plan if issues occur during recovery</li> </ul> <p>Operator Note: Templates or handoff forms can be used to standardize this process.</p>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#step-2-schedule-and-conduct-handoff-briefing","title":"Step 2: Schedule and Conduct Handoff Briefing","text":"<ul> <li>Schedule recovery handoff meeting or coordination session.</li> <li>Participants should include:</li> <li>IR Lead</li> <li>Recovery Team Lead(s)</li> <li>IT Operations</li> <li>System/Business Owners</li> <li> <p>Cybersecurity monitoring team</p> </li> <li> <p>Walk through handoff package:</p> </li> <li>Confirm eradication completion</li> <li>Review recovery process and caveats</li> <li>Confirm monitoring requirements and escalation paths</li> </ul> <p>Operator Note: Virtual meetings with screen sharing and recording are recommended for audit trail.</p>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#step-3-deliver-artifacts-and-transition-documentation","title":"Step 3: Deliver Artifacts and Transition Documentation","text":"<p>Provide recovery teams with:</p> <ul> <li>Handoff document or briefing deck</li> <li>Validation reports (scans, task/service reviews, etc.)</li> <li>Artifact retention locations (malware samples, logs, etc.)</li> <li>Recovery instructions (systems approved to bring online, order of operations)</li> </ul> <p>Operator Note: Use enterprise collaboration platforms (SharePoint, Teams, secured shared drives) to store and share handoff packages securely.</p>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#step-4-obtain-acknowledgement-and-approval-to-proceed","title":"Step 4: Obtain Acknowledgement and Approval to Proceed","text":"<ul> <li>Ensure Recovery Team Lead formally accepts handoff:</li> <li>Verbal (recorded during meeting)</li> <li> <p>Written (email confirmation or ticket approval)</p> </li> <li> <p>Record acceptance and transition status in incident tracking system.</p> </li> </ul> <p>Operator Note: This approval serves as a control gate to officially exit eradication phase.</p>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#step-5-monitor-initial-recovery-actions-as-applicable","title":"Step 5: Monitor Initial Recovery Actions (as applicable)","text":"<ul> <li>Remain available as IR team POC during early recovery.</li> <li>Review first systems brought online for any issues.</li> <li>Escalate to IR Lead if re-infection or security issues arise.</li> </ul> <p>Operator Note: Recovery and IR remain linked until full business restoration and no new incidents are detected.</p>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#running-script-document-and-capture-validation-status","title":"Running Script (Document and Capture Validation Status)","text":"<pre><code>Get-Date | Out-File RecoveryHandoffLog.txt\nWrite-Output \"Eradication validation completed. Transition to recovery initiated.\" | Out-File -Append RecoveryHandoffLog.txt\n</code></pre> <p>Operator Note: Always record dates/times of phase changes in incident records.</p>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#dependencies","title":"Dependencies","text":"<ul> <li>Eradication and validation phase must be formally completed</li> <li>All system owners and recovery teams must be identified and ready</li> <li>Handoff package prepared and available</li> <li>IR Lead and Recovery Lead available for coordination</li> </ul>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Ticketing/ITSM (ServiceNow, Jira) Cross-platform Enterprise Record handoff, approvals, and completion SharePoint / Teams / Confluence Cross-platform Enterprise Share handoff package and recovery instructions Email + Calendar Cross-platform Built-in Schedule and confirm handoff Enterprise EDR/XDR platforms Cross-platform Enterprise Prepare for recovery monitoring <p>Operator Note: Where available, use existing ITSM and documentation platforms to integrate handoff processes.</p>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Prepare handoff package with incident, eradication, validation, and recovery info.</li> <li> Schedule handoff meeting and invite all recovery stakeholders.</li> <li> Walk through handoff package and confirm understanding.</li> <li> Deliver package and obtain formal handoff acceptance.</li> <li> Update IR records and transition incident phase.</li> <li> Support initial recovery actions as needed.</li> </ul>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#best-practices","title":"Best Practices","text":"<ul> <li>Use structured handoff templates or checklists to ensure nothing is missed.</li> <li>Confirm understanding during handoff meeting \u2192 ask for questions/concerns.</li> <li>Retain all artifacts and meeting records in incident archive.</li> <li>Coordinate closely with monitoring teams for early detection of any issues post-recovery.</li> </ul>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#references","title":"References","text":"<p>NIST SP 800-61 - Incident Response Coordination SANS Incident Response Process - Recovery and Lessons Learned</p>"},{"location":"4.Eradication/4.50_Perform_Handoff_to_Recovery/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for performing eradication-to-recovery handoff Leo"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/","title":"4.51 Perform Recovery Monitoring and Validation","text":""},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#task-conduct-active-monitoring-and-validation-during-and-after-recovery-to-ensure-threats-have-been-eradicated","title":"Task Conduct Active Monitoring and Validation During and After Recovery to Ensure Threats Have Been Eradicated","text":""},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#conditions","title":"Conditions","text":"<p>Once systems are being restored and users begin returning to normal operations, the operator will execute recovery monitoring and validation procedures to confirm there are no remaining threats or signs of compromise in the environment.</p> <p>Operator Note: Recovery is the period where risks remain high \u2192 attacker tools missed during eradication or latent persistence mechanisms may attempt to resume. Active monitoring during this phase is critical.</p>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#standards","title":"Standards","text":"<ul> <li>Team member establishes active monitoring for restored systems.</li> <li>Team member validates restored systems for security and performance baselines.</li> <li>Team member monitors network, endpoints, and enterprise resources for abnormal activity.</li> <li>Team member documents monitoring actions, observations, and any anomalies detected.</li> <li>Team member escalates immediately if indicators of compromise (IOCs) or suspicious behavior are observed.</li> </ul>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#end-state","title":"End State","text":"<p>Recovery period completes without detection of malicious activity, and validation demonstrates that systems and users have returned to normal, secure operations.</p>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#notes","title":"Notes","text":"<ul> <li>Monitoring and validation should continue through the initial weeks after recovery.</li> <li>Recovery validation includes performance, functionality, AND security verification.</li> <li>Any detected anomalies must be treated as potential indicators of ongoing compromise.</li> </ul>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#step-1-establish-monitoring-coverage","title":"Step 1: Establish Monitoring Coverage","text":""},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#ensure-all-restored-systems-are","title":"Ensure all restored systems are:","text":"<ul> <li>Online and enrolled in EDR/XDR solution</li> <li>Actively reporting telemetry (no gaps in coverage)</li> <li>Under antivirus and log collection coverage</li> </ul> <p>Operator Note: Any \"silent\" systems not reporting must be investigated immediately.</p>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#step-2-conduct-host-level-validation","title":"Step 2: Conduct Host-Level Validation","text":""},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#windowslinuxmacos","title":"Windows/Linux/macOS","text":"<ul> <li>Verify no unexpected processes running</li> <li>Verify no unauthorized startup entries or tasks</li> <li>Validate user accounts and permissions</li> </ul>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#tools","title":"Tools","text":"<ul> <li>EDR/XDR \u2192 Crowdstrike, SentinelOne, Defender ATP</li> <li>Sysinternals (Windows) \u2192 Process Explorer, Autoruns</li> <li>systemctl / launchctl (Linux/macOS) \u2192 Active service enumeration</li> </ul>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#step-3-conduct-network-level-monitoring","title":"Step 3: Conduct Network-Level Monitoring","text":"<ul> <li>Validate all restored hosts communicate only on expected ports and protocols.</li> <li>Detect unusual traffic patterns (C2, port scanning, brute forcing).</li> <li>Monitor DNS requests for suspicious domains.</li> </ul>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#tools_1","title":"Tools","text":"<ul> <li>Zeek (Security Onion) \u2192 Network flow analysis</li> <li>IDS/IPS \u2192 Snort, Suricata</li> <li>Firewall/Proxy Logs \u2192 Unexpected destinations or high volumes</li> </ul>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#step-4-conduct-user-and-enterprise-monitoring","title":"Step 4: Conduct User and Enterprise Monitoring","text":"<ul> <li>Confirm no abnormal user authentication or access attempts.</li> <li>Monitor email, file shares, and privileged accounts.</li> <li>Validate business processes resume securely.</li> </ul>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#tools_2","title":"Tools","text":"<ul> <li>SIEM \u2192 Splunk, Sentinel, ELK</li> <li>Email Security Gateway \u2192 Proofpoint, M365 Defender</li> <li>AD Logs \u2192 Authentication and authorization monitoring</li> </ul>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#step-5-validate-system-performance-and-stability","title":"Step 5: Validate System Performance and Stability","text":"<ul> <li>Verify systems run without performance degradation (possible malware or crypto mining remnants).</li> <li>Validate system/app logs show no errors related to recovery process.</li> <li>Confirm backups resume as normal and are not impacted.</li> </ul> <p>Operator Note: Some malware reactivates after restart \u2014 post-recovery performance issues can be an IOC.</p>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#step-6-document-findings-and-validate-completion","title":"Step 6: Document Findings and Validate Completion","text":"<ul> <li>Record monitoring coverage, checks performed, and validation results.</li> <li>If no malicious activity is detected after monitoring period (typically 1-2 weeks post recovery), document and mark recovery validation as complete.</li> </ul> <p>Operator Note: Always retain recovery monitoring documentation as part of incident record for Lessons Learned.</p>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#running-script-windows-verify-edr-and-av-status","title":"Running Script (Windows - Verify EDR and AV Status)","text":"<pre><code>Get-MpComputerStatus\n</code></pre>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#linuxmacos-check-running-services","title":"Linux/macOS (Check Running Services)","text":"<pre><code>ps aux\nsystemctl list-units --type=service\n</code></pre>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#network-zeek-check-connections","title":"Network (Zeek - Check Connections)","text":"<pre><code>cat conn.log | grep -v \"normal_ports\"\n</code></pre>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#dependencies","title":"Dependencies","text":"<ul> <li>Full enrollment of recovered systems into security monitoring (EDR/AV/SIEM)</li> <li>Coordination with system owners and IT ops</li> <li>Predefined IOC watchlists from IR team</li> <li>On-call IR and security staff for escalation</li> </ul>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage EDR/XDR Platforms (Crowdstrike, SentinelOne, Defender ATP) Cross-platform Enterprise deployment Endpoint and host monitoring SIEM (Splunk, Sentinel, ELK) Cross-platform Enterprise deployment Correlate enterprise security events Security Onion (Zeek, Suricata) Network Sensor deployment Network traffic analysis Sysinternals (Process Explorer, Autoruns) Windows Download Validate host process integrity and startup persistence <p>Operator Note: Automated and manual validation combined gives the best coverage.</p>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Confirm all restored systems are enrolled in security monitoring.</li> <li> Validate hosts for clean running state and performance.</li> <li> Monitor network activity for anomalies.</li> <li> Monitor enterprise authentication and privileged accounts.</li> <li> Document validation activities and monitoring coverage.</li> <li> Escalate any suspicious detections immediately.</li> <li> Finalize recovery validation after monitoring period concludes.</li> </ul>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#best-practices","title":"Best Practices","text":"<ul> <li>Start monitoring immediately \u2192 do not wait for users to return.</li> <li>Monitor for at least 1-2 weeks post-recovery for latent threats.</li> <li>Correlate across host, network, and user activity for anomaly detection.</li> <li>Retain all records for compliance and post-incident review.</li> </ul>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#references","title":"References","text":"<p>Security Onion - Network Security Monitoring MITRE ATT&amp;CK - Persistence Sysinternals Suite</p>"},{"location":"4.Eradication/4.51_Perform_Recovery_Monitoring_Validation/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for recovery monitoring and validation with technical procedures and checklist Leo"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/","title":"4.52 Finalize Eradication Documentation and Reporting","text":""},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#task-document-all-eradication-activities-and-validate-final-reporting-for-handoff-and-retention","title":"Task Document All Eradication Activities and Validate Final Reporting for Handoff and Retention","text":""},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#conditions","title":"Conditions","text":"<p>After eradication and recovery monitoring have been completed and validated, the operator and IR team will finalize all eradication-related documentation. This serves as the official record of eradication actions, validates clean state of systems, and provides inputs for post-incident reporting and lessons learned.</p> <p>Operator Note: Eradication documentation ensures traceability, enables post-incident analysis, and supports audits and regulatory compliance. Every step taken during eradication should be captured clearly and accurately.</p>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#standards","title":"Standards","text":"<ul> <li>Team member collects and consolidates all eradication action logs, records, and outputs.</li> <li>Team member completes eradication summary documentation for each impacted system.</li> <li>Team member records all findings, residual risks, and validations performed.</li> <li>Team member prepares and submits eradication completion report to Incident Response Lead.</li> <li>Team member ensures records are stored securely and made available for after-action review.</li> </ul>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#end-state","title":"End State","text":"<p>A complete eradication report package is created, reviewed, and submitted for retention. This package includes records of all actions, validation outcomes, and supporting evidence.</p>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#notes","title":"Notes","text":"<ul> <li>Eradication documentation should link to original source records (e.g., AV scan results, system inventories, validation logs).</li> <li>Reports may be reviewed months later \u2192 clear, detailed language should be used.</li> <li>Coordination with recovery and enterprise teams ensures completeness.</li> </ul>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#step-1-gather-eradication-records-and-evidence","title":"Step 1: Gather Eradication Records and Evidence","text":"<p>Records to collect:</p> <ul> <li>Task, script, and action logs (e.g., scheduled task removals, user account deletions)</li> <li>Scan results (AV, persistence checks, EDR scans)</li> <li>Network logs (confirmation of no beaconing or malicious activity)</li> <li>System validation results (recovery readiness validation)</li> <li>Operator notes and IR coordination records</li> </ul> <p>Operator Note: Use incident ticketing systems, centralized IR drives, and SIEM exports to collect source records.</p>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#step-2-prepare-eradication-summary-report","title":"Step 2: Prepare Eradication Summary Report","text":""},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#report-sections","title":"Report Sections","text":"<ul> <li>Incident Overview</li> <li>Timeline</li> <li>Affected systems</li> <li> <p>Root cause summary (if determined)</p> </li> <li> <p>Eradication Actions</p> </li> <li>Steps taken to remove attacker access and artifacts</li> <li>Tools and commands/scripts used</li> <li> <p>Operator responsible for actions</p> </li> <li> <p>Validation Summary</p> </li> <li>How clean state was confirmed</li> <li> <p>Any residual risks or deferred remediation actions</p> </li> <li> <p>Transition to Recovery</p> </li> <li>Recovery approval</li> <li> <p>Recovery activities started</p> </li> <li> <p>Supporting Evidence</p> </li> <li>Links to or attachments of key artifacts</li> </ul> <p>Operator Note: Use standardized templates if available for consistency.</p>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#step-3-review-and-approve-documentation","title":"Step 3: Review and Approve Documentation","text":"<ul> <li>Review eradication report internally (IR lead + operators)</li> <li>Validate completeness and clarity</li> <li>Approve for submission and archiving</li> </ul> <p>Operator Note: IR Lead is responsible for final approval of eradication documentation.</p>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#step-4-submit-and-archive-documentation","title":"Step 4: Submit and Archive Documentation","text":"<ul> <li>Submit final eradication report to:</li> <li>Incident Manager / Crisis Management Team</li> <li>Cybersecurity leadership</li> <li> <p>Compliance (if regulatory incident)</p> </li> <li> <p>Archive eradication records securely:</p> </li> <li>Incident Response SharePoint or Document Management System</li> <li>Long-term retention repository</li> </ul> <p>Operator Note: Follow organization policy for document retention (typically 1-3 years minimum for security incidents).</p>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#step-5-prepare-for-lessons-learned-phase","title":"Step 5: Prepare for Lessons Learned Phase","text":"<ul> <li>Tag documentation for handoff to Lessons Learned team (if separate)</li> <li>Include open items or recommendations for future improvements</li> </ul> <p>Operator Note: All eradication gaps or challenges should be flagged for discussion in After Action Review.</p>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#running-script-example-record-cleanup-validation-to-file","title":"Running Script (Example - Record Cleanup Validation to File)","text":"<pre><code>Get-Date | Out-File EradicationCompletion.txt\nWrite-Output \"Eradication activities completed and validated. No remaining attacker artifacts found.\" | Out-File -Append EradicationCompletion.txt\n</code></pre>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#dependencies","title":"Dependencies","text":"<ul> <li>Completed eradication and recovery monitoring phases</li> <li>Full set of logs and records from eradication phase</li> <li>IR lead available for review and approval</li> </ul>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage ITSM / Incident Tracking (ServiceNow, Jira) Cross-platform Enterprise tool Link and record eradication actions SharePoint / Confluence Cross-platform Enterprise tool Archive eradication report SIEM (Splunk, Sentinel, ELK) Cross-platform Enterprise tool Export supporting log evidence Word / PDF Templates Cross-platform Standard Office tools Generate eradication report documents <p>Operator Note: Use enterprise-standard formats for reporting (Word, PDF) for ease of distribution and review.</p>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Collect all eradication actions and validation evidence.</li> <li> Prepare standardized eradication summary report.</li> <li> Review report internally and obtain IR lead approval.</li> <li> Submit and archive eradication report package.</li> <li> Prepare report and artifacts for Lessons Learned handoff.</li> </ul>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#best-practices","title":"Best Practices","text":"<ul> <li>Provide concise but detailed narrative in eradication summary.</li> <li>Include evidence to support each eradication claim.</li> <li>Clearly document any residual risks or deferred actions.</li> <li>Retain eradication report and supporting records for audit and future incidents.</li> </ul>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#references","title":"References","text":"<p>NIST SP 800-61 - Incident Handling Reporting SANS Post-Incident Reporting</p>"},{"location":"4.Eradication/4.52_Finalize_Eradication_Documentation_Reporting/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Fully generated operator guide for eradication documentation and reporting Leo"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/","title":"4.53 Evaluate Physical Security and Physical Access","text":""},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#task","title":"Task","text":"<p>Assess the physical security posture of the environment to identify unauthorized physical access risks, vulnerabilities in physical controls, and signs of potential compromise through physical means.</p>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#conditions","title":"Conditions","text":"<p>Given access to the physical premises, coordination with building security and IT staff, and knowledge of organizational physical security policy.</p>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#standards","title":"Standards","text":"<ul> <li>Perform a thorough physical security review of all critical IT infrastructure and workspaces.</li> <li>Identify unauthorized access points, weak physical security controls, and potential indicators of physical tampering or compromise.</li> <li>Validate controls are in place and working (locks, cameras, badge systems).</li> <li>Document and report all deficiencies or anomalies to site owners.</li> </ul>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#end-state","title":"End State","text":"<p>All physical security risks are identified, documented, and escalated. Unauthorized access risks are mitigated or removed.</p>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#notes","title":"Notes","text":"<ul> <li>Physical security failures can allow attackers to bypass all technical controls.</li> <li>Physical plant vulnerabilities (wiring closets, server rooms) are priority targets.</li> <li>Insider threats often exploit poor physical access controls.</li> </ul>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#step-1-review-access-control-mechanisms","title":"Step 1: Review Access Control Mechanisms","text":""},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#areas-to-check","title":"Areas to check:","text":"Location What to Look For Exterior Doors Secure locks, badge readers, alarms Reception Area Visitor check-in process Data Centers / Server Rooms Electronic locks, CCTV coverage, restricted badge access Wiring Closets Locked doors, no piggybacking Work Areas Workstations unattended, no passwords/screensavers active <p>Operator Note: Review badge access lists to ensure only authorized personnel have access.</p>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#step-2-validate-monitoring-and-surveillance-systems","title":"Step 2: Validate Monitoring and Surveillance Systems","text":""},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#review","title":"Review:","text":"<ul> <li>CCTV camera locations \u2192 ensure coverage of critical areas (entrances, server rooms).</li> <li>Retention of footage \u2192 minimum 30 days recommended.</li> <li>Motion detectors or intrusion alarms \u2192 confirm operational.</li> </ul> <p>Operator Note: If footage cannot be reviewed or is unavailable \u2192 log as critical deficiency.</p>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#step-3-conduct-physical-walkthrough-and-inspection","title":"Step 3: Conduct Physical Walkthrough and Inspection","text":""},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#observe","title":"Observe:","text":"<ul> <li>Tailgating and unauthorized access \u2192 follow behind someone entering.</li> <li>Unlocked doors to critical areas \u2192 wiring closets, MDF/IDF rooms, network cabinets.</li> <li>Unattended or abandoned equipment.</li> <li>Unusual or unauthorized hardware:</li> <li>USB drops</li> <li>Rogue Wi-Fi APs</li> <li>Laptops/Raspberry Pis plugged into switch ports</li> </ul> <p>Operator Note: Use combination of visual inspection and local network scans to detect rogue devices.</p>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#step-4-review-access-logs-and-visitor-records","title":"Step 4: Review Access Logs and Visitor Records","text":""},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#collect","title":"Collect:","text":"<ul> <li>Badge reader logs \u2192 identify unauthorized or suspicious entries.</li> <li>Visitor sign-in sheets \u2192 validate against badge access.</li> <li>Staff rosters \u2192 verify individuals were authorized to be onsite.</li> </ul> <p>Operator Note: Look for access outside of normal business hours or into restricted areas.</p>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#step-5-interview-or-coordinate-with-facility-staff","title":"Step 5: Interview or Coordinate with Facility Staff","text":"<ul> <li>Ask about recent visitors, contractors, or vendors.</li> <li>Verify cleaning crew and maintenance staff access restrictions.</li> <li>Validate procedures for lost or deactivated badges.</li> </ul> <p>Operator Note: Cleaning and maintenance staff often overlooked \u2192 insider risk.</p>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#step-6-identify-and-report-deficiencies","title":"Step 6: Identify and Report Deficiencies","text":"<p>Example issues to flag:</p> Deficiency Example Unlocked wiring closet Open door in hallway with access to network switch No camera coverage Blind spots near server racks Unlogged visitor Delivery contractor with no sign-in Abandoned USB drive Possible malicious device left intentionally <p>Operator Note: Work with site security to immediately secure critical deficiencies.</p>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#dependencies","title":"Dependencies","text":"<ul> <li>Onsite access or facility escort</li> <li>Cooperation with physical security or building management</li> <li>Facility maps and access policies</li> </ul>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Security Cameras / DVR Physical Site managed Video review Badge Reader Logs Physical Site managed Access audit Netspot / WiFi Explorer Windows/macOS Passive wireless scan Detect rogue APs Mobile phone / laptop Cross-platform On person Detect open ports/APs, visual inspection"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Obtain access and perform walk-through of all critical areas.</li> <li> Validate locks, badge readers, alarms, and CCTV systems are operational.</li> <li> Review and correlate access control and visitor logs.</li> <li> Identify unauthorized access methods or weaknesses.</li> <li> Physically locate and assess any unauthorized devices.</li> <li> Document all findings and coordinate remediation.</li> </ul>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#best-practices","title":"Best Practices","text":"<ul> <li>Look for social engineering attempts (tailgating, friendly visitors).</li> <li>Challenge unknown individuals politely but firmly.</li> <li>Perform sweeps at multiple times of day (peak vs off hours).</li> <li>Collaborate with facility staff \u2192 they often notice odd patterns.</li> </ul>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#references","title":"References","text":"<ul> <li>NIST SP 800-53 PE Family (Physical and Environmental Protection)</li> <li>CISA Physical Security Measures</li> <li>OSHA Facility Security Guidelines</li> </ul>"},{"location":"4.Eradication/4.53_Evaluate_Physical_Security_Access/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with deep operator-focused physical security evaluation process Leo"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/","title":"4.09.9 Verify Wireless Security","text":""},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#task","title":"Task","text":"<p>Verify that authorized wireless access points (APs) and wireless network configurations adhere to security best practices to prevent unauthorized access, eavesdropping, and rogue device connections.</p>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#conditions","title":"Conditions","text":"<p>Given access to wireless networks, wireless access point controllers or management consoles, and wireless scanning tools.</p>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#standards","title":"Standards","text":"<ul> <li>Identify and document all authorized wireless SSIDs and APs.</li> <li>Validate that wireless networks are secured using proper encryption and authentication.</li> <li>Detect and document misconfigured or weak wireless security settings.</li> <li>Recommend and/or implement corrective actions where necessary.</li> </ul>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#end-state","title":"End State","text":"<p>Wireless networks are verified as secure, unauthorized or weakly secured wireless networks are identified, and corrective actions are tracked.</p>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#notes","title":"Notes","text":"<ul> <li>Weak wireless security creates entry points for attackers bypassing perimeter defenses.</li> <li>Wireless security reviews should include validation of both configuration and live wireless spectrum analysis.</li> <li>Configuration review and passive detection should be conducted together for accuracy.</li> </ul>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#step-1-inventory-authorized-wireless-networks-and-access-points","title":"Step 1: Inventory Authorized Wireless Networks and Access Points","text":"<ul> <li>Obtain a list of all authorized SSIDs and their security configurations (from Wireless LAN Controller (WLC) or AP management system).</li> <li>Document:</li> <li>SSID names</li> <li>Encryption type (WPA2, WPA3, Open, WEP)</li> <li>Authentication method (Pre-shared key (PSK), 802.1X/EAP)</li> <li>VLAN or network segmentation</li> <li>AP MAC addresses and locations</li> </ul> <p>Example:</p> SSID Encryption Auth Type VLAN Notes CorporateWiFi WPA3 802.1X VLAN 10 Corporate devices only GuestWiFi WPA2 PSK VLAN 20 Internet-only, segregated <p>Operator Note: SSIDs using Open or WEP encryption are HIGH RISK \u2192 flag immediately.</p>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#step-2-perform-passive-wireless-scan-for-active-wireless-networks","title":"Step 2: Perform Passive Wireless Scan for Active Wireless Networks","text":""},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#recommended-tools","title":"Recommended Tools:","text":"Tool Platform Usage Kismet Linux Passive wireless detection WiFi Explorer macOS GUI visualization Airodump-ng Linux CLI-based scanning"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#example-airodump-ng","title":"Example (Airodump-ng):","text":"<pre><code>sudo airodump-ng wlan0\n</code></pre> <p>Review discovered networks:</p> <ul> <li>Compare SSIDs and BSSIDs (MAC addresses) to authorized list.</li> <li>Identify unknown SSIDs or unauthorized APs.</li> <li>Note encryption type \u2192 open or weak encryption should be flagged.</li> </ul> <p>Operator Note: Look for duplicate SSIDs \u2192 possible Evil Twin attacks.</p>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#step-3-validate-encryption-and-authentication-settings","title":"Step 3: Validate Encryption and Authentication Settings","text":""},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#wireless-controller-ap-management-console","title":"Wireless Controller / AP Management Console","text":"<ul> <li>Log into wireless controller or AP management console.</li> <li>Validate SSID security settings:</li> </ul> Setting What to Verify Encryption WPA2 or WPA3 \u2192 avoid WEP/Open Authentication Use 802.1X for enterprise or PSK for guest MAC Filtering (optional) Enforced where applicable SSID Broadcast Hidden SSIDs do NOT equal secure \u2192 ensure proper controls in place <p>Operator Note: Guest networks MUST be segmented (different VLAN, no LAN access).</p>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#step-4-detect-and-investigate-rogue-clients-and-unusual-activity","title":"Step 4: Detect and Investigate Rogue Clients and Unusual Activity","text":"<ul> <li>Use Kismet or WLC to detect clients connected to APs.</li> <li>Investigate:</li> </ul> Suspicious Activity Action Unauthorized client connected to corporate SSID Validate device ownership and MAC address High number of deauthentication packets Possible wireless attack (deauth/Evil Twin) Unusual MAC vendors (ex: virtualized MAC addresses) Flag for investigation <p>Operator Note: If using WPA2 Enterprise, validate only managed devices can connect.</p>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#step-5-review-rf-spectrum-for-unusual-signals-optional-but-recommended","title":"Step 5: Review RF Spectrum for Unusual Signals (Optional but Recommended)","text":""},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#tools","title":"Tools:","text":"Tool Platform Usage Wi-Spy / Chanalyzer Windows/macOS RF analysis Kismet + SDR Linux RF signal detection <ul> <li>Look for unusual signals in 2.\u2158/6 GHz bands \u2192 could indicate rogue APs or unauthorized Wi-Fi devices.</li> </ul> <p>Operator Note: Rogue APs may not broadcast SSIDs \u2192 RF detection helps find hidden threats.</p>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#step-6-remediate-or-escalate-issues","title":"Step 6: Remediate or Escalate Issues","text":"<p>For any weaknesses or issues found:</p> Issue Action Open/WEP networks Migrate to WPA2/WPA3 immediately Rogue AP detected Coordinate with network owners for removal Unsegmented guest networks Implement VLAN separation Unauthorized clients Investigate and block if malicious <p>Operator Note: Always document proposed fixes and work through network owners or administrators.</p>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#dependencies","title":"Dependencies","text":"<ul> <li>Wireless NIC in monitor mode</li> <li>Access to Wireless LAN Controller / AP Management</li> <li>Physical access or remote view of wireless spectrum</li> </ul>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Kismet Linux Package manager Passive wireless scanning Airodump-ng Linux Aircrack-ng suite Passive wireless scanning WiFi Explorer macOS GUI visualization Wireless LAN Controller Web/Appliance Native Configuration validation"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Obtain and document authorized SSIDs and AP configurations.</li> <li> Passively scan wireless environment for all active networks.</li> <li> Compare findings to authorized list \u2192 identify unknown/unauthorized SSIDs.</li> <li> Validate encryption and authentication settings for each SSID.</li> <li> Detect and review rogue clients and unusual wireless activity.</li> <li> Recommend remediation for weak configurations or detected issues.</li> <li> Document findings and update network security plan.</li> </ul>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#best-practices","title":"Best Practices","text":"<ul> <li>Always prefer WPA3 or WPA2-Enterprise with 802.1X where possible.</li> <li>Isolate guest networks from internal systems.</li> <li>Regularly audit wireless configurations and spectrum for new threats.</li> <li>Disable unused SSIDs and hidden SSIDs unless operationally required.</li> </ul>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#references","title":"References","text":"<ul> <li>Wi-Fi Alliance Security Best Practices</li> <li>Kismet Wireless</li> <li>Cisco Secure Wireless Architecture Guide</li> </ul>"},{"location":"4.Eradication/4.54_Verify_Wireless_Security/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with detailed operator-focused wireless security validation process Leo"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/","title":"4.55 Verify Network Segmentation and ACLs","text":""},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#task","title":"Task","text":"<p>Verify network segmentation and access control lists (ACLs) are properly configured to restrict unauthorized lateral movement, enforce network boundaries, and align with security policies.</p>"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#conditions","title":"Conditions","text":"<p>Given access to network diagrams, VLAN configurations, router/switch/firewall ACLs, and the ability to perform active network validation testing.</p>"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#standards","title":"Standards","text":"<ul> <li>Review logical network segmentation (VLANs, subnets).</li> <li>Review ACLs on routers, switches, and firewalls for proper traffic restrictions.</li> <li>Perform active validation tests to confirm isolation and enforcement.</li> <li>Document and report any gaps or weaknesses.</li> </ul>"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#end-state","title":"End State","text":"<p>Network segmentation and ACL configurations are validated. Unauthorized communication pathways are identified, and corrective actions are tracked.</p>"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#notes","title":"Notes","text":"<ul> <li>Flat or poorly segmented networks increase risk of lateral movement during incidents.</li> <li>ACL misconfigurations are common and often provide attackers unintended access.</li> <li>Validation requires both configuration review and live traffic testing.</li> </ul>"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#step-1-review-network-segmentation-design","title":"Step 1: Review Network Segmentation Design","text":"<ul> <li>Obtain and review network diagrams and VLAN/subnet documentation.</li> <li>Identify:</li> <li>Mission-critical network segments (e.g., servers, domain controllers).</li> <li>User workstations and guest networks.</li> <li>External access zones (DMZ).</li> <li>Management networks (IPMI/iLO, switches, APs).</li> </ul> <p>Operator Note: Critical and sensitive systems should never be on the same VLAN as user workstations or guest users.</p>"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#step-2-review-vlan-and-subnet-configurations","title":"Step 2: Review VLAN and Subnet Configurations","text":""},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#switches-vlan-config","title":"Switches / VLAN Config","text":"<ul> <li>Review VLAN assignment and trunking on switches:</li> </ul> <p>Example Cisco:</p> <pre><code>show vlan brief\nshow interfaces trunk\n</code></pre> <p>Look for:</p> <ul> <li>VLANs with too many mixed roles (e.g., workstations + servers).</li> <li>Native VLAN usage \u2192 should not carry sensitive traffic.</li> <li>Unused ports assigned to \"black hole\" VLAN (best practice).</li> </ul> <p>Operator Note: VLAN hopping is a real risk \u2192 avoid poorly assigned or default VLANs.</p>"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#step-3-review-router-switch-and-firewall-acls","title":"Step 3: Review Router, Switch, and Firewall ACLs","text":""},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#example-review","title":"Example review:","text":"Device Command What to look for Cisco Router <code>show access-lists</code> Permissive \"permit any any\" rules Cisco Switch (SVI ACLs) <code>show ip access-lists</code> Incomplete or missing ACLs Firewalls Web/CLI Overly broad or \"allow all\" rules <p>Validate:</p> <ul> <li>Segments are only allowed access as required (e.g., workstation VLAN \u2192 DNS, not SMB or RDP).</li> <li>Management interfaces (switches, routers, servers) are not exposed to all VLANs.</li> <li>Guest networks have no access to internal segments.</li> </ul> <p>Operator Note: \"Permit any\" or large CIDR \"permit\" ranges \u2192 red flag for misconfiguration.</p>"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#step-4-perform-active-network-validation-testing","title":"Step 4: Perform Active Network Validation Testing","text":""},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#recommended-tools","title":"Recommended Tools:","text":"Tool Platform Usage Nmap Cross-platform Scan from source VLAN to destination VLAN Netcat Cross-platform Port testing Hping3 Linux Advanced packet crafting (optional)"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#example-nmap-validation","title":"Example Nmap Validation:","text":"<pre><code>nmap -Pn -p 22,135,3389 192.168.100.0/24\n</code></pre> <p>From user VLAN \u2192 ensure you CANNOT reach sensitive ports (RDP, SMB) on server VLAN.</p> <p>Example Netcat quick test:</p> <pre><code>nc -vz 192.168.100.10 3389\n</code></pre> <p>Operator Note: Tests should be performed from representative VLANs \u2192 user \u2192 server, guest \u2192 internal, etc.</p>"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#step-5-investigate-and-escalate-findings","title":"Step 5: Investigate and Escalate Findings","text":"Issue Found Recommended Action Flat network (no segmentation) Recommend VLAN implementation Missing ACLs or overly permissive rules Work with network admins to implement controls Guest or public networks can access internal systems Block guest VLAN from internal ranges Unused switch ports active Shutdown or assign to unused VLAN <p>Operator Note: Engage network owners and administrators before making changes \u2192 change control procedures apply.</p>"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#dependencies","title":"Dependencies","text":"<ul> <li>Access to network diagrams and configuration files</li> <li>Access to switches, routers, and firewall configuration interfaces</li> <li>Ability to run network scans and connectivity tests</li> </ul>"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Nmap Cross-platform Package manager Network connectivity scans Netcat Cross-platform Built-in or package manager Port scanning and testing Switch CLI (Cisco/Aruba/etc.) CLI Native VLAN and ACL validation Firewall GUI / CLI Network device Native Review ACL and rule sets"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Obtain network diagrams and authorized segmentation scheme.</li> <li> Review VLAN configurations for proper segmentation.</li> <li> Review router, switch, and firewall ACLs.</li> <li> Perform active validation from VLAN to VLAN and guest networks.</li> <li> Identify unauthorized access paths or weak rules.</li> <li> Document and recommend corrective actions.</li> </ul>"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#best-practices","title":"Best Practices","text":"<ul> <li>Avoid \"permit any any\" rules \u2192 use least privilege principle.</li> <li>Isolate critical infrastructure \u2192 servers, management interfaces.</li> <li>Guest networks \u2192 no internal access.</li> <li>Monitor VLAN-to-VLAN traffic \u2192 validate ACLs are enforced.</li> </ul>"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#references","title":"References","text":"<ul> <li>Cisco Security Best Practices</li> <li>NIST 800-41 Rev 1 - Guidelines on Firewalls and Firewall Policy</li> <li>Nmap Network Scanning Guide</li> </ul>"},{"location":"4.Eradication/4.55_Verify_Network_Segmentation/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with detailed operator-focused network segmentation and ACL validation process Leo"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/","title":"4.56 Remove Unauthorized Users (Local/AD/Cloud)","text":""},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#task","title":"Task","text":"<p>Identify and remove unauthorized or suspicious user accounts across local systems, Active Directory (AD), and Cloud Identity Providers (Azure AD, AWS IAM, Google Workspace).</p>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#conditions","title":"Conditions","text":"<p>Given access to local systems, enterprise identity directories, and cloud tenant management interfaces.</p>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#standards","title":"Standards","text":"<ul> <li>Identify all accounts and validate against authorized user lists.</li> <li>Detect unauthorized, dormant, or suspicious accounts.</li> <li>Remove or disable unauthorized accounts.</li> <li>Validate removal and document actions taken.</li> </ul>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#end-state","title":"End State","text":"<p>All unauthorized user accounts are identified, removed, and documented across local, enterprise, and cloud environments.</p>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#notes","title":"Notes","text":"<ul> <li>User accounts are a primary attack vector for persistence and privilege escalation.</li> <li>Dormant and unauthorized accounts should be treated as serious threats.</li> <li>Proper coordination with HR, IT, and system owners is required before removal.</li> </ul>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#step-1-identify-all-active-user-accounts","title":"Step 1: Identify All Active User Accounts","text":""},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#local-accounts-windows","title":"Local Accounts (Windows)","text":"<pre><code>Get-LocalUser\n</code></pre> <p>Look for:</p> <ul> <li>Disabled = False</li> <li>LastLogonDate = stale or never</li> </ul>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#local-accounts-linuxmacos","title":"Local Accounts (Linux/macOS)","text":"<pre><code>cat /etc/passwd\n</code></pre> <p>Look for users with UID &gt;= 1000 (normal users).</p> <pre><code>lastlog\n</code></pre> <p>Look for users that have never logged in or have not logged in for long periods.</p>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#active-directory-windows-server","title":"Active Directory (Windows Server)","text":"<pre><code>Get-ADUser -Filter * -Properties LastLogonDate | Select-Object Name, Enabled, LastLogonDate\n</code></pre> <p>Look for:</p> <ul> <li>Enabled = True</li> <li>LastLogonDate = Never or stale</li> </ul>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#azure-ad-microsoft-365-cloud","title":"Azure AD (Microsoft 365 Cloud)","text":"<pre><code>Connect-AzureAD\nGet-AzureADUser -All $true | Select-Object DisplayName, UserPrincipalName, AccountEnabled\n</code></pre> <p>Look for:</p> <ul> <li>AccountEnabled = True</li> <li>UsageLocation / Last Login missing or stale</li> </ul>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#aws-iam-cloud","title":"AWS IAM (Cloud)","text":"<pre><code>aws iam list-users\naws iam get-user --user-name &lt;username&gt;\n</code></pre> <p>Look for:</p> <ul> <li>Users with no usage/activity</li> <li>Users with Console login enabled but no login history</li> </ul> <p>Operator Note: AWS IAM \u2192 <code>lastUsed</code> attribute can indicate if dormant.</p>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#google-workspace-cloud","title":"Google Workspace (Cloud)","text":"<p>Admin Console \u2192 Directory \u2192 Users \u2192 Filter by login activity</p> <p>Look for:</p> <ul> <li>Never logged in</li> <li>Last login over 90 days</li> </ul> <p>Operator Note: Dormant accounts should be reviewed with account owners.</p>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#step-2-validate-account-authorization","title":"Step 2: Validate Account Authorization","text":"<ul> <li>Cross-check users with authorized user list / HR roster.</li> <li>Check temporary / service accounts \u2192 validate ownership.</li> <li>Check accounts with elevated privileges \u2192 verify authorization.</li> </ul> <p>Operator Note: Accounts created outside of normal onboarding process are HIGH RISK.</p>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#step-3-disable-or-remove-unauthorized-accounts","title":"Step 3: Disable or Remove Unauthorized Accounts","text":""},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#local-users-windows","title":"Local Users (Windows)","text":"<pre><code>Disable-LocalUser -Name \"username\"\nRemove-LocalUser -Name \"username\"\n</code></pre>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#local-users-linuxmacos","title":"Local Users (Linux/macOS)","text":"<pre><code>sudo usermod -L username\nsudo userdel username\n</code></pre>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#active-directory","title":"Active Directory","text":"<pre><code>Disable-ADAccount -Identity \"username\"\nRemove-ADUser -Identity \"username\"\n</code></pre>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#azure-ad","title":"Azure AD","text":"<pre><code>Set-AzureADUser -ObjectId &lt;UserId&gt; -AccountEnabled $false\nRemove-AzureADUser -ObjectId &lt;UserId&gt;\n</code></pre>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#aws-iam","title":"AWS IAM","text":"<pre><code>aws iam delete-user --user-name &lt;username&gt;\n</code></pre>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#google-workspace","title":"Google Workspace","text":"<ul> <li>Admin Console \u2192 Directory \u2192 Users \u2192 Select User \u2192 Suspend or Delete</li> </ul> <p>Operator Note: Suspend (disable) first unless immediate removal is required \u2192 preserves data for audit.</p>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#step-4-validate-removal-and-audit","title":"Step 4: Validate Removal and Audit","text":"<ul> <li>Re-run account queries \u2192 confirm removal.</li> <li>Check audit logs \u2192 validate action was recorded.</li> <li>Document justification, method, and responsible approver.</li> </ul>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#dependencies","title":"Dependencies","text":"<ul> <li>Access to local systems, AD, cloud consoles</li> <li>Approved list of authorized users</li> <li>Coordination with HR and IT security</li> </ul>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage PowerShell AD Modules Windows Built-in / RSAT AD queries and management AWS CLI Cross-platform Package manager IAM management AzureAD Module PowerShell Install-Module Azure AD management Google Admin Console Web N/A Google Workspace user management"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Obtain authorized user lists for local, AD, and cloud environments.</li> <li> Collect all active user accounts across local, AD, Azure AD, AWS IAM, Google Workspace.</li> <li> Compare against authorized list \u2192 identify unauthorized or suspicious users.</li> <li> Validate elevated privilege accounts \u2192 confirm need and authorization.</li> <li> Disable or remove unauthorized accounts.</li> <li> Validate removal and log actions.</li> <li> Document all actions taken and coordinate with system owners.</li> </ul>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#best-practices","title":"Best Practices","text":"<ul> <li>Disable accounts first before deletion to prevent unintended impact.</li> <li>Review service accounts carefully \u2192 validate ownership and justification.</li> <li>Implement alerting for new accounts created outside of normal processes.</li> <li>Establish periodic review cadence for cloud and AD environments.</li> </ul>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#references","title":"References","text":"<ul> <li>Microsoft Active Directory User Management</li> <li>Azure AD User Management</li> <li>AWS IAM User Management</li> <li>Google Workspace User Management</li> </ul>"},{"location":"4.Eradication/4.56_Remove_Unauthorized_Users_AD_Cloud/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with deep operator guidance and multi-platform examples Leo"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/","title":"4.57 Remove Unauthorized Devices (Local, AD, Cloud Registered)","text":""},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#task","title":"Task","text":"<p>Identify and remove unauthorized, stale, or suspicious devices across local systems, Active Directory (AD), and Cloud Registered environments (Azure AD, Intune, AWS, Google Workspace).</p>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#conditions","title":"Conditions","text":"<p>Given access to local system inventories, Active Directory, and cloud platform management consoles.</p>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#standards","title":"Standards","text":"<ul> <li>Discover all registered and connected devices across environments.</li> <li>Validate devices against authorized inventory.</li> <li>Detect unauthorized, stale, or suspicious devices.</li> <li>Remove or disable unauthorized devices following policy and with owner coordination.</li> </ul>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#end-state","title":"End State","text":"<p>All unauthorized devices are identified, removed, and documented across local, enterprise, and cloud environments.</p>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#notes","title":"Notes","text":"<ul> <li>Unauthorized or unmanaged devices are high risk for compromise and lateral movement.</li> <li>Removal or disablement should follow local policy and include validation to avoid impact.</li> <li>Cloud-registered devices may remain persistent even after network removal \u2192 must be explicitly removed.</li> </ul>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#step-1-identify-all-active-and-registered-devices","title":"Step 1: Identify All Active and Registered Devices","text":""},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#local-network-devices-windows","title":"Local Network Devices (Windows)","text":"<pre><code>Get-ADComputer -Filter * -Properties LastLogonDate | Select-Object Name, LastLogonDate\n</code></pre> <p>Look for:</p> <ul> <li>LastLogonDate = stale (&gt;90 days)</li> <li>Computers not listed in asset inventory</li> <li>Unknown naming conventions (ex: random strings)</li> </ul>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#linuxmacos-devices-via-dhcp-or-network-scans","title":"Linux/MacOS Devices (via DHCP or Network Scans)","text":"<pre><code>sudo nmap -sn 192.168.1.0/24\n</code></pre> <p>Look for:</p> <ul> <li>Devices with hostnames not matching standard naming conventions</li> <li>IP addresses not documented in DHCP reservations</li> </ul> <p>Operator Note: Flag any unknown or unmanaged IP/MAC addresses.</p>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#active-directory","title":"Active Directory","text":"<pre><code>Get-ADComputer -Filter * -Properties Enabled, LastLogonDate | Where-Object {$_.Enabled -eq $true} | Select-Object Name, LastLogonDate\n</code></pre> <ul> <li>Look for enabled computers with no login activity (stale).</li> <li>Validate against organizational inventory.</li> </ul>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#azure-ad-and-intune","title":"Azure AD and Intune","text":"<pre><code>Get-AzureADDevice -All $true | Select-Object DisplayName, DeviceId, AccountEnabled\n</code></pre> <p>Or via Azure Portal:</p> <p>Azure Portal \u2192 Azure AD \u2192 Devices \u2192 All Devices</p> <ul> <li>Look for:</li> <li>Unmanaged or personal devices</li> <li>Stale last check-in dates</li> <li>Unauthorized platform types</li> </ul>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#aws-systems-manager-ssm-ec2-instances","title":"AWS Systems Manager (SSM) + EC2 Instances","text":"<pre><code>aws ssm describe-instance-information\naws ec2 describe-instances\n</code></pre> <p>Look for:</p> <ul> <li>Instances or devices not matching approved device tags/naming</li> <li>Instances running outside of standard VPCs/subnets</li> </ul>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#google-workspace-endpoint-management","title":"Google Workspace (Endpoint Management)","text":"<p>Admin Console \u2192 Devices \u2192 Overview \u2192 Endpoints</p> <p>Look for:</p> <ul> <li>Devices not linked to managed users</li> <li>Devices marked as personal or unmanaged</li> <li>Devices not checked-in recently</li> </ul> <p>Operator Note: Stale or unknown registered devices are high risk.</p>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#step-2-validate-device-authorization","title":"Step 2: Validate Device Authorization","text":"<ul> <li>Compare findings to asset inventories</li> <li>Confirm owners or users of each device</li> <li>Validate with business owners or IT asset managers</li> </ul> <p>Operator Note: Temporary, BYOD, or contractor devices should be explicitly approved.</p>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#step-3-disable-or-remove-unauthorized-devices","title":"Step 3: Disable or Remove Unauthorized Devices","text":""},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#local-windows-ad","title":"Local (Windows AD)","text":"<pre><code>Disable-ADAccount -Identity \"ComputerName\"\nRemove-ADComputer -Identity \"ComputerName\"\n</code></pre>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#azure-ad","title":"Azure AD","text":"<pre><code>Remove-AzureADDevice -ObjectId &lt;DeviceID&gt;\n</code></pre> <p>Or via Portal \u2192 Azure AD \u2192 Devices \u2192 Delete device.</p>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#intune-microsoft-endpoint-manager","title":"Intune (Microsoft Endpoint Manager)","text":"<ul> <li>Locate device</li> <li>Choose \"Retire\" or \"Delete\"</li> </ul>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#aws","title":"AWS","text":"<pre><code>aws ec2 terminate-instances --instance-ids &lt;instance-id&gt;\naws ssm deregister-managed-instance --instance-id &lt;instance-id&gt;\n</code></pre>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#google-workspace","title":"Google Workspace","text":"<p>Admin Console \u2192 Devices \u2192 Select Device \u2192 Remove Device</p> <p>Operator Note: Where possible, disable or quarantine before deletion to prevent disruption.</p>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#step-4-validate-removal-and-audit","title":"Step 4: Validate Removal and Audit","text":"<ul> <li>Re-run inventory queries and confirm devices are removed.</li> <li>Review event/audit logs to confirm removal actions.</li> <li>Document removal reason, method, and approver.</li> </ul>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#dependencies","title":"Dependencies","text":"<ul> <li>Access to AD, Azure AD, Intune, AWS, Google Admin Console</li> <li>Approved asset and device inventory list</li> <li>Coordination with system and business owners</li> </ul>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage PowerShell AD Modules Windows Built-in/RSAT AD device management AzureAD / MS Graph Module PowerShell Install-Module Azure AD device management AWS CLI Cross-platform Package manager EC2 / SSM device management Google Admin Console Web Native Google Workspace device management Nmap Cross-platform Package manager Network scanning"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Obtain authorized device inventory (local, AD, cloud).</li> <li> Collect all active and registered devices.</li> <li> Compare detected devices against authorized inventory.</li> <li> Validate ownership and status of suspicious devices.</li> <li> Disable or remove unauthorized devices.</li> <li> Validate removal and update inventory documentation.</li> </ul>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#best-practices","title":"Best Practices","text":"<ul> <li>Disable before deleting where possible \u2192 prevents accidental loss of forensic data.</li> <li>Stale devices should be reviewed regularly and removed if no longer needed.</li> <li>Enforce enrollment and endpoint management (Intune, SSM, Google MDM) for cloud registered devices.</li> <li>Implement alerts for new device registrations.</li> </ul>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#references","title":"References","text":"<ul> <li>Azure AD Device Management</li> <li>AWS Systems Manager</li> <li>Google Endpoint Management</li> <li>Active Directory Computer Management</li> </ul>"},{"location":"4.Eradication/4.57_Remove_Unauthorized_Devices/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with deep operator-focused guidance and multi-cloud/device examples Leo"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/","title":"4.58 Remove Unauthorized Services (Local/Cloud - Background Processes, SaaS Apps, Shadow IT)","text":""},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#task","title":"Task","text":"<p>Identify and remove unauthorized services and applications across local systems, cloud platforms (AWS, Azure, GCP), and SaaS environments to eliminate unapproved, risky, or malicious background processes and shadow IT.</p>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#conditions","title":"Conditions","text":"<p>Given access to local systems, cloud tenant management consoles, SaaS application reports, and monitoring tools.</p>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#standards","title":"Standards","text":"<ul> <li>Discover all running services, background processes, cloud-based apps, and SaaS subscriptions.</li> <li>Validate services and apps against approved lists.</li> <li>Remove, disable, or terminate unauthorized services and applications.</li> <li>Document actions and notify system or app owners.</li> </ul>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#end-state","title":"End State","text":"<p>All unauthorized services, apps, and cloud services are identified, removed or disabled, and documented.</p>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#notes","title":"Notes","text":"<ul> <li>Unauthorized services can be installed malware, unauthorized software, or shadow IT.</li> <li>Shadow IT (SaaS apps signed up by users without IT approval) can introduce major security risks.</li> <li>Cloud platforms often have running services or apps not approved \u2192 review is mandatory.</li> </ul>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#step-1-enumerate-local-background-services-and-processes","title":"Step 1: Enumerate Local Background Services and Processes","text":""},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#windows","title":"Windows","text":"<pre><code>Get-Service | Where-Object {$_.Status -eq \"Running\"} | Select-Object Name, DisplayName, Status\n</code></pre> <p>Look for:</p> <ul> <li>Unfamiliar service names</li> <li>Services running from temp folders</li> <li>Services without a digital signature</li> </ul>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#linux","title":"Linux","text":"<pre><code>systemctl list-units --type=service --state=running\nps aux\n</code></pre> <p>Look for:</p> <ul> <li>Services running as root</li> <li>Unrecognized process names</li> </ul>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#macos","title":"macOS","text":"<pre><code>launchctl list\nps aux\n</code></pre> <p>Operator Note: Cross-reference running services with baseline and approved software lists.</p>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#step-2-enumerate-installed-applications-local","title":"Step 2: Enumerate Installed Applications (Local)","text":""},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#windows_1","title":"Windows","text":"<pre><code>Get-WmiObject -Class Win32_Product | Select-Object Name\n</code></pre>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#linux_1","title":"Linux","text":"<pre><code>dpkg -l\n</code></pre>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#macos_1","title":"macOS","text":"<pre><code>system_profiler SPApplicationsDataType\n</code></pre> <p>Look for:</p> <ul> <li>Applications not in baseline inventory</li> <li>Unapproved or unauthorized tools</li> </ul> <p>Operator Note: Alert on remote access tools (AnyDesk, TeamViewer, etc.) if not approved.</p>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#step-3-enumerate-saas-applications-shadow-it","title":"Step 3: Enumerate SaaS Applications (Shadow IT)","text":""},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#microsoft-365-azure-ad","title":"Microsoft 365 / Azure AD","text":"<ul> <li>Azure AD \u2192 Enterprise Applications \u2192 All Applications</li> <li>Filter by \u201cAdded by\u201d \u2192 detect user-added apps</li> </ul> <pre><code>Get-AzureADServicePrincipal -All $true | Select DisplayName, AppId\n</code></pre> <p>Look for:</p> <ul> <li>Apps added by non-admin users</li> <li>Apps with risky permissions (mail, files, calendar)</li> </ul>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#google-workspace","title":"Google Workspace","text":"<ul> <li>Admin Console \u2192 Apps \u2192 Web and mobile apps \u2192 Connected apps</li> </ul> <p>Look for:</p> <ul> <li>Apps connected to user accounts without approval</li> </ul>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#shadow-it-discovery-optional-tools","title":"Shadow IT Discovery (Optional Tools)","text":"Tool Platform Usage Microsoft Cloud App Security (Defender for Cloud Apps) Azure SaaS discovery Netskope Cloud SaaS usage monitoring Zscaler Cloud Shadow IT discovery <p>Operator Note: SaaS apps added without IT knowledge pose major risk \u2192 escalate immediately.</p>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#step-4-enumerate-cloud-services-aws-azure-gcp","title":"Step 4: Enumerate Cloud Services (AWS / Azure / GCP)","text":""},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#aws-list-active-servicesresources","title":"AWS \u2192 List active services/resources","text":"<pre><code>aws resourcegroupstaggingapi get-resources\naws ec2 describe-instances\naws lambda list-functions\n</code></pre> <p>Look for:</p> <ul> <li>Resources without tags / owners</li> <li>Old or unauthorized services</li> </ul>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#azure","title":"Azure","text":"<pre><code>Get-AzResource\n</code></pre> <p>Azure Portal \u2192 Resource Groups \u2192 Filter by owner / tags.</p> <p>Look for:</p> <ul> <li>Unused/unknown resources</li> <li>Services with unknown owner or usage</li> </ul>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#gcp","title":"GCP","text":"<pre><code>gcloud projects list\ngcloud services list --enabled\ngcloud compute instances list\n</code></pre> <p>Look for:</p> <ul> <li>Enabled services not part of baseline</li> <li>Unused Compute Engine instances</li> </ul> <p>Operator Note: Services with owner=unknown or missing tags should be treated as suspect.</p>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#step-5-remove-or-disable-unauthorized-services","title":"Step 5: Remove or Disable Unauthorized Services","text":""},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#local-services","title":"Local Services","text":""},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#windows_2","title":"Windows","text":"<pre><code>Stop-Service -Name \"ServiceName\"\nSet-Service -Name \"ServiceName\" -StartupType Disabled\n</code></pre>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#linux_2","title":"Linux","text":"<pre><code>sudo systemctl stop servicename\nsudo systemctl disable servicename\n</code></pre>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#macos_2","title":"macOS","text":"<pre><code>sudo launchctl bootout system /Library/LaunchDaemons/com.unauthorized.service.plist\n</code></pre>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#saas-azure-ad-google-workspace","title":"SaaS (Azure AD / Google Workspace)","text":""},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#azure-ad","title":"Azure AD","text":"<pre><code>Remove-AzureADServicePrincipal -ObjectId &lt;AppId&gt;\n</code></pre>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#google-workspace_1","title":"Google Workspace","text":"<p>Admin Console \u2192 Apps \u2192 Connected Apps \u2192 Remove access</p>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#cloud-resources-aws-azure-gcp","title":"Cloud Resources (AWS, Azure, GCP)","text":""},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#aws","title":"AWS","text":"<pre><code>aws ec2 terminate-instances --instance-ids &lt;instance-id&gt;\naws lambda delete-function --function-name &lt;function-name&gt;\n</code></pre>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#azure_1","title":"Azure","text":"<pre><code>Remove-AzResource -ResourceId \"&lt;resource-id&gt;\"\n</code></pre>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#gcp_1","title":"GCP","text":"<pre><code>gcloud compute instances delete &lt;instance-name&gt; --zone=&lt;zone&gt;\n</code></pre> <p>Operator Note: Follow change management process when deleting cloud resources \u2192 review with owners first.</p>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#step-6-validate-and-document","title":"Step 6: Validate and Document","text":"<ul> <li>Confirm services removed and no longer running.</li> <li>Review audit logs for removal actions.</li> <li>Update documentation and notify owners / stakeholders.</li> </ul>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#dependencies","title":"Dependencies","text":"<ul> <li>Access to local systems, SaaS platforms, cloud platforms (AWS, Azure, GCP)</li> <li>Authorized application and services inventory</li> <li>Coordination with business and IT owners</li> </ul>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage PowerShell Windows Built-in Local service/application enumeration systemctl / launchctl Linux/macOS Native Local service management Cloud CLI Tools (aws, az, gcloud) Cross-platform Package manager Cloud service management SaaS App Management Consoles Web Native Azure AD / Google Workspace app control"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Enumerate local running services and background processes.</li> <li> Enumerate SaaS connected apps \u2192 identify user-added apps.</li> <li> Enumerate cloud services across AWS, Azure, GCP.</li> <li> Validate all services and apps against approved list.</li> <li> Disable or remove unauthorized services.</li> <li> Validate removal and document actions taken.</li> </ul>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#best-practices","title":"Best Practices","text":"<ul> <li>Quarantine suspicious services \u2192 do not delete immediately unless required.</li> <li>Coordinate SaaS app removal with end users \u2192 avoid business disruption.</li> <li>Cloud services \u2192 validate no dependency before termination.</li> <li>Implement periodic service reviews \u2192 especially in cloud and SaaS environments.</li> </ul>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#references","title":"References","text":"<ul> <li>Azure AD Enterprise Apps Management</li> <li>AWS Resource Group Tagging API</li> <li>GCP Service Management</li> </ul>"},{"location":"4.Eradication/4.58_Remove_Unauthorized_Services/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with deep operator-focused guidance across local, cloud, and SaaS platforms Leo"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/","title":"4.59 Remove Unauthorized Scheduled Tasks and Automation (Local and Cloud)","text":""},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#task","title":"Task","text":"<p>Identify and remove unauthorized scheduled tasks, automation jobs, and persistent background execution mechanisms across local systems and cloud platforms (AWS, Azure, GCP).</p>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#conditions","title":"Conditions","text":"<p>Given access to local systems, cloud automation consoles, and administrative tools to enumerate, disable, and remove scheduled tasks.</p>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#standards","title":"Standards","text":"<ul> <li>Enumerate and validate all scheduled tasks and automation jobs.</li> <li>Cross-check tasks against authorized task and automation inventories.</li> <li>Disable and remove unauthorized or suspicious tasks.</li> <li>Document and report all removals.</li> </ul>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#end-state","title":"End State","text":"<p>All unauthorized and suspicious scheduled tasks and automation are identified, removed or disabled, and documented across local and cloud environments.</p>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#notes","title":"Notes","text":"<ul> <li>Unauthorized scheduled tasks are a known persistence mechanism for attackers.</li> <li>Cloud automation (Lambda, Azure Automation, Cloud Functions) can be abused for C2 and post-exploitation.</li> <li>Detection and validation should include source, creator, and execution context.</li> </ul>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#step-1-enumerate-scheduled-tasks-and-automation-local-systems","title":"Step 1: Enumerate Scheduled Tasks and Automation - Local Systems","text":""},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#windows-task-scheduler","title":"Windows \u2192 Task Scheduler","text":"<pre><code>Get-ScheduledTask | Select-Object TaskName, State, Actions\n</code></pre> <p>Look for:</p> <ul> <li>Non-standard or unfamiliar task names.</li> <li>Tasks running from unusual directories (ex: Temp, AppData).</li> <li>Tasks triggered outside normal hours.</li> </ul> <p>Operator Note: Check for hidden tasks and those created by \"SYSTEM\" or unknown users.</p>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#linux-cron-and-anacron","title":"Linux \u2192 Cron and Anacron","text":"<pre><code>crontab -l\ncat /etc/crontab\nls /etc/cron.d/\n</code></pre> <p>Look for:</p> <ul> <li>Jobs running scripts from /tmp or /var/tmp</li> <li>Jobs running as root not approved</li> <li>Jobs running frequently at odd hours</li> </ul> <p>Operator Note: Review <code>/var/log/syslog</code> or <code>/var/log/cron</code> for execution history.</p>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#macos-launch-daemons-and-launch-agents","title":"macOS \u2192 Launch Daemons and Launch Agents","text":"<pre><code>launchctl list\ncat /Library/LaunchDaemons/*\ncat /Library/LaunchAgents/*\n</code></pre> <p>Look for:</p> <ul> <li>Unknown plist files</li> <li>Launch agents in user folders</li> <li>Daemons launching shell scripts</li> </ul>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#step-2-enumerate-cloud-scheduled-tasks-and-automation","title":"Step 2: Enumerate Cloud Scheduled Tasks and Automation","text":""},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#aws-eventbridge-cloudwatch-events-lambda-step-functions","title":"AWS \u2192 EventBridge (CloudWatch Events), Lambda, Step Functions","text":"<pre><code>aws events list-rules\naws lambda list-functions\naws stepfunctions list-state-machines\n</code></pre> <p>Look for:</p> <ul> <li>Functions or rules with unknown creators</li> <li>EventBridge rules running on suspicious schedules</li> <li>Lambda functions tied to suspicious triggers (ex: S3, SNS)</li> </ul> <p>Operator Note: Functions without tags or ownership are high priority for review.</p>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#azure-automation-accounts-runbooks-logic-apps-functions","title":"Azure \u2192 Automation Accounts, Runbooks, Logic Apps, Functions","text":"<pre><code>Get-AzAutomationAccount\nGet-AzAutomationRunbook\nGet-AzLogicApp\nGet-AzFunctionApp\n</code></pre> <p>Look for:</p> <ul> <li>Unscheduled or disabled Runbooks re-enabled</li> <li>Logic Apps performing unauthorized data transfers</li> <li>Functions with unknown owners or lack of documentation</li> </ul> <p>Operator Note: Review Activity Log \u2192 filter by resource type and create/update actions.</p>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#gcp-cloud-scheduler-cloud-functions","title":"GCP \u2192 Cloud Scheduler, Cloud Functions","text":"<pre><code>gcloud scheduler jobs list\ngcloud functions list\n</code></pre> <p>Look for:</p> <ul> <li>Jobs triggered without business justification</li> <li>Functions running without source control</li> <li>Triggers like HTTP, Pub/Sub without secure IAM bindings</li> </ul> <p>Operator Note: Cloud Functions used by attackers often have generic names \u2192 audit naming and descriptions.</p>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#step-3-validate-task-and-automation-authorization","title":"Step 3: Validate Task and Automation Authorization","text":"<ul> <li>Compare against approved inventories and runbooks.</li> <li>Validate ownership and purpose with system or service owners.</li> <li>Check implementation history (who added and why).</li> </ul> <p>Operator Note: Shadow automation (automation implemented without IT/security approval) should be reviewed carefully.</p>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#step-4-disable-or-remove-unauthorized-tasks","title":"Step 4: Disable or Remove Unauthorized Tasks","text":""},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#windows","title":"Windows","text":"<pre><code>Unregister-ScheduledTask -TaskName \"TaskName\" -Confirm:$false\n</code></pre>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#linux","title":"Linux","text":"<pre><code>crontab -r\nrm /etc/cron.d/unapprovedjob\n</code></pre>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#macos","title":"macOS","text":"<pre><code>sudo launchctl bootout system /Library/LaunchDaemons/com.unauthorized.plist\nsudo rm /Library/LaunchDaemons/com.unauthorized.plist\n</code></pre>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#aws","title":"AWS","text":"<pre><code>aws events delete-rule --name \"RuleName\"\naws lambda delete-function --function-name \"FunctionName\"\n</code></pre>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#azure","title":"Azure","text":"<pre><code>Remove-AzAutomationRunbook -AutomationAccountName \"AccountName\" -Name \"RunbookName\"\nRemove-AzFunctionApp -Name \"FunctionName\"\n</code></pre>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#gcp","title":"GCP","text":"<pre><code>gcloud scheduler jobs delete \"job-name\"\ngcloud functions delete \"function-name\"\n</code></pre> <p>Operator Note: Always disable first unless critical \u2192 preserves for forensic review.</p>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#step-5-validate-and-document-removals","title":"Step 5: Validate and Document Removals","text":"<ul> <li>Confirm removed tasks no longer exist.</li> <li>Validate audit logs reflect removal actions.</li> <li>Document findings, owners, and decisions.</li> </ul>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#dependencies","title":"Dependencies","text":"<ul> <li>Access to local OS, Cloud Platform APIs and Consoles</li> <li>Approved automation and task inventory</li> <li>Coordination with application and system owners</li> </ul>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage PowerShell / Task Scheduler Windows Built-in Task enumeration/removal systemctl / crontab Linux/macOS Native Cron/launchd management AWS CLI Cross-platform Package manager Lambda/EventBridge Azure CLI / PowerShell Cross-platform Native Azure Automation GCloud CLI Cross-platform Package manager Scheduler/Functions"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Enumerate all scheduled tasks and automation jobs across local and cloud.</li> <li> Validate each task against approved inventory.</li> <li> Identify and flag unauthorized tasks.</li> <li> Disable and remove unauthorized tasks.</li> <li> Validate and document removal.</li> </ul>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#best-practices","title":"Best Practices","text":"<ul> <li>Quarantine questionable tasks by disabling before deleting.</li> <li>Review cloud automation periodically \u2192 attackers often leave cloud persistence.</li> <li>Implement alerts for creation of new automation tasks.</li> <li>Ensure all business automation is documented and reviewed.</li> </ul>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#references","title":"References","text":"<ul> <li>AWS Lambda and EventBridge Management</li> <li>Azure Automation and Functions</li> <li>GCP Cloud Scheduler and Functions</li> </ul>"},{"location":"4.Eradication/4.59_Remove_Unauthorized_Scheduled_Tasks_Automation/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with deep operator guidance across local, cloud, and SaaS platforms Leo"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/","title":"4.60 Remove Unauthorized DNS Entries (Local, AD, Cloud DNS)","text":""},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#task","title":"Task","text":"<p>Identify and remove unauthorized or malicious DNS records across local hosts, enterprise DNS (Active Directory Integrated DNS), and Cloud DNS services (AWS Route 53, Azure DNS, Google Cloud DNS).</p>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#conditions","title":"Conditions","text":"<p>Given access to local systems, enterprise DNS servers, and cloud platform DNS management consoles.</p>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#standards","title":"Standards","text":"<ul> <li>Enumerate and validate all DNS entries across environments.</li> <li>Identify stale, rogue, or unauthorized DNS records.</li> <li>Remove or disable unauthorized DNS entries.</li> <li>Document and audit all actions taken.</li> </ul>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#end-state","title":"End State","text":"<p>All unauthorized or malicious DNS records are identified, removed, and documented across local, enterprise, and cloud DNS environments.</p>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#notes","title":"Notes","text":"<ul> <li>Rogue DNS records can enable phishing, subdomain takeovers, lateral movement, and persistence.</li> <li>Attackers often leave dynamic or malicious DNS records post-compromise.</li> <li>DNS record validation should be cross-checked against asset inventories.</li> </ul>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#step-1-enumerate-dns-entries-local-hosts-files","title":"Step 1: Enumerate DNS Entries - Local Hosts Files","text":""},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#windows","title":"Windows","text":"<pre><code>Get-Content C:\\Windows\\System32\\drivers\\etc\\hosts\n</code></pre>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#linux-macos","title":"Linux / macOS","text":"<pre><code>cat /etc/hosts\n</code></pre> <p>Look for:</p> <ul> <li>Unusual host-to-IP mappings</li> <li>Redirects to suspicious IP addresses</li> <li>Unauthorized overrides (ex: local override of security domains)</li> </ul> <p>Operator Note: Hosts file tampering is a known attacker tactic \u2192 flag suspicious entries.</p>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#step-2-enumerate-enterprise-dns-entries-ad-integrated-dns","title":"Step 2: Enumerate Enterprise DNS Entries (AD Integrated DNS)","text":""},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#active-directory-dns-windows-server","title":"Active Directory DNS (Windows Server)","text":"<pre><code>Get-DnsServerResourceRecord -ZoneName \"corp.local\"\n</code></pre> <p>Look for:</p> <ul> <li>A, CNAME, TXT, and SRV records without associated authorized hosts</li> <li>Stale records with no recent dynamic updates</li> <li>Subdomains or forwarders pointing to external or suspicious IPs</li> </ul> <p>Operator Note: Cross-reference with DHCP leases and AD computer accounts.</p>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#step-3-enumerate-cloud-dns-entries","title":"Step 3: Enumerate Cloud DNS Entries","text":""},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#aws-route-53","title":"AWS \u2192 Route 53","text":"<pre><code>aws route53 list-hosted-zones\naws route53 list-resource-record-sets --hosted-zone-id ZONEID\n</code></pre> <p>Look for:</p> <ul> <li>Records with external or unknown targets</li> <li>Wildcard or catch-all records</li> <li>Old/deprecated subdomains still pointing to active resources</li> </ul>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#azure-azure-dns","title":"Azure \u2192 Azure DNS","text":"<pre><code>Get-AzDnsZone\nGet-AzDnsRecordSet -ZoneName \"example.com\" -ResourceGroupName \"DNS-RG\"\n</code></pre> <p>Look for:</p> <ul> <li>Record sets pointing to deprecated or unknown resources</li> <li>Records without metadata or tags</li> <li>Subdomains with owner = unknown</li> </ul>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#gcp-google-cloud-dns","title":"GCP \u2192 Google Cloud DNS","text":"<pre><code>gcloud dns managed-zones list\ngcloud dns record-sets list --zone=\"zone-name\"\n</code></pre> <p>Look for:</p> <ul> <li>External IP or external domain CNAMEs</li> <li>Old TXT records (may include attacker verification)</li> <li>Wildcard entries or catch-alls</li> </ul> <p>Operator Note: Orphaned cloud DNS records may point to deleted services \u2192 subdomain takeover risk.</p>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#step-4-validate-dns-record-authorization","title":"Step 4: Validate DNS Record Authorization","text":"<ul> <li>Cross-check against asset inventory and change records.</li> <li>Confirm with application, network, or cloud owners.</li> <li>Validate IP addresses \u2192 internal/private should not point externally unless authorized.</li> </ul> <p>Operator Note: Validate owner and use-case \u2192 unknown or unsupported records should be removed.</p>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#step-5-remove-unauthorized-dns-records","title":"Step 5: Remove Unauthorized DNS Records","text":""},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#hosts-file","title":"Hosts File","text":"<pre><code># Windows\nRemove-Item -Path \"C:\\Windows\\System32\\drivers\\etc\\hosts\" -Force\n# Or manually remove the entry\n\n# Linux / macOS\nsudo nano /etc/hosts\n# Remove the unauthorized line\n</code></pre>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#active-directory-dns","title":"Active Directory DNS","text":"<pre><code>Remove-DnsServerResourceRecord -ZoneName \"corp.local\" -RRType \"A\" -Name \"badhost\" -Force\n</code></pre>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#aws-route-53_1","title":"AWS Route 53","text":"<pre><code>aws route53 change-resource-record-sets --hosted-zone-id ZONEID --change-batch file://change-batch.json\n</code></pre> <p>Example change-batch.json for deletion</p> <pre><code>{\n  \"Comment\": \"Delete unauthorized record\",\n  \"Changes\": [\n    {\n      \"Action\": \"DELETE\",\n      \"ResourceRecordSet\": {\n        \"Name\": \"badhost.example.com.\",\n        \"Type\": \"A\",\n        \"TTL\": 300,\n        \"ResourceRecords\": [\n          {\n            \"Value\": \"192.0.2.44\"\n          }\n        ]\n      }\n    }\n  ]\n}\n</code></pre>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#azure-dns","title":"Azure DNS","text":"<pre><code>Remove-AzDnsRecordSet -Name \"badhost\" -ZoneName \"example.com\" -ResourceGroupName \"DNS-RG\" -RecordType A\n</code></pre>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#google-cloud-dns","title":"Google Cloud DNS","text":"<pre><code>gcloud dns record-sets delete \"badhost.example.com.\" --zone=\"zone-name\" --type=\"A\"\n</code></pre> <p>Operator Note: When deleting cloud records, validate no active dependencies \u2192 removing legitimate records may impact production services.</p>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#step-6-validate-removal-and-document","title":"Step 6: Validate Removal and Document","text":"<ul> <li>Re-query DNS \u2192 confirm record is removed.</li> <li>Validate DNS propagation \u2192 ensure no cached/stale records.</li> <li>Document removal \u2192 include ticket/case numbers and approvers.</li> </ul>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#dependencies","title":"Dependencies","text":"<ul> <li>Access to local hosts, AD DNS servers, and cloud platform DNS management consoles.</li> <li>Approved and current DNS inventory (zones, subdomains, owners).</li> <li>Coordination with application and cloud service owners.</li> </ul>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage nslookup / dig Cross-platform Native DNS query and validation Windows DNS Manager Windows Built-in AD DNS zone management AWS CLI Cross-platform Package manager Route 53 management Azure CLI / PowerShell Cross-platform Package manager Azure DNS management GCloud CLI Cross-platform Package manager Google Cloud DNS management"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Enumerate local hosts file and validate entries.</li> <li> Enumerate AD DNS records \u2192 identify stale or unauthorized records.</li> <li> Enumerate AWS Route 53, Azure DNS, and GCP Cloud DNS records.</li> <li> Validate against inventory and owners.</li> <li> Remove unauthorized records following validation.</li> <li> Validate removal and document actions.</li> </ul>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#best-practices","title":"Best Practices","text":"<ul> <li>Disable DNS dynamic updates where not needed.</li> <li>Require tagging/metadata for all cloud DNS records.</li> <li>Regularly audit DNS zones \u2192 stale records are common.</li> <li>Use DNS logging (query logs, DNS analytics) to monitor abuse.</li> </ul>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#references","title":"References","text":"<ul> <li>Windows DNS Server Cmdlets</li> <li>AWS Route 53 CLI Reference</li> <li>Azure DNS Management</li> <li>Google Cloud DNS Management</li> </ul>"},{"location":"4.Eradication/4.60_Remove_Unauthorized_DNS_Entries/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with operator-focused DNS record validation and removal process (Local, AD, Cloud) Leo"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/","title":"4.61 Validate All Endpoints Are Removed from Monitoring Gaps (SIEM, EDR, Logging)","text":""},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#task","title":"Task","text":"<p>Ensure that all endpoints (workstations, servers, cloud VMs, and mobile endpoints) are properly onboarded into logging and monitoring platforms (SIEM, EDR, and Cloud-native services). Identify and remediate monitoring gaps where endpoints are missing or inactive.</p>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#conditions","title":"Conditions","text":"<p>Given access to SIEM, EDR, and Cloud-native logging platforms.</p>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#standards","title":"Standards","text":"<ul> <li>Enumerate all endpoints across environments.</li> <li>Validate each endpoint has active EDR and SIEM/logging agent coverage.</li> <li>Identify and close monitoring gaps.</li> <li>Document all actions taken.</li> </ul>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#end-state","title":"End State","text":"<p>All endpoints are monitored by EDR and/or SIEM and any monitoring gaps are resolved or escalated.</p>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#notes","title":"Notes","text":"<ul> <li>Endpoints missing from SIEM and EDR create serious blind spots during incident response.</li> <li>Newly provisioned or legacy systems are often overlooked.</li> <li>Cloud workloads (VMs, containers) may spin up/down \u2192 monitoring must be dynamic.</li> </ul>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#step-1-enumerate-active-endpoints-from-source-systems","title":"Step 1: Enumerate Active Endpoints from Source Systems","text":""},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#active-directory-for-on-prem-endpoints","title":"Active Directory (for on-prem endpoints)","text":"<pre><code>Get-ADComputer -Filter * | Select-Object Name, LastLogonDate\n</code></pre> <p>Look for:</p> <ul> <li>Enabled computer accounts</li> <li>Stale systems still active</li> </ul>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#cloud-platforms-aws-azure-gcp","title":"Cloud Platforms (AWS, Azure, GCP)","text":"Cloud Command/Console Look For AWS EC2 <code>aws ec2 describe-instances</code> Running instances Azure VM <code>Get-AzVM</code> Powered on VMs GCP Compute Engine <code>gcloud compute instances list</code> Running instances <p>Operator Note: Ensure cloud VMs are compared against monitoring and EDR coverage.</p>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#step-2-enumerate-endpoints-from-edr-console","title":"Step 2: Enumerate Endpoints from EDR Console","text":""},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#common-edr-platforms","title":"Common EDR platforms:","text":"EDR Query/View What to Look For CrowdStrike Hosts \u2192 Host Management Hosts missing heartbeat or never checked in Microsoft Defender ATP Devices \u2192 Active/Inactive Inactive or unmanaged devices SentinelOne Devices \u2192 All Devices offline or with stale check-in Others Equivalent views Check for offline/stale hosts <p>Operator Note: Stale endpoints (30+ days) may be compromised or improperly offboarded.</p>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#step-3-enumerate-endpoints-from-siem-log-collection","title":"Step 3: Enumerate Endpoints from SIEM / Log Collection","text":""},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#examples","title":"Examples:","text":"SIEM Method What to Look For Splunk <code>| metadata type=hosts</code> Missing known hosts Microsoft Sentinel Workbooks/Logs \u2192 Heartbeat Inactive/never reported hosts Elastic Discover \u2192 Agent ID check Missing expected agents <p>Operator Note: Cross-reference SIEM asset list against AD and EDR inventories.</p>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#step-4-compare-and-identify-monitoring-gaps","title":"Step 4: Compare and Identify Monitoring Gaps","text":"<ul> <li>Merge all collected lists \u2192 AD, EDR, SIEM, Cloud platforms.</li> <li>Identify systems not appearing in EDR or SIEM.</li> <li>Investigate reasons \u2192 offline, decommissioned, not onboarded, rogue.</li> </ul> <p>Operator Note: Onboard missing endpoints or escalate rogue/unaccounted endpoints immediately.</p>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#step-5-onboard-missing-endpoints","title":"Step 5: Onboard Missing Endpoints","text":""},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#local-onboarding-windowslinuxmacos","title":"Local Onboarding (Windows/Linux/macOS)","text":"<ul> <li>Install EDR agent (CrowdStrike, Defender ATP, etc)</li> <li>Install SIEM log collection agent (Splunk Universal Forwarder, FluentD, NXLog)</li> </ul>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#cloud-onboarding","title":"Cloud Onboarding","text":"Platform Native Logging AWS Enable GuardDuty, CloudWatch Agent Azure Azure Monitor/Defender Extension GCP Enable Cloud Logging Agent <p>Operator Note: Automation (e.g. Terraform, CloudFormation) should enforce automatic onboarding.</p>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#step-6-validate-and-document","title":"Step 6: Validate and Document","text":"<ul> <li>Validate endpoint appears in EDR and SIEM.</li> <li>Validate cloud-native logs are ingested.</li> <li>Document actions, updates to onboarding procedures, and owner sign-offs.</li> </ul>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#dependencies","title":"Dependencies","text":"<ul> <li>Access to SIEM, EDR, Cloud consoles</li> <li>Accurate endpoint inventory</li> <li>Ability to deploy and validate agent installation</li> </ul>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage PowerShell Windows Built-in AD and agent validation AWS CLI Cross-platform Package manager EC2 inventory Azure CLI / PowerShell Cross-platform Package manager VM inventory GCloud CLI Cross-platform Package manager Compute inventory Splunk / Sentinel / Elastic Web/Console Native SIEM coverage validation"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Enumerate endpoints from AD, cloud, and local infrastructure.</li> <li> Enumerate endpoints from EDR platforms.</li> <li> Enumerate endpoints from SIEM platforms.</li> <li> Compare \u2192 identify gaps.</li> <li> Onboard missing endpoints and remove stale/decommissioned entries.</li> <li> Validate and document coverage.</li> </ul>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#best-practices","title":"Best Practices","text":"<ul> <li>Review onboarding automation regularly \u2192 avoid drift.</li> <li>Flag stale/inactive hosts \u2192 validate decommission or compromise.</li> <li>Enforce agent health monitoring \u2192 alerts for missing heartbeat.</li> <li>Incorporate cloud auto-scaling logic \u2192 ensure dynamic assets are auto-onboarded.</li> </ul>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#references","title":"References","text":"<ul> <li>CrowdStrike Falcon Host Management</li> <li>Microsoft Sentinel Agent Monitoring</li> <li>AWS GuardDuty</li> <li>Azure Defender for Servers</li> <li>GCP Cloud Logging</li> </ul>"},{"location":"4.Eradication/4.61_Validate_All_Endpoint_Gaps/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with operator-focused SIEM/EDR/Cloud endpoint validation workflow Leo"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/","title":"4.62 Validate No Persistence Mechanisms Remain (Local, AD, Cloud - Backdoors, Accounts, Automation)","text":""},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#task","title":"Task","text":"<p>Detect and remove unauthorized persistence mechanisms including rogue accounts, backdoors, startup tasks, cloud functions, IAM backdoors, and unauthorized automation from local systems, Active Directory (AD), and cloud environments (AWS, Azure, GCP).</p>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#conditions","title":"Conditions","text":"<p>Given access to local, enterprise, and cloud platform administrative tools and logs.</p>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#standards","title":"Standards","text":"<ul> <li>Detect and validate persistence mechanisms across all environments.</li> <li>Remove or disable unauthorized persistence mechanisms.</li> <li>Confirm removal through validation and auditing.</li> <li>Document all actions.</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#end-state","title":"End State","text":"<p>No unauthorized accounts, services, jobs, or automated tasks remain that provide unauthorized or hidden access paths into the environment.</p>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#notes","title":"Notes","text":"<ul> <li>Persistence can be implanted across many layers: accounts, services, scheduled tasks, cloud automation, IAM policies.</li> <li>Threat actors often use obscure or hidden mechanisms.</li> <li>Thorough validation requires enumeration and cross-checking all avenues.</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#step-1-enumerate-and-review-local-persistence-mechanisms","title":"Step 1: Enumerate and Review Local Persistence Mechanisms","text":""},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#user-accounts-local","title":"User Accounts (Local)","text":""},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#windows","title":"Windows","text":"<pre><code>Get-LocalUser\n</code></pre>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#linuxmacos","title":"Linux/macOS","text":"<pre><code>cat /etc/passwd\n</code></pre> <p>Look for:</p> <ul> <li>Unauthorized user accounts</li> <li>Privileged accounts (Administrators/root group)</li> </ul> <p>Operator Note: Flag users with unusual usernames or not in authorized list.</p>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#startup-items-scheduled-tasks","title":"Startup Items / Scheduled Tasks","text":""},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#windows_1","title":"Windows","text":"<pre><code>Get-ScheduledTask\n</code></pre> <p>Check:</p> <ul> <li>Non-standard startup tasks</li> <li>Scripts located in Temp/AppData</li> <li>Unknown publisher or user-created</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#linux-cron","title":"Linux (cron)","text":"<pre><code>crontab -l\ncat /etc/cron.*\nls /etc/systemd/system/\n</code></pre> <p>Check:</p> <ul> <li>Odd scripts or binaries executing as root</li> <li>Newly added @reboot jobs</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#macos","title":"macOS","text":"<pre><code>launchctl list\n</code></pre> <p>Check:</p> <ul> <li>Unknown launch agents/daemons</li> <li>User folder agents</li> </ul> <p>Operator Note: Unknown or recently modified startup tasks \u2192 high priority for investigation.</p>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#registry-wmi-services-windows-advanced-persistence","title":"Registry / WMI / Services (Windows Advanced Persistence)","text":"<pre><code>Get-WmiObject -Namespace root\\subscription -Class __EventFilter\n</code></pre> <p>Check:</p> <ul> <li>WMI persistence \u2192 triggers hidden from normal user view</li> </ul> <pre><code>Get-ItemProperty -Path \"HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\"\n</code></pre> <p>Operator Note: Registry autoruns are easy to hide \u2192 validate all entries.</p>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#step-2-enumerate-and-review-active-directory-persistence","title":"Step 2: Enumerate and Review Active Directory Persistence","text":""},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#ad-accounts","title":"AD Accounts","text":"<pre><code>Get-ADUser -Filter * -Properties LastLogonDate, Enabled\n</code></pre> <p>Look for:</p> <ul> <li>Stale, disabled, or hidden users</li> <li>Unusual account naming conventions</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#ad-delegation-gpo-backdoors","title":"AD Delegation / GPO Backdoors","text":"<pre><code>Get-GPResultantSetOfPolicy\nGet-ADObject -LDAPFilter \"(adminCount=1)\"\n</code></pre> <p>Look for:</p> <ul> <li>Unexpected GPO delegations</li> <li>adminCount=1 \u2192 privileged accounts</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#ad-computers","title":"AD Computers","text":"<pre><code>Get-ADComputer -Filter * -Properties LastLogonDate\n</code></pre> <p>Operator Note: Unused or \"phantom\" computer accounts could be attacker-placed.</p>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#step-3-enumerate-and-review-cloud-persistence-mechanisms","title":"Step 3: Enumerate and Review Cloud Persistence Mechanisms","text":""},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#aws","title":"AWS","text":"<pre><code>aws iam list-users\naws iam list-roles\naws iam list-policies\n</code></pre> <p>Look for:</p> <ul> <li>Inline policies attached directly to users \u2192 high risk</li> <li>Users/roles created by unknown identities</li> <li>Trust policies allowing external AWS accounts (cross-account access)</li> </ul> <pre><code>aws lambda list-functions\n</code></pre> <p>Look for:</p> <ul> <li>Functions without business justification</li> <li>Auto-start triggers \u2192 SNS, S3</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#azure","title":"Azure","text":"<pre><code>Get-AzADUser\nGet-AzRoleAssignment\nGet-AzFunctionApp\n</code></pre> <p>Look for:</p> <ul> <li>Unused or high-privileged Azure AD users</li> <li>Custom roles and privileged assignments</li> <li>Azure Functions \u2192 malicious or unknown automated execution</li> </ul> <p>Azure Portal \u2192 Logic Apps / Automation Accounts:</p> <ul> <li>Unknown or newly created logic apps / runbooks</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#google-cloud-gcp","title":"Google Cloud (GCP)","text":"<pre><code>gcloud iam roles list\ngcloud projects get-iam-policy [PROJECT_ID]\ngcloud functions list\n</code></pre> <p>Look for:</p> <ul> <li>Custom roles with excessive privileges</li> <li>External members granted IAM roles</li> <li>Functions with HTTP triggers or frequent invocation</li> </ul> <p>Operator Note: External identities \u2192 attacker backdoors.</p>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#step-4-remove-unauthorized-persistence-mechanisms","title":"Step 4: Remove Unauthorized Persistence Mechanisms","text":""},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#local-windows-linux-macos","title":"Local (Windows, Linux, macOS)","text":"<ul> <li>Disable and delete unauthorized users.</li> <li>Delete unknown scheduled tasks / launch agents / crons.</li> <li>Remove autoruns and services.</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#active-directory","title":"Active Directory","text":"<ul> <li>Disable and remove unauthorized users.</li> <li>Remove GPO links or delegations.</li> <li>Clean up computer objects.</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#aws_1","title":"AWS","text":"<pre><code>aws iam delete-user --user-name USER\naws iam delete-role --role-name ROLE\naws lambda delete-function --function-name FUNCTION\n</code></pre>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#azure_1","title":"Azure","text":"<pre><code>Remove-AzADUser -ObjectId USERID\nRemove-AzFunctionApp -Name \"FunctionName\"\n</code></pre>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#gcp","title":"GCP","text":"<pre><code>gcloud iam roles delete [ROLE_ID] --project=[PROJECT_ID]\ngcloud functions delete [FUNCTION_NAME]\n</code></pre> <p>Operator Note: Disable before deletion where possible to avoid accidental service interruption.</p>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#step-5-validate-and-document","title":"Step 5: Validate and Document","text":"<ul> <li>Confirm no hidden users, roles, policies, or functions remain.</li> <li>Validate startup tasks and automation \u2192 no unauthorized entries.</li> <li>Update onboarding/offboarding and security controls to prevent re-introduction.</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#dependencies","title":"Dependencies","text":"<ul> <li>Access to OS-level, AD, and cloud management consoles</li> <li>Audit logs and administrative permissions</li> <li>Validated inventory of approved users, roles, and automation tasks</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage PowerShell / Bash Cross-platform Native Local + AD validation AWS CLI / Azure CLI / gcloud Cross-platform Package manager Cloud IAM and automation validation Sysinternals Autoruns Windows Download In-depth autorun review Microsoft Sentinel / Splunk SIEM Native Cross-correlation and detection of abnormal persistence"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Enumerate local persistence mechanisms (users, tasks, autoruns).</li> <li> Enumerate AD persistence mechanisms (users, GPOs, delegations).</li> <li> Enumerate cloud IAM, automation, and external trust relationships.</li> <li> Validate and disable/remove unauthorized mechanisms.</li> <li> Document actions and notify affected owners.</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#best-practices","title":"Best Practices","text":"<ul> <li>Disable before deleting unless urgent \u2192 preserves evidence.</li> <li>Always investigate suspicious automation or IAM roles.</li> <li>Review persistence avenues regularly \u2192 include in change management.</li> <li>Implement detection for persistence reintroduction (SIEM alerting).</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#references","title":"References","text":"<ul> <li>MITRE ATT&amp;CK Persistence Techniques</li> <li>AWS IAM Best Practices</li> <li>Azure AD Security Best Practices</li> <li>GCP IAM Overview</li> </ul>"},{"location":"4.Eradication/4.62_Validate_Persistence_Mechanisms_Removed/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with deep operator-focused persistence discovery and removal guidance Leo"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/","title":"4.63 Validate No Unauthorized Network Traffic or Command and Control (C2) Channels Exist (Local, Cloud, Perimeter)","text":""},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#task","title":"Task","text":"<p>Ensure that no unauthorized network traffic, including Command and Control (C2) channels, data exfiltration tunnels, or rogue external communications exist across local, enterprise, cloud, and perimeter environments.</p>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#conditions","title":"Conditions","text":"<p>Given access to endpoint monitoring, perimeter security devices, internal network monitoring, and cloud-native traffic analysis tools.</p>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#standards","title":"Standards","text":"<ul> <li>Monitor and detect unauthorized outbound connections.</li> <li>Detect and analyze potential C2 channels (beaconing, tunneling).</li> <li>Block or mitigate unauthorized traffic paths.</li> <li>Validate remediation and document findings.</li> </ul>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#end-state","title":"End State","text":"<p>All unauthorized network communication paths are identified, blocked/removed, and documented. C2 channels and malicious connections are terminated.</p>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#notes","title":"Notes","text":"<ul> <li>C2 channels can be hidden in HTTP/S, DNS, ICMP, custom protocols.</li> <li>Attackers frequently use cloud-based C2 infrastructure \u2192 monitor cloud traffic closely.</li> <li>DNS and HTTP beaconing are common and often missed without deep analysis.</li> </ul>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#step-1-identify-and-capture-network-traffic-local","title":"Step 1: Identify and Capture Network Traffic (Local)","text":""},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#windows-linux-macos","title":"Windows / Linux / macOS","text":"<p>Use <code>tcpdump</code> (Linux/macOS) or <code>Wireshark</code> (Windows/Linux/macOS):</p> <pre><code>sudo tcpdump -nn -i eth0\n</code></pre> <p>or</p> <pre><code># Windows using PowerShell (requires capture tool installed)\nGet-NetTCPConnection\n</code></pre> <p>Look for:</p> <ul> <li>Connections to rare or suspicious IP ranges</li> <li>High-frequency, low-data connections (beaconing behavior)</li> <li>Connections to non-standard ports (ex: 8080, 8443, 53 DNS tunneling)</li> </ul> <p>Operator Note: Sort by destination \u2192 identify \"outlier\" traffic not used by other systems.</p>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#step-2-review-perimeter-firewall-and-proxy-logs","title":"Step 2: Review Perimeter Firewall and Proxy Logs","text":""},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#firewalls-idsips-examples-palo-alto-fortinet-cisco","title":"Firewalls / IDS/IPS (Examples: Palo Alto, Fortinet, Cisco)","text":"<ul> <li>Export traffic/session logs (ex: PAN \u2192 Monitor \u2192 Traffic)</li> <li>Search for:</li> <li>Outbound traffic to unusual countries or cloud hosts</li> <li>Non-standard ports outbound (IRC/FTP/DNS over HTTP)</li> <li>Incomplete sessions / repeated connections</li> </ul>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#web-proxy-logs-squid-zscaler-cloud-swg","title":"Web Proxy Logs (Squid, Zscaler, Cloud SWG)","text":"<ul> <li>Look for:</li> <li>Unclassified / anonymizer categories</li> <li>Suspicious User-Agents (curl, python-requests, powershell)</li> </ul> <pre><code>grep -i \"CONNECT\" /var/log/squid/access.log\n</code></pre> <p>Operator Note: Proxies block many exfil attempts \u2192 validate proxy coverage.</p>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#step-3-review-endpoint-dns-requests-dns-tunneling-beaconing","title":"Step 3: Review Endpoint DNS Requests (DNS Tunneling / Beaconing)","text":""},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#windows","title":"Windows","text":"<pre><code>Get-DnsClientCache\n</code></pre>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#linuxmacos","title":"Linux/macOS","text":"<pre><code>dig +short &lt;domain&gt;\n</code></pre>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#siem","title":"SIEM","text":"<pre><code># Example Splunk\nindex=dns sourcetype=dns\n| stats count by query\n| sort -count\n</code></pre> <p>Look for:</p> <ul> <li>High volumes of DNS TXT or NULL queries</li> <li>Long/random domain names (DGA - Domain Generation Algorithm)</li> <li>Domains resolving outside expected providers</li> </ul> <p>Operator Note: DNS is frequently used for stealth \u2192 validate against approved DNS domains.</p>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#step-4-review-cloud-provider-network-logs","title":"Step 4: Review Cloud Provider Network Logs","text":""},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#aws-vpc-flow-logs-guardduty","title":"AWS \u2192 VPC Flow Logs + GuardDuty","text":"<pre><code>aws ec2 describe-flow-logs\naws guardduty list-findings\n</code></pre> <p>Look for:</p> <ul> <li>Cross-region and cross-account traffic</li> <li>Outbound traffic to suspicious ASNs or regions</li> <li>GuardDuty findings \u2192 C2 or exfiltration alerts</li> </ul>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#azure-nsg-flow-logs-defender-for-cloud","title":"Azure \u2192 NSG Flow Logs + Defender for Cloud","text":"<pre><code>Get-AzNetworkWatcherFlowLog\n</code></pre> <p>Look for:</p> <ul> <li>Outbound to internet (especially from sensitive resources)</li> <li>Unused ports/protocols</li> </ul> <p>Azure Sentinel:</p> <pre><code>AzureNetworkAnalytics_CL\n| where FlowType_s == \"Outbound\"\n| summarize count() by DestinationIP_s\n</code></pre>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#gcp-vpc-flow-logs-security-command-center","title":"GCP \u2192 VPC Flow Logs + Security Command Center","text":"<pre><code>gcloud compute networks subnets list\ngcloud compute instances list --filter=\"EXTERNAL_IP:*\"\n</code></pre> <p>Look for:</p> <ul> <li>Instances with external IP and open ports</li> <li>Traffic to unusual destinations or ports</li> </ul> <p>Operator Note: Cloud-native IDS/IPS (GuardDuty, Defender, SCC) should be reviewed for automated detections.</p>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#step-5-investigate-suspicious-connections","title":"Step 5: Investigate Suspicious Connections","text":"<ul> <li>Validate destination \u2192 ASN/WHOIS (country, host provider)</li> <li>Check IP/domain against Threat Intelligence (VirusTotal, AbuseIPDB)</li> <li>Correlate with endpoint \u2192 process / user responsible for connection</li> </ul> <p>Operator Note: In-memory malware or LOLBins (Living Off the Land Binaries) often perform C2.</p>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#step-6-block-and-remediate","title":"Step 6: Block and Remediate","text":""},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#firewall-proxy","title":"Firewall / Proxy","text":"<ul> <li>Create block rules for confirmed malicious IPs/domains.</li> <li>Update DNS filtering to block malicious domains.</li> </ul>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#edrendpoint","title":"EDR/Endpoint","text":"<ul> <li>Terminate malicious processes (CrowdStrike, Defender ATP).</li> <li>Isolate endpoint if active compromise detected.</li> </ul>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#cloud","title":"Cloud","text":""},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#aws","title":"AWS","text":"<pre><code>aws ec2 modify-instance-attribute --instance-id i-1234567890abcdef0 --no-source-dest-check\naws ec2 stop-instances --instance-ids i-1234567890abcdef0\n</code></pre>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#azure","title":"Azure","text":"<pre><code>Stop-AzVM -ResourceGroupName \"RG\" -Name \"VM\"\n</code></pre>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#gcp","title":"GCP","text":"<pre><code>gcloud compute instances stop INSTANCE_NAME\n</code></pre> <p>Operator Note: Quarantine or shutdown \u2192 safest route for active C2 channels.</p>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#step-7-validate-and-document","title":"Step 7: Validate and Document","text":"<ul> <li>Recheck for ongoing connections.</li> <li>Validate new firewall/proxy blocks are active.</li> <li>Document IP/Domain, destination, process/user, action taken.</li> </ul>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#dependencies","title":"Dependencies","text":"<ul> <li>Access to network traffic logs and endpoint telemetry</li> <li>Perimeter firewall, proxy, SIEM, and cloud native security tools</li> <li>Threat Intelligence feeds</li> </ul>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage Wireshark / tcpdump Cross-platform Native Packet capture Splunk / Sentinel / Elastic SIEM Native Network telemetry search AWS GuardDuty AWS Native Threat detection Azure Sentinel + Defender Azure Native Threat detection GCP SCC + VPC Flow Logs GCP Native Threat detection"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Capture live endpoint traffic \u2192 identify suspicious outbound connections.</li> <li> Review firewall/proxy logs \u2192 search for non-standard or unauthorized connections.</li> <li> Validate DNS activity \u2192 look for beaconing or DGA domains.</li> <li> Review cloud traffic logs (AWS, Azure, GCP) \u2192 identify external or cross-region C2 paths.</li> <li> Investigate and validate \u2192 threat intelligence and local context.</li> <li> Block confirmed malicious traffic paths.</li> <li> Validate removal and update documentation.</li> </ul>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#best-practices","title":"Best Practices","text":"<ul> <li>Block known bad IPs/domains at perimeter (automated feeds).</li> <li>Alert on any outbound connections using rare ports/protocols.</li> <li>Use cloud-native IDS/IPS where available.</li> <li>Perform regular threat hunting for C2 indicators.</li> </ul>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#references","title":"References","text":"<ul> <li>MITRE ATT&amp;CK \u2192 Command and Control</li> <li>AWS GuardDuty</li> <li>Azure Sentinel Network Monitoring</li> <li>GCP Security Command Center</li> </ul>"},{"location":"4.Eradication/4.63_Validate_No_Unauthorized_Network_Traffic/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with deep operator-focused C2 and unauthorized traffic detection/removal workflow Leo"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/","title":"4.64 Validate No Unauthorized or Unsanctioned Accounts or API Keys Remain (Local, Cloud - IAM, Service Accounts, API Tokens)","text":""},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#task","title":"Task","text":"<p>Identify and remove unauthorized, stale, or over-permissive user accounts, service accounts, and API credentials across local systems and cloud environments (AWS, Azure, GCP).</p>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#conditions","title":"Conditions","text":"<p>Given access to local system account lists, AD accounts, cloud IAM and API credential stores.</p>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#standards","title":"Standards","text":"<ul> <li>Enumerate and validate all accounts and API keys.</li> <li>Identify unauthorized, inactive, or stale accounts.</li> <li>Remove or disable unauthorized or high-risk accounts and credentials.</li> <li>Document all actions.</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#end-state","title":"End State","text":"<p>All unauthorized accounts and API credentials are identified, disabled/removed, and fully documented.</p>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#notes","title":"Notes","text":"<ul> <li>API keys and service accounts often get overlooked \u2192 attackers use them for persistence and data exfiltration.</li> <li>Orphaned and stale accounts create privilege escalation opportunities.</li> <li>OAuth tokens and personal access tokens (PATs) can bypass traditional controls.</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#step-1-enumerate-local-system-and-active-directory-accounts","title":"Step 1: Enumerate Local System and Active Directory Accounts","text":""},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#windows-local","title":"Windows Local","text":"<pre><code>Get-LocalUser\n</code></pre> <p>Look for:</p> <ul> <li>Disabled = False</li> <li>LastLogonDate is old or never logged in</li> <li>Unknown users</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#linuxmacos-local","title":"Linux/macOS Local","text":"<pre><code>cat /etc/passwd\n</code></pre> <p>Look for:</p> <ul> <li>UID &gt;= 1000</li> <li>Home directory anomalies (empty, /dev/null)</li> <li>Shell = /bin/bash or other active shells (exclude /sbin/nologin)</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#active-directory","title":"Active Directory","text":"<pre><code>Get-ADUser -Filter * -Properties LastLogonDate, Enabled | Select-Object Name, Enabled, LastLogonDate\n</code></pre> <p>Look for:</p> <ul> <li>Users with no logon in 90+ days</li> <li>Disabled users that still exist</li> <li>Service accounts with interactive login enabled</li> </ul> <p>Operator Note: Use AD group memberships to help identify high privilege accounts \u2192 validate necessity.</p>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#step-2-enumerate-api-keys-and-service-accounts-aws","title":"Step 2: Enumerate API Keys and Service Accounts - AWS","text":""},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#list-iam-users-and-access-keys","title":"List IAM Users and Access Keys","text":"<pre><code>aws iam list-users\naws iam list-access-keys --user-name USERNAME\n</code></pre> <p>Look for:</p> <ul> <li>Access keys with last used = N/A or old</li> <li>Users not tied to workload or people (ghost users)</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#identify-long-lived-api-keys","title":"Identify Long-Lived API Keys","text":"<pre><code>aws iam get-access-key-last-used --access-key-id KEY_ID\n</code></pre> <p>Look for:</p> <ul> <li>Keys not used in last 90+ days</li> <li>Non-rotated keys (older than policy allows)</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#identify-iam-roles-and-attached-policies","title":"Identify IAM Roles and Attached Policies","text":"<pre><code>aws iam list-roles\naws iam list-role-policies --role-name ROLENAME\n</code></pre> <p>Look for:</p> <ul> <li>Roles with \"*\" or wildcard permissions</li> <li>Roles not used recently or unknown use case</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#step-3-enumerate-api-keys-and-service-accounts-azure","title":"Step 3: Enumerate API Keys and Service Accounts - Azure","text":""},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#azure-ad-users-and-applications","title":"Azure AD Users and Applications","text":"<pre><code>Get-AzADUser\nGet-AzADServicePrincipal\n</code></pre> <p>Look for:</p> <ul> <li>Accounts with \"Owner\" or \"Global Admin\"</li> <li>Service Principals not used or unknown origin</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#application-secrets-and-certificates-api-tokens","title":"Application Secrets and Certificates (API Tokens)","text":"<pre><code>Get-AzADAppCredential -ObjectId OBJECT_ID\n</code></pre> <p>Look for:</p> <ul> <li>Expired, non-rotating credentials</li> <li>Apps with risky delegated permissions</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#azure-automation-runas-accounts","title":"Azure Automation RunAs Accounts","text":"<pre><code>Get-AzAutomationAccount\n</code></pre> <p>Look for:</p> <ul> <li>Automation accounts with unnecessary privileged access</li> <li>Stale Automation credentials</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#step-4-enumerate-api-keys-and-service-accounts-gcp","title":"Step 4: Enumerate API Keys and Service Accounts - GCP","text":""},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#iam-service-accounts-and-roles","title":"IAM Service Accounts and Roles","text":"<pre><code>gcloud iam service-accounts list\ngcloud projects get-iam-policy PROJECT_ID\n</code></pre> <p>Look for:</p> <ul> <li>Service accounts with \"Owner\" role</li> <li>External members granted access</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#api-keys","title":"API Keys","text":"<pre><code>gcloud alpha services api-keys list\n</code></pre> <p>Look for:</p> <ul> <li>API keys without restrictions</li> <li>API keys not tied to workload</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#oauth-client-secrets","title":"OAuth Client Secrets","text":"<pre><code>gcloud iam service-accounts keys list --iam-account SERVICE_ACCOUNT_EMAIL\n</code></pre> <p>Look for:</p> <ul> <li>Service account keys older than rotation policy</li> <li>Unknown owners</li> </ul> <p>Operator Note: API keys and service accounts are frequently exploited for lateral movement in cloud.</p>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#step-5-validate-and-investigate-accounts-keys","title":"Step 5: Validate and Investigate Accounts / Keys","text":"<ul> <li>Validate account and key ownership \u2192 contact owners</li> <li>Cross-reference with asset and workload inventories</li> <li>Review usage logs \u2192 CloudTrail (AWS), Activity Logs (Azure), Admin Activity (GCP)</li> </ul> <p>Operator Note: Absence of recent use + unknown owner = High Risk \u2192 escalate for removal.</p>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#step-6-remove-or-disable-unauthorized-or-unused-accounts-keys","title":"Step 6: Remove or Disable Unauthorized or Unused Accounts / Keys","text":""},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#local","title":"Local","text":""},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#windows","title":"Windows","text":"<pre><code>Disable-LocalUser -Name \"username\"\nRemove-LocalUser -Name \"username\"\n</code></pre>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#linuxmacos","title":"Linux/macOS","text":"<pre><code>sudo usermod -L username\nsudo userdel username\n</code></pre>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#active-directory_1","title":"Active Directory","text":"<pre><code>Disable-ADAccount -Identity \"username\"\nRemove-ADUser -Identity \"username\"\n</code></pre>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#aws","title":"AWS","text":"<pre><code>aws iam delete-user --user-name USERNAME\naws iam delete-access-key --user-name USERNAME --access-key-id KEYID\naws iam delete-role --role-name ROLENAME\n</code></pre>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#azure","title":"Azure","text":"<pre><code>Remove-AzADUser -ObjectId USERID\nRemove-AzADServicePrincipal -ObjectId OBJECTID\n</code></pre>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#gcp","title":"GCP","text":"<pre><code>gcloud iam service-accounts delete SERVICE_ACCOUNT_EMAIL\ngcloud alpha services api-keys delete KEY_ID\n</code></pre>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#step-7-validate-removal-and-document","title":"Step 7: Validate Removal and Document","text":"<ul> <li>Validate in consoles and CLI \u2192 confirm removal.</li> <li>Review audit logs for confirmation.</li> <li>Document removed accounts, owner, justification, and approver.</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#dependencies","title":"Dependencies","text":"<ul> <li>Access to local OS user administration</li> <li>Active Directory management privileges</li> <li>Cloud IAM admin roles (AWS, Azure, GCP)</li> <li>Approved user and API credential inventory</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage PowerShell Windows Built-in AD + local account validation AWS CLI Cross-platform Package manager IAM + access keys Azure CLI / PowerShell Cross-platform Package manager Azure AD + app credentials GCloud CLI Cross-platform Package manager IAM + API keys CloudTrail / Sentinel / Security Command Center Cloud Native API and credential usage audit"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Enumerate local, AD, and cloud accounts + credentials.</li> <li> Validate owner, usage, and need.</li> <li> Identify and flag unauthorized or inactive accounts + credentials.</li> <li> Disable and remove unauthorized credentials.</li> <li> Validate removal and document actions.</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#best-practices","title":"Best Practices","text":"<ul> <li>Enforce strong rotation policies \u2192 API keys, secrets.</li> <li>Disable before deleting where possible.</li> <li>Require ownership metadata on all IAM objects.</li> <li>Implement automated stale credential detection (SIEM, CSPM).</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#references","title":"References","text":"<ul> <li>AWS IAM Best Practices</li> <li>Azure Identity Security</li> <li>GCP IAM Overview</li> </ul>"},{"location":"4.Eradication/4.64_Validate_Unsanctioned_Accounts_APIs/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with deep operator guidance across local, AD, cloud IAM + API credentials Leo"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/","title":"4.65 Validate All Malware, Implants, and Webshells Have Been Removed (Local, Web, Cloud)","text":""},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#task","title":"Task","text":"<p>Ensure that no malware, implants, or webshells remain across local systems, web-facing assets, and cloud environments following eradication actions.</p>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#conditions","title":"Conditions","text":"<p>Given access to endpoint protection platforms (AV/EDR), forensic tools, web file systems, and cloud-native detection and scanning capabilities.</p>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#standards","title":"Standards","text":"<ul> <li>Enumerate all local, web, and cloud workloads.</li> <li>Detect unauthorized binaries, scripts, implants, and webshells.</li> <li>Remove and validate removal of malicious artifacts.</li> <li>Document actions taken and confirm eradication.</li> </ul>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#end-state","title":"End State","text":"<p>All identified malware, implants, and webshells are removed and validated as eradicated across all environments.</p>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#notes","title":"Notes","text":"<ul> <li>Webshells often survive typical antivirus scans \u2192 manual inspection required.</li> <li>Cloud VMs, buckets, and storage may retain malicious scripts unnoticed.</li> <li>Memory-resident implants require advanced forensic detection (EDR, memory forensics).</li> </ul>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#step-1-enumerate-local-malware-and-implants","title":"Step 1: Enumerate Local Malware and Implants","text":""},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#run-full-avedr-scans","title":"Run Full AV/EDR Scans","text":"Platform Recommended Tools Windows Defender AV (Full Scan), CrowdStrike, SentinelOne Linux ClamAV, YARA, Sophos, EDR tools macOS XProtect, Malwarebytes, EDR tools <pre><code># Windows Defender Example\nStart-MpScan -ScanType FullScan\n</code></pre> <pre><code># Linux ClamAV Example\nclamscan -r / --bell -i\n</code></pre> <p>Look for:</p> <ul> <li>Known malware</li> <li>Potentially unwanted programs (PUPs)</li> <li>Obfuscated or packed binaries</li> </ul> <p>Operator Note: Ensure EDR policies allow for aggressive scanning and detection.</p>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#detect-fileless-or-memory-resident-malware-advanced","title":"Detect Fileless or Memory Resident Malware (Advanced)","text":""},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#memory-analysis-volatility-or-edr-memory-scan","title":"Memory Analysis (Volatility or EDR Memory Scan)","text":"<pre><code>volatility -f memorydump.raw --profile=Win10x64_18362 pslist\n</code></pre> <p>Look for:</p> <ul> <li>Suspicious or unsigned processes</li> <li>Injected DLLs</li> <li>PowerShell running without visible tasks</li> </ul> <p>Operator Note: EDR consoles (CrowdStrike, SentinelOne) offer built-in memory analysis.</p>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#step-2-enumerate-web-facing-malware-and-webshells","title":"Step 2: Enumerate Web-facing Malware and Webshells","text":""},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#web-server-file-integrity-check","title":"Web Server File Integrity Check","text":"<pre><code>find /var/www -type f -exec md5sum {} \\; &gt; files.md5\n# Compare to known-good baseline\n</code></pre> <p>Look for:</p> <ul> <li>Recently modified PHP/ASP/JS files</li> <li>Files with obfuscated variable names or base64 encoding</li> <li>Files with upload or eval functions</li> </ul>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#webshell-detection-tools","title":"Webshell Detection Tools","text":"<pre><code># Linux - LMD (Linux Malware Detect)\nmaldet -a /var/www\n\n# Windows IIS\nSearch for *.asp;*.aspx files with unknown owners/modification times\n</code></pre> <p>Operator Note: Use YARA rules to detect known webshell patterns.</p>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#analyze-web-server-access-logs","title":"Analyze Web Server Access Logs","text":"<pre><code>cat /var/log/apache2/access.log | grep -i \"cmd=\"\n</code></pre> <p>Look for:</p> <ul> <li>URLs with suspicious parameters (cmd=, eval=, exec=)</li> <li>POST requests to static files (ex: jpg, php, txt)</li> </ul>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#step-3-enumerate-cloud-storage-and-compute-malware","title":"Step 3: Enumerate Cloud Storage and Compute Malware","text":""},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#aws","title":"AWS","text":"<pre><code>aws s3 ls s3://bucket-name --recursive\naws s3api list-objects --bucket bucket-name\n</code></pre> <p>Look for:</p> <ul> <li>Executable files (.exe, .sh, .php) stored in public or writable buckets</li> <li>Files uploaded recently or by unknown users</li> </ul>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#guardduty-inspector-findings","title":"GuardDuty / Inspector Findings","text":"<pre><code>aws guardduty list-findings\naws inspector2 list-findings\n</code></pre> <p>Operator Note: GuardDuty Malware Protection scans EBS volumes \u2192 ensure enabled.</p>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#azure","title":"Azure","text":"<pre><code>Get-AzStorageBlob -Container CONT -Context $ctx\n</code></pre> <p>Look for:</p> <ul> <li>Executables or scripts in blob storage</li> <li>Public blobs with risky content</li> </ul>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#defender-for-cloud","title":"Defender for Cloud","text":"<ul> <li>Review recommendations \u2192 malware detected or suspected</li> </ul>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#gcp","title":"GCP","text":"<pre><code>gcloud storage buckets list\ngcloud storage objects list --bucket BUCKET_NAME\n</code></pre> <p>Look for:</p> <ul> <li>Suspicious file extensions in storage</li> <li>Publicly accessible storage objects</li> </ul>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#security-command-center","title":"Security Command Center","text":"<ul> <li>Review active findings \u2192 malware flagged or anomalous access</li> </ul>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#step-4-remove-identified-malware-implants-and-webshells","title":"Step 4: Remove Identified Malware, Implants, and Webshells","text":""},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#local","title":"Local","text":"<pre><code># Windows\nRemove-Item -Path \"C:\\Path\\to\\Malware.exe\" -Force\n\n# Linux/macOS\nrm /path/to/malware.sh\n</code></pre>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#web-servers","title":"Web Servers","text":"<pre><code>rm /var/www/html/suspiciousfile.php\n</code></pre>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#cloud","title":"Cloud","text":""},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#aws_1","title":"AWS","text":"<pre><code>aws s3 rm s3://bucket-name/suspicious-file.php\n</code></pre>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#azure_1","title":"Azure","text":"<pre><code>Remove-AzStorageBlob -Container CONT -Blob suspicious.php -Context $ctx\n</code></pre>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#gcp_1","title":"GCP","text":"<pre><code>gcloud storage objects delete suspicious-file.php --bucket=BUCKET_NAME\n</code></pre> <p>Operator Note: Validate backups to ensure malware/webshells are not reintroduced during recovery.</p>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#step-5-validate-and-document","title":"Step 5: Validate and Document","text":"<ul> <li>Re-run AV/EDR, YARA scans after removal</li> <li>Validate web directories \u2192 no unknown PHP/ASP files remain</li> <li>Validate cloud storage \u2192 empty of malicious files</li> <li>Document removed artifacts \u2192 filename, path, owner, detection method</li> </ul>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#dependencies","title":"Dependencies","text":"<ul> <li>AV/EDR software and full scan capabilities</li> <li>Web server file access</li> <li>Cloud provider access and malware detection features</li> <li>YARA rulesets and file integrity baselines</li> </ul>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage YARA Cross-platform Package manager Malware/webshell pattern scanning ClamAV / maldet Linux Package manager On-demand file scanning EDR platforms (CrowdStrike, SentinelOne) Enterprise Native Memory + disk scanning AWS GuardDuty / Inspector AWS Native Malware detection Azure Defender for Cloud Azure Native Malware detection GCP Security Command Center GCP Native Malware detection"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Run full AV/EDR scans on all local systems.</li> <li> Review and validate memory for implants (EDR/Volatility).</li> <li> Enumerate web directories \u2192 remove unauthorized webshells.</li> <li> Enumerate cloud storage \u2192 remove unauthorized binaries and scripts.</li> <li> Validate removal with secondary scans.</li> <li> Document all malware/webshell discoveries and removal actions.</li> </ul>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#best-practices","title":"Best Practices","text":"<ul> <li>Use YARA rules regularly \u2192 detect custom malware/webshells.</li> <li>Enable malware protection features in cloud-native security tools.</li> <li>Perform periodic web and file integrity monitoring.</li> <li>Quarantine suspicious files instead of deleting immediately for forensic review.</li> </ul>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#references","title":"References","text":"<ul> <li>YARA Pattern Matching</li> <li>AWS GuardDuty Malware Protection</li> <li>Azure Defender for Servers</li> <li>GCP Security Command Center</li> </ul>"},{"location":"4.Eradication/4.65_Validate_Malware_Removal/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with deep operator-focused eradication + web/cloud malware validation Leo"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/","title":"4.66 Validate Critical Security Controls and Monitoring Are Restored and Operational (EDR, SIEM, Cloud Security Tools)","text":""},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#task","title":"Task","text":"<p>Ensure that all critical security controls (EDR, SIEM, Cloud Security Tools) are restored and operational following eradication and recovery activities.</p>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#conditions","title":"Conditions","text":"<p>Given access to endpoint agents, SIEM platforms, and cloud-native security services across all environments.</p>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#standards","title":"Standards","text":"<ul> <li>Validate EDR agent deployment, heartbeat, and policy enforcement.</li> <li>Validate SIEM log ingestion from all critical sources.</li> <li>Validate cloud-native security tooling is enabled and functioning.</li> <li>Validate alerting and response workflows.</li> <li>Document validation and remediation actions.</li> </ul>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#end-state","title":"End State","text":"<p>All critical security controls and monitoring platforms are fully restored, tested, and confirmed operational.</p>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#notes","title":"Notes","text":"<ul> <li>Systems may lose security controls during reimaging or remediation \u2192 revalidation is critical.</li> <li>Cloud-native tools must be re-enabled on rebuilt workloads.</li> <li>Alerting and response workflows should be tested before closure.</li> </ul>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#step-1-validate-edr-agent-coverage-and-health","title":"Step 1: Validate EDR Agent Coverage and Health","text":""},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#validate-agent-deployment","title":"Validate Agent Deployment","text":"Platform EDR Example Windows/Linux/macOS CrowdStrike, SentinelOne, Defender ATP"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#crowdstrike-example","title":"CrowdStrike Example","text":"<pre><code>sudo /opt/CrowdStrike/falconctl -g --aid\n</code></pre> <p>Look for:</p> <ul> <li>Agent ID assigned</li> <li>Last check-in time</li> </ul>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#microsoft-defender-atp","title":"Microsoft Defender ATP","text":"<p>Portal \u2192 Device Inventory \u2192 Filter \u2192 Agent Status \u2192 Active/Inactive</p> <p>Look for:</p> <ul> <li>Devices marked as Active</li> <li>No devices reporting stale</li> </ul> <p>Operator Note: Contact IT to redeploy agents on missing systems.</p>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#validate-policy-enforcement","title":"Validate Policy Enforcement","text":"<ul> <li>Run EICAR or benign test \u2192 confirm detection</li> <li>Validate protection policies are applied via console</li> </ul> <p>Operator Note: Disabled or outdated policies must be corrected immediately.</p>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#step-2-validate-siem-log-ingestion","title":"Step 2: Validate SIEM Log Ingestion","text":"SIEM Method Splunk Search <code>index=* earliest=-5m</code> Sentinel Workbook or Log Analytics \u2192 Query last 5 min Elastic Discover \u2192 Time range last 5 min <p>Look for:</p> <ul> <li>Recent logs from:</li> <li>Domain Controllers</li> <li>File Servers</li> <li>Security appliances</li> <li>Endpoints</li> </ul> <p>Operator Note: Any major log source not appearing \u2192 escalate to IT/logging engineer.</p>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#validate-alerting","title":"Validate Alerting","text":"<ul> <li>Generate test events (login failure, fake malware detection)</li> <li>Confirm SIEM rules trigger alerts</li> </ul> <p>Example in Splunk:</p> <pre><code>index=wineventlog EventCode=4625\n</code></pre> <p>Operator Note: Coordinate with SOC to validate end-to-end alert pipeline.</p>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#step-3-validate-cloud-security-tools-aws-azure-gcp","title":"Step 3: Validate Cloud Security Tools (AWS, Azure, GCP)","text":""},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#aws-guardduty-and-security-hub","title":"AWS \u2192 GuardDuty and Security Hub","text":"<pre><code>aws guardduty get-detector --detector-id DETECTOR_ID\n</code></pre> <p>Look for:</p> <ul> <li>Enabled = True</li> </ul> <p>Check Console:</p> <ul> <li>GuardDuty findings \u2192 confirm ingestion</li> <li>Security Hub \u2192 confirm no disabled controls</li> </ul> <p>Operator Note: If disabled \u2192 enable GuardDuty and Security Hub.</p>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#azure-defender-for-cloud","title":"Azure \u2192 Defender for Cloud","text":"<pre><code>Get-AzSecurityPricing\n</code></pre> <p>Look for:</p> <ul> <li>Pricing tier = Standard (Defender enabled)</li> </ul> <p>Check Portal:</p> <ul> <li>Defender recommendations \u2192 confirm telemetry</li> <li>Sentinel \u2192 confirm ingestion</li> </ul> <p>Operator Note: Ensure Defender for Servers and Defender for Identity are enabled.</p>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#gcp-security-command-center-cloud-logging","title":"GCP \u2192 Security Command Center + Cloud Logging","text":"<pre><code>gcloud scc findings list\ngcloud logging read \"timestamp &gt;= \\\"2025-05-01T00:00:00Z\\\"\"\n</code></pre> <p>Look for:</p> <ul> <li>Recent findings \u2192 active security scanning</li> <li>Logs from compute/storage/network</li> </ul> <p>Operator Note: Review SCC \u2192 ensure not in \"Unconfigured\" state.</p>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#step-4-validate-cross-system-alert-and-response-workflow","title":"Step 4: Validate Cross-System Alert and Response Workflow","text":"<ul> <li>Simulate security event across endpoint or cloud (benign).</li> <li>Validate alert flows:</li> <li>Detected \u2192 SIEM \u2192 SOC notification</li> <li>Detected \u2192 Cloud security platform \u2192 Alerting channel (email, Slack, PagerDuty)</li> </ul> <p>Operator Note: Validate who gets notified \u2192 SOC, IR team, management.</p>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#step-5-validate-and-document","title":"Step 5: Validate and Document","text":"<ul> <li>Validate no missing agents, log gaps, or disabled controls.</li> <li>Capture screenshots or log exports of healthy status.</li> <li>Document validation actions, results, and any remediations performed.</li> </ul>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#dependencies","title":"Dependencies","text":"<ul> <li>Access to EDR management consoles</li> <li>Access to SIEM search consoles</li> <li>Cloud security platform administrative access</li> <li>Ability to trigger test/benign security events</li> </ul>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage EDR Consoles Cross-platform Native Validate agent status SIEM (Splunk, Sentinel, Elastic) Cross-platform Native Validate log ingestion AWS CLI + GuardDuty + Security Hub AWS Package manager Validate cloud security Azure CLI + Defender for Cloud + Sentinel Azure Package manager Validate cloud security GCP CLI + Security Command Center GCP Package manager Validate cloud security"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate endpoint EDR agent deployment and policy enforcement.</li> <li> Validate SIEM log ingestion for critical log sources.</li> <li> Validate cloud-native security tool status (AWS, Azure, GCP).</li> <li> Validate alerting pipeline \u2192 simulate detection and confirm notification.</li> <li> Document validation results and escalate gaps.</li> </ul>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#best-practices","title":"Best Practices","text":"<ul> <li>Enable heartbeat monitoring on EDR to catch dropped agents.</li> <li>Integrate cloud security tool alerts into SIEM.</li> <li>Maintain source-to-SIEM mapping \u2192 identify ingestion gaps fast.</li> <li>Perform quarterly security control validation exercises.</li> </ul>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#references","title":"References","text":"<ul> <li>AWS GuardDuty</li> <li>Azure Defender for Cloud</li> <li>GCP Security Command Center</li> </ul>"},{"location":"4.Eradication/4.66_Validate_Critical_Security_Controls_Monitoring/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with operator-focused validation of EDR, SIEM, and cloud-native security controls Leo"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/","title":"4.67 Validate Clean Backups Exist and Recovery Procedures Are Ready (Local, Cloud, SaaS)","text":""},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#task","title":"Task","text":"<p>Ensure clean, malware-free backups exist across local, cloud, and SaaS environments, and that recovery procedures are documented, validated, and executable.</p>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#conditions","title":"Conditions","text":"<p>Given access to backup management consoles, storage platforms, cloud-native backup services, and SaaS backup solutions.</p>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#standards","title":"Standards","text":"<ul> <li>Verify existence and completeness of backups.</li> <li>Confirm backup integrity and malware-free status.</li> <li>Confirm retention meets organizational policies.</li> <li>Validate and document recovery procedures.</li> <li>Test recovery process (where feasible) to confirm readiness.</li> </ul>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#end-state","title":"End State","text":"<p>Confirmed existence of clean and usable backups with documented and validated recovery procedures across local, cloud, and SaaS environments.</p>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#notes","title":"Notes","text":"<ul> <li>Backups made during infection periods may be contaminated \u2192 malware scans required.</li> <li>Backups should be immutable or air-gapped where possible.</li> <li>SaaS often requires separate backup tools \u2192 validate retention and export capabilities.</li> </ul>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#step-1-validate-local-and-enterprise-backups","title":"Step 1: Validate Local and Enterprise Backups","text":""},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#common-platforms-veeam-commvault-rubrik-veritas","title":"Common Platforms \u2192 Veeam, Commvault, Rubrik, Veritas","text":"<ul> <li>Access backup management console</li> <li>Validate:</li> <li>Last successful backup dates</li> <li>Backup jobs completed without errors</li> <li>Backup destinations \u2192 no errors/missing targets</li> </ul> <p>Operator Note: Stale or failed backup jobs must be re-run.</p>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#validate-malware-free-status","title":"Validate Malware-Free Status","text":"<ul> <li>Select sample backups (recent + critical systems).</li> <li>Restore to isolated/test environment.</li> <li>Run full AV/EDR scan on restored files.</li> </ul> <pre><code>clamscan -r /restore/location\n</code></pre> <p>Operator Note: Backups from infection window \u2192 higher priority for scanning.</p>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#validate-retention-and-offsite-copies","title":"Validate Retention and Offsite Copies","text":"<ul> <li>Confirm retention settings meet policy.</li> <li>Validate offsite/immutable copies exist.</li> </ul> <pre><code># Example Veeam immutable backup chain check (GUI or CLI)\nGet-VBRBackup | Select-Object Name, IsImmutable\n</code></pre> <p>Operator Note: Immutable or offline backups should be prioritized during recovery.</p>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#step-2-validate-cloud-backups","title":"Step 2: Validate Cloud Backups","text":""},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#aws-backup-and-snapshots","title":"AWS \u2192 Backup and Snapshots","text":"<pre><code>aws backup list-backup-vaults\naws backup list-recovery-points-by-backup-vault --backup-vault-name VaultName\n</code></pre> <p>Look for:</p> <ul> <li>Recent successful recovery points</li> <li>No expired or missing critical workloads</li> </ul>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#validate-malware-free-backups-optional-scan-restore-and-av-scan","title":"Validate Malware-Free Backups (Optional Scan \u2192 Restore and AV Scan)","text":"<ul> <li>Restore EC2 snapshot into isolated VPC</li> <li>Run AV/EDR scan on restored instance</li> </ul> <pre><code>aws ec2 create-volume --snapshot-id snap-xxxx --availability-zone us-east-1a\n</code></pre> <p>Operator Note: Enable AWS Backup Vault Lock \u2192 immutable backups.</p>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#azure-azure-backup","title":"Azure \u2192 Azure Backup","text":"<pre><code>Get-AzRecoveryServicesVault\nGet-AzRecoveryServicesBackupItem\n</code></pre> <p>Look for:</p> <ul> <li>Latest recovery points</li> <li>No errors in backup jobs</li> </ul> <p>Validate by:</p> <ul> <li>Performing test restore \u2192 isolated VM or disk</li> <li>Running AV scan after recovery</li> </ul>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#gcp-cloud-storage-snapshots-backup-for-gke","title":"GCP \u2192 Cloud Storage / Snapshots / Backup for GKE","text":"<pre><code>gcloud compute snapshots list\ngcloud storage ls\n</code></pre> <p>Look for:</p> <ul> <li>Latest snapshots available</li> <li>No errors or gaps</li> </ul> <p>Restore + Validate:</p> <ul> <li>Create disk from snapshot \u2192 attach to test VM</li> <li>Run AV scan on recovered data</li> </ul> <p>Operator Note: Validate bucket object versioning and retention policies for ransomware protection.</p>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#step-3-validate-saas-application-backups","title":"Step 3: Validate SaaS Application Backups","text":""},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#m365-google-workspace-salesforce-saas-backup-tools-veeam-druva-backupify","title":"M365, Google Workspace, Salesforce \u2192 SaaS Backup Tools (Veeam, Druva, Backupify)","text":"<ul> <li>Access SaaS backup portal</li> <li>Confirm:</li> <li>Backup success \u2192 latest backup date/time</li> <li>No job failures</li> <li>Retention policies active</li> </ul> <p>Validate recovery capability:</p> <ul> <li>Perform test restore of emails/files/documents to sandbox or alternate account.</li> </ul> <p>Operator Note: Confirm SaaS admins are familiar with recovery procedures.</p>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#step-4-validate-recovery-procedures-and-playbooks","title":"Step 4: Validate Recovery Procedures and Playbooks","text":"<ul> <li>Review and confirm documented recovery playbooks exist.</li> <li>Validate:</li> <li>Personnel aware and trained</li> <li>Playbook up to date \u2192 reflecting current environment and backup platform</li> <li>Recovery priorities aligned with Business Continuity Plan (BCP)</li> </ul> <p>Perform tabletop or live recovery test:</p> <ul> <li>Select sample workload (non-critical preferred).</li> <li>Execute recovery plan end-to-end.</li> <li>Document results.</li> </ul> <p>Operator Note: Test for speed, completeness, and gaps during recovery exercise.</p>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#step-5-validate-and-document","title":"Step 5: Validate and Document","text":"<ul> <li>Ensure all backups (local, cloud, SaaS) validated.</li> <li>Confirm test recoveries performed and passed.</li> <li>Document validation evidence \u2192 backup job logs, recovery success, AV scans.</li> <li>Update Incident Record.</li> </ul>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#dependencies","title":"Dependencies","text":"<ul> <li>Access to backup software and cloud backup management portals</li> <li>Malware scanning tools (AV/EDR/YARA)</li> <li>Cloud resource access for restore testing</li> <li>SaaS application administrative access</li> </ul>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#other-available-tools","title":"Other Available Tools","text":"Tool Platform Installation Usage EDR / AV (CrowdStrike, Defender) Cross-platform Native Malware validation AWS CLI + Backup + Vault Lock AWS Package manager Cloud backup validation Azure CLI + Recovery Services Vault Azure Package manager Cloud backup validation GCloud CLI + Snapshots + Storage GCP Package manager Cloud backup validation SaaS Backup Consoles (Veeam, Druva) SaaS Native Backup validation + recovery tests"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#operator-recommendations-and-additional-tools","title":"Operator Recommendations and Additional Tools","text":""},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#operator-checklist","title":"Operator Checklist","text":"<ul> <li> Validate local + enterprise backup job success and retention.</li> <li> Malware scan test restores to validate cleanliness.</li> <li> Validate cloud backups \u2192 AWS, Azure, GCP success + malware-free.</li> <li> Validate SaaS backups \u2192 job success + sandbox restores.</li> <li> Validate recovery documentation + personnel readiness.</li> <li> Document validation and gaps.</li> </ul>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#best-practices","title":"Best Practices","text":"<ul> <li>Periodically validate malware-free backups.</li> <li>Use immutable/offsite copies as primary recovery source.</li> <li>Test recovery playbooks at least annually.</li> <li>Integrate backup validation status into incident postmortems.</li> </ul>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#references","title":"References","text":"<ul> <li>AWS Backup Vault Lock</li> <li>Azure Backup Documentation</li> <li>GCP Snapshots</li> </ul>"},{"location":"4.Eradication/4.67_Validate_Clean_Backups_Recovery/#revision-history","title":"Revision History","text":"Date Version Description Author 2025-05-02 1.0 Created from scratch with operator-focused backup and recovery validation workflow Leo"},{"location":"5.Recovery/","title":"5.Recovery","text":""},{"location":"5.Recovery/#recovery-tasks","title":"Recovery Tasks","text":"<p>Develop and implement appropriate activities to maintain plans for resilience and to restore any capabilities or services that were impaired due to a cybersecurity incident.  </p> <p>The Recover Function supports timely recovery to normal operations to reduce the impact from a cybersecurity incident. Examples of outcome Categories within this Function include: Recovery Planning; Improvements; and Communications.</p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/","title":"5.01-Vulnerability Scans","text":""},{"location":"5.Recovery/5.01_Vulnerability_Scans/#task-update-the-initial-supported-mission-partner-mp-vulnerability-assessment-va-scan","title":"Task Update the initial supported Mission Partner (MP) vulnerability assessment (VA) (scan)","text":""},{"location":"5.Recovery/5.01_Vulnerability_Scans/#conditions","title":"Conditions","text":"<p>Given an IR Team deployed supporting a designated MP in Cyber Incident Recovery.  </p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#standards","title":"Standards","text":"<p>In coordination with the supported MP, the DCO-E should:  </p> <ul> <li>Review initial the VA and document any/all changes made to improve security  </li> <li>Conduct a port scan and document deltas with original scans  </li> <li>Conduct a vulnerability scan and document deltas with the original scans  </li> <li>As needed conduct a web application vulnerability scan (e.g. Burp Suite) and document deltas  </li> <li>As needed test firewalls, IDS/IPS, proxies and boundary defense appliance configurations and document deltas  </li> <li>Provide End of Assessment Nessus Report  </li> <li>Additional assessments as needed </li> </ul>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#end-state","title":"End State","text":"<p>The IR Team provides an updated VA &amp; scan to the support mission partner in order to document any actions taken during Eradication and Recovery phases.   </p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#notes","title":"Notes","text":"<p>Depending on the severity and/or complexity of the cyber incident, the DCO-E may consider conducting another full vulnerability assessment. At a minimum, full network/system scans with tools such as NMAP, OpenVAS, NESSUS, orothers is critical.  </p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.01_Vulnerability_Scans/#running-script","title":"Running Script","text":"<p>N/A  </p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#dependencies","title":"Dependencies","text":"<p>N/A  </p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#other-available-tools","title":"Other available tools","text":"<p>N/A  </p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#references","title":"References","text":"<p>NIST Cyber Security Framework NIST SP 800-184: Guide to Cyber Event Recovery US CERT: Cyber Resilience Review Self Assessment Package </p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/","title":"5.02-Cyber Security Improvements","text":""},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#task-provide-cyber-security-improvement-recommendations-to-mission-partner-mp","title":"Task Provide cyber security improvement recommendations to Mission Partner (MP)","text":""},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#conditions","title":"Conditions","text":"<p>Given an IR Team deployed supporting a designated MP in Cyber Incident Recovery.  </p>"},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#standards","title":"Standards","text":"<p>Upon moving into the Recovery Phase, the DCO-E should review their documentation and findings (from previous port, network, service, and vulnerability scans) to provide improvement recommendations to the MP.  These recommendations may include the following areas:  </p> <ul> <li>Unauthorized Devices  </li> <li>Unauthorized Software  </li> <li>Hardware and Software Configurations  </li> <li>Vulnerability Assessments and Remediation  </li> <li>Administrative Privileges  </li> <li>Maintenance, Monitoring, and Analysis of Logs  </li> <li>Email and Web Browser  </li> <li>Malware Defense  </li> <li>Management of Network Ports  </li> <li>Data Recovery  </li> <li>Network Device Configurations  </li> <li>Boundary Defense  </li> <li>Data Protection  </li> <li>Need to Know Access  </li> <li>Wireless Access  </li> <li>User Account Management  </li> <li>User Cyber Security Training  </li> <li>Application Software Security  </li> <li>Incident Response Management  </li> <li>Cyber Security Exercises  </li> </ul> <p>The IR Team should provide recommendations in a format agreed upon with the supported MP.  </p>"},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#end-state","title":"End State","text":"<p>IR Team provides written recommendations to the supported MP on improving their cyber security posture (minimum focus on the network defense plan).  </p>"},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#notes","title":"Notes","text":"<p>Providing cyber security improvement recommendations begins with solid documentation of vulnerabilities identified upon arriving on site.  </p>"},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#references","title":"References","text":"<p>NIST Cyber Security Framework NIST SP 800-184: Guide to Cyber Event Recovery US CERT: Cyber Resilience Review Self Assessment Package</p>"},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/","title":"5.03-Firewall Analysis","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#task-review-firewall-rules-and-logs-ensure-mfa-is-enabled-for-all-user-access","title":"Task Review firewall rules and logs. Ensure MFA is enabled for all user access","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#conditions","title":"Conditions","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#standards","title":"Standards","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#end-state","title":"End State","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#notes","title":"Notes","text":"<p>Incomplete  </p>"},{"location":"5.Recovery/5.03_Firewall_Analysis/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#references","title":"References","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.04_Password_Requirements/","title":"5.04-Password Requirements","text":""},{"location":"5.Recovery/5.04_Password_Requirements/#task-password_requirements-define-and-implement-best-password-policies-and-practices","title":"Task Password_Requirements: Define and implement best password policies and practices","text":""},{"location":"5.Recovery/5.04_Password_Requirements/#conditions","title":"Conditions","text":"<p>Given a network, implement stronger password policies  </p>"},{"location":"5.Recovery/5.04_Password_Requirements/#standards","title":"Standards","text":"<p>Upon moving into the Recovery Phase, the IR Team should recommend stronger password policies  </p> <ul> <li>Remove Periodic Password Change Requirements</li> <li>Use A Password Manager</li> <li>Recommend the use of a secure Password Manager (i.e. KeePass, LastPass, etc.)</li> <li>Minimum Password Length</li> <li>Ensure password length of at least 8 characters in accordance with NIST standards.</li> <li>Encourage the use of passphrases (a string if words that makes a password long and memorable)</li> <li>Implement Screening of New Passwords</li> <li>When processing requests to establish and change memorized secrets, verifiers SHALL compare the prospective secrets against a list that contains values known to be commonly-used, expected, or compromised. For example, the list MAY include, but is not limited to:  </li> </ul> <p>Passwords obtained from previous breach corpuses.  </p> <ul> <li>Dictionary words  </li> <li>Repetitive or sequential characters (e.g. <code>aaaaaa</code>, <code>1234abcd</code>)  </li> <li>Context-specific words, such as the name of the service, the username, and derivatives thereof  </li> </ul>"},{"location":"5.Recovery/5.04_Password_Requirements/#end-state","title":"End State","text":"<p>The IR Team provides secure password policies to implement  </p>"},{"location":"5.Recovery/5.04_Password_Requirements/#notes","title":"Notes","text":"<p>N/A  </p>"},{"location":"5.Recovery/5.04_Password_Requirements/#references","title":"References","text":"<p>NIST Special Publication 800-63B </p>"},{"location":"5.Recovery/5.04_Password_Requirements/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.05_Create_new_baselines/","title":"Task Create New Baselines","text":""},{"location":"5.Recovery/5.05_Create_new_baselines/#conditions","title":"Conditions","text":"<p>Create baseline image(s) for the following(s) to meet the compliance against the NIST Moderate standards  </p> <ul> <li>Hosts  </li> <li>Servers  </li> <li>Domain Controller(s)  </li> </ul>"},{"location":"5.Recovery/5.05_Create_new_baselines/#standards","title":"Standards","text":"<ul> <li>All baseline image(s) must be checked to verify that no critical and high vulnerabilities exists in the image at the time of creation.  </li> <li>Run vulnerability analysis (Nessus preferred) of the image with the latest plugins.  </li> <li>This must include workstations, laptops, application servers, and domain controllers.  </li> <li>Use provided Security Content Automation Protocol Tool (SCAP) to achieve baseline image of 70% or greater SCAP score.  </li> </ul>"},{"location":"5.Recovery/5.05_Create_new_baselines/#end-state","title":"End State","text":"<p>All created baseline images must be free of critical/high vulnerabilities AND have 70% or greater SCAP score.  </p>"},{"location":"5.Recovery/5.05_Create_new_baselines/#notes","title":"Notes","text":""},{"location":"5.Recovery/5.05_Create_new_baselines/#manual-steps","title":"Manual Steps","text":"<ul> <li>Load/Install operating system to be used for creating baseline image.  </li> <li>Run security patches and recommended updates.  </li> <li>Ensure that the Vulnerability Scanner (Nessus) has the latest plugins and analyze the baseline image.  </li> <li>Identify and remediate all critical and high findings using the Nessus report(s) remediation guide.  </li> <li>Repeat this process until no critical and high vulnerabilities exist.  </li> <li>It is highly recommended that all vulnerabilities are reviewed and patched according to the agencys' security guidelines, including moderate and low vulnerabilities, to minimize attack surface.  </li> <li>Load Security Content Automation Protocol (SCAP) tool and scan the image.  This process can be done on the image itself or via remote.  </li> <li>Review and remediate findings to further harden the image.  </li> <li>Repeat this process until 70% or better score is achieved.  </li> <li>Save image.  </li> <li>Test out new image in small sets in multiple departments prior to mass rollout.  </li> </ul>"},{"location":"5.Recovery/5.05_Create_new_baselines/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.05_Create_new_baselines/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.05_Create_new_baselines/#references","title":"References","text":"<p>DISA SCAP Content </p>"},{"location":"5.Recovery/5.05_Create_new_baselines/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.06_Syslog_Retention/","title":"Task Syslog_Retention","text":""},{"location":"5.Recovery/5.06_Syslog_Retention/#conditions","title":"Conditions","text":"<p>The agency will generate and retain audit logs for a period of 6 months or longer.  </p>"},{"location":"5.Recovery/5.06_Syslog_Retention/#standards","title":"Standards","text":"<p>Must provide logs for the following for 6 months:  </p> <ul> <li>Firewall Events  </li> <li>DNS ingress and egress logs  </li> <li>Domain Controller Events  </li> <li>Intrusion Detection/Protection Events  </li> <li>Web Usage  </li> </ul>"},{"location":"5.Recovery/5.06_Syslog_Retention/#end-state","title":"End State","text":"<p>Retain all logs identified for 6 months (minimum) to meet the incident response requirements.  </p>"},{"location":"5.Recovery/5.06_Syslog_Retention/#notes","title":"Notes","text":""},{"location":"5.Recovery/5.06_Syslog_Retention/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.06_Syslog_Retention/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.06_Syslog_Retention/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.06_Syslog_Retention/#references","title":"References","text":""},{"location":"5.Recovery/5.06_Syslog_Retention/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.07_Patch_Management/","title":"Task Patch Management and continuous monitoring","text":""},{"location":"5.Recovery/5.07_Patch_Management/#conditions","title":"Conditions","text":"<p>Create task(s) to continuously perform vulnerability scans of all assets.  Identify and remediate all critical and high vulnerabilities more than 30 days.  </p>"},{"location":"5.Recovery/5.07_Patch_Management/#standards","title":"Standards","text":"<ul> <li>Perform authenticated (domain privileged, local admin, root) scans.  </li> <li>All assets on the network must scanned.  </li> <li>All assets must be scanned monthly.  </li> <li>Vulnerability scan signature (plugins) must be updated within 15 days of the scan.  </li> </ul>"},{"location":"5.Recovery/5.07_Patch_Management/#end-state","title":"End State","text":"<p>Must produce proof of recurring patch management and continuous monitoring.  </p> <ul> <li>Vulnerability scan history of 2 months  </li> <li>Patch management history of 2 months  </li> <li>No critical and high risk vulnerabilities detected over 30 days of detection  </li> </ul>"},{"location":"5.Recovery/5.07_Patch_Management/#notes","title":"Notes","text":""},{"location":"5.Recovery/5.07_Patch_Management/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.07_Patch_Management/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.07_Patch_Management/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.07_Patch_Management/#references","title":"References","text":"<p>NIST 800-53 NIST 800-171 </p>"},{"location":"5.Recovery/5.07_Patch_Management/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.08_User_Cyber_Training/","title":"Task User-Cyber-Training","text":""},{"location":"5.Recovery/5.08_User_Cyber_Training/#conditions","title":"Conditions","text":"<p>Provide users monthly and yearly training  </p> <ul> <li>Cyber Security Awareness Training  </li> <li>Phishing Security Training  </li> </ul>"},{"location":"5.Recovery/5.08_User_Cyber_Training/#standards","title":"Standards","text":"<p>All new and existing users are to complete annual cyber training in order to obtain network access.  </p> <p>Training certification(s) are good for one year and must be nenewed prior to the expiration date.  </p> <p>All user accounts without current certifications will be disabled until all requirements are met.  </p>"},{"location":"5.Recovery/5.08_User_Cyber_Training/#end-state","title":"End State","text":"<p>Emphasize the importance of cyber security  and raise awareness for all employees.  </p>"},{"location":"5.Recovery/5.08_User_Cyber_Training/#notes","title":"Notes","text":""},{"location":"5.Recovery/5.08_User_Cyber_Training/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.08_User_Cyber_Training/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.08_User_Cyber_Training/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.08_User_Cyber_Training/#references","title":"References","text":""},{"location":"5.Recovery/5.08_User_Cyber_Training/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.09_System_Restoration/","title":"Task","text":""},{"location":"5.Recovery/5.09_System_Restoration/#conditions","title":"Conditions","text":""},{"location":"5.Recovery/5.09_System_Restoration/#standards","title":"Standards","text":""},{"location":"5.Recovery/5.09_System_Restoration/#end-state","title":"End State","text":""},{"location":"5.Recovery/5.09_System_Restoration/#notes","title":"Notes","text":""},{"location":"5.Recovery/5.09_System_Restoration/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.09_System_Restoration/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.09_System_Restoration/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.09_System_Restoration/#references","title":"References","text":""},{"location":"5.Recovery/5.09_System_Restoration/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.10_Account_Audit/","title":"Task Account Audit","text":""},{"location":"5.Recovery/5.10_Account_Audit/#conditions","title":"Conditions","text":"<p>Review standard and privilege accounts to identify and remediate users with access beyond daily operations.  </p>"},{"location":"5.Recovery/5.10_Account_Audit/#standards","title":"Standards","text":"<p>In accordance with Principle of Least Permissions, privileged roles and standard roles must to reviewed on regular basis.    </p> <p>Privileged and Standard roles(accounts) should have minimum permissions to allow daily operations. All privilege accounts should be separate per roles.  (i.e.  Domain Admins - DA-username, Servers - svc-username,   DNS - dns-username)  </p> <ul> <li> <p>Privilege roles (100% Check monthly)  </p> <ul> <li>Enterprise administrators  </li> <li>Domain Administrators  </li> <li>Power Users  </li> <li>HelpDesk  </li> <li>Service Accounts  </li> <li>DNS Administrators  </li> <li>Other  </li> </ul> </li> <li> <p>Standard Roles (20% Check quarterly)  </p> <ul> <li>All standard role accounts with separate privilege role accounts should be checked montly.  </li> </ul> </li> </ul>"},{"location":"5.Recovery/5.10_Account_Audit/#end-state","title":"End State","text":"<p>Agency free of standard users accounts with privilege roles. Separation of privilege roles (DNS, DA, Enterprise, etc)  </p>"},{"location":"5.Recovery/5.10_Account_Audit/#notes","title":"Notes","text":""},{"location":"5.Recovery/5.10_Account_Audit/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.10_Account_Audit/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.10_Account_Audit/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.10_Account_Audit/#references","title":"References","text":"<p>NIST 800-53 AC-6 NIST 800-171 (3.1.5) </p>"},{"location":"5.Recovery/5.10_Account_Audit/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/","title":"5.11-Turn over Mission related Documents","text":""},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/#task-turn-over-mission-related-documents-turn-over-incident-mission-related-documentation-to-the-supported-mission-partner-mp","title":"Task Turn Over Mission Related Documents: Turn-Over incident mission-related documentation to the supported Mission Partner (MP).","text":""},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/#conditions","title":"Conditions","text":"<p>Given an IR Team deployed supporting a designated MP in Cyber Incident Recovery.  </p>"},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/#standards","title":"Standards","text":"<p>Upon moving into the Recovery Phase, the IR Team should gather and prepare the following items for turn-over to the supported mission partner:  </p> <ul> <li>Mission Logs  </li> <li>Accounts Added  </li> <li>Ports Opened  </li> <li>Software Installed  </li> <li>Network Maps  </li> <li>System and Network Configuration Information  </li> <li>Team Chats   </li> <li>Emails  </li> <li>Wall Notes  </li> <li>System Logs  </li> <li>Packet Captures  </li> <li>Malware Samples  </li> <li>Others  </li> </ul> <p>This list is not exhaustive. If the IR Team produces it during mission, it should be considered an artifact and turned over to the supported MP.  </p>"},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/#end-state","title":"End State","text":"<p>The IR Team provides all mission logs, journals, and incident response artifacts to the supported MP in keeping with any Non-Disclosure Agreement stipulations.  The IR Team Team Leader ensures that team members do not keep any response related documentation unless approved by the supported MP for future training opportunities.  </p>"},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/#notes","title":"Notes","text":"<p>IR Team personnel should be aware that during incident response that any/all notes, logs, journals, diagrams, etc... that they create belong to the supported MP.  It is imperative that this policy be strictly followed to ensure trust is maintained with the supported MP.  </p>"},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/#references","title":"References","text":"<p>NIST Cyber Security Framework NIST SP 800-184: Guide to Cyber Event Recovery </p>"},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.12_Creating_Clean_Backups/","title":"5.12-Creating Clean Backups","text":""},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#creating-clean-backups-task","title":"Creating Clean Backups Task","text":""},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#conditions","title":"Conditions","text":"<p>Establish a plan to prevent/recover from an incident escalating to a disaster.  </p>"},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#standards","title":"Standards","text":"<p>Create back-ups to minimize downtime in a catastrophic event using the 3-2-1 rule.</p>"},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#end-state","title":"End State","text":""},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#notes","title":"Notes","text":""},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#manual-steps","title":"Manual Steps","text":"<ul> <li>Make three copies of every piece of important data so that no single event will wipeout all the data.  </li> <li>Make two different formats such as external media, network, cloud.  </li> <li>Keep one copy offsite in case of physical disasters like theft, fire, earthquake, etc.  </li> </ul>"},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#references","title":"References","text":"<p>NIST Guide to General Server Security SANS Backup Whitepaper CISA Data Backup Options </p>"},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.13-Conduct_Outbriefing/","title":"5.13-Conduct Outbriefing","text":""},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#conduct-outbriefing-of-mission-partner-mp-task","title":"Conduct Outbriefing of Mission Partner (MP) Task","text":""},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#conditions","title":"Conditions","text":"<p>Given a IR Team deployed supporting a designated MP in a completed Cyber Incident Recovery.  </p>"},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#standards","title":"Standards","text":"<p>A mission out briefing should be conducted to inform MP of the completed cyber incident recovery mission. During this briefing, the following items should be included in briefing:  </p> <ul> <li>After Action Review (containing follow up report and lessons learned)  </li> <li>Lessons Learned  </li> <li>Question and Answer Session  </li> </ul>"},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#end-state","title":"End State","text":"<p>The IR Team communicates the after-action review report and lessons clearly and concisely to MP. The MP reviews the briefing and asks questions for clarification purposes.  </p>"},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#notes","title":"Notes","text":"<p>The listing in the standards is not exhaustive.  </p>"},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#running-script","title":"Running Script","text":""},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#other-available-tools","title":"Other available tools","text":""},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#references","title":"References","text":"<p>NIST Cyber Security Framework NIST SP 800-61: Computer Security Incident Handling Guide </p>"},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.14-Conduct_AAR/","title":"5.14-Conduct AAR","text":""},{"location":"5.Recovery/5.14-Conduct_AAR/#conduct-after-action-review-to-support-redeployment-efforts-task","title":"Conduct After Action Review to support redeployment efforts Task","text":""},{"location":"5.Recovery/5.14-Conduct_AAR/#conditions","title":"Conditions","text":"<p>Given an IR Team deployed supporting a designated MP in Cyber Incident Recovery.  </p>"},{"location":"5.Recovery/5.14-Conduct_AAR/#standards","title":"Standards","text":"<p>Upon moving into the redeployment Phase, the IR Team should develop an AAR containing the following elements:  </p> <ul> <li>List of Participants  </li> <li>Review key actions/event that occurred during mission  </li> <li>Analysis of Lessons Learned  </li> <li>Remediation plans to prevent this from occurring in the future  </li> <li>Discussion of final indicators of compromise to share for detection of potential incidents across the community  </li> <li>Staff performance review  </li> <li>Corrective actions review  </li> <li>Tool utilization review  </li> <li>Process gaps review  </li> <li>Documentation gaps review  </li> <li>Training review This list is not exhaustive. If the IR Team produces it during mission, it should be considered an artifact and turned over to the supported MP.  </li> </ul>"},{"location":"5.Recovery/5.14-Conduct_AAR/#end-state","title":"End State","text":"<p>The IR Team completes a full after action review with MP. The MP contains knowledge from knowing lessons learned, ways to prevent future incidents, and how to detect an actionable incident.  </p>"},{"location":"5.Recovery/5.14-Conduct_AAR/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.14-Conduct_AAR/#running-script","title":"Running Script","text":""},{"location":"5.Recovery/5.14-Conduct_AAR/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.14-Conduct_AAR/#other-available-tools","title":"Other available tools","text":""},{"location":"5.Recovery/5.14-Conduct_AAR/#references","title":"References","text":"<p>NIST Cyber Security Framework NIST SP 800*61: Computer Security Incident Handling Guide </p>"},{"location":"5.Recovery/5.14-Conduct_AAR/#revision-history","title":"Revision History","text":""},{"location":"6.LessonsLearned/","title":"6.Lessons Learned","text":"<p>After Action Reviews (AARs) are structured debriefings that occur after a particular event or project has concluded. The purpose of AARs is to evaluate the effectiveness of the project or operation and to identify areas for improvement. These reviews are typically conducted by a team that includes key personnel who participated in the event or project. The goal is to have an open and honest discussion about what went well, what did not go well, and what can be done differently in the future. The results of AARs are often used to inform future planning and decision-making, allowing organizations to continuously improve their processes and outcomes. Overall, the purpose of AARs is to promote learning, enhance performance, and drive organizational success.  </p>"},{"location":"6.LessonsLearned/6.01-After_Action_Review/","title":"6.01-After Action Review(AAR)","text":""},{"location":"6.LessonsLearned/6.01-After_Action_Review/#after-action-report-task","title":"After Action Report Task","text":"<p>After any training exercise or event the team should conduct an After Action Review.  This will help improve the process or document any changes in documentation needed.  </p>"},{"location":"6.LessonsLearned/6.01-After_Action_Review/#conditions","title":"Conditions","text":"<p>Given an After Action Report Template, conduct a After Action Review of the event.  </p>"},{"location":"6.LessonsLearned/6.01-After_Action_Review/#standards","title":"Standards","text":""},{"location":"6.LessonsLearned/6.01-After_Action_Review/#end-state","title":"End State","text":"<p>Completed After Action Report for the event.  </p>"},{"location":"6.LessonsLearned/6.01-After_Action_Review/#notes","title":"Notes","text":""},{"location":"6.LessonsLearned/6.01-After_Action_Review/#manual-steps","title":"Manual Steps","text":"<ul> <li>Download the After_Action_Report_Template.docx using the References Link below.  </li> <li>Conduct After Action Review with the team and document the results using the template provided.  </li> <li>Submit After Action Report to coordinating organization.  </li> </ul>"},{"location":"6.LessonsLearned/6.01-After_Action_Review/#running-script","title":"Running Script","text":""},{"location":"6.LessonsLearned/6.01-After_Action_Review/#dependencies","title":"Dependencies","text":""},{"location":"6.LessonsLearned/6.01-After_Action_Review/#other-available-tools","title":"Other available tools","text":""},{"location":"6.LessonsLearned/6.01-After_Action_Review/#references","title":"References","text":"<p>AAR Template DINFOS AAR Template </p>"},{"location":"6.LessonsLearned/6.01-After_Action_Review/#revision-history","title":"Revision History","text":"<p>Note: Place new entries at the top to create a decending list of changes. * 20220213 - Initial document creation  </p>"},{"location":"ReferenceDocuments/","title":"Reference Documents","text":"<p>This section should cover any unique references for commands, tools or any other helpful information that does not fit any where else.  </p>"},{"location":"ReferenceDocuments/PowerShell_Commands/","title":"PowerShell Commands","text":""},{"location":"ReferenceDocuments/PowerShell_Commands/#get-winevent","title":"Get-WinEvent","text":"<p>View all events in the live system Event Log: <pre><code>Get-WinEvent -LogName system\n</code></pre> View all events in the live security Event Log (requires administrator PowerShell): <pre><code>Get-WinEvent -LogName security\n</code></pre> View all events in the file example.evtx, format list (fl) output: <pre><code>Get-WinEvent -Path example.evtx | fl\n</code></pre> View all events in example.evtx, format GridView output: <pre><code>Get-WinEvent -Path example.evtx | Out-GridView\n</code></pre> Perform long tail analysis of example.evtx: <pre><code>Get-WinEvent -Path example.evtx | Group-Object id -NoElement | sort count\n</code></pre> Pull events 7030 and 7045 from system.evtx: <pre><code>Get-WinEvent -FilterHashtable @{Path=\"system.evtx\"; ID=7030,7045}\n</code></pre> Same as above, but use the live system event log: <pre><code>Get-WinEvent -FilterHashtable @{logname=\"system\"; id=7030,7045}\n</code></pre> Search for events containing the string \"USB\" in the file system.evtx: <pre><code>Get-WinEvent -FilterHashtable @{Path=\"system.evtx\"} | Where {$_.Message -like \"*USB*\"}\n</code></pre> 'grep'-style search for lines of events containing the case insensitive string \"USB\" in the file system.evtx: <pre><code>Get-WinEvent -FilterHashtable @{Path=\"system.evtx\"} | fl | findstr /i USB\n</code></pre> Pull all errors (level=2) from application.evtx: <pre><code>Get-WinEvent -FilterHashtable @{Path=\"application.evtx\"; level=2}\n</code></pre> Pull all errors (level=2) from application.evtx and count the number of lines ('wc'-style): <pre><code>Get-WinEvent -FilterHashtable @{Path=\"application.evtx\"; level=2} | Measure-Object -Line\n</code></pre> Export Event Logs to CSV format <pre><code># Define the path to the directory where your event log files are stored\n$logDirectory = \"patch to log files\"\n\n# Loop through each event log file in the directory\nGet-ChildItem $logDirectory -Filter *.evtx | ForEach-Object {\n    $logPath = $_.FullName\n\n    # Define the output path for the CSV file\n    $csvPath = \"$logDirectory\\$($_.BaseName).csv\"\n\n    # Export the event log to a CSV file\n    Get-WinEvent -Path $logPath | Select-Object * -ExcludeProperty ContainerLog | Export-Csv $csvPath -NoTypeInformation\n}\n</code></pre></p>"},{"location":"ReferenceDocuments/PowerShell_Commands/#applocker","title":"AppLocker","text":"<p>Pull all AppLocker logs from the live AppLocker event log (requires Applocker): <pre><code>Get-WinEvent -logname \"Microsoft-Windows-AppLocker/EXE and DLL\"\n</code></pre> Search for live AppLocker EXE/MSI block events: \"(EXE) was prevented from running\": <pre><code>Get-WinEvent -FilterHashtable @{logname=\"Microsoft-Windows-Applocker/EXE and DLL\"; id=8004}\n</code></pre> Search for live AppLocker EXE/MSI audit events: \"(EXE) was allowed to run but would have been prevented from running if the AppLocker policy were enforced\": <pre><code>Get-WinEvent -FilterHashtable @{logname=\"Microsoft-Windows-Applocker/EXE and DLL\"; id=8003}\n</code></pre></p>"},{"location":"ReferenceDocuments/PowerShell_Commands/#emet","title":"EMET","text":"<p>Pull all EMET logs from the live Application Event log (requires EMET): <pre><code>Get-WinEvent -FilterHashtable @{logname=\"application\"; providername=\"EMET\"}\n ```  \nPull all EMET logs from a saved Application Event log (requires EMET):  \n```powershell\nGet-WinEvent -FilterHashtable @{path=\"application.evtx\"; providername=\"EMET\"}\n</code></pre></p>"},{"location":"ReferenceDocuments/PowerShell_Commands/#sysmon","title":"Sysmon","text":"<p>Pull all Sysmon logs from the live Sysmon Event log (requires Sysmon and an admin PowerShell): <pre><code>Get-WinEvent -LogName \"Microsoft-Windows-Sysmon/Operational\"\n</code></pre> Pull Sysmon event ID 1 from the live Sysmon Event log <pre><code>Get-WinEvent -FilterHashtable @{logname=\"Microsoft-Windows-Sysmon/Operational\"; id=1}\n</code></pre></p>"},{"location":"ReferenceDocuments/PowerShell_Commands/#windows-defender","title":"Windows Defender","text":"<p>Pull all live Windows Defender event logs <pre><code>Get-WinEvent -FilterHashtable @{logname=\"Microsoft-Windows-Windows Defender/Operational\"}\n</code></pre> Pull Windows Defender event logs 1116 and 1117 from the live event log <pre><code>Get-WinEvent -FilterHashtable @{logname=\"Microsoft-Windows-Windows Defender/Operational\";id=1116,1117}\n</code></pre> Pull Windows Defender event logs 1116 (malware detected) and 1117 (malware blocked) from a saved evtx file <pre><code>Get-WinEvent -FilterHashtable @{path=\"WindowsDefender.evtx\";id=1116,1117}\n</code></pre></p>"},{"location":"ReferenceDocuments/PowerShell_Commands/#references","title":"References","text":"<p>SANS PowerShell Reference SANS PowerShell Reference GitHub </p>"},{"location":"ReferenceDocuments/PowerShell_Commands/#revision-history","title":"Revision History","text":"<ul> <li>20230127 - Initial creation  </li> </ul>"}]}