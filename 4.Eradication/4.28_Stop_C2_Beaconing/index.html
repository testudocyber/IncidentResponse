<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ir.cnd.ca.gov/4.Eradication/4.28_Stop_C2_Beaconing/">
      
      
        <link rel="prev" href="../4.27_Stop_malware_backdoor/">
      
      
        <link rel="next" href="../4.30_Security_Onion_Hunting/">
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>4.28-Stop C2 Beaconing - Incident Response</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    

  <!-- Extra style sheets (can't be set in mkdocs.yml due to content hash) -->
  <link
    rel="stylesheet"
    href="../../assets/stylesheets/custom.css"
  />

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#428-stop-c2-beaconing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            

          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Incident Response" class="md-header__button md-logo" aria-label="Incident Response" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Incident Response
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              4.28-Stop C2 Beaconing
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/cmdcnd/IncidentResponse" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../1.Preparation/" class="md-tabs__link">
          
  
  
    
  
  1.Preparation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../2.Identification/" class="md-tabs__link">
          
  
  
    
  
  2.Identification

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../3.Containment/" class="md-tabs__link">
          
  
  
    
  
  3.Containment

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  4.Eradication

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../5.Recovery/" class="md-tabs__link">
          
  
  
    
  
  5.Recovery

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../6.LessonsLearned/" class="md-tabs__link">
          
  
  
    
  
  6.Lessons Learned

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ReferenceDocuments/" class="md-tabs__link">
          
  
  
    
  
  Reference Documents

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Incident Response" class="md-nav__button md-logo" aria-label="Incident Response" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    Incident Response
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cmdcnd/IncidentResponse" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../1.Preparation/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    1.Preparation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            1.Preparation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.01-Troop_Leading_Procedures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.01-Troop Leading Procedures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.02-Receive_Mission/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.02-Receive Mission
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.03-Personnel_Status/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.03-Personnel Status
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.04-Legal_Support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.04-Legal Support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.05-Partner_Engagements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.05-Partner Engagements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.06-Create_and_Execute_IR_Orders/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.06-Create and Execute IR Orders
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.07-Integrate_Additional_Support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.07-Integrate Additional Support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.08-Mission_Intent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.08-Mission Intent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.09-Continuous_AARs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.09-Continuous AAR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.10-Incident_Tracking_and_Reporting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.10-Incident Tracking and Reporting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.13-Review_Information_Security_Policies_Constraint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.13-Review Information Security Policies Constraint
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.14-Request_Logs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.14-Request Logs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.15-Interview_Network_Owner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.15-Interview Network Owner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.16-Establish Network Owner Priorities Objectives
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.17-Establish_Mission_Log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.17-Establish Mission Log
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.17-Establish_Mission_Log" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.17.1-Establish Mission Log Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.18-Request_Network_Accounts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.18-Request Network Accounts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.19-Legal Authorities Regulatory Constraints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1.Preparation/Preparation_References" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Preparation References
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../2.Identification/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    2.Identification
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            2.Identification
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.01-Review Organizational Processes and Conduct a site survey
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.02-Create_Active_IP_List/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.02-Create Active IP List
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/2.Identification/2.02-Create_Active_IP_List/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.02Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.03-DNS_Host_Name_Mapping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.03-DNS Host Name Mapping
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/2.Identification/2.03-DNS_Host_Name_Mapping/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.03Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.04-Active_Host_and_Service_Enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.04-Active Host and Service Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/2.Identification/2.04-Active_Host_and_Service_Enumeration/README.md/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.04Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.05-Active_IP_List_on_Key_Ports/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.05-Active IP List on Key Ports
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/2.Identification/2.05-Active_IP_List_on_Key_Ports/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.05Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.06-All_Port_Scan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.06-All Port Scan
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/2.Identification/2.06-All_Port_Scan/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.06Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.07-Scan_ICS_Equipment_Ports/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.07-Scan ICS Equipment Ports
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/2.Identification/2.07-Scan_ICS_Equipment_Ports/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.07Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.08-Conduct_Vulnerability_Scan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.08-Perform Vulnerability Scan
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.11-Determine_Installed_Software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.11-Determine Installed Software
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/2.Identification/2.11-Determine_Installed_Software/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.11Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.12-Perform_SCAP_Configuration_Scan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.12-Perform SCAP Configuration Scan
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.13-Perform_STIG_Scan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.13-Perform STIG SCAN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.14-Gather_AD_Structure_Information/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.14-Gather AD Structure Information
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/2.Identification/2.14-Gather_AD_Structure_Information/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.14Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.15-AD_Configuration_Scan_with_Powershell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.15-AD Configuration Scan with Powershell
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/2.Identification/2.15-AD_Configuration_Scan_with_Powershell/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.15Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.16-List_all_AD_Domain_Accounts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.16-List AD Domain Accounts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/2.Identification/2.16-List_all_AD_Domain_Accounts/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.16Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.17-Scan_Device_For_Default_Admin_Password/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.17-Scan Device for Default Admin Password
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.18-Review_Organizational_User_Policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.18-Review Organizational User Policies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2.Identification/2.19-Create_firewall_rule_list/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.19-Create Firewall Rule List
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/2.Identification/2.19-Create_firewall_rule_list/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.19Files
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../3.Containment/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    3.Containment
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            3.Containment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.Containment/3.01_Export_users_from_Active_Directory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.01-Export Users from Active Directory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.Containment/3.02_Export_groups_from_Active_Directory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.02-Export Groups from Active Directory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.03-Export Group Policy Objects from Active Directory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.04-Export Trust Relationship from Active Directory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.Containment/3.05_Export_OU_Structure_from_Active_Directory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.05-Export-OU Structure from Active Directory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.Containment/3.06_Monitor_AD_New_Account_Creation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.06-Monitor Active Directory New Account Creation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/3.Containment/3.06_Monitor_AD_New_Account_Creation/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.06Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.Containment/3.07_Create_team_admin_account_in_AD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.07-Create Team Admin Account in Active Directory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.Containment/3.08_Change_Domain_Administrator_account/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.08-Change Domain Administrator Account
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.Containment/3.09_Disable_Domain_Administrator_password/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.09-Disable Domain Administrator Account
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.10-Change or Disable Workstation Local Administrators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3.Containment/3.11_Verify_patch_compliance_on_all_hosts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.11-Verify Patch Compliance on all hosts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    4.Eradication
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            4.Eradication
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.01_Synchronize_all_host_clocks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.01-Synchronize Time on all hosts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.02_Enable_Account_Usage_Auditing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.02-Enable Account Usage Auditing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/4.Eradication/4.02_Enable_Account_Usage_Auditing/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.02Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.03_Deploy_network_intrusion_detection_system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.03-Deploy Network Intrusion Detection System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/4.Eradication/4.03_Deploy_network_intrusion_detection_system/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.03Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.04_Monitor_NIDS_and_Report_Threats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.04-Monitor NIDS and Report Threats
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.05_SIEM_Events_to_IDS_and_network_logs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.05-SIEM Events to IDS and Network Logs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.06-Evaluate Host Kernel to check for Rootkits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.07-Use Host Log Data to Evaluate System Processes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.07Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.08_Deploy_or_evaluate_host_sensors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.08-Deploy or Evaluate Host Sensors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/4.Eradication/4.08_Deploy_or_evaluate_host_sensors/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.08Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.09_Install_and_Deploy_Security_Onion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.09-Install and Deploy Security Onion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.10_PAN_Forward_Syslog_SO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.10-PAN Forward Syslog to SecurityOnion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.11_Monitoring_account_creation_SO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.11-Monitoring Account Creation using SecurityOnion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.12_Detect_network_vulnerability_scans_SO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.12-Detect Network Vulnerability Scans using SecurityOnion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.13_Detect_SMB_using_SO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.13-Detect SMB using SecurityOnion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.14_Monitor_AD_New_Account_Creation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.14-Monitor Active Directory New Account Creation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.15_Monitor_DHCP_for_new_reservations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.15-Monitor DHCP for New Reservations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.16_Monitor_AD_for_new_DNS_names/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.16-Monitor Active Directory for New DNS Names
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.17_Respond_to_alerts_about_unauthorized_users/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.17-Respond to Alerts about unauthorized users
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.18_Compare_hashes_of_suspected_malware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.18-Compare Hashes of suspected malware
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.19_Perform_manual_host_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.19-Perform Manual Host Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.19.1-Perform Manual Host Analysis Live Physical Host Windows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.19.2-Perform Manual Host Analysis Memory Image File
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.19.3-Create Hard Disk Image
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.20_Investigate_Alerts_From_Host_Sensors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.20-Investigate Alerts from Host Sensors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.21_Find_and_contain_rogue_workstations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.21-Find and Contain Rogue Workstation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.22_Block_unauthorized_software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.22-Block Unauthorized Software
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.23_Stop_Credential_reuse_attack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.23-Stop Credential Reuse Attack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.24_Stop_brute_force_attack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.24-Stop Brute Force Attack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.25_Stop_malware_rootkit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.25-Stop Malware Rootkit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.26_Stop_data_exfiltration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.26-Stop Data Exfiltration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.27_Stop_malware_backdoor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.27-Stop Malware Backdoor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/4.Eradication/4.27_Stop_malware_backdoor/scripts" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.27Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    4.28-Stop C2 Beaconing
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    4.28-Stop C2 Beaconing
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    <span class="md-ellipsis">
      Task
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Conditions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#standards" class="md-nav__link">
    <span class="md-ellipsis">
      Standards
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#end-state" class="md-nav__link">
    <span class="md-ellipsis">
      End State
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manual-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Steps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Manual Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-detect-beaconing" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1 → Detect Beaconing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 1 → Detect Beaconing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-network-tools-zeek-wireshark-siem" class="md-nav__link">
    <span class="md-ellipsis">
      Using Network Tools (Zeek, Wireshark, SIEM)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using Network Tools (Zeek, Wireshark, SIEM)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-zeek-command" class="md-nav__link">
    <span class="md-ellipsis">
      Example Zeek command:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suspicious-dns-example" class="md-nav__link">
    <span class="md-ellipsis">
      Suspicious DNS Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-edr-av-telemetry" class="md-nav__link">
    <span class="md-ellipsis">
      Using EDR / AV Telemetry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-dns-server-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Using DNS Server Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-isolate-infected-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2 → Isolate Infected Hosts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2 → Isolate Infected Hosts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edr-isolation" class="md-nav__link">
    <span class="md-ellipsis">
      EDR Isolation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-isolation" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Isolation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-block-malicious-domains-and-ips" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3 → Block Malicious Domains and IPs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 3 → Block Malicious Domains and IPs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flush-dns-cache-local" class="md-nav__link">
    <span class="md-ellipsis">
      Flush DNS Cache (Local)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-at-dns-sinkhole" class="md-nav__link">
    <span class="md-ellipsis">
      Block at DNS (Sinkhole)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Block at DNS (Sinkhole)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-dns" class="md-nav__link">
    <span class="md-ellipsis">
      Windows DNS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-bind" class="md-nav__link">
    <span class="md-ellipsis">
      Linux (Bind)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aws-route53-azure-dns" class="md-nav__link">
    <span class="md-ellipsis">
      AWS Route53 / Azure DNS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-at-network-firewall" class="md-nav__link">
    <span class="md-ellipsis">
      Block at Network Firewall
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-remove-malware-backdoors-related-to-beaconing" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4 → Remove Malware Backdoors (Related to Beaconing)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4 → Remove Malware Backdoors (Related to Beaconing)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows" class="md-nav__link">
    <span class="md-ellipsis">
      Windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macos" class="md-nav__link">
    <span class="md-ellipsis">
      macOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    <span class="md-ellipsis">
      Linux
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-monitor-and-validate" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5 → Monitor and Validate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-script-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Running Script Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running Script Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#block-domain-via-hosts-file-quick-block" class="md-nav__link">
    <span class="md-ellipsis">
      Block Domain via Hosts File (Quick Block)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-ip-via-firewall-linux" class="md-nav__link">
    <span class="md-ellipsis">
      Block IP via Firewall (Linux)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Dependencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-available-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Other Available Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operator-recommendations-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Operator Recommendations and Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operator Recommendations and Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operator-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      Operator Checklist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#revision-history" class="md-nav__link">
    <span class="md-ellipsis">
      Revision History
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.30_Security_Onion_Hunting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.30-SecurityOnion Hunting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/4.Eradication/4.30_Security_Onion_Hunting/EventLogExamples" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.30Files
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../5.Recovery/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    5.Recovery
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            5.Recovery
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5.Recovery/5.01_Vulnerability_Scans/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.01-Vulnerability Scans
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5.Recovery/5.02_Cyber-Security-Improvements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.02-Cyber Security Improvements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5.Recovery/5.03_Firewall_Analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.03-Firewall Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5.Recovery/5.04_Password_Requirements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.04-Password Requirements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5.Recovery/5.05_Create_new_baselines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.05-Create New Baselines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5.Recovery/5.06_Syslog_Retention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.06-Syslog Retention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5.Recovery/5.07_Patch_Management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.07-Patch Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5.Recovery/5.08_User_Cyber_Training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.08-User Cyber Training
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5.Recovery/5.09_System_Restoration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.09-System Restoration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5.Recovery/5.10_Account_Audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.10-Account Audit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5.Recovery/5.11_Turn_Over_Mission_Related_Documents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.11-Turn over Mission related Documents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5.Recovery/5.12_Creating_Clean_Backups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.12-Creating Clean Backups
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5.Recovery/5.13-Conduct_Outbriefing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.13-Conduct Outbriefing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5.Recovery/5.14-Conduct_AAR/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.14-Conduct AAR
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../6.LessonsLearned/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    6.Lessons Learned
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            6.Lessons Learned
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../6.LessonsLearned/6.01-After_Action_Review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6.01-After Action Review(AAR)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/cmdcnd/IncidentResponse/tree/main/docs/6.LessonsLearned/6.01-After_Action_Review/templates" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6.01Files
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../ReferenceDocuments/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Reference Documents
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Reference Documents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ReferenceDocuments/PowerShell_Commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PowerShell Commands
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    <span class="md-ellipsis">
      Task
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Conditions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#standards" class="md-nav__link">
    <span class="md-ellipsis">
      Standards
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#end-state" class="md-nav__link">
    <span class="md-ellipsis">
      End State
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manual-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Steps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Manual Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-detect-beaconing" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1 → Detect Beaconing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 1 → Detect Beaconing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-network-tools-zeek-wireshark-siem" class="md-nav__link">
    <span class="md-ellipsis">
      Using Network Tools (Zeek, Wireshark, SIEM)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using Network Tools (Zeek, Wireshark, SIEM)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-zeek-command" class="md-nav__link">
    <span class="md-ellipsis">
      Example Zeek command:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suspicious-dns-example" class="md-nav__link">
    <span class="md-ellipsis">
      Suspicious DNS Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-edr-av-telemetry" class="md-nav__link">
    <span class="md-ellipsis">
      Using EDR / AV Telemetry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-dns-server-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Using DNS Server Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-isolate-infected-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2 → Isolate Infected Hosts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2 → Isolate Infected Hosts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edr-isolation" class="md-nav__link">
    <span class="md-ellipsis">
      EDR Isolation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-isolation" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Isolation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-block-malicious-domains-and-ips" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3 → Block Malicious Domains and IPs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 3 → Block Malicious Domains and IPs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flush-dns-cache-local" class="md-nav__link">
    <span class="md-ellipsis">
      Flush DNS Cache (Local)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-at-dns-sinkhole" class="md-nav__link">
    <span class="md-ellipsis">
      Block at DNS (Sinkhole)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Block at DNS (Sinkhole)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-dns" class="md-nav__link">
    <span class="md-ellipsis">
      Windows DNS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-bind" class="md-nav__link">
    <span class="md-ellipsis">
      Linux (Bind)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aws-route53-azure-dns" class="md-nav__link">
    <span class="md-ellipsis">
      AWS Route53 / Azure DNS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-at-network-firewall" class="md-nav__link">
    <span class="md-ellipsis">
      Block at Network Firewall
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-remove-malware-backdoors-related-to-beaconing" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4 → Remove Malware Backdoors (Related to Beaconing)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4 → Remove Malware Backdoors (Related to Beaconing)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows" class="md-nav__link">
    <span class="md-ellipsis">
      Windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macos" class="md-nav__link">
    <span class="md-ellipsis">
      macOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    <span class="md-ellipsis">
      Linux
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-monitor-and-validate" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5 → Monitor and Validate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-script-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Running Script Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running Script Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#block-domain-via-hosts-file-quick-block" class="md-nav__link">
    <span class="md-ellipsis">
      Block Domain via Hosts File (Quick Block)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-ip-via-firewall-linux" class="md-nav__link">
    <span class="md-ellipsis">
      Block IP via Firewall (Linux)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Dependencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-available-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Other Available Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operator-recommendations-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Operator Recommendations and Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operator Recommendations and Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operator-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      Operator Checklist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#revision-history" class="md-nav__link">
    <span class="md-ellipsis">
      Revision History
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/cmdcnd/IncidentResponse/edit/main/docs/4.Eradication/4.28_Stop_C2_Beaconing/README.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/cmdcnd/IncidentResponse/raw/main/docs/4.Eradication/4.28_Stop_C2_Beaconing/README.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="428-stop-c2-beaconing">4.28 Stop C2 Beaconing<a class="headerlink" href="#428-stop-c2-beaconing" title="Permanent link">&para;</a></h1>
<h2 id="task">Task<a class="headerlink" href="#task" title="Permanent link">&para;</a></h2>
<p>Stop Command and Control (C2) Beaconing</p>
<hr />
<h2 id="conditions">Conditions<a class="headerlink" href="#conditions" title="Permanent link">&para;</a></h2>
<ul>
<li>Given a network environment with potential malware infections or unauthorized backdoors</li>
<li>Monitoring tools available to detect and analyze outbound network traffic</li>
<li>Administrative access to DNS, firewall, and endpoint security infrastructure</li>
</ul>
<hr />
<h2 id="standards">Standards<a class="headerlink" href="#standards" title="Permanent link">&para;</a></h2>
<ul>
<li>Detect and identify C2 beaconing behavior using network, DNS, and endpoint analysis.</li>
<li>Identify and document suspicious DNS names, IP addresses, and ports associated with C2 channels.</li>
<li>Block malicious IPs/domains at the firewall, endpoint, and DNS resolver.</li>
<li>Flush DNS caches to prevent re-resolution.</li>
<li>Create DNS sinkhole zones for malicious domains to prevent external resolution.</li>
<li>Remove associated malware/backdoors/persistence mechanisms from infected hosts.</li>
<li>Validate and monitor for beaconing cessation.</li>
</ul>
<hr />
<h2 id="end-state">End State<a class="headerlink" href="#end-state" title="Permanent link">&para;</a></h2>
<ul>
<li>All C2 beaconing activity has ceased.</li>
<li>Suspicious domains no longer resolve externally.</li>
<li>Endpoint persistence mechanisms have been removed.</li>
<li>Network and endpoint telemetry confirms eradication.</li>
<li>IOC and response actions are documented.</li>
</ul>
<hr />
<h2 id="notes">Notes<a class="headerlink" href="#notes" title="Permanent link">&para;</a></h2>
<p><strong>C2 Beaconing Techniques Include:</strong></p>
<ul>
<li>DNS tunneling (subdomain beaconing)</li>
<li>HTTPS encrypted beaconing (POST and GET requests to staging servers)</li>
<li>HTTP non-standard port beaconing (8080, 8443, etc.)</li>
<li>TCP/IP covert channels</li>
<li>Cloud relay infrastructure usage</li>
</ul>
<p><strong>Known Ports and Protocols (Example — Cobalt Strike):</strong></p>
<table>
<thead>
<tr>
<th>Protocol</th>
<th>Port</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>HTTPS (TCP)</td>
<td>443</td>
<td>Default beaconing (encrypted)</td>
</tr>
<tr>
<td>HTTP (TCP)</td>
<td>80</td>
<td>C2 in clear-text</td>
</tr>
<tr>
<td>TCP (custom ports)</td>
<td>50050, 2222, 8080, 8443</td>
<td>Often used in red team or attacker deployments</td>
</tr>
<tr>
<td>DNS (UDP/TCP)</td>
<td>53</td>
<td>DNS beaconing and tunneling</td>
</tr>
</tbody>
</table>
<p>Cobalt Strike — one of the most common commercial/offensive C2 platforms — often uses HTTP/HTTPS and DNS-based beaconing as default profiles.</p>
<hr />
<h2 id="manual-steps">Manual Steps<a class="headerlink" href="#manual-steps" title="Permanent link">&para;</a></h2>
<h3 id="step-1-detect-beaconing">Step 1 → Detect Beaconing<a class="headerlink" href="#step-1-detect-beaconing" title="Permanent link">&para;</a></h3>
<h4 id="using-network-tools-zeek-wireshark-siem">Using Network Tools (Zeek, Wireshark, SIEM)<a class="headerlink" href="#using-network-tools-zeek-wireshark-siem" title="Permanent link">&para;</a></h4>
<ul>
<li>Look for frequent, regular interval outbound connections to unknown domains/IPs.</li>
<li>Review DNS queries → Look for strange subdomains and high entropy.</li>
</ul>
<h5 id="example-zeek-command">Example Zeek command:<a class="headerlink" href="#example-zeek-command" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>zeek<span class="w"> </span>-r<span class="w"> </span>traffic.pcap<span class="w"> </span>dns.log<span class="w"> </span>http.log<span class="w"> </span>conn.log
</code></pre></div>
<h5 id="suspicious-dns-example">Suspicious DNS Example:<a class="headerlink" href="#suspicious-dns-example" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>xyz987dnscommand.c2malicious.net
</code></pre></div>
<h4 id="using-edr-av-telemetry">Using EDR / AV Telemetry<a class="headerlink" href="#using-edr-av-telemetry" title="Permanent link">&para;</a></h4>
<ul>
<li>Detect parent processes generating outbound connections.</li>
<li>Look for svchost.exe, rundll32.exe, or powershell.exe contacting external IPs.</li>
</ul>
<h4 id="using-dns-server-logs">Using DNS Server Logs<a class="headerlink" href="#using-dns-server-logs" title="Permanent link">&para;</a></h4>
<ul>
<li>Windows DNS → Enable and query DNS analytical logs.</li>
<li>BIND/Linux → Review <code>named</code> query logs.</li>
</ul>
<hr />
<h3 id="step-2-isolate-infected-hosts">Step 2 → Isolate Infected Hosts<a class="headerlink" href="#step-2-isolate-infected-hosts" title="Permanent link">&para;</a></h3>
<h4 id="edr-isolation">EDR Isolation<a class="headerlink" href="#edr-isolation" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">falconctl</span> <span class="n">-g</span> <span class="p">-</span><span class="n">-isolation</span>
</code></pre></div>
<h4 id="manual-isolation">Manual Isolation<a class="headerlink" href="#manual-isolation" title="Permanent link">&para;</a></h4>
<ul>
<li>Disable network adapters.</li>
<li>Block outbound access via local firewall rules.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">New-NetFirewallRule</span> <span class="n">-DisplayName</span> <span class="s2">&quot;Block C2 IP&quot;</span> <span class="n">-Direction</span> <span class="n">Outbound</span> <span class="n">-RemoteAddress</span> <span class="p">&lt;</span><span class="n">C2_IP</span><span class="p">&gt;</span> <span class="n">-Action</span> <span class="n">Block</span>
</code></pre></div>
<hr />
<h3 id="step-3-block-malicious-domains-and-ips">Step 3 → Block Malicious Domains and IPs<a class="headerlink" href="#step-3-block-malicious-domains-and-ips" title="Permanent link">&para;</a></h3>
<h4 id="flush-dns-cache-local">Flush DNS Cache (Local)<a class="headerlink" href="#flush-dns-cache-local" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">ipconfig</span> <span class="p">/</span><span class="n">flushdns</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>sudo<span class="w"> </span>systemd-resolve<span class="w"> </span>--flush-caches
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>sudo<span class="w"> </span>killall<span class="w"> </span>-HUP<span class="w"> </span>mDNSResponder
</code></pre></div>
<h4 id="block-at-dns-sinkhole">Block at DNS (Sinkhole)<a class="headerlink" href="#block-at-dns-sinkhole" title="Permanent link">&para;</a></h4>
<h5 id="windows-dns">Windows DNS<a class="headerlink" href="#windows-dns" title="Permanent link">&para;</a></h5>
<ol>
<li>Open DNS Manager.</li>
<li>New Zone → Primary → <code>maliciousdomain.com</code>.</li>
<li>Disable dynamic updates.</li>
<li>Add A record → Point to 127.0.0.1.</li>
</ol>
<h5 id="linux-bind">Linux (Bind)<a class="headerlink" href="#linux-bind" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>zone<span class="w"> </span><span class="s2">&quot;maliciousdomain.com&quot;</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span><span class="nb">type</span><span class="w"> </span>master<span class="p">;</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span>file<span class="w"> </span><span class="s2">&quot;/etc/bind/db.null&quot;</span><span class="p">;</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="o">}</span><span class="p">;</span>
</code></pre></div>
<h5 id="aws-route53-azure-dns">AWS Route53 / Azure DNS<a class="headerlink" href="#aws-route53-azure-dns" title="Permanent link">&para;</a></h5>
<ul>
<li>Create Private Hosted Zone → Add A record → Point to internal IP (blocking exfil).</li>
</ul>
<h4 id="block-at-network-firewall">Block at Network Firewall<a class="headerlink" href="#block-at-network-firewall" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>iptables<span class="w"> </span>-A<span class="w"> </span>OUTPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">443</span><span class="w"> </span>-d<span class="w"> </span>&lt;C2_IP&gt;<span class="w"> </span>-j<span class="w"> </span>DROP
</code></pre></div>
<ul>
<li>Block HTTP/HTTPS, DNS, and custom ports associated with Cobalt Strike or other C2 infrastructure.</li>
</ul>
<hr />
<h3 id="step-4-remove-malware-backdoors-related-to-beaconing">Step 4 → Remove Malware Backdoors (Related to Beaconing)<a class="headerlink" href="#step-4-remove-malware-backdoors-related-to-beaconing" title="Permanent link">&para;</a></h3>
<ul>
<li>Use Cerberus (as in <strong>4.27</strong>) to identify injected threads and malicious memory artifacts.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">Cerberus</span><span class="p">.</span><span class="n">exe</span> <span class="p">-</span><span class="n">-analyze</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">Cerberus</span><span class="p">.</span><span class="n">exe</span> <span class="p">-</span><span class="n">-kill</span>
</code></pre></div>
<ul>
<li>Validate persistence mechanisms (Autoruns, Scheduled Tasks, Services, Registry Run keys).</li>
<li>Remove accordingly across:</li>
</ul>
<h5 id="windows">Windows<a class="headerlink" href="#windows" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nb">Remove-ItemProperty</span> <span class="n">-Path</span> <span class="s2">&quot;HKCU:\Software\Microsoft\Windows\CurrentVersion\Run&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;Backdoor&quot;</span>
</code></pre></div>
<h5 id="macos">macOS<a class="headerlink" href="#macos" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>launchctl<span class="w"> </span>remove<span class="w"> </span>com.malware.launcher
</code></pre></div>
<h5 id="linux">Linux<a class="headerlink" href="#linux" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>crontab<span class="w"> </span>-l
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>crontab<span class="w"> </span>-r
</code></pre></div>
<hr />
<h3 id="step-5-monitor-and-validate">Step 5 → Monitor and Validate<a class="headerlink" href="#step-5-monitor-and-validate" title="Permanent link">&para;</a></h3>
<ul>
<li>Confirm sinkholed domains resolve to localhost/internal IP.</li>
<li>Monitor network traffic for any fallback domains or C2 IPs.</li>
<li>Review EDR/network telemetry for re-attempts.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>zeek<span class="w"> </span>-i<span class="w"> </span>eth0<span class="w"> </span>dns.log<span class="w"> </span>http.log<span class="w"> </span>conn.log
</code></pre></div>
<hr />
<h2 id="running-script-examples">Running Script Examples<a class="headerlink" href="#running-script-examples" title="Permanent link">&para;</a></h2>
<h5 id="block-domain-via-hosts-file-quick-block">Block Domain via Hosts File (Quick Block)<a class="headerlink" href="#block-domain-via-hosts-file-quick-block" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nb">Add-Content</span> <span class="n">-Path</span> <span class="s2">&quot;C:\Windows\System32\drivers\etc\hosts&quot;</span> <span class="n">-Value</span> <span class="s2">&quot;</span><span class="se">`n</span><span class="s2">127.0.0.1 beacon.badactor.com&quot;</span>
</code></pre></div>
<h5 id="block-ip-via-firewall-linux">Block IP via Firewall (Linux)<a class="headerlink" href="#block-ip-via-firewall-linux" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>iptables<span class="w"> </span>-A<span class="w"> </span>OUTPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>-d<span class="w"> </span><span class="m">192</span>.168.100.100<span class="w"> </span>--dport<span class="w"> </span><span class="m">8080</span><span class="w"> </span>-j<span class="w"> </span>DROP
</code></pre></div>
<hr />
<h2 id="dependencies">Dependencies<a class="headerlink" href="#dependencies" title="Permanent link">&para;</a></h2>
<ul>
<li>DNS server access (internal and cloud hosted)</li>
<li>Firewall or proxy policy management</li>
<li>EDR with process and network telemetry</li>
<li>SIEM or Zeek for traffic analysis</li>
<li>Administrative access to endpoints</li>
</ul>
<hr />
<h2 id="other-available-tools">Other Available Tools<a class="headerlink" href="#other-available-tools" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Tool</th>
<th>Platform</th>
<th>Installation</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>Zeek</td>
<td>Cross-platform</td>
<td>Installed</td>
<td>Network and DNS beaconing detection</td>
</tr>
<tr>
<td>Splunk</td>
<td>Cross-platform</td>
<td>Installed</td>
<td>Detect C2 beaconing</td>
</tr>
<tr>
<td>CrowdStrike / SentinelOne</td>
<td>Cross-platform</td>
<td>Installed</td>
<td>Endpoint and C2 process detection</td>
</tr>
<tr>
<td>Cerberus</td>
<td>Windows</td>
<td>Included in toolkit</td>
<td>Identify + kill injected threads</td>
</tr>
<tr>
<td>BIND</td>
<td>Linux</td>
<td>Installed</td>
<td>Sinkhole domains</td>
</tr>
<tr>
<td>Windows DNS Server</td>
<td>Windows</td>
<td>Installed</td>
<td>Create sinkhole zones</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="operator-recommendations-and-best-practices">Operator Recommendations and Best Practices<a class="headerlink" href="#operator-recommendations-and-best-practices" title="Permanent link">&para;</a></h2>
<h3 id="operator-checklist">Operator Checklist<a class="headerlink" href="#operator-checklist" title="Permanent link">&para;</a></h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Detect and confirm C2 beaconing activity</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Identify domains/IPs and communication ports</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Flush DNS caches</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Block or sinkhole domains via DNS</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Block outbound IP traffic via firewall (host/network)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Remove malware backdoors and persistence</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Validate beaconing has stopped</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Monitor for re-infection or fallback channels</li>
</ul>
<h3 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h3>
<ul>
<li>Sinkhole malicious domains for visibility and validation rather than simply blocking.</li>
<li>Document all IOC findings and coordinate with threat intelligence teams.</li>
<li>Monitor after eradication for new domains, domain-fluxing, or alternate C2 channels.</li>
<li>Use layered blocking (host, network, DNS) to prevent re-establishment.</li>
</ul>
<hr />
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://www.cobaltstrike.com/help-beacon">Cobalt Strike C2 Profiles</a></li>
<li><a href="https://zeek.org/">Zeek DNS Tunneling Detection</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows-server/networking/dns/deploy/primary-zones">Windows DNS Sinkhole Zones</a></li>
<li><a href="https://www.crowdstrike.com">CrowdStrike Isolation Documentation</a></li>
</ul>
<hr />
<h2 id="revision-history">Revision History<a class="headerlink" href="#revision-history" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Date</th>
<th>Version</th>
<th>Description</th>
<th>Author</th>
</tr>
</thead>
<tbody>
<tr>
<td>2025-05-02</td>
<td>1.2</td>
<td>Integrated original instructions + expanded with Cobalt Strike ports, advanced C2 detection, blocking, and DNS handling</td>
<td>Leo</td>
</tr>
</tbody>
</table>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../4.27_Stop_malware_backdoor/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 4.27-Stop Malware Backdoor">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                4.27-Stop Malware Backdoor
              </div>
            </div>
          </a>
        
        
          
          <a href="../4.30_Security_Onion_Hunting/" class="md-footer__link md-footer__link--next" aria-label="Next: 4.30-SecurityOnion Hunting">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                4.30-SecurityOnion Hunting
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
  
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    

  <!-- Extra JavaScript (can't be set in mkdocs.yml due to content hash) -->
  <script src="../../assets/javascripts/custom.js"></script>

  </body>
</html>